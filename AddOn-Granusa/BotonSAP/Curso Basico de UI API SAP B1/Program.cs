using System;
using System.Text;
using System.Windows.Forms;
using System.Windows.Forms.VisualStyles;
using System.Xml;
//using Button = SAPbouiCOM.Button;
using SAPbouiCOM.Framework;
using BOTONSAP;
using System.IO;
using Application = System.Windows.Forms.Application;
using SAPbouiCOM;
using SAPbobsCOM;
using System.Text.RegularExpressions;
using System.Runtime.InteropServices;
using System.ServiceModel;
using System.Drawing;
using System.Globalization;
using Microsoft.Office;
using System.Net.Mail;
using System.Configuration;
using System.Net.Configuration;
using System.Net;
using System.Security.Cryptography.X509Certificates;
using System.Net.Security;
using System.Threading;
using System.Linq;

//ADDON GRANOS Y NUTRICION con gitHub
namespace BOTONSAP
{
    class Program
    {
        /*Agregar referencia ui api
          Agregar cadena (0030002C0030002C00530041005000420044005F00440061007400650076002C0050004C006F006D0056004900490056)
          agregar referencia para el Application.run (System.Windows.Forms)
          Revisar la arquitectura del proyecto  sea la misma que la del cliente SAP
             */

        public static SAPbouiCOM.Application SBO_Application = null; //SAPbouiCOM.Application SBO_Application = null;
        public static SAPbobsCOM.Company oCompany = null;//SAPbobsCOM.Company oCompany = null;
        public static SAPbouiCOM.Form oFormUDF = null;
        public static bool accionBTN = false;
        public static EditText oText, oValor;
        public static String botonAdd = "", codigo = null, DocTotal = null;
        public static string btnNC = null;
        public static string FolioIni = null, FolioFin = null, SerieMasiva = null;
        public static string compania = null;
        public static string p_RT = null;
        public static string p_EntNum = null;
        public static string v_AdicionalInfo = null;
        public static string v_RTa = null;
        public static string v_DecimalGR = "0";
        public static string v_version = "4.0";
        public static string v_addOn = "GRANUSA_FE(x86)";
        public static bool v_permiso = true;
        public static bool v_Jenga = false;

        static void Main(string[] args)
        {

            ConexionUIAPI();
            ConexionSingleSignOn();
            //ConexionMultipleAddOn();
            SBO_Application.StatusBar.SetText("Addon FE iniciado Correctamente", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
            // Cliclo para leer todos los eventos de tipo itemeven
            AddMenuItems();
            SBO_Application.ItemEvent += new SAPbouiCOM._IApplicationEvents_ItemEventEventHandler(SBO_Application_ItemEvent);
            SBO_Application.MenuEvent += new SAPbouiCOM._IApplicationEvents_MenuEventEventHandler(SBO_Application_MenuEvent);

            //agarramos la cantidad de decimales 
            Recordset oDecimal;
            oDecimal = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oDecimal.DoQuery("SELECT \"U_Valor\" FROM \"FG_PROD\".\"@APP_CONFIG\" WHERE \"U_Empresa\"='GR' AND \"Name\"='DecimalesFE' ");
            v_DecimalGR = oDecimal.Fields.Item(0).Value.ToString();

            //control de version del addOn
            Recordset oVaddOn;
            oVaddOn = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oVaddOn.DoQuery("SELECT COUNT(*) FROM \"FG_PROD\".\"@APP_CONFIG\" WHERE \"Name\"='" + v_addOn + "' AND \"U_Valor\"='" + v_version + "' AND \"U_Empresa\"='GR' ");
            int v_existe = int.Parse(oVaddOn.Fields.Item(0).Value.ToString());
            if (v_existe == 0)
            {
                MessageBox.Show("Debe actualizar la versión del addOn!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                var oMenuItem = SBO_Application.Menus.Item("43520");
                var oMenus = oMenuItem.SubMenus; //If you want add sub menu by using this line you can add sub menu
                oMenus.RemoveEx("FG");
                oCompany.Disconnect();
                SBO_Application.StatusBar.SetText("ACTUALIZAR LA VERSION DEL ADDON", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
            }

            //autorizacion para el MENU
            Recordset oAutorizacion;
            oAutorizacion = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oAutorizacion.DoQuery("SELECT COUNT(*) FROM \"FG_PROD\".\"@APP_CONFIG\" WHERE \"U_Empresa\"='GR' AND \"Name\"='PERMISO MENU' AND \"U_Valor\"='" + oCompany.UserName.ToString() + "'  ");
            int v_menuAut = int.Parse(oAutorizacion.Fields.Item(0).Value.ToString());
            if (v_menuAut > 0)
            {
                v_permiso = true;
            }

            //Recordset oAct;
            //oAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            ////////////////oAct.DoQuery("UPDATE NNM1 SET \"EndStr\"='002' WHERE \"SeriesName\"='1-002NE' ");
            ////oAct.DoQuery("UPDATE "@REMI_CAB" SET \"BaseRef\"='', \"BaseType\"=0, \"BaseEntry\"=0 WHERE \"DocEntry\"='15120' ");
            //////oAct.DoQuery("UPDATE \"FG_PROD\".\"@IMPPDV\" SET \"Code\"='53' WHERE \"DocEntry\"=53 ");
            //oAct.DoQuery("update OINV set \"U_KUDE\"='JVBERi0xLjQKJfbk/N8KMSAwIG9iago8PAovVHlwZSAvQ2F0YWxvZwovVmVyc2lvbiAvMS40Ci9QYWdlcyAyIDAgUgo+PgplbmRvYmoKMiAwIG9iago8PAovVHlwZSAvUGFnZXMKL0tpZHMgWzMgMCBSXQovQ291bnQgMQo+PgplbmRvYmoKMyAwIG9iago8PAovVHlwZSAvUGFnZQovTWVkaWFCb3ggWzAuMCAwLjAgNTk1LjI3NTYzIDg0MS44ODk4XQovUGFyZW50IDIgMCBSCi9Db250ZW50cyA0IDAgUgovUmVzb3VyY2VzIDUgMCBSCj4+CmVuZG9iago0IDAgb2JqCjw8Ci9MZW5ndGggMzI1MQovRmlsdGVyIC9GbGF0ZURlY29kZQo+PgpzdHJlYW0NCnic7VzrcxpHEv/OXzFfrkq+ikbzfrhUqUMLOCSyUADlrup8HwgiDndIKEjyXfLXX/fssix4hWYlFuOqGAv2vT093b9+zExzwuDD4c8pTp3z1pLxTYOHw8fpD+z/lh3hhDNGBAsHGTVKWE8YtcYwRY6XG/mJ9OazIVzqGfeGbP4uPjZOOvBQwcjwl8bRWa/fb7Z6/Tdk+O9Ge9j4sfBige9NX6vJfxuMeEVgB87NGlrr8HvSmnyajif9d2ckGYRzjAySxqDBwz3pZTfhF+6epQ+ZFS9cvU/DJ+cED5/ACJ9efWw4tFI6aC3JN+GCk+4NJ605kF4k3mdPKzQHPoXHAyUZq9ZYP7xpeDI8ByYJuABYVGjh+D4j/H68asE/j7FzTtWZ1UopLZhRBr6VMdxIq6y2wgC3jTYJ/OER0ZGmbbyRhn/7LzL8Hvm+anTg+Fo3EC4rES6rEH70JooEoeoj4VRZ5BHwpGOlYNYD99rAN+BU4JJHfgmmpWirSI7Jjb7P9GK1a5+g3y7pt1Xox77lRgD92I6c4lQS4EgC7WhB77etytrI4Ept4Vy4Iz+a7od72uEevFdbGdPqrFH1tPEomd9MFuPpnIxm5G6+IDej3+H7ekLmD4v5PblbzK8fxw+wdUETekmflqr1jtK8RtFufroekfej28fJjPQWD9M/yLvHyWIxWczJ+ISEs9CA2Yj8NAXSF9NRnC6YajhSTRe0QqRoe2NMBzVCNgWTTArJRQu2vLRSwR6TkZpg68SOZA7cnL8l4/ntw+jn6Wx6Pbr+28cFcPx+RMfzmzgpkN5Ty80TeL1FiXcJ4Ef9q+QtiRIARb2XFWmpxlfHmBPSsWMWq0epidgTr1BIEZzEErwQsM8YimqMUGpPOauXgdxw5axVsexLzdu+RK17O0UkBez5NP04uR1PR3GS58ARk6Jmxp0wfiKYkLGsk7pGQdulF6XMPlWkikJwTbW3tfYrY/w4/YN/0m7r3B83gwDOfTEKsK+KAmzq/tsnowCb+i2f9dOWjnNPcMotO85VEzkQMONQ3NAVha1OJnypO6cB+bzNnLzYLvaOCm0qEi6rEH7EQHVNUF0QqLeavVWR1oM9bz12yWG0tCfX8/HjzeT2IaDg9Bq20HeIg0HODXW+XmaCBWacKx9rgSFUfg5edsrD9/PbyXWk2ZCacv6Z2dgpu64GEIHPZqNFLLek3ye3htO7IGjj0c3P03kc14yk2rhauWaFAFD1sTzTz/nDO+XZ0rePkjBeu4RFuiMWrdQ+7QXw6faaBl8OQGz0NoZd1lItII4j69m1YFY52EUXvj8zo3gYifRpHm39kjU/URefX1OHJBjzXc+jAFtKKpwxdpcNXj5l/ZKb7FnrDOGKFwmohyOnSloBgTvERpjmiXL8nAL9r7WbLmejP0CLmauiQHv1B8BVNp0smkT/CqJJ9LdsM02igafVwZQapsKivS1GjasXu5Ne75KSVptc9nstSprv+pSctfvvht81z8n5sNWMTYEFhu/VeThVKKIiuLkV3VjQI6nqxZVBOxn2+uSn9rDd7140+90mSZrvL3tka9CyydC9+helSbsYdkqICkTN7OxeXFy9b/d7Vbi3V08jZJNs0PsswurAni6m0mP5aSWFkK1Ofp5qk+XxVwFhKxArQyoMttqtbRmJsvjau6JZxNzYKwJsvH2WPaZiiF2Th9RqDnsQH7TPybDfHJw3W1tk8bdNIvbuTq7FxeWwvL8g72H6KdYFB5Nn6oWSw8wmdCbjX8M4Tp5VnZHhYnQ/A+c0Np8gKKuXdZiVOWYG/h9kOqHEIwhjlNmI5RLp0vFJi8n/gH9RLi6DONrWm6wpHeKLTtzsNxWRTB+vR9dxA02eSlkv55qDq4uk27sgH45a3cGw3x32Prw5yHxEpIiaJAwQ2GCMo0VUUWXrTV887dVGy6l5bk7Dn3JaxrgvkBKKYlrtnv8BB/yFIRac3WJVNtel4FVb1UZ1b8GZ9lK9TYLHQ3JAhhk3QfHjRtgEVTUPGVS18V8g8v8KJXO/1rk1uRstHkbpyFQMs7ShjNWcaWpedofN84ON379CodqvKf1KhaokUyGZKWYqpHtNogLunqUPOYg0BTiYimulOloKhjN5FVgbbeDXJS0lNeyrqKT+n4kLCMgW48jBaeFql/VB0rzoNg/VWwwzhfJZ48Erwjg7ejKdoKxmx+a7ZGj41jClDCrU2qQhzV8DFTodHtT8gKFCSdVRbdjRABZ4TvwJI6+EkYv5zc+LCfmdNO8ms9k0Np9ndd0zN05VS3noSBByxbGTQRAS1da6xWG7uS37/8USpYc96pcG+BeHCtJhzlrSjUzFQ6xZL7ekc9J6cbAR/lcQEpSYLMVCWID7+I2PmGUGbNBQjgrDnA0n8531awS3lFsZRiBvCnsbVzkP+ATmIb0q31u/CqCFOs9luCjf2aCJMwpvkS4lKt/bpFzQAuXZzvo1n8kFW28nXltodDDD2U/6GMBB7sjm7+Jj42ylFukCj5LOzTsQxSwsSgpLlIZ/bZwqCUCF6SFrOt+WrFEsUJhTzY2jwKwwpDMr7O2VbhwKBqDFJWzgzmWAW9aCotDkTbCCyrTzZ/n2Hsk/ulxMcCzt8Xb6MFpM56WrQwtinNNtGJXQHz6Ql+/sk/JklE4lLiO5oFMHRHH7fzhx8L6M4KKCH4xs6L+UkrpCmYOhlLMCqctIBIHvFaFIhpv57+rSHEBFuandBqlpDsTlPPl747Zw+04Xcr7vnv9wcc62OA8vQ9c9NuHiatjv/oNgS8h5MyGX51cD8uFIsh/eDbYNC70AdPfTKiMAmQxXVpMjTplk37At8faLMHhPDVHAOMaF4OCkRjYiHpX334bYjogG6v00wXGvQZ40IFF8EyIBfP8aISnzsa2Av8MDW75lHWoJ2PLDRtukOUh6L4VbfnDSxalk1fGWHyBY2W90NcA9xEZUR9zDEKlXQe5hNKGoFZ5avb0ZG8kTk7XhaWc+bR4jymeed76xigV+yd105V/jpat0PZDaWDO0h1XGT8Lo4Ops2Ns65FpYwMWoEualScQyErgRoDCAXUpGZuc4p5Yzr3dHg/GeU480RJJgPBVYAWB3JGgnQcQlkzaOBAmGCxPmLxxgKyVBY/GqlIRYoJDWY7L0hcvXSvvCcrnsi2i40oxyHOeqhwwuqFPxmJMVSKhNYU/DIJ5SPAzuhcpeKlEcvjuaKa0FnAFL2pKqHTUDTYIkSct2qE9ceSWQe/DQOIXSjhrHzAtXHJabbnBbjdcuVp84dZaJHUqyls4Ep9hHkqAN4qDeYUdUJUExHlz9HaJKxX5QWlFQ511aGJy2kFFQWZO526Mqa9WGb6u14kGJ20kLB3CjlBhrP63SRjtRYi0cpyALnkcqMXS0E2KXsqO9RD/UxWoQkxDNcfXCIfZyo8gsNeDNR3onEpkgxS41qDIJHlQIAPgLdgTqvFOS71KLJddLErwADxAiEBu/aGk3s3Ce1GMwwF5z0FyPM3CW5he0GYxgXGlIb6hl3PPdEoZjIjGqCxLGNduhxKSFf2KzF0ZT5r2qav6fazwOs0TZfgNRjXI7tP3p6yk39huxZXl4ccE1mCbrKvsfz7EgRHak+9OWWYYFtTWWKidfWjClFLyYt0u1fZ4fJXMfcO3ouLAG+VUze3maqeBPzuzFz6uAoto8kHQBPBZr6Lffdwe4jmi9Hpo+5AXJn/eVs2t9JV5VkA1vn2WP2V6YuUDEeinlvDvDRFRgRfj1YfLgSfdGlFRndpvFPbnG/2v8TTNKJQyGExmHcatCfRaszmCl1Saxy9WCWOXNZCV6cc5Gc1XnLSxM4p+XclalRQgFzvLohLK/YaGSaXeaWWmAzmp6L9gtCXvetLISwDKcxeLB3DTDtsaJeXGLmsAVq5VlR78+PNzdvz05mfzncfQwHdH7yQP9OP9E734/Gc9v7x9nOHEhjlS12bvyKVJlTqqsUv6OOzjgBKgdqDRhWDadhy1MtUD3CFy+EBKVeCz7iiTeyPpU/xSjD50mGCBOCXOEWxilYNSC0oazjOFYG5MPELGAoxq+ZXZN0Q+yWiRcGfCPZEhVhKfqNOIpfTZ4VGG+shb4hHAfHBdOO7guEX57IYsiRHC20cE7LbGtpfFYC8imBdY7BrU4L6n9RGHQTl5oWxaKdqCuW9DNoKkWqw51sBBbWEuss8WHqMlJWnwc78LzKVbAOzthPppJtX692De+o6jveA8W9pbwtaokGUp9Y0UjC2/0GWUaj5oCKq3XmdxAJZ2hTYoinYAe4SkiKhmlseZBfb211ZjlNBiO3ihYApeugSx5+QqvjvgJX87l+T+DFeJNDQplbmRzdHJlYW0KZW5kb2JqCjUgMCBvYmoKPDwKL0ZvbnQgNiAwIFIKL1hPYmplY3QgPDwKL0ltMSA3IDAgUgovSW0yIDggMCBSCj4+Cj4+CmVuZG9iago2IDAgb2JqCjw8Ci9GMSA5IDAgUgovRjIgMTAgMCBSCi9GMyAxMSAwIFIKPj4KZW5kb2JqCjcgMCBvYmoKPDwKL0xlbmd0aCAyODE3NQovVHlwZSAvWE9iamVjdAovU3VidHlwZSAvSW1hZ2UKL0ZpbHRlciAvRmxhdGVEZWNvZGUKL0JpdHNQZXJDb21wb25lbnQgOAovV2lkdGggNTMzCi9IZWlnaHQgNDY4Ci9Db2xvclNwYWNlIC9EZXZpY2VSR0IKL0RlY29kZVBhcm1zIDEyIDAgUgovU01hc2sgMTMgMCBSCj4+CnN0cmVhbQ0KeJzsnQd8HMXVwGd294p6L5ZkWbLl3rGxsY0xPbRA6BCSUFJIPpIv7UtPID0QkkBCb6EkgdAxbmAb94KbXGRLllVt9d6lu9vdmW9mdu90kk53e5Y77x9+jnTam52ZnZ037817bxACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOBshwpOdy0AAADOHfDprsBJhAmM9c2lW6sPlLfXt6u9soLTHEkXZky6LGdcKk493bUDAAA4uzk35QeTHO/V7H5sxwf7e6o9sqpjrEtUwljRsF2XxzqSfzX/jpvHzMX43Gw+AADAKeAcnECP0vbHP136Wtn6TlmjiOqYUsxFCm+qJCHC25zscf5k7s0/mHw1+wykCAAAwHFwrk2dTPO4d8Mzb1Rv1WxMYmBjz8O374GFtGAfylSKc8sPXfDF70y8EuQHAADAcaCc7gqcYN6p2vHuse26gxKJUjL4r0yQYMI1EaaUtDvUR3e+uzBrCuWC5kwUIaxidQh19jZ30K62nm63prk0TWf1p5rGW8HrzH5FROMXk/4mYIk1URI/YK54SdiGFUmmNoJz49PmJI49SbXtr8DI+rOCF9Xudrnb3K4Wd3uvS9U0lbXCITujoyMyIxMTHE43iskJ/0bH50MR5C6swGbUfKxbPdrW0NTbqiKqYCk5MmZsfFZGdHr6GTmuTiqsQ6oRcrJxi9pike5CyVni85P6irGbNiDU6qprdffVdbV39fZ4iNuFqAMrTiwlRcWPikuMj07IQ9EnuyafNc6prmTD6IaVD6/sPEglQhAOOFdgQ4oIPUTW8Ldyr/j7grvPqCFVQduK6qt21R7e3Vx2rKOx2dXZhTyECwheSUyNh0bZ/7DEhKT5CKn/i2G0HBtX8SvY70ymEEzHSyn/vfFXk5zxYVVpuP5ppa3b66r2NZUeaa9udHX2am5Zx06bMzkiZlRM0rT4zJkpE6bHjArZvezBHXQ3FjWWF7XUFLfXVLTXNbo72t29GiU6f1TeavBLsUJQrD0iJTJuUnzm7MSxM9PzslMnjbfwBNld/rT17eXN+xQmXDG3ZfL/YSaY2I8Iy0zC8v/H4jOZfYok9sMUe/rvLvzioCawovZ3H1t/rGBj9cHi1qp6d6cuEbHNxvoZyQSzojKd8QvSJ12RM+vS7LwUnBK8Yofb6z1ObEeGusyen9P4k0KJT+Y5KO3jteOPI4LSiMjkFAutruroaEZuha2mHNSG2HLDaRe2XJ1Nr6JkNdLJRlcU/4TISJIR1lD06HDeiBbasq22ck9jeUlbVW1XS7O7x6V5VEztkuSQbJGKIz0qYZQjITshdXpSdl5ixiRn+sjfOLbIqO84eqixIr+5vLS9rrqnpbW3vZequsTL1hHvJram4o+DUjZm4m3OMZHJE5LHXJg+eWHGtLyIxDPqrT9LOad6cFfXsevef6jR7mYjg4iZMwgSt2PhiTRp6x3/SDoDRhKrzYHuqtcKNq2s2FlF2jwyMXZufFY4o4rGoKd+3/KV4HsfzCu47tHfC2xe0GXkdNNpMZmpEYmEsImJKWnIlC5MMHkFEe89rs5g3kUIR2j4t0vumxozyr+25X1trx1au/TI1jKtzSVrrGSCzEoasopNczYNRxLbpKhRl4yZecP4+XPixgydhQ901a6u2PtR+c6Czpou2aVLVDNkuykDRaN4LajXFCkZH/K+oYhpVFGqnBeRfvPkxbdMv2Qsjg7ew1/f8OxrdZt0rqAFGhzUr3q8P/hd5tuzt9z0J/+a72irfir/g4+rd3coqkei4jqxw4a8wpyIOopedarSec7sn19011VpU4arWB3tWvLc9zqcTL5zCeSrGhbLBf8+Yz+KOZFX7Eezb/3erKuDtNfg+xtefKN8O1s8eEswliHeZRTydTH/WaaYCb97J1724KI7Q5bM2N9X/3bBxuVlW8vUNlZzl8IHLCuIeIclNu5BKR8SFClEitZt46PSFoyefGn2rPPTRyWj5LDm8SpKDzUWfVS2Y/Oxg+Wepl5Z12TkGy3e1vRPbH414UOHNVDRUaIeedXoWffOvHJhYh5IkZFwTtmv9tdVdGHVfOFCGSqM977e07m7sei0m7C2tJfd+PGjGxsO9th0XWFTu5i7vBX1v3LQjs7QP/n9PuA3tt6UdLYQRfl91bi32pg/qNlVFNMhzcdGiVK8W/5ub4fvY6YevZC/dsHbP2y1uzU+3/jqaf4j5jiuLek20ie5t+kVn5ZWPF60bLEjz9fPVbRjadHuuW//X6mrrlfBfDa38+8TiYkusyzs3yhePWzOekY0j5gPmLxRFX03rdlz6O0n9y97cPfb9865PBcnDNfPKtcS2F2Q/8oJ+3rVT6hg7yX+ZtCq3ubfbX/72qW/7LRrul0XHWgOHOpT9PxgMtVl07fqR+9c9fCXVv/9l4u+OCkqgCJS29Pe4lDbnbrxFW+d/GpidIDRuUx+EDYX07Ke+uGa6YNr5Ksfbox09Tetf271u4fvI8KNnyXd9SHfiHLa/fj2N6946+dtbBiw2kRgWUd0wNRt3M38gC2GWM9rWO9T9GatckfF0adKPorTI6Yn5zxeuOpzubNCKiWfdle9dWDtJa9/u4Z0aAph2hK285eEeGWi8aZ4B8yQruB9iNnqRJVQndL1cuPWN1bumBc3dkd72fz4caE6EgjMOSU/ajrq2AQRUnIYULFOcUtaSWv1lamTT3LVhoVNxy/t/viWD//YKrtUBzHX3sjPBuXFuuU+4JX9Sglfvw6+cqj4QFxFI0z3Z12qSeaFm1pL7/3w8T0d5b1MzmEqGRXFg79vTvKsh8VKnMikR9JjUvlKs5Z2vlKw6co3f1mptrhtlDi4oiNmdAmZTfeXR8M3TFyIjQmX14TUKOojxUu31hR82l56QXzeMF0jIe88E7y7qJiJ2NUepPnaftfKv33qOaY6CeLDzKjusFsqxsdciUR6h1N/u2lX3Sdthzoap8YNjj3q9PSyTiZ88jZ0rf46Ua9IMud/IeoJf4K0Xeuzsu7pcPdiU9P06hwBOri/IPbXPqIGL3NZ1d7b3v51oaeuz6mzLzJ5hjSxAef//PzKNn8QyrToNNZUwpYy9bbe5s6ijfnFf9v93p1jFw/XnM3NR14tWPOF93/dKrtVhX2fGNodNRZAlKLhnsFAfLqILrGhjVw2sr2r5KZVjzx2cMXtU6/JAEUkfM4p+UHErocxTlFAA4XAt2GAuHcvanN1n6L6DaHQ1fi1FU/saC3ps7OqEz6HGuup/vnjhN1LmMKMOZf2z/ZByyf8ZefTu6Z72K9spXb3qsfKaJvG5Byf7CUhHQbPGL7ZyZAeQipghyrPTxn35eYj17/328LeBreNYEVMA1ThLZaouaPjJ4dCNL1/xYlMsw9fWmqbekq/svyxDa2HLk6cOvgbGN+74Zl+602AIv3q7ruK8FYwBfGeZX85JneqMjcFsfvpg5WNgXXzk8yscUyvUmV9c3fZt1b/vbKnKWegFqK5VLHtIgnFc0CxAUaxKJDdoqevZ/je6adX09jd8UBfEur3FngHhan0MTHQobmDFPjy0c33b3i6wdZL7HxLjYlkgv1fqmF6xXywuvD7YM2SRNMoW5ooSK+y97xQuva6vAsGt5XSJ4pX3bny0TpbL7Jx3VFYHiVDcOP+B2UV81LTiYYwsVqvd/4q/62qzqbTboQ4Gzmn5EdSZIJEZYqG+F0FQiLmeIm02U92xQJyuLPm3uWP7es75rEj3ZR4JzPDir9IsnYf4YGAZV3yaNLu7qr7Vz5eglqp2HsWq26foSDwW2e+3OL/2BtfSBoeW7W0QerUbVhHpl2fenWigXUMozm+FomVO6ssLZfav7vmhf2dNTNjMwd/yTCPDVvk4Iawh6JSWuru+MWGV4+xmkv8IhJykhnYHHONjJnI0Xa6j/5211uDpqpe6iFebw8auKQBH4kKkF7VFaoe4nKxjzb0laADfvCpCFzSuDXPcKW9UbnthxtebFHcOjc6GlLJ2rA1r5F8v/vslEIDxS6J9OoD5FY17fzG5ufertjWZdf4ZrgYJ353xNZH8uBaGEOOGpt9uNehvlC6jo2cWkpBCwmLc0p+TE0bF6UqHlkNonwMAGOnJk1IGH2S6xUApnncu+Jvu9Rq3T6cwfaMgM19bMW9rr1o3fadB/VaYSH3mqzCKYQq+r8L17jtOqVSkIX7CCGGwML0EGn4+ZaXW2lrIk7srwal92x8OtwJp5W6vrX1ue295dzKP5K6CYOX26a9XbX9isrz/f+kEyNWydK6B4mJk3WpSw9hZTILt7acMhELe22YkpkCevvyR2ojXDaNij2rE/UcedOZCIlyOv0+og9sfu6V6o3IjonstyN/otGFJOu1e14s+SQlMga0kLCQQl9y9jA5ZfyYyGSb2NkIPQiE82ayFDE3Y+wpHjEVtO17q5/Z7akyDben5OYY43CbKXbYaZ9dfXL/0oN6vc5VEYwseScMLsiNkYfPCbJpZA/r65aRTBWC6jJZ33b4yf2bhlQkPNj1dbh7Y8MBVdbEfsfxT5lGJA77r9dGn9m/wn/bhHC32jAKFr2HNWtf0cOsMUaBdxMqKP3z9veq5B5FZ0uKE/8AWYk2R4Tv16O9vcsqd2kKJhI+mZlPhRsNN8FJHoU8deDj/Lbqk3avc5BzSn4w3fP6cfNNhwzDzhpoqqLY8IwkWEdXZM9NR8GcPk8GL+9dt62jTJd0Yuz2n7y3Q4QRSlhYivkeKsE83IHyDWtLNxUzJpWZCkL46pgYbkZhwrfZzf0oYT46eS02dCPu2Utlt6w+d3DFoOnA2JCxeH+jnpqw0XMH1JHV2jDX8y6U8N6O0terdvj+ZJpmLIKNxTp/cytDXSsuINbltdhVoAQHUFl21+xZ23SIYKpL3s2S4NVEhieAGbWEsbkBZ7j0Yr8qmUsoiiJs/dNRk6epA6mIEN3fCf3Eg4XXHZdQOqbNcs8/9n4Aibqtc07JD8YdUy7MxHFCwdeDXGZs06ZrEXfPvOIUKx+HXI0vHfrYJRM6TIRjAPCQ/ywiPKOi3EqMW4l3O+I9zlQ1UuaBiAH8dYMT7vXG3cV8IY1xpIyNTQ+z6iOFdW+j3PfvQ5+MvKATO50wSdxnJ68fWH/c85SxccRe3ZxQV7ILZGzRmNtfuDTkjWBVfXrP8h6bavxiqRz+XhmxGGIgGA7X3JBpjPvBhXD3B79fe4lG0MDgl5MMUw1Via6q2repq+yU3fRs55za/2BMjhj1z+L1P9n+SmukZrhgIr8Fp5H8CvGQVJygRfx2/p0L4nNOcQ1fK1jdoHQTCVufkjE1Td7hzjdsHTlGjv/VwjuynPExzmibrLSr7juX/aHF7kJm0JglBnSi9buLajs05b4ZV6wr3V1O6kkYjR4ZYuFLKVlfvb+eUr88ImfA0lJs++5qLS3sbDI+EPHv4cHao2BL3zpuue/PhqYj+9sriPC7s9KDYk1G7Joc5ZHjbVF2xdbrcXfoLreNeGRCJLG28/e1E4UqHs33iUt1E9OUdupECFtVtdvc7x3cDLsgFjnX5Afj3gkXRzgcv9v2Zhlt0THSJa83r9CD2Qxm16UxSsIfLrnnlsw5953auh1wNdzw3m914b4UbHgaAdaUYCopBDk1OUZ22GSpR/f0EdVlI8SMTQ7xLlOJdrr7JsVnLowzc14dcTWYEe04TIkQ/sSLMet+JQfH3pizcH3Jbm5VwoHvOTCSzS9ewO//zOhuy/JHePXQo31NjZ66gc0IXxIGr3H432XTcIfi2tVcbH4i8qdYLtHoBWpTLL28EpbDrawsyYM+WVu9t0fxECtTOeaxjYqGznOMvnv21Yuyp6Q7Ull7bQhVuZv3VxdvqS/cXHvwqKfFrRCv9zUSrlzYrfXbDHTuyzys8AholB7k+IxNt5QwbHfsX1Umm6sP1oW8GhCcg/LDWDjs7q56duf7K6r3dSOXLvM4D75kU3E6jrt+7LyvzLh61sCEHKeG9SV7GvQu7oI0/CstFH8i60zTV1JoFKvt5/MWjI8dhZy2Nk9nfm3Fy/mr9vZVemxGtEswIcJeom6srjq8EwlVjBWsIWxt5+NEIPJVXJ173hRnAhp+LkC+rsCG0sCtHNh/4WmEnCFfCJzVu7OSPDZa28KX+WeQUZu3RiKIlLZUGR8osjJ0yR+sADF8HLLNysWSmYbGeu2QogyQH6zrblz9MI+wCd37/Kmxts1wZr50zU+nRiQGuILSCtSzunjH8/uWHyJNqrAz81gg7hHQX0uC9CCxHQMkhfHKU9JvjTc1dTzk2lB1FzS5O/W+Fqvf+mxzDsoPg7nRo430SnsbS6t7OzRNT7BFjo1PnpqVlYtST4tyyupz9fI/MhU+5GVIxk7Vdmf24gfmXTPDkTGoti205Yl96/5euLxDFpl3hy+KTbyqQpZX7qz3pnYocjed3CgTP6gkR7jx5/Lmi6pg79o/UD1NjYhvDpie+TwxhSQbWqNk/o39rIezY8e+qmLU4ur0feJLjnIc9Ffdz/R3fGUZ9sDKHjNmTaE0DKFuxolYlR9ymMYxnlUMD5AfzQiVdjQQQ+0Jab4SvhLXjJsfUHgg7/KOUUq7Xt274pVD6+vlXk3RRYyH32UotH3V8EPjzeOaEReTsqHhCjOpLvwMxGZfeB5cLk1t9wTbPQV8nLPyA/mN1DOEqt7mgpajyBnaH9/plr8z4ao/nH9nwCYk4ST2Pjhtzj/sebPbEezF4H+TSKWrpbiuJG3UePPTkfUKtvY2YhEYNi4iaULKZOT1whmuKNMtgDB9BTt1OUWKGhWdnB2bluSItku2DldXWWddUWdNq8RUyTCiGQztrNXdH2fnzc90/BLUcIKWddOdiFtHj0OzEQ2v6zMFm8g6GO7mErYY92qTBxujQhSMkF0eMC10oZ6Wvg7qsNBxxqyPTTft4LsIeZgHW1w34cLfrfvX+vZCO89CoPiVJOEh1s5+SWjoF9xWhhwaTkJRY2LSxidlZUUnRNkdLlWv7mza3XCktK+x26YTI1eR5Q7mqbokS7E1wLksP840Dnc1duJeIokzSAZOpqamzZd3lM0m16ec97/DCA/zeoyZSrGnpviD5r0am1KpTAP5XPIUujrqkbW97RVLMiYYux7Gqi3cCYt7jPI0Skis8ngaCZlgmy7ZRPIKXXgHe2SicZUBGUlkJUJnZ03JFXOlJEaaT4hQM3sRIcJDx+HBydQ5J23CgvRJs9MnTE/NSh94VAMrobir9s2K7f8sXF2Nu3gqSCmUIxBPrsEnoB61Pz8N9YYdh9Fw3mdE5tspcqQH5cWmz0rIHR2TZLfZq7qbNlYWlNM2kc6PhuMQwQ2q7X0dleJXm00Ry2iropH1HO98xRn6UlY4toXrs6DgAZpNn7vXTVTJUuA973FdwhuPFTRZWWSI59tC6QsFy1/f8bHTL6yEST1TJ/UzRZnf4jeiUZoyMSpjSda0i0dPmRGXPToyGaEBS8Ym2rSrvu6VgtXLG/PdChE5J4PXxietzhhT5xkPyI9Tx7G2RlXBA/NbDcBI9TGKxPx8yW0hjx5iF+zurtr6fnGd0j38gOevjCahys7GkdRcVIWbliI8UgJ1zkrLuzhr2rTEMVmJyUn26AikNyPS0tpa0dVU0lq3v7WSqVn1nnZE9c+NmvmiUYLx0gvXf5E5hgfT2TScrEcuyJx0Y+6C+bnTx6Ho4USm7/PtraVf+fjxMqk1iDXMHzbl9Q3I5hT+1MBlIc86fsuY8++eec2FsTn+9amkTb/b+Oa/67bznIDhOcqiLnef8fo5JFtA6R8EdvsIydLLa7Nm5vJHpgNUFh3z2EkSzADZXy3u3ojJpx0lf/z0tR9c8BUrjkxJYoVxc+bcmJj0/mpL3gWHGTkk0iZS7FTlsc7k68bOu3r83LHx47OGNzMYZ66wkv9Q8P4fC9538dOszyyDxDkAyI9TR4fWrRsR0sN6TvFXYWH6xBmODCsFzonKmps2fkXrPjrU/0RADc0d07a+/jW4qQBgyZp92fyB6RnJWtRXJl5y+5RFM6Ozgx/JV4e6jrY1FtVXLUqZ5G2YN2c6X1NKUaqUpjlunrLojimXnReVZd3SuCAx78kja3+885U+JURgtc/50xVWAo8hsHo7VelXc2/7waSrh9YzB6ewdW7ph41bei0HDWDjwSC3rhkahKKEaWkVu+1RdkfoCzG+/uNHwjLZsbncpgyoTqTdIXI64NBRjmbqaMkl0+dL1koy/vn5X7YiQoZe4JAUkSrZvKdCsF1TxigJd8++4q5pF2eiGItjxrCR7m+qfK9xt0XxAULGOiA/Th19VEdExwoebh3EJnpJRxOTgs3O/rDLHsp/e1XLfm24la/pIEl1onk/oN7thtDwmV4Yj+M023WjZ39r1ucXxOYex1xgVEScqcsaSLJR/J0TLrpp8pLZ0cdzDt3N4+f/fdd7pag9ROV99yX98oNYNtv5yU56dcrsmwIJDwO2zn2+eN2ne8qJ16RmKUJCVKZbtMImO4xjqEjgZcCgb5rmqCh7hJXekxU5zOQokl0ZoLLEosSkiPgW2kSQtYEjshK67NqTJWuPNNV8d+4NxxFOYaOSsD/yezL5PdGe/sXzLv3ylItG4ZifhFWQGJBvV+9eXrfHpYRI3Oa1loZ5g88wID9OHXZ+Nig1VnHDDVEZ0XgL60ofo6OSg3rGcvh+r6wM+Sw0PNcJpukk+i+X3nvnqPkj8UdQEFao7NSka7Nm/9/5N8+NHv374y0qHUXnJqaVdoSQHxwxWRDa70tjJOqzAvUWEO2WvjT18tygbb8gZ1L0p0qbrIY18/SHvFA5jDgFZLin4Rir+x/h7J+LHSp5YGRiCkJTE0YfaWvGocKWfPDDyhD2yNrH7Yd2fnTkujHzNraUjk0cZ/1YXCzLEpLtOo1H0d+e+bm7p182Gsf9OIyWDGBS8mg7kTyY6taSVIblTv1ZBuTHqSPeFiVRWTeTNwxj6KeoV9cC/ikEw0xdXHgQKc0Zi8RCrNDVaD2FFdMV2BJwVGTiFSMTHowIFc+WMn540fW3ZS8cuV+cOF3b6na1v3+UCC6xhmF6JyhVjpuZFSJDc6p9VI4zsZ02BMjLYQHJTkME8vgjdgPYBBdhbWMjPPkhRqAy0EmaPa+/H/xoefMBl6KHEU3BDx2hHkVvlPV/1Wz54OiuGYljHj248prRc6fEpoQcAzGyLdUTeem4mffMvvqC+DG/DKsNQ3BrHmpaDS214JT5uJ/tnJXyo5bS/Jp9u+vLutW+zKj42eljl6RMGfmsVM+KrS/YWVfc4uqKlh1T03Lnj5k+HseckDozcmNSFSKpkjbs4oYiTcbFzdXW9f3qvlbdUECGeTN4OJiOxsbznUkj/sN6hXUJS4QoOl/AjzCjw0/n3Z6XlhCP428/7iK8bO6sONBZF8bI9V9Nh7nFLVE0LSU3B8UHvywNoez4lP2tDdzp1LI/L+bJGXnJCg3rNTSfgt1aFyhh+u+yR60og6XstWPPf+7gimLSTCRjVyKU8xs3G3pP0KRYk1Crw7W5u3jb/pJH8t9ZmDzh1ZLNF+ZNHYcDx4gw4mMy3rnp59MTwtgbG7YmlP754DI3zzhndSMI9A+LnH3yY0tLyZffeyi/q5J7dkvIpuOIfGl+8oRPu6suiD7OkzzYCFtaX3D7u7/a33XUbaNiRkb2YmmSnLqsbu/nR80+ITXPSkiKJnYX1obaUEx9BFOmeuxpLK1Hlo5E5Kdbr/0z92WSCA6UURdLEhMADiJPS8lGYiFZ4mqQjFhwK8dNCHOxEdc7ktf4RAXisPbme+p+vPqFLtkT2pfU/A67t+z3m/BesHB0haHfsJtkRSWHvAlr4H2bnjbmptASxOtOJFMprr8Io64yCv1YhCSn2C5ZjD+Xretq3NzHKzFYfoyLSHzgvBt++umrfTbd8MWiFqdiauYSYGgirUKr4v6ovWDd9sL5B3O2dpQtigt89nhI/0MrsAdRg7qeKPr4if0fehQaUvP2mQVAfljkbJIf7Pm/VLrpSx89WiP1aE4zO45bIbpC1nUeOvLBH/9euPrWyVeEe4JYG217aM9bTxV93G5z0UgjJw/Pca4p+h5U/81PnnixZN1X8y4Z+SQ4yZk+NTZrg7sUowCn4Plcz8vVltcLt1kpcGtr5acNJZhnWA28rmYyQtZxljN5bOIw54FbwOpu+0mAPfGyvtbyrtqStobKzoabVz+6u7mkTupVZWLGcFtAGkHtWbcmREZZefROc4fJklexUbKMJZ+ssO4iJgQNF/92xZJiIYdhczKgyhDPYNYDjZRuP1b0duMO1vnYe3BxuIjM88gjU01SN7lK71r+l78UfPjFaZ8/Uaf+GZK7qre5pKtlX1Pp3Ruezm8sLtXaNEmnYUhRwCpnk/x4+ODSP+19u8fG3x6JR5CZKyBNJIyqxB2/3PXvLTUHi3ubJ0aGXjMabG+vvG3pY1t6Klw2TcTGYa+SS5i+y9Zi9YrrZ9tesdss7VUGh1Xz8cJV2/eUuexBlm7Y5SCP57/3UXPhVclTgpR2yNX41RV/aZVd3rC8wYteY9ZTCL514mLf+6lTB0K+aHBLM8AptgWzKWBPx9GdtSU7Go/Mee9HNd0tXdjjVpCxeUFlJPNsH2HES2C/DQDL7lH9OBVLYd7enOeW94dFmLcR5ax7Mz9RGnqGM+SmSPNiaS/HJolknJZbzdRYe6DZPBXjOtrVvrxzbWehKgc7BjgI4ugZ4RMn7lAldf5m79s760pKelvGRyYdV5GcCkrbemq2Vxbct/HZQ62VVT3NncijSrouUV1CMj/0DFs/MJGGVlQAk7NGfnzUUPiljx/tsYukgUZiA9/Zffx5sykFdTv1DxvzOz7psjgcV7cV3b/qsULcrPMZxjgwxFje8R804fLOXqc2u+fhne+U0q68Ee+FXJ97weP7lh1DrebLP2gOp2aunjq58wfrni/oqp0eEzgQ5FBf648/fiJfrdMlY0twwHDnuX+41YLNtyRJirtj0qIHvX+SsFucq2UpFzz25kY9nqaGD+vhdcU7rlr++3ymcsgefmgVu7tDHCsoDjYyeoc/LGIlExOHZ3PyT3tBzfOzQxLu/KGa0c0Wdz+4oLApdiOzCvGI/LtWp3lTA9HDUADCaA03ovGAlAAPfRSOYW/Wj9e/tLp1v8uuEW5tw4aFyuKtvFeaLohEoj0O8n5Lfvuaroru7tzosE9yK+1tebts210fPHiks6pbVlVFbJPbkGkiFl1KxJtgHNUWHHMJgMF+ZZWzQ3600Jbblj7RYfPo2Eyv52PQmNBksr6r9M7lf15TV3TFqMlBynyuZP1Xlz1ea+sWyV2HOcpJjHK2hCnzNP9j+7sjPxUg1xl/7Zi5z1euFR6bAVQAY/rRFVqmNt668pEnC1dek31RblSU74JiV8MHxTtvfv+hUqlNpBoKcKA45bGBPLzARqUbc+eNd6SOoMqWD7k6XlgL1jUUvlfy6ede/0k96XLbKLHT/ikJYyOAw2gkn900bOTktzTXYuwfnGfVe3dA9SypOppuSqbQlcJmWByWcJ75Xbc3A5ZF5yCei8OjWcrRpAUeaMHKD7KzwpZljZQ+s/edFw6taZS6NYmIk9AHJaaydhtkekQRTDb0lf1s2/PW369aSndU736vdOdl7/6iCXV62Nvk5M+JUq9ubUYyin5mpeoWkq8A4XN2yI//FO3a2VlG7YbhYtghKk7M4Pmj95La+z557OnSdd8aF2Dfgmm7r+3/4Cefvtpp94gseAH3I/qRCNZk7Y2SLbdNXDTChrDK5HdXv1W6uU3y6MFWm5JHJiWk8f/2/ucv+Uvnpo5LjYxzEf1Ye+OR9po6pY+wOiGiy5L50gy+Dc9FqhApyxP91WlXDe0BK3YS5J0MJelkKfOsGrt6Ku9d9/Ty6vw2u5vKKpKNlZ/k20YQAhX7MoPxPN2SJCNC+LxuwYBDqc3f/4qSMCdTZDFiwKN7kDfaOXSlhPZk9+7M9OnEwuK4H7F7jfuIO/SlfPUT5gKAIsUWbFpIFcNpV1vlIzveWtV8yCVzMWacDHYcWyLiuGEm5LRlDfnPHFlj5fr/Ht1+2/u/3N9T06NoyMZdzEU/MhmiG7l4OSLPJR9GRKesOUxZwiKhv9nEoOAzLfPqmctZID8qaNutb/2pz6aLY5dCGl6wxsexXqt0/3j7S59U7N3YeGRsCs+Tw6hDaEfVnvtX/X5rS3GfzQj5NQ41CoZIw0fabK5XDq4buQoyOyrzyxOWPFu6xmX3ysKh87/OA6jYeHcr6BjprG7ZK7VwPYBv0dix12IlDbfrasjEaFX58cI7ZsZmjqS2J49jPU0/2P6vN0s3tsp9qp0bGfiuFpN8hKdiNN2RhGyUCZaJ5NCkzIiE6cm5Gcnpbxxc0yj3WboNRsqQ05DCQrdm6lf1MDJ+Y9NJw6wYIQNzl4f4Mn/4GiadfZZ6wKN6wpKX7J1wWggZOT8hh70L71btfPPwlm31h1olt8pVamrsrHsPbDMKDOX1RCQ207ts+mN7l+5zVc9yZgW+jOmpTUU3rv7L2qYDbknXRZIV4930+ROL9Q7vIZ6dU0cxqjQ6MnN2Wh6WpdePblGlEWWyAYZyFsiPw9VVxa463WFsuoV6E4QGwo1OWOqx0Q+b9m5YeXB0TEp2XCoba5WddRV9DT0KW5L41OcQZRp7LDyxiERWHt1Z5LpthM1h4qeWdpY0167qPsTHfqDVPTFN3GbYhTnqjS1WCyYS9po4Vfw/U67+xviL7x9UMqXmAjlUSmvsLeqEwyrwr8ptNyz/Y5HW4LGL8z0w9eblMJ4flowEH4gyyZEuxV43ds6NOQtnpaWkoJQmhFYVbG5EoWZPI8M6VuyDAyDCWyQTHFowsBbd+slffV0b6mrzMC2fzuEhfAlvUXdB4qFoEq3rbQm5mmEXXLP6T1bKNBEvj4wseQZjMykm95HbWle4r7GssK26pKu+1d3RYyNsaaYZJYaCGlvbWDqqtz+25f2AjSrpbfn2ppfeqtjW5nBTfl4KJsS39vJeLDJbM83cTqQMJeGmvAXXjZs/OXFcCkKrG4veKWfyI2hzvLl92P95rLQfOCvkx/6WSo9CrVoG+vfNiIyxJusdDtLXV1Pay7ea2apNtxkG0jACfs2SMWqTPAdqikNfGooMHFvU19aw4uHdWhUOrIGEDfa+ShL3JUBLEid9c+7tAScXoZ1bXO2GZ+qxAnuIP9353+eKVnU6NaJw3YIHrgzevzEM2Tja5bhh1NyfXfSFSY5MX1vqw808P9j/Kjw0a3qFd9aztnsu0ugTr2ZD9fCkNBXJ3ku76q1c3NjTFiRh58jxH2OsE46hjpKmmqfzV37Usk9XuIgkljPTM/V6RdXenT0Vgz4/0F1198o/73FXuyNFjmqKyaAHKQY0P1OA0nQ18ouTL79n2sUTnWm+uq1oKID9j5PBWSA/WtVeEsb4F+5Fwr1J0VEOSlyUNmlSQlaEPbKX9JW312yqLjxKO3ThgBiu/4oqk7qe5uNowlAmRyTs6ij/+kdPFJJmnSkYEtbJSJf6xqHpDg1fEDPu0cvuD5FrKJz55EQpIUzx+ur6p9+u2dnj1MQsKomnQHxLSFPpociuozkROT9cePONWecNkoI2FJ4fPw3ymwX802cFvSwsHyf+r0b0avEr9nkRhgEuajlWjTqDqyBbemoquxupJQ9ko2b8H2JtyydAnbw1aaEtD25795+Vm92ybnH0GBtdPXb1k/ID/p/v6a66Z9WT+7UattYQYT/SoIdonCIlERpNbbeMXvCt6dfOjs8cPGZ0foHFVrCa2MB91xpngfyI5BvYIpWGYXMJ/mhFLAiTHxlazH1TLr9z0iUTIpL8B1NVb/NTh9a+cnh1k81lbiRYCRg2C6AR1oJ+rXB+3NidbdXf/+TJfa6qPhsReSGIkR8ijFkOU1/woMTGvYYvTZz8xNXfG4uDuUKKRlty4UVhTtbByqH0W5uf/0/tNk0xDHTYcGNF3jNHeTMkJOs0UrPfkT3/Nxd9iSlqQ8theiC3eIc20fOlKiZEJf35xIhhYrLQIkOV4Fu7RLe46eULAAm1Q2fuf/hEDhVbAFYRXca+Wad1bDtWfFv2+cNdWEHprzc+3WHTrKuRxmPxoJGe3pqEk6pox/bq4n2oRqKhjaDGM5Ewckv6roYS81RKjCto29dW/P2gp5qpqsLO1a9CYrMnjHgglEnjHr7ovtuy5gZ8UhpXbvy+HLAO3l5iD1sFZcUaZ4H8mJQwyqkrLomvPkIqoZgSRcfTlbQ/XvXVK5MCJMUaHZnMRueCjAnf2fhiLerQhxhPAiAywbGCoj1SXvKY42/JEOYlZJV3dz914J3XSza2KB5NDifQSyBiYbgEYes8uy7dmDX/d+ffG1x4nC5eLd/yeuUW1RY4h7YRHSxTFK3bHjrv9lunXB0kJtmS7kjNOLtetX+nJNxpgXLHqpNzFDaTTJpqCEGF213MGdO6FuKRybMHVs7LHh/wr6209ZHd/3mvagfhRqQwjkDXEa3qDr2zEpLROO5HO/9zqLTWLVuSXj6xUNFaV82/zrviG5ue29FaqtsHXeT9UQwkRUcznZkPX/K1ixMmDHv+WFjZjTF1a7ADYomzQH7MGzd77K7kItKkYxryIGM2AU10pr983Q+DHMFkDLKl1Xvv2/Bkm9QX0pvVOK9Dovj8+Lxx6ROPtx2BGRsdzXdfZ1z2YsFHbx7d0s2zBIU4pQAZOUWwGbLMj2Py4BnRGd+d84XbR4dIlGuIJ8tTwwlT44+4Gq5//7dd9mHPgMNi2yZZcz688Ev3jA2VLcbybKBj3ODuov0r/bAhFjdAwsHIrOXzDI6KjFKM6JFwTFg6Rjs6Sh7Z+hYTFYl+iQjrKd1Wl3/r8n9s6Sh127gvm+XIa7F/KKHi5qP+nzE9RkGdWSg2XIkyMzlHKcJuy+5vxrHOrWp3b18L+/W10s1vHNva6xAJqwO+oxQ5dHxF8pSnr7w/CyUFqR62plEZ32eCuamnzWqlP9ucBfKDraZfrdj4/c3/7LDxQ5jV4c0EPFiMSN+fcd10+6iQxV6fOeub4y/9c/lKNYgKYt6FR7CmuKO+f/FNwc+BOD5Meda0f2nl9i5uLw72tvfv0XITDna6pSmRGffMvPyqSXNzccIdJ75yJ6AM9vL/36f/OkrakGL6kA2FSPykjR+df1NI4dFhPaRRePyXt9b7f4J9/1hD1S2F6YULu71KNEMviHFESNY7ut/Mglx2/dXKrYWttY8dXpkVnepWXaVtdTe+//ND3XV9iocofJue8F0myxsaElIldLCtand7vwhpbK/42fIXHlhyY7hKiVOJFHkQQpwUObBtxE01DXvYvS7+8EG3rBNk5q0atKjCwg8tF8f/dcnXRuMQ+YqYDhmy3r7QeFUiFe21Vqv82eYskB+Mr+RcVNHa8GjhMp6lSrz9BPe72yHvO8XmldFS7JV5cyxZqzEu7Gv7d9mmY7Qr4Pj2yim+8TJKi/7Nki9dnT79xLWpH/aqPFXyyXdWP9mKXcNlQkTm9jhyeFAUtadGxI+PSZuZmDMvc8L8jNHGUc9WCeus7TAMKsNSido/LP3Uo9AB3pb+N8FYJvjKtJm3T7rWyrMjZnSBBd9QSg+0Vu3qqZkXnSXCS7EvOiE0orZui/YrSq3VyCu+uFu2bmymxTucTiILK72lr3vXD1zquu1ke0/pzt0lEj+xic/+PCeBzXD7Ni+1/ry5AqDTVrvnT3veKafdhiG0R9Lyteqvr3/irVFztrSXLYoba1GKtPS2ama69zCkjsLGgi5vbjmyv/OY7r/b6PfMJJE0xa4q98+9zkp6BYJCB2j6VFRdxpurCkZuwfsscHbID8MubLPZHt+7rNXuJpIeYCYSh63OSM3JRFazVE12xs9Oyz3WdCDA34ytdR7Fh3P0uL9deu/1meffN9J2BIC16ze73/pr8YpexU3F4wi4NhbCg8Srkd+fdcO1OeePiU5PDMMMNSJGfo+Shtp61E2G5Fnxuwd16Modk5dYPJ+O9m9CD4uvG1vknt9veb2VtiIeish9vfgpwRY3rDFyE8v6h0Uru7dmTDNoR9xOQlF0RmRiI60n2Iz5sXhDEU1LWFM0fmPuCE18Ct7xOoazKugKWdGQf/TdX/+paNmijKkVWptHwX129Z3WnZs+PHhL7oJ9ruqZjsE+ToPrRul9G59CrKstJ741QoGiJGdSVOqyku2diiaJkwkCXCpsBsl6xBcmLbZWchgxpEwyrW0uerlyC4iQkJwd8gN5Rcj0lHF/3v7m7r6jKluj+E20XgckPDo+zfojZ1d+b/drUuMB3e8bPlWGlRbhka9Nm/6jRXfMPd6TRYLDWvTbfe/9rXhln6IRpNAg2oeo2ILkvF9O+/yIjuI4HnEwUgWkrK3eI/F0LSSw2ZFpRDhSt02LyzmxNTJupmPycXPBF1c+c+OURfWoR/wljP1kzapfddi9ZBzyyn4YhVBO3KgDbfV6mM5uviBv42v+b8RxPzTeWoI9Mj2g1h3a85ZjB2bvmluhTEFkj7DR0fdC1brlR3dcmXPex82HArqoIDGwVzYd+KgqX7NT67v3koRkDWfEJo/iUV8VGOkEKwEbwhRJtrCblJKdgyxl16fhOEGwZWi34vnx1pf31JWurj+UHZeU4rQl4eNPD3wOc9bID+RdblfQtn8fWPdK4dpqvYOfA4HFVC+0dvYWRaEwDg9nxMtRCnsxZCp2FogIU+SrQLumzIjK/M78a7+Ue+HJW4OsqD3weMGyHrtqzgPDb3yINalkk20noDJmV1krh4rpfWQ3bHZ3E2F8C3hPI7otUrLFxlpKkk9EnUJOj74L2OP0KGRNV+H67UXcBcNUg0L4J5huvpSnZrJSK+r9z/LiRTh3edfFc9InLGvZIxLaWvWrRv5tOLHxCkLzViWiYeq2ie0T3hU8qwzrfLeMKuWeF6u3vFG+dWZszkO731mUNXl6WnY6Mr3+KlDP3w6t+Pu+DxptbmuJ1rzqPn840twU7lFW2d2AcbBkd+x1SI8IcS6k37VmRbDZvmAYCbVabe7nj657tWx9lCb/aOoNVm/0GeNskh8GuTiBZ2UYN+93G/+zobmoy65izNYpksS9e6U2T29YpXVpLlXyzpE8EEmXqDxKjfrOjGtvnbmE3evLJ6kZguUlO3kOODG1hsgmIszl+5srCvvapkQkjOSmp0Ull3i+cTLc7MqmTBfytLmtpbRCyIKHml/hRpoNHv5JUfgnO9ATFj05uFzEc/6JiAuMP2k7EnnA1smW39Sad/LJB/Nwbh4jryBJE5YxnxuXiLEiXU6yxV26s7jCXrg0RY5Mj4yPd8a4PK5jPS01tMMji5MrKdItDzd2R0WjF2VPYj+7NA/frBpmyAj5Tjrc/GW3YmXSeS0sWwVFC7nTvkRcCte6UhKtnif0WePskx/INyNQ+s7RXa8UrtvaXNjD03DqbHgf6aiybrVkV9609q/cwVFYxRUixen2GzLmfvW86xYm5Pz4JLeC3f2q5X/QJeJdo4VYvLKramnnQxtezO+qmx2dfgLEgOU5OAxzTyCiZLt5iEggR1IjpK8buQvqyqyUZkcyxWFkeg0rMnxw3RC1OP0J11M/77iQYOSfLmtW/Pi8yLR8rYaE8lC3TljRJAG/r2Mc41EWj5+1piyfKCL3tek0buywyFxNkfnxJT2o66irG4nzTIhM8UB5Y+lu3PlemuRIW5DObcVOxYa04d8IkTZxf3P5UdQ7BkVaKT/A8c7Dwxqoi9eSPQy7Lk9JCpzSETgr5YeBMYEycVHeWvbGobXvH93RbPMcaK480GXV925PT/WOhiPsLVAoivbYr8qY+cB51y1KzDtlK/RIxS6O1Am67+GFLYdUhbzfvm/r0sPnp078w/6l05Mz8pLSUxxZyZa1Chr+5DTyvhgdn8pPUZW9DpKBqtVrJ/88sKaMto7zC2UIcCGly1sP9uBTF94VVmb1MBg4N7I2X593waGD77kCG/zDxPB3NSZAYZU9ro10zvkJ427KnL+hZK/GDyWT/NccRuIZYuTy4h94t/+F1VMm/OAcK7fFyEyhGK0q319wcwpOYU95dHTynt5j+jCxh4YLW73U83L+sl+fd3vw8uspffHQhx7rO+j+iwBMs5yJOfFRwa7/DHMWyw+D0V5d5IYpi3+x5qUi3PTBEUuHh4t0Gi+04l62WpqgJP9+yVduyBicaumkwu712/x3VrYd5C7JwrU0yMtmxE/xZRFGdTbX0vZ9y1v2RWjIqStZkckTE7IfObTic9nTZkZnW2iC1xJ8qqwkM1OyIjXFbVO1YVywRAYTvLWz5BdrXymhXeOHnPPIGt6MmjdXVd6y5q/r6go6HNZcXU8EktXUIqYN0uIAMuxWEb6wa4wLXY3PF6yqo72Un94yAsXBTCbI/4vQ7XH2iAatzSPOGgnrmbNB6SB4cdaMJDmaV1AsdAYuP0xnL+9HxgA2O0C3fjOMZZ2HqSxOm7hozALxAX5o9zsfNu7Xzbw2AZRW9hePjTx36KOpKWMCmhzYh0dR87uH937+vV8U9VRrtpC7Xv0tR94QXbbumZGSk4zAfhWYs15+GBiqetrnf3DLij+8fHjDxpbSJUl5wb/ycvnGtyq3qjZ6ccz4xy7/1nRH6qnfGLg6d+7zB1fWOvqERT/0as1cs3KHAb6l2augXpvWpjccamp4v3HXw3tss+Nzni/ecOOEqaEjQuipEyHjHamTU3K3dxUFMWiwurjs+vtN+SXv//ZPB5fPTsiOioxmy90WV1d5S829G57Z1XC4UmtTJU118EQnp6bubPKSJUvyQ5ywa1l6ILGEpsg/ueBkR8qXJl7y+JFVnrBMLcMUrmPsVPHP59ySFp343Q1Pq3bdp/1Z356XNWl+2nhZsmGzvicJnUpyqh79k7m3+OJzF2ZNthctUyXVP1qn37lMEooPpQ0O9f5Nz36QuevFIxvHJqRG2ezdHr2lp6Wks/761Q/nN5W3074+hUp2Q/SF94Lz/XyC544aNi0KcI7ID+QVIVdlnvfSsc3fXvvU1u6KRdG5Aa9kl61oPPSt1U902lSbLj8w9wsznGmnuLYGc+PH3DXh4idLVvfZNRxq+qF+/xoHmFORipRv30i88d2Se1NP8ac7yl7cn/Z29Y5bMuedIeOeVeO5w5/s2VWsizxiQ+3yxvkPmEqqTPd5ag7u+69MJUWYQ9gMS2TqkoUthrsnyZhnUrUeUT1SrE7m4fe0xHODxvUXgHFlT9Mnlfv3kloSVhjI0Ipg7NDxNckzbp98TQ5CqxK3LO3Yp9pE2nPLpfJgVaRMSM881tzG68Kn7BMvsyWGjqJU249mf2FRUn8ur9lpUyZFpuartYbb3qDOYMKDGNmbJdqhqP9t2PFuzS4bQSKtNtJk7n/MBpvhz0bF+aLUe2xBWP3KunF+1qQT1NZzkBHujJ5ZsBEyNTGHUr1Ya/z6sr89V7zuKG33Hy7s58N99Q/ufvMba/5Rq/SwQRVF5Ny40yM8jAr/eP61F8SOk8W5u9a/aLgRUa+vjnFwryphDeNeB9mr196/7snvbee2oIDfligJGYTt7/86ci6bOG+iI1V4uInz4gYJNiFACPdj4NnSPQphelW33dNld/faVbesmZlzDR9gDdk0LIkzwK3soxuGmzBXnt7v8sAzS89Fp979Vou3wFRG8qCLc6JSHr3sf8ahRDYPSmF2PN+D4GWKOuvSVDzq15fck8vjTvFPltyVoyRJOhPEYc3/NC86YxxOVBSuyhi558Rmh3nE+HEj+skoh2KdRmu2b0+56vvTrvK/hqnPX550iVPjtjxkBiD6LxnMJQQRmzDsF4+id9v1bgfpcuj8rFJMxJG6WIgPPrjYcgRz6cLlDg5efdyvpY1yxo+NG3v8TT3XOXf0D4PUqASF4j6FHEEt3939Qs7e5PMzJv5qz5syllvV7mtW/XFPS3mr4iYyMU6fYHNDjPN0ZqtNwknbuqvuX/vEob7qEWVK79ftqSqhdof+TOUn62oKVjYUXJ06zaeIhJeI1PzKCfBgzcMx/67c8T+bnuxy8JQW3PsyoKMR7b+vOJpUMsMqeL0pW1PadGlKZNaCMTO2lu/br9fJOuUzTNBJ2ycpvYdf8ygDv68MMegbXzLmLIwjHA4rapxkzonmXBegQn6izvBGi5TsQzv24qScza3F/7PmuSNag0f200hDzfwiVJurCXYdLYzLe2zJvVOdZmKPOTEZHzcU3rf27/VSJ/Ieuh4iAEakkpuTmrsToQvjc380+6Z/Fq2tou2sSsSY/nkYv3l0bBhgc79EiAVi16Q0GvWz+Xd+c/zFgzqZ/dpG2zZW7l/eflC1GfpYvyAfFPjSP1ANmeHrbK6noEjVNiM+e0pq9lslW7rsmjgdWrKihbD5YU7q+NCp9D7DnGvyI8rm4P64EncWoZJUjFqO1G7mqYGEqstjoG2STI2jTfn17B/n6fO259mZXA3LirfyQEhr+HyXg5bLZz9V0ou0ugfWPPnUFd/uTw/uja8MlXTYuJmZFveEcNeYeTuyL3r12OZuh4atLNTFwbFC45AxkiPdUpYU+7VZ135l2udSMd7SUnLPqscrlS6ens+CTGR3zI1McmlanacNezd+zb/045uIzJgRNvvEOiz53sTKdnNravgq9Ltc8acoxTgjA6ZGWZw48ZCr8YcfP7up84jbxudrSZzoNFwzxRqbu1awGT/GLX19whU/W/D5eDwgtu5zaVPePfrpdzf+s1npUyWe8mToGPLN4MZfHKoyL3nCM17L8A2TL3h1/7r/HNnQIve6FI2pOlx2DPxKaKhX+SDUTpV5jtG/veS+i5PGfyvQtQk44XBffd3Sx/do1ZqkD13HBDCEGoWL0yvtBEeo8rykvPtnXrUway4TA5lS/D8KV3Y6VEOz82Ww9n0XDfyJqSwXJI8/Q4zAZyZnivwwTlHe1Vhc2lzX7umJkB1jktIXZk2e4kgJ6/nJEl/ZYLFe0cUyj7BhIHkz94mRIRbApkmV/ddjLQTJn2raWVhXXthW39DVytZzmdFJ09JyRidNsJ6dl93x/er8G1b/ZUf94TbFpfNXun9KNVdp5vg2VntmxieutRvqNzXz8A0t3JsBHusSrUadD6x56unLv3NV2hTxJzc1j2fE/T2CjYy23hgN3F8NxDvQwgngFmA9XE9p2t7EVw6vrSGdHkls24hVnoZ9eXHNqoiASb4jYtPlZClqTsrYq8fMuXTCvDwUbTypC5PGb2wpfXjHG9taSntkjUjeLVWzPf1xf8aJdeyvi9Mn97R2r+/qxX7LT4r61/jUm5MTC6s5Pzxdp6OdoaM1WZUe37tsd3OFhs1k40REd/A1tmlfpN6sylScfMkn/OzIhOHCCpjqwMbYC3uXv1G0+Rjt1BTkzW1l1NU4fdkYvzy/p0ykJD3i4vSpX55++dXp0wMO5puy5ydfm/y3XW9vbCjqchDz/GaxKWB0BvXmJeYn+hGagqIvHDPZ10BxAb1r1uWflOevPbrvYFNlI+51K4RboMSINPZHvOeSDdqv8EoOkfjAqeFse/KdEy/8+syrRg3xtfNnUkT6/s6aB7f+a0PToR6FJ9E1/bGw2a2GydD7CJlYlGwajtLk3KiUy7NnXZ47d1LypNF+Qi4nMe2vuz8o01pcsm5qikIV8k/pbJzjyf7frssz0mHzIxhnhPxgQ+Rr255fW7anGfV6uOkXs9nAVoxSUORV4+awFbr1/W1jkeIzIJja7aC1kenIZy4HHeHkVmNC7p8HV1/5xi9q1Q42oPnRapJkV3GkprClyra2yoUJOSELWdtafO2y329rK+m267pTzCZYkvxDDfiR3UaeDjYxUjFfSLIRCCcu5CKSvzg8vHdo+T5HRZFSUj+mdP5q0yvTbv2laKwjWpW6uYXcWA+bk5CYuSVixoWZoovwKYEqlJ4ob9l0sWC8ccri/xat/6Qsv6S7oU/SNYXadDO7sNAS5SiixGDH2MRRUxPHzBs1YW7ahLyIxKFz4pKkvEZKVx/d/p+Dn+xrrmhXNNYfOiI6NpUtPrmI2Zo1IUqVr0yZPm/yzE7ULVOfaOEnE9koFXFvyD99ioo9xkyVFBPzEwtN++6s674867pu1IF4VDl/SD3IMMBhV2+fLCqvc0XKpbFn7cas/Hg5mGUsC8eyvrpz4hVLy7ctK95R0lPXLalIZNcRyWe4aynBcrRuy4tMvSRv9nUT5l8QOSbYGRjiT7WUbqja+dLej/LbK3vtmk54iIXGi6Ves4/EFlyxmu3uaZflDUxt66+gFLsa8uvK1lTu29dUWuNu78VsUW/YEnnYBzIzOhj6K6sqT1clEZxMo2aljr0hb8HivFnjvEuB4MyMzWR1/rR23/uHN26vLWohfW7Z0J/4X4UeJdlUFIVto5zx45NGs6XGvNGTxyQm56D4oTYx9m8lbfpvwc6VpVsPd9b2SLouU00mrC9ln4VRzCB2ImXJcTNSLKdI+UxymuUHG4hvV316x7I/VdB2j4N4V4NMddA1O6lC7S8d27St5vDSmvzrM2ZbGW2qqtFwgqXYDTUeNWsphPX92t3Xf/ibMrVZZSPYIRmLKcozAtE+RV3dWXh45Z/+Xb71rtyFw1WVtfcvBSu+vOLPzXKf5iSSmAzoEPXfOO7GRrBDk7McSVOTsrNiUmLs9l5Nq+5uKWgsO6a29PDMdJr/fsbQVvOS+SKeFqi1L+5Zze7ShNDDi+/pxqqHp7RW2WJYExvaRNIJ0dnPKj8rQRcbjQxWMS1Tsp7XMDS+lexvZ92W313X2NZY7+rs87jYpK9IcoIzIiUqIcWelB6XmuJ3/XCkeksrdDcV1Byp7Glp6uloU3s0qhM+uCWnJDtt9ihbZJzkXJQzbUzQ1e7I23WSyqygtK27/nBTeU1PS6u7WyO6U7LFO2PHxiSPTUyfIZJ7WqxAhjfqtrKtfHfd4YNt1dU9zZ293aqmsRIi7c6s2KSZ8bmLRk9eOHwgrb8gqUOorbOpvLemqrOpvq+jpae90+NyaR4VcY3aLtkiFUd6VOIYZ1JuQtrYmJxx0ZbExtA6s3sdQx0NLS3Helpa+ro8TPJRHKHYEiIjkiISMqKSJSdfu4UsPEfEJ/5k+jUFPdUHGo+VtNWyXm3XejRVV1mZihSN7bH26FHRybOTshODRrMCp1N+sKf4zJFPHtrxeovd5U3qZ24+in/Y2pkti0ih3vD1tf9oufAeK2XqRAvPM4Qi4tawM/R3nj3yyTfWP9Mi9WLuB8mEBzHcZ/kqSxjEPAqtIJ3/u/WFnmEOv6zsabr9o7+saN7XZxPRHlxM+rl6eOFblzpKI1FfHLf4mgkLpicmJqAE5DfzVqL2/LryZ/ct39Zc0mc3MkgGlphmnkQmKGT08uE1106cd3509s0TFobTQZxvhPuFUJzY2XZQaXSgLcL388lOSHPysG4XtYi/SWfoX8PKYD30w6FlnpDHfQLHTJABczJudw5zOuXHxqbCP25/vSXCRc3E5dhnePHzn2RaP221u3/36RuFrsYpzhBnxbj4fB44TfggsHkuLXVZMO9vbCy8beWfWx1uKknUcB40IjD662q2oVPxPLrzneLe5omRA2JWuS1i7eMftu3z2HUueag3M5xpaELenBOSTUfnO7IeufwbC2MDHNTj+6SVtv5q23svl2/02DRCmQIROPzQ9GXiyR56Xy9Yd/6Ce0I29mwH3nzrnFS16WzhrKvwmcNpi/9g8+mLBZ/UO1zUmPGDosu4FnU/t/ejkG4euqaG5+KOkUt1h6zqU3s/anFoRKz0gyz2idj0rUKdbxat97+S/fD44dWraverst/29JCqYB7TQC6Pm/TG1T8KKDz8YZr1Qwu/elf2Im8kVaiekehHpbtrUMCIEAAAgLA5bfKjrK91fc1+JNx9Qh4wwxb2qkxWVuyoRp3BrzQPeLAM4Qdch5BeBV11mxoL6XDnV/jBI9oID2VaWbmzyW9dU4+6X8hf3uVUvcpRIKcp7u+DsjxRv1lyT1aEpcNqUjH+6bzbRtM4rkeGdmKlVbirsO6olZIBAABCctrkx876w23YLbLyW4m05VKmQevcW1se/DqdhJd6jl3q0UO4F+2qO9KBXcJKGqJkkUqEz+RlXY2lnRX9JVSV1uodlMdWDxt2QYVP1Y0TLpoTlSWihi1JwXERidfkLAgtgcUdPDI50mY1OTEAAEBwTpv8KG6pViXTwy+47YWa/qqySyb760pDlmzV/8o8/DO0+lPSVifSIYSe0MVGDt9Z6ZW1/Q39oq64raZP0rkrI0UoUHuNTZAITbp83MxwrbEXZU2zW3A600VTmz1gvwIA4MRw2uSHW9eoN843NEaUE6Y9qiv4hQo2w3xDJ+oQZUoIO2Rb8Au7iYr7t7gtQCn7Qqenv6pdap8mhf42EzHJ9rCTqWTFxzv00HmgWHNlZFWtAQAACMlpkx/xzlgpjLRKRrgstikhjjePkO0KRRaPPqMivCvWGSL4I9UZJYVzkhrlJ6khm18+xCibsz86afhvaTKu6+m2fB8Tly4i5kKKS8SjqVMcpzPZFwAA5xKnTX7MSs22I4lnlLaUQpUH9PLjLZMyg1+ZFZ0kERmTEC65fBlOqES1KCki1RHiqIwZaXkysZmRfiEQ8bs84BnlJvQnXhsTk2TkDBm2Pt6EHasqdwVx8QpIYWOlR7Zw0hs/XFqanTHBeskAAABBOG3y4/xRWelKnGGVwqGqwY9TlnAijZwfKh1NclJarBxpJFYKUaZIdD02Nj3k0WIzM0aNsseETHguyjRSodAEJXp6fLbv83EJGbGqjQb3NKfULeurSndYP39XfIkuO7pHlfXg+gdPpEHozOjR6bE51gsHAAAIwmmTH0k46fqsuRH8RFMSemGPkU1DV42eNS4iRDqBXBQ1LS5L1nl6qOCTNcWSjcjz0kLn18xBKVdnz7HpMvVP2xmgjtxsJVEqE/nSzJn+Vc2MHzM5NksS3w9yOyKjZrnnL7vebQheIT/+e3T7joZCIpEgmzNGXqMY1X7/7M+f8EhmAAA+s5zO86O+NPPSND0K98drYP9Nb+zbBRfZ1lM8jq/N/lzIuZ5d8IW8BU5dkcXpfGLCNrOMYrNIahSo6Hq8x35N3vyQ9WRlfmXG5RmeSFmcMSuj/s15bP5nSgbCz4Giiar969Ou8K9qBsY3TFpg4zkLjSoNI4EodtnQO7W7frft5SaeqioYTAK+V7/3R9te67ZpRr7YodVG2Dj2migUX5w69YtjLwjZWAAAAIucTvlxXsyYXyz+UqIaIbI+E+zLnt2/liZ824DgKLfyv3OuXxCba6XYaybOvShuvF2ThaDg6QNF2mix0SKycotWSw5i+9rkyy5KHGelzLnRo3+16ItJrKo8l6iZsBb5EhTyrXLDD5lEq7ZvTb92YeLg09dvmzwv157MtCgqEWnIqTumK7HI8u1R9FcqNnxzxUubOyoCboSwD/d1Vv9wx7++ufof9ahTx0ZkSqAcPkKIMr0nG8f97IJbwPkKAIATyOmfUP5VueWnW15tkPvEkcbYTL4tKibzMyiVsSThp/NvuWfcYuvTXz3t+s2G/75zbGuHouqyOAtCfFUSZ4YzPSBJc/zPjM/fN/OGjHCm1H+WbHpw+2u19l4RRS57866Zx6pKujQaxf5k7o33j78iYFWfOrz6Zzv+3R2hEkIDSm5f+kiu5VApQY04L2nsoqwJU+LHxNqjiaS19XUXtddtry3a11LWJrmIbBwGMlh0+O4tC4GcTeKfvuybV6XNsN5SAACAkJx++cFY01T08Na38tvLe20eXRyjJLPpmaBoXbkm87z/nX/b7Oj0cNfObG7f0HTknaJNn9Yequ1t9QhVxE7l0bFpCzOn3DZ+8QVJOcexHl/ZUPDoljfzu6tcNs04Ek4SRyfEqY5L06f/6MJb54hk2gGpovQ7yx9Z2Vmg8aPb8NC8udjrUsxz5vID3nhAoo2wH1hv8LqqMtIkLlTFbzrfcAnkqIy9/7I/T8dpT1z9wKI4S2oWAAAo/APlPrOcKX3E5tbi5uKddSU1PU1uTYu3R42LS52XOfW86FEjeZDG+QQIdfX0qWw2joywIRSbNbKMm42U7qzft7v+SHV3m4doqfbYvMSMCzLGz4zODllsoavxGx89saunTJONwxFpyNQtAf9O/f9M/a8zEsJwS12823ZlxuyfXnjrLOdwx9wFhnXaY3//sKKi0zhfyhtaElZeytCEDJgPHdJioXA6NIGxn8weyS0s3m4Q/gsG37V+nTzSCgy+XcBMa/5HtQ46YWn4zgnyvAYVMsjm2u8cM6g8/2qGwcDROJzq7fu7332GPhzz3E3fyyOcLHmgGZYy0iN++tObQYoE54w4fxD5HUiATqjwPxmPP3Xg2Qlh3WKKM/VwZ819q5/arR7lJ1Zzly7JeMHCC/rw4lM/uDMyK1BEudt1nEsTfnzhHRfnXngcDlddXV1r1uzv60mg3iMaAeAzgDeeWdiRiw6W3nHHotNan7MAmB1OA+V9bU/u+eCNim1tUq/K7V8IG5nhkflDwG8NWrCZcssrw6g46dauyePsSTeOXXjX1IsnRaQfdw23bj187FiHKFUcaB1UCOHjEXxDyvQlIxiyMRSk/MFLXb8iQ6oCIQsfOQPqQHwfDs67MCAD26DmB8zRMEKvF4t5H4a5i6/HAvTwkJKHNjZchq7Pgiy0fGesmb9ayitqItxaRPwv5Z72o9Kcl1wyM+zqfsYA+XF6YEN8d+/Rl/Z89FHV3nraq8o8Ly8VryZ/47DvFfXT0A13ZqFwe4MZuZ1KJlKER06WIuelTbwmd/7FeVOzURzo3QAAnGxgljmdMClS2te6vHznipLtBe2VnYquKZStmYg3Vwr1sx5LxhEhfHHFgyPtOvtPSsTR89MnXjFm9oLsCZOcYXsZAAAAHDcw3ZwRMKFQ5G7aW1tc1FpT0lHf0Nfa3N3RRVQP0ijV+N6GJMmSPUqKSHFGpUXHZ0enjYvPyEvOmJwwKhPFgNgAAODUA/POGYdhvW3gxuSu3j61V9Ls1IGpFhlhc6BYX65HkBkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABnI+ADCpytHDt27J8v/dMYwkuWLLnkkktOSzU6Ojo2bdrkdDovv/xycKoOlyNHjhTsLxiTO2bu3LkWv0IpZR3e3Ny8ePHi1NTU4YplsB8URfnc50KfOwccH2dK/kTgzGfVqlUrly2naOjhJTzH0Y0333zZZZedyvoUHSxauWIF/0nCc+bMOZW39tHY2Hj33XfXVtewGaqysvK01OHs5cCBA/fee6/mUSVJyt+587x586x86/nnn3/pxRfZMPzXK68Nl2v1D3/4Q2FhIfvh/vvvB+Fx8gD5AVhlx/YdO3buDPw3jL9yzz2ntDYIVR4t9/2clzf4wMdTQ0VFRW1NLRKL4vLy8s/4uRHt7e1s1c+W/Oedd56V67dv3+7xeDBFuq4fKS21eJd169YZ+e7rG+pqa2uHXvDaa6898cQT7Ifrrrvuq1/96te+9jXrTQDC4nSeXwucXRwpKR7uT4pNGTfuVB9RVXz4iPFDVFTUcHaMk01WVlZMbAwTG2zSvOSSSz6zwoNpEnfccQebrx944AEmUy1+a9KkSUaPJSQkzLvgAovfmj59OhZcuGhxRkbGoHS8BQUFzz77LPvhmmuuefDBBz+zT+TUAPoHYAn2ll504WL+E0YLFy266oqriF9qbqfTmZSUdIqrVF5p6h9sEk9MTDzFdzfIzMysq6vLz8+fMmVKTk7OaanDmUDhwcLysjKe7xPj3NxcZO0UnyVLlvx/e/cdX0WZNXB8bhppQEBCNUACCSEQmiIgVYQgFkJVwF1FXZoUCwi+wvqqWBZFBXRXXV1cQQVhXYqVIqASIXSQNNJJkE5CSYBAkj0zZ+7kbkiA3c/73/v7flx2MjN3yjP3nvOUmXsPHDhw+NChbj161KxZ8wb3NWvWrG7dugUEBMi/xlVf5HPu3DnJYZLO77///v/qVPAfIH/ghiQlJV0qKTGsr5OXj/1d99xVaQWJF4WFhS63WrVqOYtOnTrl7e0tE15eXhImXB4/wHXs2LFDhw7JZ97Pzy8sLKxZs2aeS48ePZqTk1NcXBwSEiJRyTNJyKIhg4fodEzrmEpBRJbm5+efOXNGokxERETDhhU/hSKbPXv2rP7OihykTJw+fTo9Pb2oqEgSgOylyqgnK0u1+vDhwxcvXpSDiYyMlH9lvrxWTq1nz55lZVX80IW8Kjc397fffpNTkBRbu3ZtOUHPEqiOvDAvL0/2WFpa2qBBA0lOni9xTkE2K6cmfx48eFCOrUaNGrKm1OWvvWUpFrkQcsB6ClJWmZmZly9fjoqKatSokWf5y3UxrAAdHBxsuCN1QUGBXk0tQMO6g2Dh/Pn6QwN+vr5ymnJ4upETJ07IUcmEnrW8JDExUf7s2rWrcyRNmzaVvV99qHJgUgjyppKLKFUEfW/ouXfu3LnKs5N3mhS4nIW8nY4fP351q1RWkNQiG5GD1K3t2bNHLmJoaGi7du1orPynyB+4IeZopPu3qqrsqpL5s2fPXrdunfYn7Nq1S8e0JXo+cP/9Z8+Y8a5x48afLFms60vInjJpyq5dOyVE6o+MBgUFbdq0SZdKpf6Ps2dv2rjx8uUrulTaN+vXr+/fv7+uIIGptPSKTreNaevUdmXio48+euihhwpPF+jSgKBAmfPYY4/pCpKQpGZq/ZJK+eKPFy1ZsmTYkCHFxRfMLXh7jR8/vtJ5yfzvv/lm+NBhefl5TkfJgAEDdNHw4cMl/8m05J7ly5d7vmrVqlXDhg07nJevBaJnIcFLZl67qPft2zf20ccOJCWVl9s/ShkeEZGamtqqVSs9hTffeHP58i9kYuCAu2Tvj455RLK7vlZCp5SMRMPqNv7zzz8/M226TDRuZPb8LHh7gZxayeUS2Y3E3Oeee85Zc8eOHZMfn6TTL7/6SlxcnJ7XoEGDJOvLRGxs7KJFi7Zs2fL0k085ryopKRn1wEiZ+J9Z5qZef/31zZs3e7lcT059StLhiBEjJL536dJFFp08eTI+Pl4yh5zU6NGjn3jiCWcjks8+eP+DYUOGmnnF+skbyVirV6+WRV9++eXcuXMNa87SpUudNp9ki7++/9ehg4dcuHBB59So4Tdw4D2SGzyrHZMnT5aNu8qNOS+9KCdoXta8PF10W9cu/8+Hr/4L5A/ckAMHDuiEr6+vBKlKnc76qRs6dKjkD/PvcmPFihWGFW7GjRt39uw5WSMoMOjVOa9JjVVmfvzxx489+ujFCxcrtmAYTgVw27ZtY8aMKTh12nMXUnN8/vnnt27dqr0WGRkZ9o/ruozoNtFal5QgMnbsWIm/nj/efaH4wod//TA4MFj/1HBvWCMW/1z91erVq5xzkSq5BEQJcFLV1TnSiJk6Zer2xERZ5PKqiCw6PizVZwnWOqdNmzZO6JEIJWcnJeb5s+b6S2ASECVNVlfIciSfffbZ5EmTLl285PnLYdnZWTNnzvzwww/d20/XidKysiemTJWWh7MFybuSLKvbvmGlcz3fwODAJ6dO3bp1m31wVuhfsGCBE0OTf/3VPnJ3l5RhBf1TJ0/qD5jpTCd1eZJWhWQ7mTh65IichrlHb2P6tOmH8szC1/qHpBNtdshSp/RkevHixZL+L18qcZeJeXitW7fWxoSUrc6vGVxTkoe+SpKrJIacrGzP6H/pUsmqVSuPHDviWbfo169feZmZlXft2bNm9Rqpuzjry1XWNy1uHPkDNyTZHSauXL488v4HDI+fRo+KitKPqETVWbNmrV9rppAtP/0scW3h/IX79uyVFX39/F58+aXW7VrLmvPmzVvxhV1Vlzpvl9u6NG0WJrG4W5fuCxculHbJuD+MLSoqkqWdOna65557S0ou/OW9D86dO1t6+crXX3+tL0xPS9ef1qoTUkdvvjp37tzUyVMl1Lqsavjo0Q/WrVN72RfLf7Xi4MrVK/Ugc7Oz9YUSOyR5hDcP79CpQ8KWBKlTy/ySi5d2796tuygsLHx8/IQMK2DJCxs0aNDl1ttqhdQ6cvhI9+7dzZ9sSUm5WHxBc1j79uZvncrMnIM5EstOnDguL/Hz8+3b5462se22Jf6yZUuCy9qOBtYqLfvss3cWLJR4K/F34N0De/bqJWlSUppkryOHf/t176+6i7h+cV5y/C5j/Yb1kgX7D4grOndOMoEmhv17916jHp2VZQ8aZaRnpB9Mb9u2bWRk1A8bNpw9Z/Y4SaNNH5sQe/fZ+SMwKEhLWHufrly2mn2u8sjISHNpYGDXbl23WXlIdt++Q/t69erJTIn4sv49dw3U41jyyWLJPVoCMVYJyKnphfDx9ZX8oQf/9ptvL1u2VPfr7+9/W+fOTZqa742uXbvqGWWk29c9onm4VhokD40fO07WMazKzX3xg5o0abL2+7VpqakyZ/u2xM8//dQ59+Lz563r5ZLWYa2atXr16pmUlGyXSbmxf/fe6i4NqkT+wPUVFBTcfddAnZbqm3aLO+rXb+BEqwmPTNi8cZPUK6Uy+/ePFn37/XeG+Wn1mjFjRs+e5vD7jh07/rFihX7yGzRsuGDhgoiICMNjuFVq2Zo8One+7d2/vKszp0yakphoRqjTp+1GSXaufZPPzWFhurX33nsvJ8ecGRAQsPDdd7QNsWLZMskfTle+YfVf2SdSXi416Hf+8m5oaOialWtefmWOztc6qSydPXt2hru226/fna+89ppzmq++/ieZXrNmjf4p09HR0Tr97OyZkjwMsw7ueunlOX379jWsxxGc4nLWvLqQhw0eataNXcZDYx5+/PHH9TBWrlypkbew8JRhNSAKzxR4W8lbMs2zM2fcN3iwTA8eFK83s5ZWNRLj0FipJRYXN2DOK3Nk+r0//3nRoo/17JzTv2fg3fqSqKhIXST/SoZzb8kl1X+9agk//qj5Q6anT58uJ6jzpTF01l3s0lCrU6fOpCmTY2JidNxFjkQPQ/6UfC9zEhMSli79XHKnObJSu/bCdxbKys7Fsq+7++auiBZ2k0iuuyYPeeGrf3qtV69ehtXKHD1ylLwJ5YXffvedHo+kxtJSu3Ck2vG3jxdJppHqwsTxE3T7lz2aI7gR3L+L65OPutPSlypeDZO//E9aD/JvZMtIZ82wlmF9+tjPga/5+ivt3R7zyJhBgwYZVhSQT7t263t7e7/w4gtOx4hGKPnYJyQk6Iw7+vRKS0tLTEic/9Zbu3bu1NVuvvlm3c6h3EM6p0WLCJ345ptvNApItb24uHj39u1LP1u65FM73mmEMsynRnJ1QsLNtKee1KECHR9WOkfSzMYNP+icpk2bPjVtmmeN3h5Kcdflg4OCNSt8+/XXToAbFB/vPBKf4X644aa69ZwjqeSHH344X3Te2lpQ7969U/bvX7du3cyZMyV52GVrnbsUkXMk3Xv0uDc+Xqf9a/jrRIg1MlzlLqR88vPzdUKS99PTn9Y1AwODnZfokLiVpc7onJiYNs4WMt3Z19fHR66F3SZwl0PNmsHay6Tz5chLSuxuqKCgoHlvvRkfHy+tFi3hzIxM63q5tBtKfLF8hSYPmZ4xc4a0YCoVuN5qoXNaRJjvOjmdrVu36gq9e/fS5GFYlyy0Xj1tIh89clRnSnvR3pqXa+z4cY0bNzas2oaTnOrcdK1bD3A12h+4vlx3gJCP99sL5kvgkAnDXY1t0KDB7x7+nbPyiAdGbNiw3hn77RfXf8KECYb27eTkpCanaL9+65jWVz9l9tNPP5VcKvF2uUqN8tffmFdpqeSqwYMHz5o1S6LGKY2qLleE1Zl+MOngieM6FOFat3at/Gd43tnpco0YOkL/zM2x80dEeHhnayhFnDx1Us9FsprUSWXOli1bnFuq7osfVOWIdGZWtu5FXqIbX7dhg1NQox980Ol2j+tnD/u3at2quuC+bds2nSguKn7k4TE6/iErexkuaWe0jIrUo81MTzes7wCQuWOsZza1nO91Nxea3ty0yu0bVrQt0Aacy+gf198ZWD516oSefkBgoJ5+fk7+lSuXdc2YNjFO6zA7w34nSGNC1xTp7ux4c5MmnoPVTl+ZGPXg6NjYWOdP2WBfO7mWt4gw6xDSQBkxbLieS9OwsP79+19dUAcOHCgrLdNk0yzCbF9K47Lk4iU9+L79+s194w1n5bIyOyvo3WIiNSlF15R836dPH91+4clC5yVNrQyNG0f7A9eXkWXXqWv4+3fu3Fkqbg0tkjnk30qf84OpqZ6D6/qMmMrLy3PaMa2tm24rv/bgQS/rE15pvo+3T6eOHRe++452aEh13t1LU67dX1l5WYa9V3vfshFNAFGRkS+/9PKAu807pvRWWt149x7dnb1Io0Ejl9S+dXRXHybXpW3aVFTAPWVbvVuyWkQLuwsuLSVVF7Vo2dIZhE9OTj5z1q7L6zBJlXLdDSP7fi33tFSQ4+IGzJs3T482M9scJZalIXXq6B0H4vDhwyfdPXstPJqDlUjxlttR1dWxY0dnfpb79KXa7t5Lph6Bt7eP0+Em62Rm2R160dGtK+4XyLCHiCL+/cY8p30mif++++7zXCTFW3S+SKfDw81XFRYWyqXRFkP7Dh2rzLJSknoXg6TnqKgomTiUc8hwd37qeIw6fvx4QWGBlqK8TzVtmKdvnWa79u2dx5Uyciqee28eEVFd0aFKtD9wfRnp9g0/4c2aX/sGx7Vr1770wovm3arWJ1bmLFm8pKCgQB9K0IEN5eVVxXYkgsirJIXUqVt3yJAhUnMMDg6W5o6EMPnAO7vev3+/y6qf+/r6aXS7dOGSLpKXjB79oH+gf3Bg4E2hoRJlNI7ra9PS0pwEdmunim9bch6tbxERoWueP3/eWVrlKUuEGnSvHRMjrVh27Ngx57mH5k0rGgFrv/vOcCfEtm3bVld0Fy/ad6O179D+lltv9fX1lVMOCwuTfFa7dm1nNbkWWrDRURVNmaSkpHJ3aym6VbVf5XJg/37njJxoK1u79+577de2tlNFtnvgJzg4yOmn+v777/UKyp/OiUi7YUj8YN1Oi3//Fpn0dHsjzZs3184ix969e13uikLLKPv2Bz0cw91iuLoaYd4KYWU1yXPaz2alHJO3l1dNn4onEHft2mWXp8vofccdiz/9NDst+8JF+9beTrdUNHzlLWFvwdvb6U3FDSJ/4Pq0aiwf5uYR4Z6f6nL3EyH6p4T1iRMm6D37Dz8y5pOP/y4rSDXwhx/sgQTPhwp379pVaVMyrbVCmb5w4cLQoUNDQ0N1fqXbhZ17RqUBpM8t1wqppatJm6PzLR279ujhrGxX563tOIPnfn5+zVo0c1bo19f+5kenBuoZsrdv2351LDP7UtwhW29PkgDkzHG+l0kq2o898qgehbePT6Uw6kn2eMzqqff399dv/bv63M1DvbOfNelqEVURrJ0CkV00CgurbhcHDiTrBuvWrStFpzOl7XK64JROR7obEMdOHJPranicteTLSZMmOYcR09Ye2c7Pz3cGOUL+/RnyrOws+1BbVE5pKUkpel5SaLHWkIl5Ha09Gub3Yv1ydYHLHGc8KTrazp21a9t7lPZo9tFsZ82Hfv97nQgKDBo40Lz1Iz033SlJzyyenZmtXYXSTPF8zhQ3gvyB65CYO3rkKMP6NO7auXP82LETxo7TT+K4seNcVvBq06aN1L4fHz9Rb+68o2/fiRMnrl+//nB+vqvcWLNqlYYDqUoHBAToE17p6Rkzpz/zzVdfSchPSk3VamCXLl1W/dO80fZCUfEzT09b/c/ViQmJGzZs+NuHf9uxPdGJp/oUoXknqPvJ89jYWIlEV65ckaXPv/Dioo8WRcdEl12+/NuRI1Msrdz3jOpJSWZyAmhmZmbFqGxLO4BKiFmzarVOf/75Z2VlV9Z+u/bM+TNpySlTnnwiJCTECdlmv4076wQEBmi3TEpq6jsLFoTWazB18tRLl+y2kZ+v7zXyh5zCwVSzEBITtz8741mp7Mu5f/f1dwvmz8/PO/zGm2bPfkZyRpHdMDI77pwgm2J916yoW6eOc16VyMoD+sdpDPWsaJt3JV2x2mQuI9ydP0pLzVQsGz9z5szrc19fsWzZ008+lZudo0t9fH2dTi3zjjj3syrL//Hl3xct6nr77bL06NGj8dZNE9ahNq90MCmp9gGbDwBaByw5+Ka6N506ZQ5ryWsnjp/41eqvvLy8srIyuvfs2alTJ7l2xe4urzaxsXru7Tt21LeEeGfhwq0/by3zKps6efLBNPMuZJeX64FRI7XMJU/YV8HP72b3OIc5atLnDjn8MpcR2araoSlUh/yB60hJSZG4rNPHLJ5L5RMujYYjR45MnjQ5L998lFfq0ZMnT5aP4gcffPDRhx+5zMe70vS5Qqnfff7p5wsWzNcotvnHH+U/ayuu3r17y/9LBbNjh46795hPYCSnpCSnvKx70RihdyJJHJFwr42K9u3s4QTJB3967bWVVu4pLCx8//33nCMsdxkjR5pPRMsinRAtI1s6g9urVq1yVtZedREfHy+ZTL8DXBLAJ5/Yj837+vqOm2jeDrB/n90X1KRx43rmrT6G/Ht7127rrSF0aYgsWWI+diBZbcSw4cusx8UDAwOvUc6jRo36/ttvi4qK5Zg2b960adNGZ5Fu39xp8l67ieOq+Mphayy6r/v4I6sLglIPOOO+pSqqVZSz2q/u5zxq1KjhjNlIpt+5c4cZlcvK/2E9VScXWoK4PhxTv36o83VV1oC5nUBSU1Lkv9bWcJEUnXusxQzNnkciKcedWowOHewrKMez9NOlb89/S6d3794l/+mZtrEG3g+mHtS3gRyJ86jpLbfccvvt3RMSthjm92mmPfHUVGcvssKw4cMnTJggVRnDHOS3n2sxb81y3w0hubOouEgHgT0HhHCDGD/HdSS7nzyvUv369aXCO3fu3EOH7OHfP4wbq/W7fv36eblHyBd/slhzxqgHR439w2M+PpUrLs4NXS+9Mkeim+cijRqNGjXUfpLc3FzzaXCX1f6IjXFWm/nss/3j4jyHVXTXIbVDpMppWGHL6VaKCK8Y6XVu65Sjcnow5LXzFy7Qr2DxjMhynHo8TldYS3fKkfmTpk7xrP5LY2vWH2fHtLN7S/z9/a9RkhLXXvzfOfpshOcpyB4bN2rsPtQ095YDpeRd7m9kKS62K+YR1Y8Am0/su9srzjfQyJxkd9ulXr1Q7TCU6eHxw50MIQcgmW/atOl39tWuM6NR48ZOmXSQDNC+nVNKUjx6g7K5WXexVfp2/fz8fKdNFuvRlTTywZHjx4+TUqrUXem+S9huO9bw93eewZRFz7/wfPfuPSplzVq1as16bvYzM55xagnZ7sZTRPOKtpd5Ecvt+9w8bxfGDaK9hutI2rv3RKF9j6O3+4PtjHwEB4c0adZEgoXEdMkJZV5e0pJwPrTbtm3T3iqphuu9+Rp8JYLIIvlXYlPoTaGx7SWMtPUcC0lISEhLSzt79qyfj1/9hvWlWSBVTn15dna2PgPhVVbW3Wq1eL5QjmTv3r3Hjx+XLUvVODw8XGKN1N91v5s3b9bVJM4638e3b98+qZjL8Uvkcp5zdja4Y8eO/fv3S4tHqueSF+U4tfPn500/G8aVUuvm3cjIilq/ZKkNGzb8lv9bSEitO/v3DwsLk9OUeq6UQIBvwG23X+cnkqTxtHXr1qysLImwgdbdtNHR0Rp/ZRdyqLKCHGqAr2+X7vb9Y1JKe3buNKwxZzmp6r4GWMpNUq+X1Xxp1aaNk35++eWXixcv+sqlDAmRZOCciBz2xg0bTxeelpzarVs32XJeZma2ORLmU69hPefJPsP6apkfN27Mzc/38fJq1KTJsGHDZCNJSUnSXiwtLZWs3LNnT89SlasjOdtlfX/ZrbfeWukLJeXiJiYmHjl8uMz60jO5fJ07d3Y2KOceFBSkcwz3sJZeRGkbOd+YKdfRc7BN31HSjHZZX8Lm3DuQY9Fvk3TetwCA/wOVmgIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcKP+BV1/XjQNCmVuZHN0cmVhbQplbmRvYmoKOCAwIG9iago8PAovTGVuZ3RoIDE4MwovVHlwZSAvWE9iamVjdAovU3VidHlwZSAvSW1hZ2UKL0ZpbHRlciAvRmxhdGVEZWNvZGUKL0JpdHNQZXJDb21wb25lbnQgMQovV2lkdGggMTAwCi9IZWlnaHQgMTAwCi9Db2xvclNwYWNlIC9EZXZpY2VHcmF5Cj4+CnN0cmVhbQ0KeJzd07ENwyAQBdCzKLwEktegYyWzgO0skJmuuzWQWMB0KSz94CiSXQTOnaXQveIk/ucAjrPiv8HUwY5EcxuCLDZg00BBTGarA1u4AqYLQOYhH9epoOSRc7gKsI+dqqqA0+pp7I0GA0lPH+c2sJE3K2lgmshSr0EiObM4q+CT5yGncD9R2uEYJCkoXWPIrzgrKA9sO3xnWhAs/tiqKpAWbzWUPaDJRQV7HjydQRu3/NO78QYNKxPODQplbmRzdHJlYW0KZW5kb2JqCjkgMCBvYmoKPDwKL1R5cGUgL0ZvbnQKL1N1YnR5cGUgL1R5cGUxCi9CYXNlRm9udCAvVGltZXMtQm9sZAovRW5jb2RpbmcgL1dpbkFuc2lFbmNvZGluZwo+PgplbmRvYmoKMTAgMCBvYmoKPDwKL1R5cGUgL0ZvbnQKL1N1YnR5cGUgL1R5cGUxCi9CYXNlRm9udCAvSGVsdmV0aWNhLUJvbGQKL0VuY29kaW5nIC9XaW5BbnNpRW5jb2RpbmcKPj4KZW5kb2JqCjExIDAgb2JqCjw8Ci9UeXBlIC9Gb250Ci9TdWJ0eXBlIC9UeXBlMQovQmFzZUZvbnQgL0hlbHZldGljYQovRW5jb2RpbmcgL1dpbkFuc2lFbmNvZGluZwo+PgplbmRvYmoKMTIgMCBvYmoKPDwKL0JpdHNQZXJDb21wb25lbnQgOAovUHJlZGljdG9yIDE1Ci9Db2x1bW5zIDUzMwovQ29sb3JzIDMKPj4KZW5kb2JqCjEzIDAgb2JqCjw8Ci9MZW5ndGggOTUzNAovVHlwZSAvWE9iamVjdAovU3VidHlwZSAvSW1hZ2UKL0ZpbHRlciAvRmxhdGVEZWNvZGUKL0JpdHNQZXJDb21wb25lbnQgOAovV2lkdGggNTMzCi9IZWlnaHQgNDY4Ci9Db2xvclNwYWNlIC9EZXZpY2VHcmF5Cj4+CnN0cmVhbQ0KeJzt3WdgFMXDB+DZu8ulh4SEIL0TihQFqQpIldBRiggiSEdRVEQFlY4oKAoKolgQRQEVRUB6VVEEBP9iRZCOkH51b+/mnb26u7OXXHwVgv6eD2J2drbOzU7bWUIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgQBCu9hFAiWJuO2fd3p1vDki42gcCJYXxjh+pz+nbTVf7YKBESFlGgzwPmvEUARK1lipNiLraBwRX30BVmqBig7+QVRjjyjfq2LP/nUOGDht278iRo5mRI0YMv+fuuwb1b1hoTIPJaNQNiEmudmOXO+4c0Kt1zbQY7pCEaKMpKirKZGLRDQaDYAitISTW7TV2wrjb68UX/zyKEBWbWCoxNrqoR6wpvkrTviPuf3jCyO7Xl4m+FnNe8y51oqBLzMXcQnLXWbvOiDSck1WNUezWGb13z2g0RwezolK3TVv75ZFDX3y4cFgdZf5kqjFg1rpfrMEtWI+vndQqWrlL4amfjx45fOjgga/379u3b+/u3fsW+jZgqP/I9ix/tHPv9k9URKlarWrVKpUrV65Qvnz568qVr1A+UbnF0rVqVKtSuWKlCuXKlUlLTUktE6s5y6Qes9cdvpDvyD3307blU3tUDZOhxtw4+vWv/gxdDcv/Vg6teM2li+slzU28nFSc6ML1i7PDpgef4199e/DAgW8PHDx48NtvDx7+bn89b8wqz51RrHTshRt9P0BDxpTDelv5dWrZ0F4NK7lgb+xGH6mXHukYjFImx53vYOw2m8PpFD0eOlF5HsuoR/RQD5UkUXSKosMzU3Wa1eafVm9Z+uGVrokGzcWI7bj0hM6hO1a2vMbK76O5c+hUjDNouq2IFKGnNYuY/Dy3eDd7jpR+8LROBB/rM8mB3Ro+0Ab+zCJXWMVHWlPeH6UhF7RMcR6GPdrQdYqfd9klHr0DKvhqUlVFumi4ODfssX/b9C/dnKvlWe4EHtJ/yOtI5iNHoi0hrX/kF39K0qZn8YsVDjbx71hYow06KZDWv+jF+bamL8rNXMhaxQ01facN3RRKFJm/hz2ighcCD9vmK92FHbr4UNz/80ZdSQu4458VaaKo9W1hlyG8DqRpgc7iqR3D5xJ+ubf4d80litOmptrnoN/Rct4YXbiArYocMeo3beg3wdAh4ctLTHNf/Aetha0kW6wqFZVsk7ijnxxhosjgLmSEujU4r7f4vfC5b9CFDN++P9QGnK/xfbg473nPpye3/GtFWdF8XBv6QyB0UKFpgnaS10l9r+hDpy9fO3lFG+5x2SOywnIt7jpGatHZvxqT0r2l5H0LH2mXe7hCQcgAOUpfbvH3ip+u+ZQ29Bf/c6Gps/ADasHWMXHlXl3Tr5laSNwfmkMvKBNRvOSvI7oQf7vp8s4FLqcozGH57t/OLf5RmSi4dHrclyhiPi9i443YSuUKLU6EFN5kU5I8pznytyJ7ejwT2XX427nluyB8XKw4A1mUO7ilP8eEziaGSxQnfImiX1HbrsNWuiHC41h9zdRMq6oLfa4bI4pVM8LrwGr0ka1mifDXRpeSYieKvVF6ieKYIqeI5h4fx71limjdNhOlumytVpEeSKt/4P79M0a4lMc9IrJIL0VyDZyjOjdvcKtuHZ8z/WiEF/ZMPCEGrkxRuJp6ZYojiqbbqBPaUF+Zgq/IUmrNUhYzrmdrtY/0OJZEXNu/2oRBF4NHndcvssJQdZ3il87NbyavGtHlyqkccf22jl5Bs3DDCOnFLfxGUfuIClP74Crsv46unhCfVHvom5f8CxqztTpHehwnr50KCGnwge+G5i2vH2GMRzRnKy7rVKVs3WH/0yxeQARSK6LLtTiqyIw64DYiGIr3+KDzCenOLdytSBRGruHrO/n5b9R2DJ2s7I9gKDvGl45uIHptIGFIFf7eG/ePMmaMmrtgSp+y2sb8sOt/qT7ZtzJ8GUzSHPXyc/EGIbJE0Ubg2hTDGUKEYpYp6KcG0pVbuFlR7DNyLaxfy6GJlzVLZyguQvpcC1siF8Fui/hAavxNN6wkKq8uFc4PPp0NU9UXoY0QWaI4HWM4ol6S+8Mnry1aeVDnmXQ/SxTrIr4NXodNOln8x4pEIXAlmj3y47+sduk0oni8Ghtt91VJNdu2fb9q3lMzV5zUOZDaV+4eXXEdVGe6TjFyIX69KmgiEWpHctfeJUbF40PaM61zmSj58psyZnHtx1OJYPxUdyt/rJ43Y8UFnYAzMaQdv09FvmjgSjTb5FCujnVI3TOaNDVbbmLtpNzV0r7lfaPXErvyR/lvThSqrlVHhjKogeoiLA2bKL58PLNuWnLFFoNmfp5HaV9iCuYU2+5OVxbSW+dpYs4lgmk95a1sHiXfsXLv8kGWWJ1q43LFj174Qhu6WQ6tw0V6OVaVKkzeoTxtA6FZC9vEKrYa85Q2+r85UTyuPNH1qnqWcYsybE2YRLGgfqiRwJDWekQaMfkycPfihtrhKxO0cVlOoZMoHgnES+SLrJ5EchO3cKGyoqUtUdL1cmglfjeLk/j6WUtfkGVKqibMrM0r/s2JYrryROeqw2Yqwz4memWKtc34pj3zDyxAml+Pv+RlNF2qL7JEsZHb5sZQ++Q4fo/JpDG3TFloJNy4kI/kA0nQ5lLMvo5ccdyb4C48ptM/oG0Q/TcnClVx8lF12Ahl2BqdROEZrNeJHM0SxcYGejszHVDHX8QSBd8jkRmKwGf6LFHU55ZNUu6E2+Aab5FmO78pSle10ozVk5u5nyqtd+w1NFEz9Fb6l1D9Fp9Wh6kSxYuEb6c4n6i3yegD5wfrt/eZNDWDxSxRbNFuNDs5FCH+jDaUJQo+pYxX7uQz7s57s6xHuVheRybXVB5rhriyCdHVQBOxhOcUcd3mvvzoLWEGfsR3nbN8waDw3aWq1pqP1M8C1eNjjE5OcSZer9XU0DwlzM6aaeKzRGHaqt3oFsVNMu7m7mKSThvaSOVOuIaPd7wHWUlvNJDX3uGlQperQZjma8MUTaySnVO0OOQ7Nb3eXCHT99v8PVMn0Kuq8kQvqhKPaYcyrAWfg9KzxXo50VBXW26UHx87tBt9TZnQ1mpDpQSdRDFEuRuuL/5tb8lBeICLFnT0piIOXUh9UJum6hTn1K8w4/BA7T/rAa45PjnYKy4ND9PEGaWq1j+iDGqhDDkXp5Mozuk+PnSYK3V+YPEObuATK2iauEQxTxmRG/PiiNdJFAOVUbjxfct9p55QSC+L/YmwXRlCdPn2U9Zp20NLdqJQ5mrrNe3xNypv+KAwG1AN4ssLDaQnNX9VhsgjYqppL8yFSBKF+cYHPz6nfy9eIAbTTu3CacrIb2tDc2NJXW47A5RR3teGLvFnPWUKGdJFt1TUO/aYRhPXnNCPUIIfHx1VB/qV6szaXlSGXUrX30IVu3KtC3UDyyvvU226OtHpJY0gp0h/oJDusWeJYOZKDdOU0bkRk39Gk+u57agSPJcoXgqEVNStgfh9dx137JWe1h1V7lNyc4okTZvuT+1CYSNs6rAl+m9CGZer1rr4YFmTIERVe+qSavHr8q+NSxRni0gUxvYrCh2YM4cYzNzPV/Xuzmpt6Plo0oTbztBCozwXDEp4ppDxPxvVRfW42z92FHbsJTdRPKg91OxR/gpEzAzuNFrob6ORZjX79nfWHtIkKF/7N5cozhRa0DQ0LqoHdBrLKfZqF85RboPrLjsVrS7reI1RRuHKpsqmrRsKeeVJWbGNHqTzOotKXVJCJWuH6jLr28QajXG9v+RD3tUfV2hcVMTpM6O9axYvUZR/VbN21icvaJZMIUIUl1M8q9wI1955MjrUPxH0hDIK13c1RRkafefmcCdpDTY9GNpoHzRnV2ufSiU2UWTqnZvl+N593DhFryr6W0nbGe4yBczzJSeuoFlIojDdc1G97tsdEgwJ+eplj+olivmKrQhc09Yps6on02eZspeU+zlMUh+ZsdLw1w+6uG0wa/2/morqJyp1LWyVYNTutcQmCq7rrnADw2ymahHvAu3xtwUXI1GYNS+YrqktF0riNU+lh1mi4B4fzys2I3BNW2fMOqOjvlIOx+N+EJO0B8dWSrmN2zL1jaggpIG6eOl+tpp87NdMotDL+C+tenLiUysv6oSoWyGUmumNXAg67H+HUydRhJs4Ik1da/ipr+83mKQZD/qIXk6xULEdgSsCXIzVGR0llg41eGmLSFyPjl/Scm5F+pQc0FDdtL6ike/YtUN7SmxBk38r2DKjgvf6VHhW5xW5+8NuqPHP/NoBu4MTB3CJ4lyYRGF4S7Xa22n+5aU05fkniGDicoqXlYMjuErk5Vi9cZT9g3FiuLfYfbeaV5p/xu4yGEjyQeUSZ3DqMG2iKLE5xd3aszrRPnB1DD0t3DnfGn5LZRfzV9rno9BkEhEnimGqtR4O9kRqE8UclijUzSHMa8oCApco8uJ0Rl7RI4FOtFI6LyysCDOsfSG3JsuGolXNZb/fHCyca5PiDYXemauorOYpcV6Zp3XTnvKBmLAbYpe/oc4wJ0p/Gah4XFfVhoZJFNVV7xcPD3UxlbKr479j0ClTvFFoorDE6QyyofQtb59WfF+9lrJj8inElOaSxmB+1QrqhbsrhI5F+9DqVvituYqGqg90hPLEBe2bDl0L31ZPfmTt8fuSlWtEmCiEJcp1HlakqmRNojhsFqK40XPvKPop+UThiie6A8B+fLTf0Pkn9EJ8P+pG3w/Q9n/25tesrOrcz6+uWFubKCaSkso0S3mcWamqwCrqetfQQl8OMk7Q1Ayyd8/vqWmw5BLFWd1EkawcoLtJOYolWfviUWMS9Y12o6uViYLrLvMkkTLaZUXZzp6AzSnd0FTdKTiWX7OsqnP/IWXDjrb6v7nkviJmelJxnBvVJ21SFt1tvQrdTtQ89SlPqZfEt4pziUK/9qEaIK7qq0rWln73lDLt1270k0ITBS1F4viRN0U483izAewf57Laiisk8EXS/LgnFH+5r1P+jLi3TYaV3OkIjF1DGd4LmrBXQmewQXd4XJCgefVnp+7PIMIq6X3KVWopQ5K53oSvJ3Cd0huVL3HwiSKZRP+V2bl8rCvbBwpWBp33fr41KRvmv1b9LLgiGl3aoVqxZpq7kpKnBcZ/zNaEBO/0ibuLeHNeOznMFt21uERxSncUgrLXxa16omkLmrqUr3vxVVKaRgzFbLNT+2FuhzIxUeayk3Xq7AsMPyj+WqvKePn5c5jHCr+sV5Ghob85f4kmwF/N9DyWrBtPQdtDna/bIv4XEoX67bqIEsVWxQ9UJ1GkE9Imgq0UxvHbV0dsegFdDcoxJLtUX0PgX2ummu7ZEiamrzdH3a/OD8y+vHdV0TVqwyHt2W6opzMxK58odB8fqmE7dypDSuveCo3tykTBPz7KEJKk9xpfEfjBnrwziap3o6VyyoeobqIosY0VXrGt3rRRt3o0UAP5d/lxiwhKycJO7nSt257uVStRHZcraP6hmyhU80fsDw2KJaaIXvTfWWSiEGbqRCvc4XsjWGkQMaqG7M1TnH78VJ0IFyMdjni1mDt8rx6KYFpB6fkekU3DM1f/Kp3d8Hh9RY4RYaJQ97Cv8w8GNiT24t/70bNNWabYyQXLhZRahQ3d0Z1ZZXoEcwzsitG8G0UH+A8lqtxDuv0AH5fcaqmf0MjqVE66M4yVn6tHWG26Ifxkgt+ODP4cIkwUZvVb5ycmd2zUuOvEVYV2uimoCprcO4Bu+fUBI99CHTT1Hr2l7VoXveOWhJvJZt3otk3bDHg63LPnob9wm66wqPfp6caBP4QuOZR2jzSqQTv8RenXfv4fRISJQq9VqBg2KX5+Anc7nN4kWu5EuNg7YswbdBaXalrkfr097AnFKq5cCzMyT6T03KgU+Zqaqs2TmxWrRhw1iWtYVFriewRwiUK/oEnSdQaERW69speU6y6z+YZwtMzRj3y+JiF187nFJ3V61DXmeosyBu3EPoXJvhamOPK+A5u7bt7c1/zNhGEGcOvRnzo34Fxn+U5xtY9wEz8NCrOZnxdH8EP8QLEhA5coLvnT4c26x3tUnsxMZ2jWCmKeyicVBXG0v1EiWW/wjewIP/5iXaTTBV1NXOE+teg4PqZqMwufkdramVXauZzieJhEEfWa3jYuPpBAWhRdKX1dsSED92Lo6UBfSk2dtzgW+t9XvEM7aHsk21TVF8Pv82jL4C6r/aC3wv7b48zTtQsnF/P+/KOMlQbNefX5UTW1ZV9uvr80bTkztfPDLyy4v5mmDz2qL1ee49g6CHxO8bv2+yoB8TO1DdrOLSPKyEfTSjOEcgvXda4aZzspx2qx2h1OKXCbQ3WT1LmaN/k+6xq4IEKrnaoQ0duEZqwx6QvdIf75M5WvS2ZwrehnFraTT9R8t6asfAspOTLe99XIHCuqqwM6aM+mnDpRVF7gn6Rhr6rR5RYuj9ZzvDSpqr3TP4cdoWGsOS9Uicvat3BAxcBbFQmDVLsbml4vIyOjdu2aPrUzaqsmAohKSklJTSuTXrZchQpVqtaoWbucYh/lHz8W3M4v825U1r7j7lS2x80IXIfoaoPf13xgwLFteLr6MsX1+jCUbZ5c/1jL5MBjotxjyrnkL5UiJYUwIFTGutBTlVlwXTyVVGfbO/Thn5zBwcdh9GRNpKxNr8x7af0lqjXTkDBo+Kjx9z/40KTJT0ybPXfu3HnjCnmoCjF1u9wz/v7RA9tUT1B/9zCq5l1Tl6xZ9+mH7y597tFwL6hHJqbe4CkvvbJgcv/ruY+Txd78+IeHT549/dOmp1Rf8xHiamaOf+aNjz/fuX3T2ucndE7Xabo1pNzUf+wD94/s07xyjKqhR4hpMHj2O5u279mx7q0ZEdft/nGG8cobJQ1ThnETTKpykjGqoNH+peU0FbjnW5UysetrTO7zlWZjnvp/Z1+xoPyC3D9EiDKbzSb93RiNpnAfwitys964JamQeYv6TlmVXdPcpNXK0XmaXqR838vI0Z+olh67KXQJS2lLi0tLfPvdf5RJ+ybeEkWK5WqCjRURN2nCZsu/VE21fE8FZWaZoHnlOy/iygxcUdwkb/mKchk3ElUxFwc3J9AfcitQGdX3BZ0N1Fl6ZU39sfMVOkkoHn4EsmKY3VBt2M2hsJFcRHkKdnV/8Iva3jPN26ATrsQZQrFphlJS1UvaXKIINckQvuVGLmqqJ3K6Tbs3TSFl1hU4QSg+/t6+HAq8Sxum+ArM61xEuT1uvmoJ17+jmbhshjYcSgR+qMeCUCD3dZSaoTB+XMrDbOnTqiU9tHvT9DeHf+0QriZ+CLJiZjjtq1NWxcCgHlzE3kT73uGbRk2dXjNtcvMrcopQXElch1KlUKD28wUHFAXH67RjZj1yRPV31FwZ6kQRpe6nOFLYa4dwFWlfBF6lHJKiebFG8WQhgrZQsVaOGKfuElytHh+hafe464qcIBRfPU1W0UwZqMnuVV/Ea6CJ6KuZaDo+XlU8cAy91CMhN19DH3P+r1EXA6aomp5TVPn98+qunntVI1qn+yJW0HQ/f97cf+tNtTV5UkFjAiWWouJZcI/mhc90xWwh07UjYEaEXu+1jQlE5CYn/nrWHe063TVX+4qnrSOBEqxdYPLMtfwnNUw3v+X9gu+JZc357qvOgWHWn4Xm8Y6N7MXMk0XNXv2fU9JeL469deob7y0aW1f3nQ5DXFrFCqVjdXs0E7rN+2DdK+PqK0sHtYqaMFK2jvuQgeHZjRs3bd68ZcuWrcwWla1e20J8C7aq1mCLt3spVvCvFfr/4EpeOxg5QnBLymiafW0LRA0uCx5NcFs7du7cuYvZzexR272bLd+507cC+69/197tsd1v3rRh46KS92Xrv5pQDdw4gIxC5rvyyRrCV0bTzlJXZB80/jfySA7P5ap/8RZcE6osLfQCXJ5bTS9W+zGjRo8ZGzSG4108btw4TfhoWTA8fHRuW2xT473GBTY6zmesnnFKir0oQ8frus9L8ad/l+oNjhnN9RT9uxhuWBluzmpxw+CUkjTGCK4cY8WHDvIpwvLR0Kpoxfwvi6k1ZP6Go5e8DVbuy99venH0zak6Y1rhv8YUE59WqXq1CqUTYqNLWpULAAAAAAAA4P+nxptvvtk70pVL3337FWoqqTv6ZvUCQ+aI4Dcp6w4e3B+vTBbDwE0bP5Nt3NgnovUHuCm9O8JtJxxyiVdmTtsmOdTaRrXkaZEeCySEPR5biZqfpMR7I9go3iGi9Z+WqLtJhNtu76R01T/SiJbStqXq72lU+wLDYUod/jHREz2epSWvm7wk+5a6JMnjcbmzIpu8/CMXvRzpNOeVTki5/f76oYXVZH+O/V7VkkwHPauemfY1t/ih783aptl0OdJEcZizXLYP+g9gekYW4ZjL83XEP/4y/ev8E8/y0SJ1tFSPSGk0QDMVlKlHF//b1m3vGxOLNv/iuMnmtN3j+18hOaW0d7ICeUYieWyXMb1tn9u8n28UyrTrc4vvg065btci7+rxN/fp4p29TyidWtpESrXvlRFIAOaM2/q2SyGkVOnUFN/tiKrWoXfXpmnKH6yxRmavG7xzbsWVTo0nUY16dVbMS29MSWUbSO/co7J3/6mpZeLZ/ySnppUWhJSXRXqpdlocSUxlxxl3aycipKSmJflGCKS369u1mpFElU5L882/k9SyZ6eyvqNIKp1iIjEtezfX/0A4+I1y2AsCRYS3HY7cFoRUOSu5j6YRUv8zu4fS8zHsB/+WhRUvT/Vl6zR1UvFudonNT8hfcsl7nN2JOvlSTsP7LorU6ftWpGHg96JE6dtEOOSwfy3fKuOQI1a7Q3TlzgvtuPkuJ1vpaEO2rfkuaXn5naJIfywfDO6S4/wuZnaeixbIM8a3tVIXew6Zjkl0F+mU73SJDrtlCFnpKBhf9QjdQMpfcruekW987ffld6bsZclIJ7XVYUsSXpYna8hd5E3Rey3ZfVp/J3roZ9fCBJpXzzLRer58TFxsfDwhLe3U84732wFZTYjpkSxv8fNTQm49Qak8iMfejpB7PFSsR4Sy/uHCnnHsee6m9kXegeYWeTqmip/4poQeTlKyqLiMLam9Q6Quh/ztq+DEecL9OZTKvfy/JRCymdL3jnnksYEvBo9rrJse/ESSl51jqfJh9m99QspbKV1KHnO7RNEpWa8nX1DHhGOUziNtRSrdzpLjA76J4vYLZAGll1htOONr6pvsex37w3zS41yU7x2ONOrKX+lryGExv+CPU2fOnF/PftJvOWhWpRmU5txGhOdEtzPr/Tmv9iX1LlHXhkH3nqP0LUKe996ltEOU/jTm9h0SPSqQiRJ1iQee/4Vd+3tYveAbSl0/vTz73bLCjaI7ewgR6vxKnVlL731f9NiDX/gbL1LLKz0fz6W0D4k6LblE6/I1Ng89HHz2L5KoKO56/pRI3Y0IWeOmf0YR4VYntY8jD6yzO6Stby6KjvrdZT9J3bl3kHGi62JlIWquRD2XVs95rT8hWyXrNmLIOEnFc8+O22lz2R8gpFaOKBaceekrm5tlYxBWcq493+4dl7Oc/VWTlTpfyqO2oSzDtouuYxne8cWrqFv+LNg60fUZIZuoZwcRpkriOZYrjLbT01FkiSTRg4lkiIu6RxJhuYe635aHexnIEI87pwGJOUg9OawUu1ByWQOfpkk+S51PsccKS0ijSCWr3em4m5CjLvp9MFFs83jcbxvJk2yjNxLjb27nNrZwLCtg3iqQzlantSE7sjLZDpv93ND6iWSR6PhNEDo5PZ5TN3p3TU45c18khndcjstdWA7zp8V5UCB9LXbxRCXS0ip63r0K1/qa0cJmzb986fKlnGxvLf8NuzXfZX9SIMJOyZF/i/cW1ch1FYxs2H42+5m9RMwnPNJiYjwu5r/RoO2E3yndI5AdktvegZBekseVSepYKD3if3dxtsd9PpYMckm2F9mWtkiOXwIFvOEueqFxkz4rHG5PB9LR6pBWsyLofqe0LXBcxuMezy+sHPCAwyNVJJWynLa5bOlCF7VWZAvtzrNyGaGp1WY75y0QbZcKNhKyVnLm9/Mlqxr5Yt5IUuGSNesd+c8jBZZLRjLTYim4VyANLA5J+7U2UBjmcOa3TUtPL5vuLXo1y7NYxTeMglDV4hK3+94mGO9xyhPmutz0UmNSwU6lsaSRw1Hge1vNwXLqs6L0DctJRrlctprkPhd1BD6Y8JFH3EvIh25nNstVon+3Od8P7HaVxyPZvQWVg9FkvE0SWwiC+VebM/i9rAoFVJK/qDbbTvPMpL1Fsvb1pivPH2xPy5yOPfJKd9kdcgJmSei0mP8cSbxgs37nrwDd4XTntSZ3WK3s2cIcLcg7ZyAb8y1nkwjpyM4NM3UUYr7LfVbxZtGoAovVwZ6+pItDcj7nW/a6x1Jgd7scOVtbCaQ7e8a3If1Ea578urPtUD8DqWxx2qfJm3K7TpvJKx63PdAL8bPb9SoxnrDnf8n+qJ9tdzwY2M8harexB4PjzxXsgbLYTs+wLKRijtU+PrBCDzsV5SH4H7lc+wkZZ3fn1RKI+bzTvpYt/MJuWSqvNEN0ZFWRE0UtiztvOKlnKcgNTAs0z+XJLk0etzpy5CathHP2nH1EOJmTt4b9NdZGbZG13v5HbaXSztBfvS/a8izSiWRC+jlddn/9cbWYf/yJR8d2rSD/CGeJ1JZKhonWi7OemNCvronlJbe5PJb2LGib5Nggf+HObW/hi3gdq0feR9JzrVlvsb9mFrhsrQM7OubO3Tp10rBbUuRPv+2VxE/lnbPEFVxhFqtRprPCwa8u2yuEvORwnWXFlH42Z/4jhCT+6cj3/tI/dlq+8K59j53mNCEtbba8hf4mrT0e6TsDmW21X5JruX0sYvYkkpGVlycn+KUizVXO5Q0ap6htibd1SP5Pkwv27KnZonM4IZ0lt3u/3MEpsEKc689y7F9Bfphs9tAfBdLTJWZ3kqMLRoE85KF57P6Zznjs8wl5mbpdT/puTE8XldqTcvmW3B2EVDkjeSzB+Vm+kGys7CoQA4sfe1YqkCeDm+mQLMFPWWx20pNsfxXzXXljWX7hcP4RTRIOeOz5bQm5yerKGSyv9IujYJl37UUuejme1LM6HT/5GiDiLki2N1lN1u7IYhHMu9ziqTTSO9eeJ0/usEdy/4hm7/CqWan446aNmzZt2XoDKXvIZnvDfFB07zOS9IvUI60aNHhBQ9LTTt27hnbqPfnzGBJ1hoqsNlc+j9Izj3bJHLueVRfflNw/s0ykppU67/VNtJA/7Y5Ry1LIDInay5PE805b3rRRP9nZjQs+qBZ4qOOd/p0GPrPaQOpbPfl3sWT0udN1PPDakvm46NooyF0aUn47Qj5xOQoWjN7n8bhyU9mjxUmdXzzSkKQXiFbfB8u/crsPGEjsL6zgs/GuQbNaknoOKXesQG62epx7O7ZfY3dnP0nI5Hz3n4ly6hUdq67Ctb5mDAx2kUrpZQ67XccrkMdYXZ8VzsZZvK0+nltJ1Bbfy5dUKkfqsYKAPFPjQu9X2Nl/uhLDEUpXszyD1Ujl2fniAlP8lyU7Kf01iggr3B7KconnLfRUsMJZw/tmvVuiZ2LICHlSWJZhnHZ7PgqE17FSzzPs31mU2q8jZK7Edk892yR6giW/Vt4ybntW3aGid36FUjlUXMi2Pcb/kYJeZJCHskorMa2V98KKyNnzWaHlPZEekrdtp6GyC/Cek++MS3TYpP9FfyCJlpECqZ3rdO0zE8OjuS6X22Nhue91+0W5G9V1rBLpLVKL/FWJ2NcdktsjSafakKRL1PE0SxQvuGi+XBVN+dwttyDmXRf7B3W9x25V5WNsQ38OvD3XfTTULdXld9HFtinujCFLKM1mdYI62aIjOKVjL5vkvItt9HNKjxsEUuMklWjuqBE2+jkLNG1lydFRgzwlunO9H4poYnFbBrJtmyZlyxUasTuZ4aJZcraUvFaU2AmeHcJChW8cdrl+2ttO85sRCKtZjx49unfv3q1b99YJXbt168oupNCxW7fMGFaEqDli1rRxTb0Ta3WaNOfpEc1jBVI1s1tXb4+jsfHYGdPu65QokDgWvRpbvVlm947e3D+67SNzpg7JEMxsq3XldUvdO3tiTVKxW2ZbxZ5T+k2Z/fhd9VmZokVm904sYmpmZmbwReiq7GDkTqwO3bq3kjdRccLM0dVJrW7dvBOLJg2bM2O4mTTO7NbFWza4LrNbN18faY0R06ff1yaK3JDZvYOcDoix2cQZk/t4u/mETl0z67F/q3X1nidc+9D3DQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPDv838ZHGRWDQplbmRzdHJlYW0KZW5kb2JqCnhyZWYKMCAxNAowMDAwMDAwMDAwIDY1NTM1IGYNCjAwMDAwMDAwMTUgMDAwMDAgbg0KMDAwMDAwMDA3OCAwMDAwMCBuDQowMDAwMDAwMTM1IDAwMDAwIG4NCjAwMDAwMDAyNTQgMDAwMDAgbg0KMDAwMDAwMzU4MCAwMDAwMCBuDQowMDAwMDAzNjUwIDAwMDAwIG4NCjAwMDAwMDM3MDMgMDAwMDAgbg0KMDAwMDAzMjA4NSAwMDAwMCBuDQowMDAwMDMyNDQwIDAwMDAwIG4NCjAwMDAwMzI1MzggMDAwMDAgbg0KMDAwMDAzMjY0MSAwMDAwMCBuDQowMDAwMDMyNzM5IDAwMDAwIG4NCjAwMDAwMzI4MTggMDAwMDAgbg0KdHJhaWxlcgo8PAovUm9vdCAxIDAgUgovSUQgWzwxOTQ1Q0Y2RDQ3QTg0QjM3MkE3RjVGRjE0MTk3NUNCMj4gPDE5NDVDRjZENDdBODRCMzcyQTdGNUZGMTQxOTc1Q0IyPl0KL1NpemUgMTQKPj4',\"U_ESTADO\"='APROBADO',\"U_CDC\"='01800823800001001000003712023060617618218838',\"U_ID\"='230238740' where \"DocNum\"=101498  ");
            ////oAct.DoQuery("update OINV set \"U_ESTADO\"='APROBADO' where \"DocNum\"=101559  ");
            //oAct.DoQuery("update OINV set \"U_ID\"='243792074' where \"DocNum\"=101559  ");
            //oAct.DoQuery("update OINV set \"U_CDC\"='01800823800001001000008912023061514596858250' where \"DocNum\"=101559 ");
            ////oAct.DoQuery("update OINV set \"FolioPref\"='022',\"FolioNum\"=982 where \"DocNum\"=34279337  ");
            //oAct.DoQuery("update OINV set \"FolioPref\"='022',\"FolioNum\"=948 where \"DocNum\"=34279338  ");
            //oAct.DoQuery("UPDATE NNM1 SET \"NextFolio\"='5' WHERE \"SeriesName\"='1-1FE' ");
            //oAct.DoQuery("INSERT INTO \"@RELOJ_MARCACIONES\" (\"Code\",\"Name\",\"DocEntry\",\"U_COD_ENROLAC\",\"U_FECHA_HORA\",\"U_COD_RELOJ\",\"U_IND_ENTSAL\",\"U_FECHAREAL\",\"U_RESPUESTAWS\") VALUES ('39654278','','39654278','30263','20230317','8','E','20230317','PRUEBA') ");
            //oAct.DoQuery("UPDATE ORIN SET \"FolioPref\"='0',\"FolioNum\"='0' where \"DocNum\"='61448'");
            //oAct.DoQuery("UPDATE OINV SET \"FolioPref\"='014',\"FolioNum\"='78' where \"DocNum\"='48278118'");
            //oAct.DoQuery("UPDATE ORIN SET \"FolioPref\"='017',\"FolioNum\"='697' where \"DocNum\"='102810'");
            ////oActSerie.DoQuery("UPDATE OINV SET \"FolioPref\"=\"U_ESTA\" where \"U_TIMB\"='16094946' and  \"FolioNum\">0 ");
            //actualizar folio de los asientos
            //Recordset oAct;
            //oAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            //oAct.DoQuery("SELECT T0.\"DocNum\",T0.\"FolioPref\",T0.\"FolioNum\",T0.\"U_TIMB\",T1.\"FolioPref\",T1.\"FolioNum\",T0.\"TransId\",T1.\"TransId\" FROM ORIN T0 "+
            //             "INNER JOIN OJDT T1 ON T0.\"TransId\"=T1.\"TransId\" "+
            //             "WHERE T1.\"FolioNum\" is null AND T0.\"CANCELED\"='N' AND (T0.\"DocDate\" BETWEEN '20230201' AND '20230210')");

            //while(!oAct.EoF)
            //{
            //    string pref = oAct.Fields.Item(1).Value.ToString();
            //    string fol = oAct.Fields.Item(2).Value.ToString();
            //    string tra = oAct.Fields.Item(6).Value.ToString();
            //    Recordset oActFolio;
            //    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            //    oActFolio.DoQuery("UPDATE OJDT SET \"FolioPref\"='"+ oAct .Fields.Item(1).Value.ToString()+ "' ,\"FolioNum\"='"+ oAct.Fields.Item(2).Value.ToString() + "' WHERE \"TransId\"='"+ oAct.Fields.Item(6).Value.ToString() + "'");
            //    oAct.MoveNext();
            //}




            System.Windows.Forms.Application.Run();
        }

        public static void ConexionUIAPI()
        {
            try
            {
                SboGuiApi oSboGuiApi = new SboGuiApi();
                string sConnStr = Environment.GetCommandLineArgs().GetValue(1).ToString();
                oSboGuiApi.Connect(sConnStr);

                SBO_Application = oSboGuiApi.GetApplication(-1);
                SBO_Application.StatusBar.SetText("CONEXION EXITOSA - AddOn Factura Electrónica ", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);//Conexion UI API Exitosa
                oSboGuiApi = null;
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.Message);
            }
        }
        //Opcion recomendada y con mejor performance
        public static void ConexionSingleSignOn()
        {
            try
            {
                oCompany = new SAPbobsCOM.Company();
                string sCookie = oCompany.GetContextCookie();
                string SConn = SBO_Application.Company.GetConnectionContext(sCookie);
                int error = oCompany.SetSboLoginContext(SConn);

                if (error == 0)
                {
                    oCompany.Connect();
                    SBO_Application.StatusBar.SetText("CONEXION EXITOSA - AddOn Factura Electrónica", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                }
                else
                {
                    SBO_Application.StatusBar.SetText("Error - en la conexion DI API", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                }
            }
            catch (Exception ex)
            {
                SBO_Application.StatusBar.SetText("Error General - " + ex.ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
            }

        }
        //Conexion repartida para multiples Add-Ons
        public static void ConexionMultipleAddOn()
        {
            try
            {
                // oCompany = SBO_Application.Company.GetDICompany();
                SBO_Application.StatusBar.SetText("Conexion DI API", BoMessageTime.bmt_Short, BoStatusBarMessageType.smt_Success);
            }
            catch (Exception ex)
            {
                SBO_Application.StatusBar.SetText("Error General - " + ex.ToString(), BoMessageTime.bmt_Short, BoStatusBarMessageType.smt_Success);
            }
        }

        //agregar menu
        public static void AddMenuItems()
        {
            //variables para nombre del menu e icono
            compania = oCompany.CompanyName;

            string icono = null;
            if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
            {
                icono = "\\FGicono.bmp";
            }
            else
            {
                icono = "\\GRicono.bmp";
            }
            string[] pp = System.Reflection.Assembly.GetExecutingAssembly().GetManifestResourceNames();
            string pathIcono = Environment.GetFolderPath(Environment.SpecialFolder.Desktop) + icono;
            string oo = System.AppDomain.CurrentDomain.BaseDirectory + "GRicono.bmp";

            var oCreationPackage = (MenuCreationParams)SBO_Application.CreateObject(BoCreatableObjectType.cot_MenuCreationParams);
            var oMenuItem = SBO_Application.Menus.Item("43520");
            var path = Application.StartupPath;
            oCreationPackage.Type = BoMenuType.mt_POPUP;
            oCreationPackage.UniqueID = "FG";
            oCreationPackage.String = compania;// "Frigorifico Guarani";
            oCreationPackage.Enabled = true;
            oCreationPackage.Image = oo;// "FGicono.bmp";
            oCreationPackage.Position = 0;

            var oMenus = oMenuItem.SubMenus; //If you want add sub menu by using this line you can add sub menu

            try
            {
                if (oMenus.Exists("FG"))
                {
                    oMenus.RemoveEx("FG");
                }
                oMenus.AddEx(oCreationPackage);
            }
            catch (Exception)
            { //  Menu already exists
                SBO_Application.SetStatusBarMessage("Menu Already Exists", BoMessageTime.bmt_Short);
            }

            try
            {
                // Get the menu collection of the newly added pop-up item
                //oMenuItem = SBO_Application.Menus.Item("FG");
                //oMenus = oMenuItem.SubMenus;
                //crear carpeta JENGA
                //oMenuItem = SBO_Application.Menus.Item("FG");
                //oMenus = oMenuItem.SubMenus;
                //oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_POPUP;
                //oCreationPackage.UniqueID = "JE";
                //oCreationPackage.String = "Jenga";
                //oCreationPackage.Position = 1;
                //oMenus = oMenuItem.SubMenus;
                //oMenus.AddEx(oCreationPackage);
                //crear carpeta FACTURACION ELECTRONICA
                oMenuItem = SBO_Application.Menus.Item("FG");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_POPUP;
                oCreationPackage.UniqueID = "FE";
                oCreationPackage.String = "Factura Electronica";
                oCreationPackage.Position = 2;
                oMenus = oMenuItem.SubMenus;
                oMenus.AddEx(oCreationPackage);
                //sub obejtos de la carpeta JENGA
                //OBEJTIVOS
                //oMenuItem = SBO_Application.Menus.Item("JE");
                //oMenus = oMenuItem.SubMenus;
                //oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                //oCreationPackage.UniqueID = "botonSAP.Obejtivo";
                //oCreationPackage.String = "Objetivo";
                //oCreationPackage.Position = 1;
                //oMenus.AddEx(oCreationPackage);
                //////Comision
                //oMenuItem = SBO_Application.Menus.Item("JE");
                //oMenus = oMenuItem.SubMenus;
                //oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                //oCreationPackage.UniqueID = "botonSAP.Comision";
                //oCreationPackage.String = "Comision";
                //oCreationPackage.Position = 2;
                //oMenus.AddEx(oCreationPackage);
                //////Forecast
                //oMenuItem = SBO_Application.Menus.Item("JE");
                //oMenus = oMenuItem.SubMenus;
                //oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                //oCreationPackage.UniqueID = "botonSAP.Forescast";
                //oCreationPackage.String = "Forecast";
                //oCreationPackage.Position = 3;
                //oMenus.AddEx(oCreationPackage);

                //sub obejtos de la carpeta FACTURACION ELECTRONICA
                //FACTURACION ELECTRONICA
                oMenuItem = SBO_Application.Menus.Item("FE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "botonSAP.anular";
                oCreationPackage.String = "Anular Documento";
                oCreationPackage.Position = 1;
                oMenus.AddEx(oCreationPackage);
                oMenuItem = SBO_Application.Menus.Item("FE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "botonSAP.cancelar";
                oCreationPackage.String = "Cancelar Documento";
                oCreationPackage.Position = 2;
                oMenus.AddEx(oCreationPackage);
                oMenuItem = SBO_Application.Menus.Item("FE");
                oMenus = oMenuItem.SubMenus;
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "auditoria";
                oCreationPackage.String = "Control de Documento";
                oCreationPackage.Position = 3;
                oMenus.AddEx(oCreationPackage);
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "inutilizar";
                oCreationPackage.String = "Inutilizar Documento";
                oCreationPackage.Position = 4;
                oMenus.AddEx(oCreationPackage);
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "numeracion";
                oCreationPackage.String = "Numeracion de Documento";
                oCreationPackage.Position = 5;
                oMenus.AddEx(oCreationPackage);
                oCreationPackage.Type = SAPbouiCOM.BoMenuType.mt_STRING;
                oCreationPackage.UniqueID = "RemiTemp";
                oCreationPackage.String = "Remisión temporal";
                oCreationPackage.Position = 6;
                oMenus.AddEx(oCreationPackage);

            }
            catch (Exception er)
            { //  Menu already exists
                SBO_Application.SetStatusBarMessage(er.Message + "Menu Already Exists", SAPbouiCOM.BoMessageTime.bmt_Short, true);
            }
        }
        //fin prueba de menu

        public static void SBO_Application_ItemEvent(string FormUID, ref ItemEvent pVal, out bool BubbleEvent)
        {
            BubbleEvent = true;
            try
            {
                //FACTURACION MASIVA
                #region FACTURACION MASIVA
                if (pVal.FormTypeEx == "191")
                {
                    //creamos el boton para consumir el web service
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.Button oButton1;
                        oItem1 = oForm1.Items.Add("btnFM", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.Button)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "Crear FE";
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height + 7);
                        oItem1.Left = (oItem1.Width + 20) - 40;
                        //ocultar boton PRINT
                        SAPbouiCOM.Button oBtnPrint;
                        oBtnPrint = (SAPbouiCOM.Button)oForm1.Items.Item(0).Specific;
                        oBtnPrint.Item.Visible = false;
                        //ocultar campos de folio
                        EditText oFolio1 = (SAPbouiCOM.EditText)oForm1.Items.Item(5).Specific;
                        oFolio1.Item.Visible = false;
                        EditText oFolio2 = (SAPbouiCOM.EditText)oForm1.Items.Item(7).Specific;
                        oFolio2.Item.Visible = false;
                        StaticText text1 = (SAPbouiCOM.StaticText)oForm1.Items.Item(6).Specific;
                        text1.Item.Visible = false;
                        StaticText text2 = (SAPbouiCOM.StaticText)oForm1.Items.Item(4).Specific;
                        text2.Item.Visible = false;

                        //creamos el boton para imprimir
                        Item oItem2;
                        SAPbouiCOM.Button oButton2;
                        oItem2 = oForm1.Items.Add("btnPrint", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton2 = (SAPbouiCOM.Button)oItem2.Specific;
                        //Agregando propiedades al boton
                        oButton2.Caption = "Print";
                        //agregando posicio del boton
                        oItem2.Top = oForm1.Height - (oItem2.Height + 7);
                        oItem2.Left = (oItem2.Width + 20) + 97;
                    }
                    //consumir evento luego de presionar el boton
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "btnFM" && pVal.BeforeAction == true)
                    {
                        if (false == oCompany.InTransaction)
                        {
                            oCompany.StartTransaction();
                        }
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oItem;

                        SAPbouiCOM.Matrix oMatrix = (SAPbouiCOM.Matrix)oForm.Items.Item("3").Specific;
                        int row = oMatrix.RowCount;
                        int rec = 1;
                        string[] l_error = new string[row];
                        int l = 0;
                        Cursor.Current = Cursors.WaitCursor;
                        SAPbouiCOM.ProgressBar BarraProgreso;
                        BarraProgreso = SBO_Application.StatusBar.CreateProgressBar("Creando documentos masivos", row, true);
                        BarraProgreso.Value = 1;
                        int progreso = 1;
                        while (rec <= row)
                        {
                            BarraProgreso.Text = "Creando documentos masivos";
                            progreso += 1;
                            BarraProgreso.Value = progreso;// BarraProgreso.Value + 1;
                            oItem = (SAPbouiCOM.EditText)oMatrix.Columns.Item("1").Cells.Item(rec).Specific;
                            string codigo = oItem.Value;
                            //para saber si sobrepasa la cantidad de lineas maximas
                            SAPbobsCOM.Recordset oCanLineas;
                            oCanLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oCanLineas.DoQuery("SELECT COUNT(T1.\"DocEntry\") FROM OINV T0 INNER JOIN INV1 T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"DocNum\"='" + codigo + "'");
                            int canLineas = int.Parse(oCanLineas.Fields.Item(0).Value.ToString());
                            if (canLineas > 45)
                            {
                                MessageBox.Show("El documento " + codigo + " excede la cantidad de lineas maximas");
                            }
                            else
                            {
                                //buscamos el establecimeinto y punto de exp correspondiente
                                SAPbobsCOM.Recordset oSeriesDatos;
                                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM OINV T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                                //procedemos a actualizar el documento
                                SAPbobsCOM.Recordset oDocAct;
                                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oDocAct.DoQuery("UPDATE OINV SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                                //consumimos el webservice
                                SAPbobsCOM.Recordset oFactu;
                                oFactu = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oFactu.DoQuery("SELECT \"FolioNum\" FROM OINV WHERE \"DocNum\"='" + codigo + "'");
                                string FolioFact = oFactu.Fields.Item(0).Value.ToString();
                                //if(string.IsNullOrEmpty(FolioFact))
                                if (FolioFact.Equals("0"))
                                {

                                    CrearDocumento(codigo, "OINV", "INV1", "1", "FACTURA", "Factura electrónica");

                                }

                                //controlamos los errores
                                SAPbobsCOM.Recordset oListaError;
                                oListaError = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oListaError.DoQuery("SELECT \"FolioNum\" FROM OINV WHERE \"DocNum\"='" + codigo + "'");
                                string FolioError = oListaError.Fields.Item(0).Value.ToString();

                                if (FolioError.Equals("0"))
                                {
                                    l_error[l] = codigo;
                                    l++;
                                }
                            }

                            rec++;

                        }

                        BarraProgreso.Stop();
                        Cursor.Current = Cursors.Default;
                        if (l > 0)
                        {
                            string errores = string.Join(Environment.NewLine, l_error);
                            MessageBox.Show(errores);
                        }
                        else
                        {
                            l_error[0] = "Facturas creadas con exito";
                            MessageBox.Show(l_error[0].ToString());
                        }

                    }
                    //abrir impresion masiva de facturas
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "btnPrint" && pVal.BeforeAction == true)
                    {
                        //formulario de facturacion masiva
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oItem;
                        SAPbouiCOM.EditText oItem1;
                        SAPbouiCOM.EditText oFilaMaxtrix;
                        SAPbouiCOM.EditText oFilaPU;
                        //agarramos la matrix
                        SAPbouiCOM.Matrix oMatrix = (SAPbouiCOM.Matrix)oForm.Items.Item("3").Specific;
                        int row = oMatrix.RowCount;

                        //actualizamos el estado de los documentos a Impreso
                        int fila = 1;
                        while (fila <= row)
                        {
                            oFilaMaxtrix = (SAPbouiCOM.EditText)oMatrix.Columns.Item("1").Cells.Item(fila).Specific;
                            string FolioAct = oFilaMaxtrix.Value;

                            SAPbobsCOM.Recordset ActEstado;
                            ActEstado = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            ActEstado.DoQuery("UPDATE OINV SET \"Printed\"='Y' WHERE \"DocNum\"='" + FolioAct + "'");
                            fila++;
                        }

                        //agarramos el primer y ultimo folio
                        int filaPU = 1;
                        string auxP = null;
                        string auxU = null;
                        string FolioPU = null;
                        string FolioBusqueda = null;
                        while (filaPU <= row)
                        {
                            oFilaPU = (SAPbouiCOM.EditText)oMatrix.Columns.Item("1").Cells.Item(filaPU).Specific;
                            FolioBusqueda = oFilaPU.Value;
                            SAPbobsCOM.Recordset NumFolio;
                            NumFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            NumFolio.DoQuery("SELECT \"FolioNum\" FROM OINV WHERE \"DocNum\"='" + FolioBusqueda + "'");
                            FolioPU = NumFolio.Fields.Item(0).Value.ToString();

                            if (filaPU == 1)
                            {
                                auxP = FolioPU;
                                auxU = FolioPU;
                            }
                            else
                            {
                                int NumauxP = int.Parse(auxP);
                                int NumauxU = int.Parse(auxU);
                                int Numfolio = int.Parse(FolioPU);

                                if (Numfolio < NumauxP)
                                {
                                    auxP = FolioPU;
                                }
                                if (Numfolio > NumauxU)
                                {
                                    auxU = FolioPU;
                                }
                            }
                            filaPU++;

                        }


                        //agarramos el primer y ultimo documento de la matrix
                        oItem = (SAPbouiCOM.EditText)oMatrix.Columns.Item("1").Cells.Item(1).Specific;
                        FolioIni = oItem.Value;
                        //oItem1 = (SAPbouiCOM.EditText)oMatrix.Columns.Item("1").Cells.Item(row).Specific;
                        //FolioFin = oItem1.Value;
                        //query para consultar los folios
                        SAPbobsCOM.Recordset query;
                        query = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("select T1.\"SeriesName\" from OINV T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" where T0.\"DocNum\"='" + FolioIni + "'");


                        //agarramos el reporte correspondiente
                        SBO_Application.ActivateMenuItem("ca83ab56bb664f5cb8e3306dbb9c0baf");
                        SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
                        //guadamos las variables a mandar
                        string copyInicio = auxP;
                        string copyFin = auxU;
                        string copySerie = query.Fields.Item(0).Value.ToString();
                        //agarramos los campos del formulario del rpeorte
                        SAPbouiCOM.EditText inicio = (SAPbouiCOM.EditText)form.Items.Item("1000003").Specific;
                        SAPbouiCOM.EditText fin = (SAPbouiCOM.EditText)form.Items.Item("1000009").Specific;
                        SAPbouiCOM.EditText serie = (SAPbouiCOM.EditText)form.Items.Item("1000015").Specific;
                        SAPbouiCOM.Button btnok = (SAPbouiCOM.Button)form.Items.Item("1").Specific;
                        //mandamos las variables a los campos del reporte
                        inicio.Value = copyInicio;
                        fin.Value = copyFin;
                        serie.Value = copySerie;
                        //inhabilitamos los campos para que no puedan modificarse
                        inicio.Item.Enabled = false;
                        fin.Item.Enabled = false;
                        //serie.Item.Enabled = false;
                        btnok.Item.Click();

                    }

                }
                #endregion

                //FACTURA
                #region FACTURA
                //bloquear campos UDF
                if (pVal.FormTypeEx == "-133")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        bloquearCampos(oForm);
                        oFormUDF = SBO_Application.Forms.Item(FormUID);

                    }
                }

                if (pVal.FormTypeEx == "133")
                {
                    //creamos el boton para lectura del PDF
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        SAPbouiCOM.Button oButton;
                        oItem = oForm.Items.Add("btnPreview", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton = (SAPbouiCOM.Button)oItem.Specific;
                        //Agregando propiedades al boton
                        oButton.Caption = "PDF";
                        //agregando posicio del boton
                        oItem.Top = oForm.Height - (oItem.Height + 9);
                        oItem.Left = (oItem.Width + 20) + 60;


                    }


                    //en caso de presionar el boton cancelar, seteamos el campo auxiliar del botoncrear
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "2")
                    {
                        botonAdd = "";
                    }
                    //al presionar crear, tomamos el valor del numero de documento y guardamos el ID del boton crear para poder usar para el webserivce
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "1" && pVal.BeforeAction == false && pVal.FormMode != 2)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        Item SNCode;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;

                        SAPbouiCOM.Matrix oMatrix = (SAPbouiCOM.Matrix)oForm.Items.Item("38").Specific;
                        int row = oMatrix.RowCount;
                        if (row > 45)
                        {
                            SBO_Application.SetStatusBarMessage("El detalle no puede superar 45 lineas", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                            return;
                        }

                        //validaciones del socio de negocio
                        string v_direB = null, v_direS = null, v_indus = null, v_natu = null, v_cont = null;
                        SNCode = oForm.Items.Item("4");
                        EditText oSNCode = (SAPbouiCOM.EditText)SNCode.Specific;
                        string v_sncode = oSNCode.Value;
                        //EditText oLici = (SAPbouiCOM.EditText)oForm.Items.Item("").Specific;
                        //string v_licitacion = oLici.Value.ToString();

                        SAPbobsCOM.Recordset query;
                        query = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT T0.\"IndustryC\",T0.\"U_iNatRec\",T0.\"U_iTipCont\",T1.\"Address\",T2.\"Address\" " +
                            "FROM OCRD T0 " +
                            "LEFT JOIN CRD1 T1 ON T1.\"CardCode\"=T0.\"CardCode\" AND T1.\"AdresType\"='B' " +
                            "LEFT JOIN CRD1 T2 ON T2.\"CardCode\"=T0.\"CardCode\" AND T2.\"AdresType\"='S' " +
                            "WHERE T0.\"CardCode\"='" + v_sncode + "'");
                        v_indus = query.Fields.Item(0).Value.ToString();
                        v_natu = query.Fields.Item(1).Value.ToString();
                        v_cont = query.Fields.Item(2).Value.ToString();
                        v_direB = query.Fields.Item(3).Value.ToString();
                        v_direS = query.Fields.Item(4).Value.ToString();
                        //verificamos si no estan vacios
                        if (string.IsNullOrEmpty(v_indus) || v_indus.Equals("0"))
                        {
                            SBO_Application.SetStatusBarMessage("Debe agregar el tipo de operacion al Socio de Negocio", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                            return;
                        }
                        if (string.IsNullOrEmpty(v_natu))
                        {
                            SBO_Application.SetStatusBarMessage("Debe agregar la Naturaleza al Socio de Negocio", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                            return;
                        }
                        if (string.IsNullOrEmpty(v_cont))
                        {
                            SBO_Application.SetStatusBarMessage("Debe agregar el tipo de contribuyente Socio de Negocio", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                            return;
                        }
                        if (string.IsNullOrEmpty(v_direB))
                        {
                            if (string.IsNullOrEmpty(v_direS))
                            {
                                SBO_Application.SetStatusBarMessage("Debe agregar Direccion al Socio de Negocio", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                                return;
                            }
                        }
                        if (v_direB.Equals(v_direS))
                        {
                            SBO_Application.SetStatusBarMessage("Las direcciones son iguales, modificar el Socio de Negocio", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                            return;
                        }
                        //if(v_indus.Equals("3") && string.IsNullOrEmpty(v_licitacion))
                        //{
                        //    MessageBox.Show("Debe agregar el código de licitación");
                        //    return;
                        //}

                        //limpiamos los campos de FE
                        EditText oID = (EditText)oFormUDF.Items.Item("U_ID").Specific;
                        EditText oCDC = (EditText)oFormUDF.Items.Item("U_CDC").Specific;
                        EditText oESTADO = (EditText)oFormUDF.Items.Item("U_ESTADO").Specific;
                        EditText oKUDE = (EditText)oFormUDF.Items.Item("U_KUDE").Specific;
                        EditText oXML = (EditText)oFormUDF.Items.Item("U_XMLFIRMADO").Specific;
                        EditText oMSJERROR = (EditText)oFormUDF.Items.Item("U_MensajeError").Specific;
                        EditText oFECHAT = (EditText)oFormUDF.Items.Item("U_FechaT").Specific;
                        EditText oQR = (EditText)oFormUDF.Items.Item("U_CODIGOQR").Specific;
                        EditText oREMISION = (EditText)oFormUDF.Items.Item("U_InfoAdicional").Specific;

                        oID.Item.Enabled = true;
                        oCDC.Item.Enabled = true;
                        oESTADO.Item.Enabled = true;
                        oKUDE.Item.Enabled = true;
                        oXML.Item.Enabled = true;
                        oMSJERROR.Item.Enabled = true;
                        oFECHAT.Item.Enabled = true;
                        oQR.Item.Enabled = true;

                        oID.Value = "";
                        oCDC.Value = "";
                        oESTADO.Value = "";
                        oKUDE.Value = "";
                        oXML.Value = "";
                        oMSJERROR.Value = "";
                        oFECHAT.Value = "";
                        oQR.Value = "";

                        oID.Item.Enabled = false;
                        oCDC.Item.Enabled = false;
                        oESTADO.Item.Enabled = false;
                        oKUDE.Item.Enabled = false;
                        oXML.Item.Enabled = false;
                        oMSJERROR.Item.Enabled = false;
                        oFECHAT.Item.Enabled = false;
                        oQR.Item.Enabled = false;

                        //buscamos el numero de remision
                        Recordset oRemi;
                        oRemi = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oRemi.DoQuery("SELECT T0.\"U_ESTA\"||'-'||T0.\"U_PEMI\"||'-'||RIGHT('0000000'||CAST(T0.\"FolioNum\" AS CHAR),7) " +
                                      "FROM ODLN T0 " +
                                      "LEFT JOIN INV1 T1 ON T1.\"BaseRef\"=t0.\"DocNum\" " +
                                      "LEFT JOIN OINV T2 ON T2.\"DocEntry\"=T1.\"DocEntry\" " +
                                      "WHERE T2.\"DocNum\"='" + codigo + "'");
                        v_AdicionalInfo = oRemi.Fields.Item(0).Value.ToString();
                    }
                    //una vez terminado el proceso de creacion de la factura, consultamos el docentry de la factura creada y consumimos el web service
                    if (pVal.BeforeAction == false && pVal.ActionSuccess == true && pVal.ItemUID == "1" && pVal.FormTypeEx == "133" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //string codigo = oText.Value;
                        string tablacab = "OINV";
                        string tabladet = "INV1";

                        //control para saber si es o no documento de cancelación
                        SAPbobsCOM.Recordset oCancel;
                        oCancel = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oCancel.DoQuery("SELECT \"CANCELED\",\"Series\" FROM OINV WHERE \"DocNum\"='" + codigo + "' ");
                        string v_cancel = oCancel.Fields.Item(0).Value.ToString();
                        string v_series = oCancel.Fields.Item(1).Value.ToString();
                        //consultamos si es documento de cancelacion
                        if (v_cancel.Equals("N"))
                        {
                            CrearDocumento(codigo, tablacab, tabladet, "1", "FACTURA", "Factura electrónica");
                        }
                        //SBO_Application.StatusBar.SetText("Factura generada con exito ", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                        //botonAdd = "";
                    }
                    //evento cuando se presiona el boton de preview documento
                    if (pVal.ItemUID == "btnPreview" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        //CrearDocumento("101554", "OINV", "INV1", "1", "FACTURA", "Factura electrónica");
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //para obtener el docnum
                        Item oDocNum;
                        EditText oDoc;
                        oDocNum = oForm.Items.Item("8");
                        oDoc = (SAPbouiCOM.EditText)oDocNum.Specific;
                        string v_docnum = oDoc.Value;
                        //para obtener el folio
                        Item oFolio;
                        EditText oFol;
                        oFolio = oForm.Items.Item("211");
                        oFol = (SAPbouiCOM.EditText)oFolio.Specific;
                        string v_folio = oFol.Value;
                        //obtener descipcion del boton
                        Item oBtnitem;
                        SAPbouiCOM.Button btnPrev;
                        oBtnitem = oForm.Items.Item("btnPreview");
                        btnPrev = (SAPbouiCOM.Button)oBtnitem.Specific;
                        string v_Btn = btnPrev.Caption.ToString();

                        if (v_Btn.Equals("PDF"))
                        {
                            try
                            {
                                //tomamos el valor del form y del item
                                //SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                                Item oItem;
                                oItem = oForm.Items.Item("8");
                                oText = (SAPbouiCOM.EditText)oItem.Specific;
                                codigo = oText.Value;
                                string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                                try
                                {
                                    SAPbobsCOM.Recordset query;
                                    query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                    query.DoQuery("SELECT \"U_KUDE\" FROM OINV WHERE \"DocNum\"=" + codigo);

                                    string KUDE = query.Fields.Item(0).Value.ToString();
                                    byte[] bytes = Convert.FromBase64String(KUDE);
                                    //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                                    File.Delete(Path.Combine(path + "\\temporal.pdf"));
                                    FileStream obj = File.Create(path + "\\temporal.pdf");
                                    obj.Write(bytes, 0, bytes.Length);
                                    obj.Flush();
                                    obj.Close();
                                    System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                                    //File.Delete(Path.Combine(path + "\\temporal.pdf"));

                                }
                                catch (Exception e)
                                {

                                }
                            }
                            catch (Exception e)
                            {
                                MessageBox.Show(e.ToString());
                            }
                        }
                        else
                        {
                            ReenviarDocumento(v_docnum, "OINV", "INV1", "1", "FACTURA", "Factura electrónica", v_folio);
                        }


                    }
                    //cambiar de nombre el boton PDF a REENVIAR
                    if (pVal.FormMode == 1 && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.ItemUID == "57")
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPreview").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM OINV WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O") && (v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO") || v_estadoSet.Equals("")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }

                    }
                    //cambiar el boton buscando un documento
                    if (pVal.FormMode == 0 && pVal.BeforeAction == true && pVal.ItemUID == "1" && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPreview").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM OINV WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O") && (v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO") || v_estadoSet.Equals("")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }
                    }

                }
                #endregion

                //NOTA DE DEBITO
                #region NOTA DE DEBITO
                //bloquear campos UDF
                if (pVal.FormTypeEx == "-65303")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        bloquearCampos(oForm);

                    }
                }

                if (pVal.FormTypeEx == "65303")
                {
                    //creamos el boton para consumir el web service
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.Button oButton1;
                        oItem1 = oForm1.Items.Add("btnPDFND", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.Button)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "PDF";
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height + 9);
                        oItem1.Left = (oItem1.Width + 20) + 60;
                    }

                    //agarramos el DocNum del documento
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "1" && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;
                    }

                    //consumir web service despues de crear el documento
                    if (pVal.BeforeAction == false && pVal.ActionSuccess == true && pVal.ItemUID == "1" && pVal.FormTypeEx == "65303" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3)
                    {
                        //CrearDocumento(codigo, "OINV", "INV1", "6", "NOTA_DEBITO", "Nota de débito electrónica");
                        CrearNotaDebito(codigo);
                    }

                    //evento cuando se presiona el boton de preview documento
                    if (pVal.ItemUID == "btnPDFND" && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //para obtener el docnum
                        Item oDocNum;
                        EditText oDoc;
                        oDocNum = oForm.Items.Item("8");
                        oDoc = (SAPbouiCOM.EditText)oDocNum.Specific;
                        string v_docnum = oDoc.Value;
                        //para obtener el folio
                        Item oFolio;
                        EditText oFol;
                        oFolio = oForm.Items.Item("211");
                        oFol = (SAPbouiCOM.EditText)oFolio.Specific;
                        string v_folio = oFol.Value;
                        //obtener descipcion del boton
                        Item oBtnitem;
                        SAPbouiCOM.Button btnPrev;
                        oBtnitem = oForm.Items.Item("btnPreview");
                        btnPrev = (SAPbouiCOM.Button)oBtnitem.Specific;
                        string v_Btn = btnPrev.Caption.ToString();

                        if (v_Btn.Equals("PDF"))
                        {
                            //tomamos el valor del form y del item
                            //SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                            Item oItem;
                            oItem = oForm.Items.Item("8");
                            oText = (SAPbouiCOM.EditText)oItem.Specific;
                            codigo = oText.Value;
                            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            try
                            {
                                SAPbobsCOM.Recordset query;
                                query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                query.DoQuery("SELECT \"U_KUDE\" FROM OINV WHERE \"DocNum\"=" + codigo);

                                string KUDE = query.Fields.Item(0).Value.ToString();
                                byte[] bytes = Convert.FromBase64String(KUDE);
                                //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                                File.Delete(Path.Combine(path + "\\temporal.pdf"));
                                FileStream obj = File.Create(path + "\\temporal.pdf");
                                obj.Write(bytes, 0, bytes.Length);
                                obj.Flush();
                                obj.Close();
                                System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                                //File.Delete(Path.Combine(path + "\\temporal.pdf"));
                            }
                            catch
                            {

                            }
                        }
                        else
                        {

                        }


                    }
                    //cambiar de nombre el boton PDF a REENVIAR
                    if (pVal.FormMode == 1 && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.ItemUID == "57")
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPreview").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM ORIN WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O") && (v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }

                    }
                    //cambiar el boton buscando un documento
                    if (pVal.FormMode == 0 && pVal.BeforeAction == true && pVal.ItemUID == "1" && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPreview").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM ORIN WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O") && (v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }
                    }
                }
                #endregion

                //FORM ANULAR
                #region ANULAR
                if (pVal.FormTypeEx == "UDO_FT_ANULAR")
                {
                    //cargar los combobox del form
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadAnular(oForm);
                    }
                    //agarrar los datos seleccionados del form
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true && pVal.ItemUID == "Item_0")
                    {
                        Cursor.Current = Cursors.WaitCursor;
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item fact1;
                        Item fact2;
                        Item fact3;
                        Item motivo;
                        SAPbouiCOM.ComboBox cboDocu;
                        SAPbouiCOM.ComboBox cboMoti;
                        fact1 = oForm.Items.Item("0_U_E");
                        fact2 = oForm.Items.Item("Item_3");
                        fact3 = oForm.Items.Item("Item_4");
                        motivo = oForm.Items.Item("1_U_E");
                        //cboDocu = (SAPbouiCOM.ComboBox)oForm.Items.Item("cboDocu").Specific;
                        cboDocu = (SAPbouiCOM.ComboBox)oForm.Items.Item("cboDocu").Specific;
                        string valorDocu = cboDocu.Selected.Value.ToString();
                        string tabla = null;
                        if (valorDocu.Equals("1"))
                        {
                            tabla = "OINV";
                        }
                        if (valorDocu.Equals("2"))
                        {
                            tabla = "ORIN";
                        }
                        if (valorDocu.Equals("3"))
                        {
                            tabla = "OINV";
                        }
                        if (valorDocu.Equals("4"))
                        {
                            tabla = "ODLN";
                        }
                        if (valorDocu.Equals("5"))
                        {
                            tabla = "OWTR";
                        }
                        if (valorDocu.Equals("6"))
                        {
                            tabla = "OINV";
                        }
                        if (valorDocu.Equals("7"))
                        {
                            tabla = "\"@REMI_CAB\"";
                        }
                        cboMoti = (SAPbouiCOM.ComboBox)oForm.Items.Item("cboMoti").Specific;
                        string v_moti = cboMoti.Selected.Description.ToString();
                        EditText f1 = (SAPbouiCOM.EditText)fact1.Specific;
                        EditText f2 = (SAPbouiCOM.EditText)fact2.Specific;
                        EditText f3 = (SAPbouiCOM.EditText)fact3.Specific;
                        EditText moti = (SAPbouiCOM.EditText)motivo.Specific;
                        string esta = f1.Value;
                        string punt = f2.Value;
                        string folio = f3.Value;
                        //verificamos si el documento no esta cerrado
                        string SubType = null;
                        if (valorDocu.Equals("3"))
                        {
                            SubType = " AND \"DocSubType\"='DN' ";
                        }
                        if (valorDocu.Equals("6"))
                        {
                            SubType = " AND \"DocSubType\"='IX' ";
                        }
                        else
                        {
                            SubType = " ";
                        }
                        //timbrado
                        string tim = null;
                        if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                        {
                            tim = "16094946";
                        }
                        else
                        {
                            tim = "16148774";

                        }

                        //consultamos si el documento esta rechazado, sino no ejecutar el proceso
                        SAPbobsCOM.Recordset oConsulta;
                        oConsulta = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        if (valorDocu.Equals("7"))
                        {
                            oConsulta.DoQuery("SELECT \"U_ESTADO\" FROM \"@REMI_CAB\" WHERE \"U_PEMI\"='" + punt + "' AND \"U_ESTA\"='" + esta + "' AND \"U_FolioNum\"='" + folio + "' ");
                        }
                        else
                        {
                            oConsulta.DoQuery("SELECT \"U_ESTADO\" FROM " + tabla + " WHERE \"U_PEMI\"='" + punt + "' AND \"U_ESTA\"='" + esta + "' AND \"FolioNum\"='" + folio + "' ");
                        }
                        string v_estadoDoc = oConsulta.Fields.Item(0).Value.ToString();
                        if (v_estadoDoc.Equals("RECHAZADO"))
                        {
                            SBO_Application.SetStatusBarMessage("No se puede anular un documento RECHAZADO!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                            return;
                        }
                        else
                        {
                            Recordset DocCerrado;
                            DocCerrado = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            if (valorDocu.Equals("7"))
                            {
                                DocCerrado.DoQuery("SELECT \"U_DosStatus\",\"U_DocDate\" FROM " + tabla + " WHERE \"U_ESTA\"='" + esta + "' AND \"U_PEMI\"='" + punt + "' AND \"U_FolioNum\"='" + folio + "' AND \"U_TIMB\"='" + tim + "' " + SubType);
                            }
                            else
                            {
                                DocCerrado.DoQuery("SELECT \"DocStatus\",\"DocDate\" FROM " + tabla + " WHERE \"U_ESTA\"='" + esta + "' AND \"U_PEMI\"='" + punt + "' AND \"FolioNum\"='" + folio + "' AND \"U_TIMB\"='" + tim + "' " + SubType);
                            }

                            string estadoDoc = DocCerrado.Fields.Item(0).Value.ToString();
                            string fechaDoc = DocCerrado.Fields.Item(1).Value.ToString();
                            //if (estadoDoc.Equals("C") && !tabla.Equals("ORIN"))
                            //{
                            //    SBO_Application.StatusBar.SetText("Documento se encuentra cerrado, no se puede anular!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                            //    return;
                            //}
                            //restamos la fecha con la fecha actual
                            TimeSpan resta = DateTime.Now - DateTime.Parse(fechaDoc);
                            int dias = resta.Days;
                            //if (dias > 2)
                            //{
                            //    SBO_Application.StatusBar.SetText("Documento ya exedió el limite de 48hs permitidos para anular!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                            //    return;
                            //}
                            Cursor.Current = Cursors.WaitCursor;
                            AnularDocumento(esta, punt, folio, v_moti, tabla, SubType);
                            Cursor.Current = Cursors.Default;
                            f1.Value = "";
                            f2.Value = "";
                            f3.Value = "";
                            Cursor.Current = Cursors.Default;
                        }


                    }
                }
                #endregion

                //FORM CANCELAR               
                #region CANCELAR
                if (pVal.FormTypeEx == "UDO_FT_CANCELAR")
                {
                    //cargamos el combobox
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadCancelar(oForm);
                    }
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true && pVal.ItemUID == "btnCan")
                    {


                        Cursor.Current = Cursors.WaitCursor;
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item Docu;
                        Item tipo;
                        SAPbouiCOM.ComboBox cboTipo;
                        Docu = oForm.Items.Item("0_U_E");
                        //cboDocu = (SAPbouiCOM.ComboBox)oForm.Items.Item("cboDocu").Specific;
                        cboTipo = (SAPbouiCOM.ComboBox)oForm.Items.Item("cboTipo").Specific;
                        string valorDocu = cboTipo.Selected.Value.ToString();
                        string tabla = null;
                        string subtype = null;
                        if (valorDocu.Equals("1"))
                        {
                            tabla = "OINV";
                        }
                        if (valorDocu.Equals("2"))
                        {
                            tabla = "ORIN";
                        }
                        if (valorDocu.Equals("3"))
                        {
                            tabla = "OINV";
                            subtype = " AND \"DocSubType\"='DN' ";
                        }
                        if (valorDocu.Equals("4"))
                        {
                            tabla = "ODLN";
                        }
                        if (valorDocu.Equals("5"))
                        {
                            tabla = "OWTR";
                        }
                        if (valorDocu.Equals("6"))
                        {
                            tabla = "OINV";
                            subtype = " AND \"DocSubType\"='IX' ";
                        }
                        EditText v_docu = (SAPbouiCOM.EditText)Docu.Specific;
                        string docu_v = v_docu.Value;

                        //verificamos si el documento no esta cerrado
                        Recordset DocCerrado;
                        DocCerrado = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        DocCerrado.DoQuery("SELECT \"DocStatus\",\"DocEntry\" FROM " + tabla + " WHERE \"DocNum\"='" + docu_v + "' AND \"U_TIMB\"='16148774' " + subtype);
                        string estadoDoc = DocCerrado.Fields.Item(0).Value.ToString();
                        string v_entry = DocCerrado.Fields.Item(1).Value.ToString();
                        if (estadoDoc.Equals("C") && !tabla.Equals("ORIN"))
                        {
                            SBO_Application.StatusBar.SetText("Documento se encuentra cerrado, no se puede Cancelar!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                            return;
                        }
                        if (string.IsNullOrEmpty(estadoDoc))
                        {
                            SBO_Application.StatusBar.SetText("No existe documento!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                            return;
                        }

                        string B_Code = null;
                        if (tabla.Equals("OINV"))
                        {
                            //instanciamos el objeto
                            SAPbobsCOM.Documents documento;
                            SAPbobsCOM.Documents docCancel;
                            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                            if (documento.GetByKey(int.Parse(v_entry)))
                            {
                                B_Code = documento.UserFields.Fields.Item("U_RT").Value.ToString();
                                docCancel = documento.CreateCancellationDocument();
                                int cancelado = docCancel.Add();
                                string error = oCompany.GetLastErrorDescription().ToString();
                                if (cancelado == 0)
                                {
                                    //cancelar RT
                                    SAPbobsCOM.UserTable oUserT;
                                    oUserT = oCompany.UserTables.Item("REMI_CAB");
                                    if (oUserT.GetByKey(B_Code))
                                    {
                                        SAPbobsCOM.Recordset cancelUDO;
                                        cancelUDO = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                        cancelUDO.DoQuery("UPDATE \"@REMI_CAB\" SET \"Canceled\"='Y',\"U_ESTADO\"='CANCELADO' WHERE \"Code\"='" + B_Code + "'");
                                    }
                                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                                }
                                else
                                {
                                    SBO_Application.StatusBar.SetText(oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                }
                            }

                        }
                        if (tabla.Equals("ORIN"))
                        {
                            //instanciamos el objeto
                            SAPbobsCOM.Documents documento;
                            SAPbobsCOM.Documents docCancel;
                            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
                            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
                            if (documento.GetByKey(int.Parse(v_entry)))
                            {
                                docCancel = documento.CreateCancellationDocument();
                                int cancelado = docCancel.Add();
                                if (cancelado == 0)
                                {
                                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                                }
                                else
                                {
                                    SBO_Application.StatusBar.SetText(oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                }
                            }
                        }
                        if (tabla.Equals("OINV"))
                        {
                            //instanciamos el objeto
                            SAPbobsCOM.Documents documento;
                            SAPbobsCOM.Documents docCancel;
                            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                            if (documento.GetByKey(int.Parse(v_entry)))
                            {
                                docCancel = documento.CreateCancellationDocument();
                                int cancelado = docCancel.Add();
                                if (cancelado == 0)
                                {
                                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                                }
                                else
                                {
                                    SBO_Application.StatusBar.SetText(oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                }
                            }
                        }
                        if (tabla.Equals("ODLN"))
                        {
                            //instanciamos el objeto

                            SAPbobsCOM.Documents documento;
                            SAPbobsCOM.Documents docCancel;
                            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
                            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
                            if (documento.GetByKey(int.Parse(v_entry)))
                            {
                                B_Code = documento.UserFields.Fields.Item("U_RT").Value.ToString();
                                docCancel = documento.CreateCancellationDocument();
                                int cancelado = docCancel.Add();
                                if (cancelado == 0)
                                {
                                    //cancelar RT
                                    SAPbobsCOM.UserTable oUserT;
                                    oUserT = oCompany.UserTables.Item("REMI_CAB");
                                    if (oUserT.GetByKey(B_Code))
                                    {
                                        SAPbobsCOM.Recordset cancelUDO;
                                        cancelUDO = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                        cancelUDO.DoQuery("UPDATE \"@REMI_CAB\" SET \"Canceled\"='Y',\"U_ESTADO\"='CANCELADO' WHERE \"Code\"='" + B_Code + "'");
                                    }

                                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                                }
                                else
                                {
                                    SBO_Application.StatusBar.SetText(oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                }
                            }

                        }
                        if (tabla.Equals("OWTR"))
                        {
                            //instanciamos el objeto
                            SAPbobsCOM.StockTransfer documento;
                            documento = (SAPbobsCOM.StockTransfer)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);
                            if (documento.GetByKey(int.Parse(v_entry)))
                            {
                                int cancelado = documento.Cancel();
                                if (cancelado == 0)
                                {
                                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                                }
                                else
                                {
                                    SBO_Application.StatusBar.SetText(oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                }
                            }
                        }
                        v_docu.Value = "";
                        Cursor.Current = Cursors.Default;
                    }
                }
                #endregion

                //REMISION ENTREGA
                #region REMISION ENTREGA
                //bloquear campos UDF
                if (pVal.FormTypeEx == "-140")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        oFormUDF = SBO_Application.Forms.Item(FormUID);
                        bloquearCampos(oForm);

                    }

                }
                if (pVal.FormTypeEx == "140")
                {
                    //creamos el boton para consumir el web service
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        //BOTON GENERAR REMISION
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.Button oButton1;
                        oItem1 = oForm1.Items.Add("btnRemi", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.Button)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "Remision/PDF";
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height + 9);
                        oItem1.Left = (oItem1.Width + 20) + 130;

                        //BOTON DE REENVIO
                        Item oItem2;
                        SAPbouiCOM.Button oButton2;
                        oItem2 = oForm1.Items.Add("btnRee", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton2 = (SAPbouiCOM.Button)oItem2.Specific;
                        //Agregando propiedades al boton
                        oButton2.Caption = "Reenvio";
                        //agregando posicio del boton
                        oItem2.Top = oForm1.Height - (oItem2.Height + 9);
                        oItem2.Left = (oItem2.Width + 20) + 60;
                    }

                    //evento para reenviar remision
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "btnRee" && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        EditText oFolio = (SAPbouiCOM.EditText)oForm.Items.Item("211").Specific;
                        EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("8").Specific;
                        EditText oEstado = (SAPbouiCOM.EditText)oFormUDF.Items.Item("U_ESTADO").Specific;
                        string v_folio = oFolio.Value;
                        string v_docNum = oDocNum.Value;
                        string v_estado = oEstado.Value;
                        if (!string.IsNullOrEmpty(v_folio) && v_estado.Equals("RECHAZADO"))
                        {
                            ReenvioNotaRemision(v_docNum, "ODLN", "DLN1", v_folio);
                            //buscamos el documento creado
                            oForm.Mode = BoFormMode.fm_FIND_MODE;
                            SAPbouiCOM.Button oButton = (SAPbouiCOM.Button)oForm.Items.Item("1").Specific;
                            SAPbouiCOM.Button oPDF = (SAPbouiCOM.Button)oForm.Items.Item("btnRemi").Specific;
                            oDocNum.Value = v_docNum;
                            oButton.Item.Click();
                        }
                        else
                        {
                            MessageBox.Show("No se puede reenviar", "ATENCION", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return;
                        }
                    }


                    //disparar evento para consultar el servicio para remision
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "btnRemi" && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        Item oFolio;
                        Item oItemTras, oItemChof, oItemChapa;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;

                        oFolio = oForm.Items.Item("211");
                        EditText oNumFolio = (SAPbouiCOM.EditText)oFolio.Specific;
                        string v_folio = oNumFolio.Value;
                        //SAPbouiCOM.EditText oRT = (SAPbouiCOM.EditText)oForm.Items.Item("U_RT").Specific;
                        //NotaRemision(codigo, "ODLN", "DLN1");
                        if (string.IsNullOrEmpty(v_folio) || v_folio.Equals("0"))
                        {
                            NotaRemision(codigo, "ODLN", "DLN1");
                            //buscamos el documento creado
                            oForm.Mode = BoFormMode.fm_FIND_MODE;
                            EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("8").Specific;
                            SAPbouiCOM.Button oButton = (SAPbouiCOM.Button)oForm.Items.Item("1").Specific;
                            SAPbouiCOM.Button oPDF = (SAPbouiCOM.Button)oForm.Items.Item("btnRemi").Specific;
                            oDocNum.Value = codigo;
                            oButton.Item.Click();
                            EditText oFolioNum = (SAPbouiCOM.EditText)oForm.Items.Item("211").Specific;
                            string v_folioNum = oFolioNum.Value;
                            if (!string.IsNullOrEmpty(v_folioNum) && !v_folioNum.Equals("0"))
                            {
                                oPDF.Item.Click();
                            }

                        }
                        else
                        {
                            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            try
                            {
                                SAPbobsCOM.Recordset query;
                                query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                query.DoQuery("SELECT \"U_KUDE\" FROM ODLN WHERE \"DocNum\"=" + codigo);

                                string KUDE = query.Fields.Item(0).Value.ToString();
                                byte[] bytes = Convert.FromBase64String(KUDE);
                                //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                                File.Delete(Path.Combine(path + "\\temporal.pdf"));
                                FileStream obj = File.Create(path + "\\temporal.pdf");
                                obj.Write(bytes, 0, bytes.Length);
                                obj.Flush();
                                obj.Close();
                                System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                                //File.Delete(Path.Combine(path + "\\temporal.pdf"));

                            }
                            catch (Exception e)
                            {

                            }
                        }


                    }

                    if (pVal.BeforeAction == true && pVal.ItemUID == "1" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED)
                    {
                        SAPbouiCOM.Form oFormEnt = SBO_Application.Forms.Item(FormUID);
                        EditText oEntNum = (EditText)oFormEnt.Items.Item("8").Specific;
                        p_EntNum = oEntNum.Value;
                        EditText oEntOrd = (EditText)oFormUDF.Items.Item("U_RT").Specific;
                        p_RT = oEntOrd.Value;
                        SAPbouiCOM.EditText oRTa = (SAPbouiCOM.EditText)oFormUDF.Items.Item("U_RTa").Specific;
                        v_RTa = oRTa.Value;
                    }
                    //ponemos en mapa re relaciones la orden con la entrega
                    if (pVal.BeforeAction == false && pVal.ActionSuccess == true && pVal.ItemUID == "1" && pVal.FormTypeEx == "140" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3)
                    {
                        SAPbouiCOM.Form oFormEnt = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button oBtnR = (SAPbouiCOM.Button)oFormEnt.Items.Item("btnRemi").Specific;


                        if (!string.IsNullOrEmpty(p_RT))
                        {
                            //realcionamos la orden a la entrega
                            //buscamos el docentry del documento
                            //REMISION TEMPORAL
                            SAPbobsCOM.Recordset oRT;
                            oRT = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oRT.DoQuery("SELECT \"U_FolioPref\",\"U_FolioNum\",\"U_Order\",\"U_DocTotal\",\"U_ESTA\",\"U_PEMI\",\"U_TIMB\",\"U_KUDE\",\"U_XMLFIRMADO\" FROM \"@REMI_CAB\" WHERE \"Code\"='" + p_RT + "'");
                            string v_pref = oRT.Fields.Item(0).Value.ToString();
                            int v_folioEnt = int.Parse(oRT.Fields.Item(1).Value.ToString());
                            string v_order = oRT.Fields.Item(2).Value.ToString();
                            string v_totalRT = oRT.Fields.Item(3).Value.ToString();
                            string v_ESTA = oRT.Fields.Item(4).Value.ToString();
                            string v_PEMI = oRT.Fields.Item(5).Value.ToString();
                            string v_TIMB = oRT.Fields.Item(6).Value.ToString();
                            string v_KUDE = oRT.Fields.Item(7).Value.ToString();
                            string V_XML = oRT.Fields.Item(8).Value.ToString();

                            SAPbobsCOM.Recordset oRTDet;
                            oRTDet = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oRTDet.DoQuery("SELECT COUNT(*) FROM \"@REMI_DET\" WHERE \"Code\"='" + p_RT + "'");
                            int v_cant = int.Parse(oRTDet.Fields.Item(0).Value.ToString());


                            //ORDEN DE VENTA
                            SAPbobsCOM.Recordset oEntry;
                            oEntry = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oEntry.DoQuery("SELECT \"DocEntry\", CASE WHEN \"DocCur\"='PYG' THEN IFNULL(\"DocTotal\",0) ELSE IFNULL(\"DocTotalFC\",0) END FROM ORDR WHERE \"DocNum\"='" + v_order + "'");
                            int v_DocEntryOV = int.Parse(oEntry.Fields.Item(0).Value.ToString());
                            string v_DocTotalOV = oEntry.Fields.Item(1).Value.ToString();


                            SAPbobsCOM.Recordset oEntryEnt;
                            oEntryEnt = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oEntryEnt.DoQuery("SELECT \"DocEntry\" FROM ODLN WHERE \"DocNum\"='" + p_EntNum + "'");
                            int v_EntDE = int.Parse(oEntryEnt.Fields.Item(0).Value.ToString());

                            //actualizamos el folio de la entrega
                            SAPbobsCOM.Recordset oActFolio;
                            oActFolio = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oActFolio.DoQuery("UPDATE ODLN SET \"FolioNum\"='" + v_folioEnt + "',\"FolioPref\"='" + v_pref + "',\"U_ESTA\"='" + v_ESTA + "',\"U_PEMI\"='" + v_PEMI + "',\"U_TIMB\"='" + v_TIMB + "',\"U_KUDE\"='" + v_KUDE + "',\"U_XMLFIRMADO\"='" + V_XML + "' WHERE \"DocEntry\"='" + v_EntDE + "' ");

                            //si es de una orden a una entrega
                            if (v_RTa.Equals("ENTREGA"))
                            {
                                //grabamos el mapa de relaciones
                                SAPbobsCOM.Recordset oUpEnt;
                                oUpEnt = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oUpEnt.DoQuery("UPDATE DLN1 SET \"BaseEntry\"='" + v_DocEntryOV + "',\"BaseType\"='17',\"BaseRef\"='" + v_order + "' WHERE \"DocEntry\"='" + v_EntDE + "' ");

                                //verificamos si hay que cerrar la ordern de venta
                                SAPbobsCOM.Recordset oMontos;
                                oMontos = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oMontos.DoQuery("SELECT SUM(\"Total\") FROM ( " +
                                                "SELECT CASE WHEN T1.\"DocCur\"='PYG' THEN IFNULL(T1.\"DocTotal\",0) ELSE IFNULL(T1.\"DocTotalFC\",0) END AS \"Total\" " +
                                                "FROM DLN1 T0 " +
                                                "INNER JOIN ODLN T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                                "WHERE T0.\"BaseRef\"='" + v_order + "' " +
                                                "GROUP BY T1.\"DocCur\",T1.\"DocTotal\",T1.\"DocTotalFC\") ");
                                string v_montoET = oMontos.Fields.Item(0).Value.ToString();
                                decimal v_monto = decimal.Parse(v_montoET);
                                decimal v_montoOV = decimal.Parse(v_DocTotalOV);
                                if (v_montoOV == v_monto)
                                {
                                    SAPbobsCOM.Recordset oOV;
                                    oOV = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                    oOV.DoQuery("UPDATE ORDR SET \"DocStatus\"='C' WHERE \"DocEntry\"='" + v_DocEntryOV + "'");
                                }
                            }


                        }
                        //buscamos el documento creado
                        oFormEnt.Mode = BoFormMode.fm_FIND_MODE;
                        EditText oDocNum = (SAPbouiCOM.EditText)oFormEnt.Items.Item("8").Specific;
                        SAPbouiCOM.Button oButton = (SAPbouiCOM.Button)oFormEnt.Items.Item("1").Specific;

                        oDocNum.Value = p_EntNum;
                        oButton.Item.Click();
                        //oBtnR.Item.Click();


                    }


                }
                #endregion

                //REMISION TRASLADO
                #region REMISION TRASLADO
                //bloquear campos UDF
                if (pVal.FormTypeEx == "-940")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        bloquearCampos(oForm);

                    }
                }
                if (pVal.FormTypeEx == "940")
                {
                    //creamos el boton para consumir el web service
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.Button oButton1;
                        oItem1 = oForm1.Items.Add("btnRemi", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.Button)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "Remision/PDF";
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height + 8);
                        oItem1.Left = (oItem1.Width + 20) + 130;

                        //BOTON PDF
                        //SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //Item oItem2;
                        //SAPbouiCOM.Button oButton;
                        //oItem2 = oForm.Items.Add("btnPDFRemi", BoFormItemTypes.it_BUTTON);
                        ////Inicializando el objeto boton con la referencia del objeto item
                        //oButton = (SAPbouiCOM.Button)oItem2.Specific;
                        ////Agregando propiedades al boton
                        //oButton.Caption = "PDF";
                        ////agregando posicio del boton
                        //oItem2.Top = oForm.Height - (oItem2.Height + 8);
                        //oItem2.Left = (oItem2.Width + 20) + 200;
                    }
                    //disparar evento para consultar el servicio para remision
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "btnRemi" && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        Item oFolio;

                        oFolio = oForm.Items.Item("10000056");
                        EditText oNumFolio = (SAPbouiCOM.EditText)oFolio.Specific;
                        string v_folio = oNumFolio.Value;

                        oItem = oForm.Items.Item("11");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;

                        if (string.IsNullOrEmpty(v_folio) || v_folio.Equals("0"))
                        {
                            NotaRemision(codigo, "OWTR", "WTR1");
                        }
                        else
                        {
                            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            try
                            {
                                SAPbobsCOM.Recordset query;
                                query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                query.DoQuery("SELECT \"U_KUDE\" FROM OWTR WHERE \"DocNum\"=" + codigo);

                                string KUDE = query.Fields.Item(0).Value.ToString();
                                byte[] bytes = Convert.FromBase64String(KUDE);
                                //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                                File.Delete(Path.Combine(path + "\\temporal.pdf"));
                                FileStream obj = File.Create(path + "\\temporal.pdf");
                                obj.Write(bytes, 0, bytes.Length);
                                obj.Flush();
                                obj.Close();
                                System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                                //File.Delete(Path.Combine(path + "\\temporal.pdf"));

                            }
                            catch (Exception e)
                            {

                            }
                        }



                    }
                    //vizualuzar PDF
                    //if (pVal.ItemUID == "btnPDFRemi" && pVal.BeforeAction == true)
                    //{

                    //    //tomamos el valor del form y del item
                    //    SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                    //    Item oItem;
                    //    oItem = oForm.Items.Item("11");
                    //    oText = (SAPbouiCOM.EditText)oItem.Specific;
                    //    codigo = oText.Value;
                    //    string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                    //    try
                    //    {
                    //        SAPbobsCOM.Recordset query;
                    //        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //        query.DoQuery("SELECT \"U_KUDE\" FROM OWTR WHERE \"DocNum\"=" + codigo);

                    //        string KUDE = query.Fields.Item(0).Value.ToString();
                    //        byte[] bytes = Convert.FromBase64String(KUDE);
                    //        //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                    //        File.Delete(Path.Combine(path + "\\temporal.pdf"));
                    //        FileStream obj = File.Create(path + "\\temporal.pdf");
                    //        obj.Write(bytes, 0, bytes.Length);
                    //        obj.Flush();
                    //        obj.Close();
                    //        System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                    //        //File.Delete(Path.Combine(path + "\\temporal.pdf"));

                    //    }
                    //    catch (Exception e)
                    //    {

                    //    }

                    //}
                }
                #endregion

                //NOTA DE CREDITO
                #region NOTA DE CREDITO
                //bloquear campos UDF
                if (pVal.FormTypeEx == "-179")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        bloquearCampos(oForm);

                    }
                }
                if (pVal.FormTypeEx == "179")
                {

                    //creamos el boton para consumir el web service
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.Button oButton1;
                        oItem1 = oForm1.Items.Add("btnPDFNC", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.Button)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "PDF";
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height + 9);
                        oItem1.Left = (oItem1.Width + 20) + 60;
                    }
                    //al presionar crear, tomamos el valor del numero de documento y guardamos el ID del boton crear para poder usar para el webserivce
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "1" && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;
                        //botonAdd = "1";

                    }
                    if (pVal.BeforeAction == false && pVal.ActionSuccess == true && pVal.ItemUID == "1" && pVal.FormTypeEx == "179" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.ComboBox cboserie = (SAPbouiCOM.ComboBox)oForm.Items.Item("88").Specific;
                        string v_serie = cboserie.Selected.Value;

                        SAPbobsCOM.Recordset oUltiNC;
                        oUltiNC = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oUltiNC.DoQuery("SELECT MAX(\"DocEntry\") FROM ORIN WHERE \"Series\"='" + v_serie + "'");
                        string v_nuedocentry = oUltiNC.Fields.Item(0).Value.ToString();

                        SAPbobsCOM.Recordset oUltiNCDoc;
                        oUltiNCDoc = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oUltiNCDoc.DoQuery("SELECT \"DocNum\" FROM ORIN WHERE \"DocEntry\"='" + v_nuedocentry + "'");
                        string v_nuevocod = oUltiNCDoc.Fields.Item(0).Value.ToString();


                        //control para saber si es o no documento de cancelación
                        SAPbobsCOM.Recordset oCancel;
                        oCancel = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oCancel.DoQuery("SELECT \"CANCELED\" FROM ORIN WHERE \"DocNum\"='" + v_nuevocod + "' ");
                        string v_cancel = oCancel.Fields.Item(0).Value.ToString();
                        //consultamos si es documento de cancelacion
                        if (v_cancel.Equals("N"))
                        {
                            CrearDocumento(v_nuevocod, "ORIN", "RIN1", "5", "NOTA_CREDITO", "Nota de crédito electrónica");
                            //buscamos el documento creado
                            oForm.Mode = BoFormMode.fm_FIND_MODE;
                            EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("8").Specific;
                            SAPbouiCOM.Button oButton = (SAPbouiCOM.Button)oForm.Items.Item("1").Specific;
                            oDocNum.Value = v_nuevocod;
                            oButton.Item.Click();
                        }

                    }
                    //visualizar PDF
                    if (pVal.ItemUID == "btnPDFNC" && pVal.BeforeAction == false)
                    {

                        //CrearDocumento("60149", "ORIN", "RIN1", "5", "NOTA_CREDITO", "Nota de crédito electrónica");
                        //ReenviarDocumento("60154", "ORIN", "RIN1", "5", "NOTA_CREDITO", "Nota de crédito electrónica", "");
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //para obtener el docnum
                        Item oDocNum;
                        EditText oDoc;
                        oDocNum = oForm.Items.Item("8");
                        oDoc = (SAPbouiCOM.EditText)oDocNum.Specific;
                        string v_docnum = oDoc.Value;
                        //para obtener el folio
                        Item oFolio;
                        EditText oFol;
                        oFolio = oForm.Items.Item("211");
                        oFol = (SAPbouiCOM.EditText)oFolio.Specific;
                        string v_folio = oFol.Value;
                        //obtener descipcion del boton
                        Item oBtnitem;
                        SAPbouiCOM.Button btnPrev;
                        oBtnitem = oForm.Items.Item("btnPDFNC");
                        btnPrev = (SAPbouiCOM.Button)oBtnitem.Specific;
                        string v_Btn = btnPrev.Caption.ToString();

                        if (v_Btn.Equals("PDF"))
                        {
                            //tomamos el valor del form y del item
                            //SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                            Item oItem;
                            oItem = oForm.Items.Item("8");
                            oText = (SAPbouiCOM.EditText)oItem.Specific;
                            codigo = oText.Value;
                            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            try
                            {
                                SAPbobsCOM.Recordset query;
                                query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                query.DoQuery("SELECT \"U_KUDE\" FROM ORIN WHERE \"DocNum\"=" + codigo);

                                string KUDE = query.Fields.Item(0).Value.ToString();
                                byte[] bytes = Convert.FromBase64String(KUDE);
                                //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                                File.Delete(Path.Combine(path + "\\temporal.pdf"));
                                FileStream obj = File.Create(path + "\\temporal.pdf");
                                obj.Write(bytes, 0, bytes.Length);
                                obj.Flush();
                                obj.Close();
                                System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                                //File.Delete(Path.Combine(path + "\\temporal.pdf"));
                            }
                            catch (Exception e)
                            {

                            }
                        }
                        else
                        {
                            //CrearDocumento("60035", "ORIN", "RIN1", "5", "NOTA_CREDITO", "Nota de crédito electrónica");
                            ReenviarDocumento(v_docnum, "ORIN", "RIN1", "5", "NOTA_CREDITO", "Nota de crédito electrónica", v_folio);
                        }


                    }
                    //cambiar de nombre el boton PDF a REENVIAR
                    if (pVal.FormMode == 1 && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.ItemUID == "57")
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFNC").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM ORIN WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if ((v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO") || v_estadoSet.Equals("")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }

                    }
                    //cambiar el boton buscando un documento
                    if (pVal.FormMode == 0 && pVal.BeforeAction == true && pVal.ItemUID == "1" && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFNC").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM ORIN WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if ((v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO") || v_estadoSet.Equals("")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }
                    }
                }
                #endregion

                //AUTOFACTURA
                #region AUTOFACTURA
                if (pVal.FormTypeEx == "UDO_FT_AutoFactura")
                {
                    //agarramos el DocNum del documento
                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "1" && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;
                    }

                    //consumimos el web service luego de crear el documento
                    if (pVal.BeforeAction == false && pVal.ActionSuccess == true && pVal.ItemUID == "1" && pVal.FormTypeEx == "UDO_FT_AutoFactura" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3)
                    {

                    }
                }
                #endregion

                //FACTURA EXPORT
                #region FACTURA EXPORT
                //bloquear campos
                if (pVal.FormTypeEx == "-65307")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        bloquearCampos(oForm);

                    }
                }
                //creamos el boton de PDF
                if (pVal.FormTypeEx == "65307")
                {
                    //creamos el boton para consumir el web service
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.Button oButton1;
                        oItem1 = oForm1.Items.Add("btnPDFEX", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.Button)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "PDF";
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height + 9);
                        oItem1.Left = (oItem1.Width + 20) + 60;
                    }

                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "1" && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        Item oItem2;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;

                        oItem2 = oForm.Items.Item("29");
                        oValor = (SAPbouiCOM.EditText)oItem2.Specific;
                        DocTotal = oValor.Value;

                    }

                    //al pesionar crear, abrimos el form del detalle del documento de export que mandaremos
                    if (pVal.BeforeAction == true && pVal.ItemUID == "1" && pVal.FormTypeEx == "65307" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3)
                    {
                        //validaciones de campos para export
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.ComboBox oDirePay = (SAPbouiCOM.ComboBox)oForm.Items.Item("226").Specific;//direccion paycode
                        SAPbouiCOM.ComboBox oDireShip = (SAPbouiCOM.ComboBox)oForm.Items.Item("40").Specific;//direccion shipcode
                        SAPbouiCOM.EditText oCardCode = (SAPbouiCOM.EditText)oForm.Items.Item("4").Specific;//codigo del SN
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("8").Specific;//DocNum
                        SAPbouiCOM.Button oBtn = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFEX").Specific;
                        string v_direPay = oDirePay.Selected.Value.ToString();
                        string v_direShip = oDireShip.Selected.Value.ToString();
                        string v_cardcode = oCardCode.Value.ToString();
                        string v_DocNum = oDocNum.Value.ToString();
                        //si las direcciones estan vacías
                        if (string.IsNullOrEmpty(v_direPay) && string.IsNullOrEmpty(v_direShip))
                        {
                            MessageBox.Show("La dirección en la factura no puede quedar vacío!!");
                            //oBtn.Caption = "Re-enviar";
                            return;
                        }
                        //si hay datos vacíos del SN
                        SAPbobsCOM.Recordset querySN;
                        querySN = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        querySN.DoQuery("SELECT \"IndustryC\",\"U_iNatRec\",\"U_iTipCont\" FROM OCRD WHERE \"CardCode\"='" + v_cardcode + "' ");
                        string v_industry = querySN.Fields.Item(0).Value.ToString();
                        string v_nat = querySN.Fields.Item(1).Value.ToString();
                        string v_cont = querySN.Fields.Item(2).Value.ToString();
                        //consulta apara el pais
                        if (!string.IsNullOrEmpty(v_direShip))
                        {
                            SAPbobsCOM.Recordset paisSN;
                            paisSN = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            paisSN.DoQuery("SELECT \"Country\" FROM CRD1 WHERE \"CardCode\"='" + v_cardcode + "' ");
                            string v_pais = paisSN.Fields.Item(0).Value.ToString();
                            if (string.IsNullOrEmpty(v_pais))
                            {
                                MessageBox.Show("Se debe cargar el país del receptor!!");
                                //oBtn.Caption = "Re-enviar";
                                return;
                            }
                        }
                        if (!string.IsNullOrEmpty(v_direPay))
                        {
                            SAPbobsCOM.Recordset paisSN;
                            paisSN = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            paisSN.DoQuery("SELECT \"Country\" FROM CRD1 WHERE \"CardCode\"='" + v_cardcode + "' ");
                            string v_pais = paisSN.Fields.Item(0).Value.ToString();
                            if (string.IsNullOrEmpty(v_pais))
                            {
                                MessageBox.Show("Se debe cargar el país del receptor!!");
                                //oBtn.Caption = "Re-enviar";
                                return;
                            }
                        }


                        if (string.IsNullOrEmpty(v_industry) || v_industry.Equals("0"))
                        {
                            MessageBox.Show("El tipo de operación del Socio de negocio no puede quedar vacío!!");
                            //oBtn.Caption = "Re-enviar";
                            return;
                        }
                        else if (string.IsNullOrEmpty(v_nat))
                        {
                            MessageBox.Show("La naturaleza del receptor no puede quedar vacío!!");
                            //oBtn.Caption = "Re-enviar";
                            return;
                        }
                        else if (string.IsNullOrEmpty(v_cont))
                        {
                            MessageBox.Show("El tipo de contribuyente del receptor no puede quedar vacío");
                            //oBtn.Caption = "Re-enviar";
                            return;
                        }
                        else
                        {
                            SBO_Application.ActivateMenuItem("47667");//47660
                            SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
                        }


                    }

                    //evento cuando se presiona el boton de preview documento
                    if (pVal.ItemUID == "btnPDFEX" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        //CrearDocumentoExport("10578", "OINV", "INV1", "1", "FACTURA", "Factura electrónica","");
                        //tomamos el valor del form y del item
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;

                        SAPbouiCOM.Button obtn = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFEX").Specific;
                        string v_btntexto = obtn.Caption.ToString();

                        if (v_btntexto.Equals("Re-enviar"))
                        //if (v_btntexto.Equals("PDF"))
                        {
                            validacionExport(oForm);
                        }
                        else
                        {
                            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            SAPbobsCOM.Recordset query;
                            query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            query.DoQuery("SELECT \"U_KUDE\" FROM OINV WHERE \"DocNum\"=" + codigo + " AND \"DocSubType\"='IX' ");

                            string KUDE = query.Fields.Item(0).Value.ToString();
                            byte[] bytes = Convert.FromBase64String(KUDE);
                            //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            File.Delete(Path.Combine(path + "\\temporal.pdf"));
                            FileStream obj = File.Create(path + "\\temporal.pdf");
                            obj.Write(bytes, 0, bytes.Length);
                            obj.Flush();
                            obj.Close();
                            System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                            //File.Delete(Path.Combine(path + "\\temporal.pdf"));
                        }



                    }
                    //cambiar de nombre el boton PDF a REENVIAR
                    if (pVal.FormMode == 1 && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.ItemUID == "57")
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFEX").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM OINV WHERE \"DocNum\"=" + v_docnum + " AND \"DocSubType\"='IX' ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O"))
                            {
                                if (!v_estadoSet.Equals("APROBADO") && !v_estadoSet.Equals("PROCESADO"))
                                {
                                    btnreenviar.Caption = "Re-enviar";
                                }

                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }

                    }
                    //cambiar el boton buscando un documento
                    if (pVal.FormMode == 0 && pVal.BeforeAction == true && pVal.ItemUID == "1" && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFEX").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM OINV WHERE \"DocNum\"=" + v_docnum + " AND \"DocSubType\"='IX' ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O"))
                            {
                                if (!v_estadoSet.Equals("APROBADO") && !v_estadoSet.Equals("PROCESADO"))
                                {
                                    btnreenviar.Caption = "Re-enviar";
                                }
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }
                    }


                }

                //cargar datos en el UDO detalle export
                if (pVal.FormTypeEx == "UDO_FT_EXPORT")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadExport(oForm);
                    }

                    //acturalizar el campo de la descripcion de la grilla segun lo seleccionado en el combo
                    if (pVal.ItemUID == "Item_0" && pVal.EventType == BoEventTypes.et_COMBO_SELECT && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Item oItem;
                        SAPbouiCOM.ComboBox cboItem;
                        SAPbouiCOM.ComboBoxColumn cbcol;
                        SAPbouiCOM.Grid grilla;

                        oItem = oForm.Items.Item("Item_0");
                        grilla = (SAPbouiCOM.Grid)oItem.Specific;
                        //cbcol = (SAPbouiCOM.ComboBoxColumn)grilla.Columns.Item(0);
                        int index = grilla.GetDataTableRowIndex(pVal.Row);
                        string desc = ((SAPbouiCOM.ComboBoxColumn)grilla.Columns.Item("ItemCode")).GetSelectedValue(pVal.Row).Description;
                        grilla.DataTable.SetValue(1, index, desc);
                    }
                    //agregar un alinea al presionar ENTER
                    if (pVal.CharPressed == 13 && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Grid grilla;
                        grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_0").Specific;
                        grilla.DataTable.Rows.Add();
                    }

                    //grabar los datos en la tabla
                    if (pVal.ItemUID == "btCrear" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Grid grilla;
                        SAPbouiCOM.Item oItem;
                        SAPbouiCOM.DBDataSource source = oForm.DataSources.DBDataSources.Item("@EXPORT");
                        source.Clear();
                        SAPbouiCOM.EditText DocNumExport = (SAPbouiCOM.EditText)oForm.Items.Item("1_U_E").Specific;
                        SAPbouiCOM.Button btnCancelar = (SAPbouiCOM.Button)oForm.Items.Item("2").Specific;
                        //datos extras de export
                        //tipo de operacion
                        SAPbouiCOM.EditText oOpe;
                        oOpe = (SAPbouiCOM.EditText)oForm.Items.Item("Item_12").Specific;
                        string v_ope = oOpe.Value;
                        //condicion
                        SAPbouiCOM.ComboBox oCond;
                        oCond = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_13").Specific;
                        string v_cond = oCond.Selected.Value.ToString();
                        //pais destino
                        SAPbouiCOM.EditText oPais;
                        oPais = (SAPbouiCOM.EditText)oForm.Items.Item("Item_14").Specific;
                        string v_pais = oPais.Value;
                        //empresa fletera
                        SAPbouiCOM.EditText oFlete;
                        oFlete = (SAPbouiCOM.EditText)oForm.Items.Item("Item_15").Specific;
                        string v_flete = oFlete.Value;
                        //agente de trasnporte
                        SAPbouiCOM.EditText oTrans;
                        oTrans = (SAPbouiCOM.EditText)oForm.Items.Item("Item_16").Specific;
                        string v_trans = oTrans.Value;
                        //embarque
                        SAPbouiCOM.EditText oEmb;
                        oEmb = (SAPbouiCOM.EditText)oForm.Items.Item("Item_17").Specific;
                        string v_emb = oEmb.Value;
                        //manifiesto
                        SAPbouiCOM.EditText oMani;
                        oMani = (SAPbouiCOM.EditText)oForm.Items.Item("Item_18").Specific;
                        string v_mani = oMani.Value;
                        //barcaza
                        SAPbouiCOM.EditText oBarc;
                        oBarc = (SAPbouiCOM.EditText)oForm.Items.Item("Item_19").Specific;
                        string v_barc = oBarc.Value;
                        //instruccion de pago
                        SAPbouiCOM.EditText oPago;
                        oPago = (SAPbouiCOM.EditText)oForm.Items.Item("Item_20").Specific;
                        string v_pago = oPago.Value;
                        //armar el string que ira a la set
                        string v_infoSet = "Tipo operacion: " + v_ope + ", condicion: " + v_cond + ", país destino: " + v_pais + ", empresa fletera: " + v_flete + ", agente de transporte: " + v_trans + ", embarque: " + v_emb + ", Manifiesto: " + v_mani + ", barcaza: " + v_barc + ", instrucciones de pago: " + v_pago + "";

                        string NumExport = DocNumExport.Value;
                        oItem = oForm.Items.Item("Item_0");
                        grilla = (SAPbouiCOM.Grid)oItem.Specific;
                        int can = grilla.Rows.Count;
                        int f = 1;
                        int i = 0;
                        int MaxCod = 0;
                        SAPbobsCOM.Recordset codMax;
                        codMax = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        codMax.DoQuery("select CASE WHEN MAX(\"DocEntry\")=0 THEN 1 ELSE  MAX(\"DocEntry\") END from \"@EXPORT\" ");
                        MaxCod = int.Parse(codMax.Fields.Item(0).Value.ToString()) + 1;

                        while (f <= can)
                        {
                            string cod = ((SAPbouiCOM.ComboBoxColumn)grilla.Columns.Item("ItemCode")).GetSelectedValue(i).Value;
                            string descrip = ((SAPbouiCOM.ComboBoxColumn)grilla.Columns.Item("ItemCode")).GetSelectedValue(i).Description;
                            string cant = grilla.DataTable.GetValue(2, i).ToString();
                            string monto = grilla.DataTable.GetValue(3, i).ToString();

                            SAPbobsCOM.Recordset crear;
                            crear = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            crear.DoQuery("INSERT INTO \"@EXPORT\" (\"Code\",\"Name\",\"DocEntry\",\"U_U_DocEntry\",\"U_U_ItemCode\",\"U_U_Dscription\",\"U_U_TotalLine\",\"U_U_LineId\",\"U_U_cantidad\") " +
                                                           " VALUES('" + MaxCod + "','" + MaxCod + "','" + MaxCod + "','" + NumExport + "','" + cod + "','" + descrip + "','" + monto + "','" + f + "','" + cant + "') ");
                            i++;
                            f++;
                            MaxCod++;
                        }
                        SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                        btnCancelar.Item.Click();
                        CrearDocumentoExport(codigo, "OINV", "INV1", "1", "FACTURA", "Factura electrónica", v_infoSet, can);



                    }
                    if (pVal.ItemUID == "Item_0" && pVal.EventType == BoEventTypes.et_DOUBLE_CLICK && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Grid grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_0").Specific;
                        int fila = grilla.Rows.SelectedRows.Item(0, SAPbouiCOM.BoOrderType.ot_RowOrder);
                        grilla.DataTable.Rows.Remove(fila);
                    }


                }

                //

                #endregion

                //ACTUALIZAR SET
                #region SET
                if (pVal.FormTypeEx == "UDO_FT_TABLASET")
                {
                    if (pVal.ItemUID == "Item_0" && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        string query = "SELECT \"U_CDC\" FROM OINV WHERE \"U_TIMB\"='16148774' AND (\"U_ESTADO\"!='APROBADO' AND \"U_ESTADO\"!='RECHAZADO') AND \"CANCELED\"='N' limit 900 ";
                        SAPbobsCOM.Recordset oDatosDoc;
                        oDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oDatosDoc.DoQuery(query);
                        //instanciamos el servicio
                        consultas.ConsultasClient cliente = new consultas.ConsultasClient();
                        consultas.consultaRequest consultaEstado = new consultas.consultaRequest();
                        consultas.consultaRequest1[] consultaEstado1 = new consultas.consultaRequest1[1];
                        consultas.consultaResponse consultaResp = new consultas.consultaResponse();
                        consultas.consultaResponse1 consultaResp1 = new consultas.consultaResponse1();
                        consultas.numeroTipoDocumento numTipo = new consultas.numeroTipoDocumento();
                        consultas.numeroTipoDocumento[] numTipo1 = new consultas.numeroTipoDocumento[1];

                        string[] v_cdc = new string[1];
                        string v_estado = null;
                        while (!oDatosDoc.EoF)
                        {
                            // consumimos el servicio para saber el estado del documento
                            string msjError = null;
                            v_cdc[0] = oDatosDoc.Fields.Item(0).Value.ToString();
                            consultaEstado.cdc = v_cdc;
                            consultaEstado.ruc = 80003232;
                            consultaEstado.dv = "2";
                            consultaResp = cliente.consulta(consultaEstado);
                            v_estado = consultaResp.documento[0].estado;
                            if (v_estado.Equals("RECHAZADO") || v_estado.Equals("RECHAZADO_REINGRESADO"))
                            {
                                msjError = consultaResp.documento[0].documentoError[0].mensaje.ToString();
                            }

                            SAPbobsCOM.Recordset oActDoc;
                            oActDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oActDoc.DoQuery("UPDATE ");
                        }
                    }
                }
                #endregion

                //AUDITORIA
                #region AUDITORIA
                if (pVal.FormTypeEx == "UDO_FT_AUDITORIAFE")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadAuditoria(oForm);
                    }

                    //evento para actualizar los estados
                    if (pVal.ItemUID == "Item_1" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == false)
                    {
                        ActualizarEstados();
                    }

                    //evento cuando se presiona el boton de filtrar
                    if (pVal.ItemUID == "Item_0" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button btn = (SAPbouiCOM.Button)oForm.Items.Item("Item_0").Specific;
                        SAPbouiCOM.Grid grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_13").Specific;
                        SAPbouiCOM.EditText fechaD = (SAPbouiCOM.EditText)oForm.Items.Item("Item_2").Specific;
                        SAPbouiCOM.EditText fechaH = (SAPbouiCOM.EditText)oForm.Items.Item("Item_3").Specific;
                        SAPbouiCOM.EditText serie = (SAPbouiCOM.EditText)oForm.Items.Item("Item_6").Specific;
                        SAPbouiCOM.EditText sn = (SAPbouiCOM.EditText)oForm.Items.Item("Item_36").Specific;
                        SAPbouiCOM.Button btndes = (SAPbouiCOM.Button)oForm.Items.Item("Item_37").Specific;
                        SAPbouiCOM.Button btncorreo = (SAPbouiCOM.Button)oForm.Items.Item("Item_39").Specific;

                        if (btn.Caption.Equals("Filtrar"))
                        {
                            ControlFE(oForm);
                            btn.Caption = "Limpiar";
                        }
                        else
                        {
                            grilla.DataTable.Clear();
                            btn.Caption = "Filtrar";
                            fechaD.Value = "";
                            fechaH.Value = "";
                            serie.Value = "";
                            sn.Value = "";
                            btndes.Item.Enabled = true;
                            btncorreo.Item.Enabled = false;
                        }
                    }
                    //evento para descargar PDF y XML
                    if (pVal.ItemUID == "Item_37" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        descargarPdfXml(oForm);
                        SAPbouiCOM.Button btndesc = (SAPbouiCOM.Button)oForm.Items.Item("Item_37").Specific;
                        SAPbouiCOM.Button btncorreo = (SAPbouiCOM.Button)oForm.Items.Item("Item_39").Specific;
                        btndesc.Item.Enabled = false;
                        btncorreo.Item.Enabled = true;
                    }
                    //evento para mandar correo
                    if (pVal.ItemUID == "Item_39" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Grid oGrilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_13").Specific;
                        SAPbouiCOM.Button btndesc = (SAPbouiCOM.Button)oForm.Items.Item("Item_37").Specific;
                        SAPbouiCOM.Button btncorreo = (SAPbouiCOM.Button)oForm.Items.Item("Item_39").Specific;
                        int GrillaCount = oGrilla.DataTable.Rows.Count;
                        int contador = 0;
                        //barra de progreso
                        //SAPbouiCOM.ProgressBar BarraProgreso;
                        //BarraProgreso = SBO_Application.StatusBar.CreateProgressBar("Enviando documentos por correo", GrillaCount, true);
                        //BarraProgreso.Value = 1;
                        //int progreso = 1;

                        while (GrillaCount > contador)
                        {
                            // barra de progreso, estado
                            //BarraProgreso.Text = "Enviando documentos por correo";
                            //progreso += 1;
                            //BarraProgreso.Value = progreso;
                            string valorchk = oGrilla.DataTable.GetValue(13, contador).ToString();
                            string mailcontrol = oGrilla.DataTable.GetValue(7, contador).ToString();
                            //if(!string.IsNullOrEmpty(mailcontrol))
                            //{

                            //}
                            //else
                            //{

                            //}
                            if (valorchk.Equals("Y"))
                            {


                                string mail = oGrilla.DataTable.GetValue(7, contador).ToString();
                                string cardcode = oGrilla.DataTable.GetValue(3, contador).ToString();
                                string cardname = oGrilla.DataTable.GetValue(4, contador).ToString();
                                if (string.IsNullOrEmpty(mail))
                                {
                                    MessageBox.Show("El Socio de negocio: " + cardcode + ", " + cardname + " no posee correo, favor actualizar!!");
                                    return;
                                }
                                string cdc = oGrilla.DataTable.GetValue(6, contador).ToString();
                                string doc = oGrilla.DataTable.GetValue(5, contador).ToString();
                                DateTime v_fecha = DateTime.Parse(oGrilla.DataTable.GetValue(0, contador).ToString());
                                string fecha = v_fecha.ToString("dd/MM/yyyy");
                                string interno = oGrilla.DataTable.GetValue(2, contador).ToString();
                                string textDocu = oGrilla.DataTable.GetValue(1, contador).ToString();
                                //tipo de documento
                                string tabla = null; string tipodocumento = null; string sub = null; ;
                                if (textDocu.Equals("Factura")) { tabla = "OINV"; tipodocumento = "Factura electrónica"; }
                                if (textDocu.Equals("Nota de crédito")) { tabla = "ORIN"; tipodocumento = "Nota de crédito electrónica"; }
                                if (textDocu.Equals("Remisión entrega")) { tabla = "ODLN"; tipodocumento = "Remisión electrónica"; }
                                if (textDocu.Equals("Remisión traslado")) { tabla = "OWTR"; tipodocumento = "Remisión electrónica"; }
                                if (textDocu.Equals("Nota de débito")) { tabla = "OINV"; sub = " AND \"DocSubType\"='DN' "; tipodocumento = "Factura electrónica"; }
                                if (textDocu.Equals("Factura export")) { tabla = "OINV"; sub = " AND \"DocSubType\"='IX' "; tipodocumento = "Factura electrónica"; }
                                if (textDocu.Equals("Autofactura")) { tabla = ""; tipodocumento = "Autofacura electrónica"; }
                                //buscamos los datos del documento
                                SAPbobsCOM.Recordset oDocDatos;
                                oDocDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oDocDatos.DoQuery("SELECT \"DocTotal\",\"DocCur\" FROM " + tabla + " WHERE \"DocNum\"=" + interno + sub + "");
                                string v_total = oDocDatos.Fields.Item(0).Value.ToString();
                                double total_v = double.Parse(v_total);
                                string total = total_v.ToString("N");
                                string moneda = null;
                                if (oDocDatos.Fields.Item(1).Value.ToString() == "GS") { moneda = "PYG"; } else { moneda = "USD"; }
                                //activamos el evento de mandar correo
                                enviarcorreo(mail, cdc, doc, fecha, moneda, total, tipodocumento);
                            }
                            contador++;
                        }
                        btncorreo.Item.Enabled = false;
                        btndesc.Item.Enabled = true;
                        //BarraProgreso.Stop();
                    }
                    //evento para exportar a excel
                    if (pVal.ItemUID == "Item_38" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        ExportarExcel(oForm);
                    }

                    //evento para tildar o destildar todos los check
                    if (pVal.ItemUID == "Item_40" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Grid grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_13").Specific;
                        SAPbouiCOM.CheckBox chktodos = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_40").Specific;
                        bool v_chek = chktodos.Checked;
                        int lineas = grilla.Rows.Count;
                        int contador = 0;
                        //recorremos la grilla
                        if (v_chek == true)
                        {
                            while (lineas > contador)
                            {
                                grilla.DataTable.SetValue(13, contador, "Y");
                                contador++;
                            }
                        }
                        else
                        {
                            while (lineas >= contador)
                            {
                                grilla.DataTable.SetValue(13, contador, "N");
                                contador++;
                            }
                        }

                    }



                }
                #endregion

                //INUTILIZACION
                #region INUTILIZAR
                if (pVal.FormTypeEx == "UDO_FT_INUTILIZAR")
                {
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadinutilizacion(oForm);
                    }

                    //evento para mandar uno por uno
                    if (pVal.ItemUID == "Item_24" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        //los datos del documento que vamos a inutilizar
                        SAPbouiCOM.EditText ruc = (SAPbouiCOM.EditText)oForm.Items.Item("Item_16").Specific;
                        SAPbouiCOM.EditText timbrado = (SAPbouiCOM.EditText)oForm.Items.Item("Item_17").Specific;
                        SAPbouiCOM.EditText esta = (SAPbouiCOM.EditText)oForm.Items.Item("Item_18").Specific;
                        SAPbouiCOM.EditText pemi = (SAPbouiCOM.EditText)oForm.Items.Item("Item_19").Specific;
                        SAPbouiCOM.ComboBox documento = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_20").Specific;
                        SAPbouiCOM.EditText desde = (SAPbouiCOM.EditText)oForm.Items.Item("Item_21").Specific;
                        SAPbouiCOM.EditText hasta = (SAPbouiCOM.EditText)oForm.Items.Item("Item_22").Specific;
                        SAPbouiCOM.ComboBox motivo = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_23").Specific;

                        //pasamos los valores a string
                        string v_ruc = ruc.Value;
                        string v_timbrado = timbrado.Value;
                        string v_esta = esta.Value;
                        string v_pemi = pemi.Value;
                        string v_documento = documento.Selected.Value.ToString();
                        string v_desde = desde.Value;
                        string v_hasta = hasta.Value;
                        string v_motivo = motivo.Selected.Description.ToString();

                        string v_tabla = null;
                        if (v_documento.Equals("1")) { v_tabla = "OINV"; }
                        if (v_documento.Equals("2")) { v_tabla = "OINV"; }
                        if (v_documento.Equals("5")) { v_tabla = "ORIN"; }
                        if (v_documento.Equals("7")) { v_tabla = "ODLN"; }
                        if (v_documento.Equals("8")) { v_tabla = "OWTR"; }

                        //consultamos si el documento esta rechazado, sino no ejecutar el proceso
                        SAPbobsCOM.Recordset oConsulta;
                        oConsulta = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oConsulta.DoQuery("SELECT \"U_ESTADO\" FROM " + v_tabla + " WHERE \"U_PEMI\"='" + v_pemi + "' AND \"U_ESTA\"='" + v_esta + "' AND \"FolioNum\"='" + v_desde + "' AND \"U_TIMB\"='" + v_timbrado + "' ");
                        string v_estadoDoc = oConsulta.Fields.Item(0).Value.ToString();
                        if (!v_estadoDoc.Equals("RECHAZADO"))
                        {
                            SBO_Application.SetStatusBarMessage("Solo se puede inutilizar un documento RECHAZADO!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                            return;
                        }
                        else
                        {
                            //ejecutamos el servicio
                            inutilizarDoc(v_ruc, v_timbrado, v_esta, v_pemi, v_documento, v_desde, v_hasta, v_motivo);
                        }



                    }
                    //evento para inutilizar de forma masiva
                    if (pVal.ItemUID == "Item_7" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText urlDirctorio = (SAPbouiCOM.EditText)oForm.Items.Item("Item_0").Specific;
                        string url = urlDirctorio.Value;

                        inutilizarMasivo(url);
                        //ejecutamos el servicio para inutilizacion
                    }

                    //evento para abjuntar el excel
                    if (pVal.ItemUID == "Item_3" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText FILE = (SAPbouiCOM.EditText)oForm.Items.Item("Item_0").Specific;

                        //buscamos el archivo EXCEL para la inutilizacion
                        Thread t = new Thread(() =>
                        {
                            OpenFileDialog openFileDialog = new OpenFileDialog();

                            DialogResult dr = openFileDialog.ShowDialog();
                            if (dr == DialogResult.OK)
                            {
                                string fileName = openFileDialog.FileName;
                                FILE.Value = fileName;
                                //SAPbouiCOM.Framework.Application.SBO_Application.MessageBox(fileName);
                            }
                        });          // Kick off a new thread
                        t.IsBackground = true;
                        t.SetApartmentState(ApartmentState.STA);
                        t.Start();


                    }
                    //evento para descargar la plantilla
                    if (pVal.ItemUID == "Item_1" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == true)
                    {
                        descargarPlantilla();
                    }

                }
                #endregion

                //JENGA - Objetivos
                #region OBJETIVOS
                if (pVal.FormTypeEx == "UDO_FT_JOBJETIVOS")
                {
                    //evento de incio
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadObjetivos(oForm);
                    }
                    //evento al presiona el boton de excel
                    if (pVal.ItemUID == "Item_0" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText FILE = (SAPbouiCOM.EditText)oForm.Items.Item("Item_5").Specific;
                        FILE.Item.Visible = false;

                        //buscamos el archivo EXCEL para la inutilizacion
                        Thread t = new Thread(() =>
                        {
                            OpenFileDialog openFileDialog = new OpenFileDialog();

                            DialogResult dr = openFileDialog.ShowDialog();
                            if (dr == DialogResult.OK)
                            {
                                string fileName = openFileDialog.FileName;
                                FILE.Value = fileName;
                                cargarGrillaObj(fileName, oForm);
                                //SAPbouiCOM.Framework.Application.SBO_Application.MessageBox(fileName);
                            }
                        });          // Kick off a new thread
                        t.IsBackground = true;
                        t.SetApartmentState(ApartmentState.STA);
                        t.Start();


                    }
                }
                #endregion

                //NUMERACION DE DOCUMENTOS
                #region NUMERACION
                if (pVal.FormTypeEx == "UDO_FT_NUMERACION")
                {
                    //funcion cuando carga el form
                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        loadNumeracion(oForm);
                    }

                    //evento al presionar el boton OK
                    if (pVal.ItemUID == "Item_9" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == false)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.EditText oSerie = (SAPbouiCOM.EditText)oForm.Items.Item("0_U_E").Specific;
                        SAPbouiCOM.EditText oFolio = (SAPbouiCOM.EditText)oForm.Items.Item("1_U_E").Specific;
                        SAPbouiCOM.EditText oPref = (SAPbouiCOM.EditText)oForm.Items.Item("Item_4").Specific;
                        SAPbouiCOM.EditText oFolioDoc = (SAPbouiCOM.EditText)oForm.Items.Item("Item_8").Specific;
                        SAPbouiCOM.Folder oFolder1 = (SAPbouiCOM.Folder)oForm.Items.Item("Item_1").Specific;
                        SAPbouiCOM.Folder oFolder2 = (SAPbouiCOM.Folder)oForm.Items.Item("Item_2").Specific;
                        SAPbouiCOM.ComboBox otipoDoc = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_5").Specific;
                        SAPbouiCOM.EditText oCDC = (SAPbouiCOM.EditText)oForm.Items.Item("Item_12").Specific;
                        SAPbouiCOM.EditText oInterno = (SAPbouiCOM.EditText)oForm.Items.Item("Item_13").Specific;
                        //mandamos a un string los valores
                        string v_folder1 = oFolder1.Selected.ToString();
                        string v_folder2 = oFolder2.Selected.ToString();



                        if (v_folder1.Equals("True"))
                        {
                            string v_serie = oSerie.Value.ToString();
                            string v_folio = oFolio.Value.ToString();
                            actualizarSerie(v_serie, v_folio);
                            oSerie.Value = "";
                            oFolio.Value = "";
                        }
                        if (v_folder2.Equals("True"))
                        {
                            string v_prefijo = oPref.Value.ToString();
                            string v_folioDoc = oFolioDoc.Value.ToString();
                            string v_tipoDoc = otipoDoc.Selected.Value.ToString();
                            string v_CDC = oCDC.Value.ToString();
                            string v_interno = oInterno.Value.ToString();
                            foliarDesfoliar(v_prefijo, v_folioDoc, v_CDC, v_tipoDoc, v_interno);
                            oPref.Value = "";
                            oFolioDoc.Value = "";
                            oCDC.Value = "";
                            oInterno.Value = "";
                        }

                    }
                }
                #endregion

                //ORDEN DE VENTA
                #region ORDEN DE VENTA
                if (pVal.FormTypeEx == "139")
                {

                    //creamos el boton para mandar a RT
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        Item oItem;
                        SAPbouiCOM.Button oButton;
                        oItem = oForm.Items.Add("btnRT", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton = (SAPbouiCOM.Button)oItem.Specific;
                        //Agregando propiedades al boton
                        oButton.Caption = "Copiar a RT";
                        //agregando posicio del boton
                        oItem.Top = oForm.Height - (oItem.Height + 9);
                        oItem.Left = (oItem.Width + 20) + 60;
                    }

                    //evento para abrir el form de remision temporal
                    if (pVal.ItemUID == "btnRT" && pVal.EventType == BoEventTypes.et_CLICK && pVal.BeforeAction == false)
                    {
                        //agarramos el docnum de la OV
                        SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);
                        EditText DocNumOV = (SAPbouiCOM.EditText)oForm.Items.Item("8").Specific;
                        EditText CardCodeOV = (SAPbouiCOM.EditText)oForm.Items.Item("4").Specific;
                        EditText CardNameOV = (SAPbouiCOM.EditText)oForm.Items.Item("54").Specific;
                        EditText DocDateOV = (SAPbouiCOM.EditText)oForm.Items.Item("10").Specific;
                        EditText DocDueDateOV = (SAPbouiCOM.EditText)oForm.Items.Item("12").Specific;
                        EditText TaxDateOV = (SAPbouiCOM.EditText)oForm.Items.Item("46").Specific;
                        SAPbouiCOM.ComboBox DocCurOV = (SAPbouiCOM.ComboBox)oForm.Items.Item("63").Specific;
                        SAPbouiCOM.ComboBox ClaseOV = (SAPbouiCOM.ComboBox)oForm.Items.Item("3").Specific;
                        EditText DocTotalOV = (SAPbouiCOM.EditText)oForm.Items.Item("29").Specific;
                        EditText IvaOV = (SAPbouiCOM.EditText)oForm.Items.Item("27").Specific;
                        //SAPbouiCOM.ComboBox ShipOV = (SAPbouiCOM.ComboBox)oForm.Items.Item("40").Specific;
                        SAPbouiCOM.Matrix Matrix = (SAPbouiCOM.Matrix)oForm.Items.Item("38").Specific;
                        //SAPbouiCOM.ComboBox PayOV = (SAPbouiCOM.ComboBox)oForm.Items.Item("226").Specific;
                        //pasamos a un string
                        string v_DocNumOV = DocNumOV.Value;
                        string v_CardCodeOV = CardCodeOV.Value;
                        string v_CardNameOV = CardNameOV.Value;
                        string v_DocDateOV = DocDateOV.Value;
                        string v_DocCurOV = DocCurOV.Selected.Value;
                        string v_DocDueDteOV = DocDueDateOV.Value;
                        string v_DocCurDesOV = DocCurOV.Selected.Description;
                        string v_TaxDateOV = TaxDateOV.Value;
                        string v_ClaseOV = ClaseOV.Selected.Value;
                        string v_DocTotalOV = DocTotalOV.Value;
                        string v_IvaOV = IvaOV.Value;
                        //string v_ShipOV = ShipOV.Selected.Value;
                        //string v_PayOV = PayOV.Selected.Description;

                        //desplegamos el formulario de RT
                        //SBO_Application.ActivateMenuItem("47634");//47660
                        SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "REMI_TEMP", "");
                        SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
                        form.Mode = BoFormMode.fm_ADD_MODE;
                        //pasamos los datos de la OV a la RT
                        EditText CardCodeRT = (SAPbouiCOM.EditText)form.Items.Item("14_U_E").Specific;
                        EditText CardNameRT = (SAPbouiCOM.EditText)form.Items.Item("15_U_E").Specific;
                        EditText OrdeVRT = (SAPbouiCOM.EditText)form.Items.Item("25_U_E").Specific;
                        EditText DocDateRT = (SAPbouiCOM.EditText)form.Items.Item("19_U_E").Specific;
                        EditText DocDueDateRT = (SAPbouiCOM.EditText)form.Items.Item("20_U_E").Specific;
                        EditText TaxDateRT = (SAPbouiCOM.EditText)form.Items.Item("21_U_E").Specific;
                        SAPbouiCOM.ComboBox MonedaRT = (SAPbouiCOM.ComboBox)(form.Items.Item("16_U_Cb").Specific);
                        SAPbouiCOM.ComboBox EstadoRT = (SAPbouiCOM.ComboBox)(form.Items.Item("22_U_Cb").Specific);
                        SAPbouiCOM.ComboBox ClaseRT = (SAPbouiCOM.ComboBox)(form.Items.Item("13_U_Cb").Specific);
                        EditText DocTotalRT = (SAPbouiCOM.EditText)form.Items.Item("26_U_E").Specific;
                        EditText IvaRT = (SAPbouiCOM.EditText)form.Items.Item("27_U_E").Specific;
                        //EditText ShipRT = (SAPbouiCOM.EditText)form.Items.Item("29_U_E").Specific;
                        SAPbouiCOM.ComboBox operacion = (SAPbouiCOM.ComboBox)(form.Items.Item("41_U_Cb").Specific);
                        SAPbouiCOM.ComboBox transaccion = (SAPbouiCOM.ComboBox)(form.Items.Item("40_U_Cb").Specific);
                        SAPbouiCOM.EditText DocNum = (SAPbouiCOM.EditText)(form.Items.Item("0_U_E").Specific);
                        //detalle 
                        SAPbouiCOM.Matrix MatrixRT = (SAPbouiCOM.Matrix)form.Items.Item("0_U_G").Specific;
                        SAPbouiCOM.DBDataSource source = form.DataSources.DBDataSources.Item("@REMI_DET");
                        MatrixRT.FlushToDataSource();
                        source.Clear();
                        //detalle lote
                        SAPbouiCOM.Matrix MatrixRTLote = (SAPbouiCOM.Matrix)form.Items.Item("2_U_G").Specific;
                        SAPbouiCOM.DBDataSource sourceLo = form.DataSources.DBDataSources.Item("@REMI_DET3");
                        MatrixRTLote.FlushToDataSource();
                        sourceLo.Clear();
                        //EditText PayRT = (SAPbouiCOM.EditText)form.Items.Item("28_U_E").Specific;
                        //mandamos las variables a la RT
                        Recordset oNewDocEntryRT;
                        oNewDocEntryRT = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oNewDocEntryRT.DoQuery("SELECT MAX(\"DocEntry\")+1 FROM \"@REMI_CAB\" ");
                        string v_NewDocEntryRT = oNewDocEntryRT.Fields.Item(0).Value.ToString();
                        DocNum.Value = v_NewDocEntryRT;
                        CardCodeRT.Value = v_CardCodeOV;
                        CardNameRT.Value = v_CardNameOV;
                        OrdeVRT.Value = v_DocNumOV;
                        DocDateRT.Value = DateTime.Now.ToString("yyyyMMdd");//v_DocDateOV;
                        DocDueDateRT.Value = DateTime.Now.ToString("yyyyMMdd"); //v_DocDueDteOV;
                        TaxDateRT.Value = DateTime.Now.ToString("yyyyMMdd"); //v_TaxDateOV;
                        operacion.Select(0, SAPbouiCOM.BoSearchKey.psk_Index);
                        transaccion.Select(0, SAPbouiCOM.BoSearchKey.psk_Index);
                        MonedaRT.Select(v_DocCurOV, SAPbouiCOM.BoSearchKey.psk_ByValue);
                        EstadoRT.Select(0, SAPbouiCOM.BoSearchKey.psk_Index);
                        ClaseRT.Select(v_ClaseOV, SAPbouiCOM.BoSearchKey.psk_ByValue);
                        DocTotalRT.Value = v_DocTotalOV.Replace(".", string.Empty).Replace(",", ".");
                        IvaRT.Value = v_IvaOV.Replace(".", string.Empty).Replace(",", ".");
                        //ShipRT.Value = v_ShipOV;
                        int filaMatrix = Matrix.RowCount;
                        int filaNueva = 0;
                        int filaitem = 1;
                        while (filaNueva < filaMatrix)
                        {
                            EditText oItemcode = (EditText)Matrix.Columns.Item("1").Cells.Item(filaitem).Specific;
                            string v_ItemCode = oItemcode.Value;
                            EditText oDescripcion = (EditText)Matrix.Columns.Item("3").Cells.Item(filaitem).Specific;
                            string v_Descripcion = oDescripcion.Value;
                            EditText oQuantity = (EditText)Matrix.Columns.Item("11").Cells.Item(filaitem).Specific;
                            string v_quantity = oQuantity.Value;
                            EditText oWhsCode = (EditText)Matrix.Columns.Item("24").Cells.Item(filaitem).Specific;
                            string v_WhsCode = oWhsCode.Value;
                            EditText oTaxCode = (EditText)Matrix.Columns.Item("160").Cells.Item(filaitem).Specific;
                            string v_TaxCode = oTaxCode.Value;
                            EditText oPrice = (EditText)Matrix.Columns.Item("20").Cells.Item(filaitem).Specific;
                            string v_Price = oPrice.Value;
                            EditText oTotalLinea;
                            EditText oIva;
                            if (v_DocCurOV.Equals("USD"))
                            {
                                oTotalLinea = (EditText)Matrix.Columns.Item("284").Cells.Item(filaitem).Specific;
                                oIva = (EditText)Matrix.Columns.Item("83").Cells.Item(filaitem).Specific;
                            }
                            else
                            {
                                oTotalLinea = (EditText)Matrix.Columns.Item("288").Cells.Item(filaitem).Specific;
                                oIva = (EditText)Matrix.Columns.Item("82").Cells.Item(filaitem).Specific;
                            }

                            string v_totalLinea = oTotalLinea.Value;

                            string v_Iva = oIva.Value;
                            SAPbouiCOM.ComboBox oSlpName = (SAPbouiCOM.ComboBox)Matrix.Columns.Item("27").Cells.Item(filaitem).Specific;
                            string v_SlpName = oSlpName.Selected.Description;

                            decimal v_totalLineaSum = 0;
                            decimal v_ivaimp = 0;

                            if (!string.IsNullOrEmpty(v_ItemCode))
                            {
                                //cargamos los datos en la matrix
                                source.InsertRecord(source.Size);
                                source.Offset = source.Size - 1;
                                source.SetValue("U_ItemCode", filaNueva, v_ItemCode);
                                source.SetValue("U_Descripcion", filaNueva, v_Descripcion);
                                source.SetValue("U_Quantity", filaNueva, v_quantity);
                                source.SetValue("U_WhsCode", filaNueva, v_WhsCode);
                                source.SetValue("U_TaxCode", filaNueva, v_TaxCode);
                                source.SetValue("U_Price", filaNueva, v_Price.Replace(".", string.Empty).Replace(",", "."));
                                source.SetValue("U_SlpName", filaNueva, v_SlpName);
                                source.SetValue("U_VatSum", filaNueva, v_Iva.Replace(".", string.Empty).Replace(",", "."));
                                source.SetValue("U_TotalLine", filaNueva, v_totalLinea.Replace(".", string.Empty).Replace(",", "."));
                                MatrixRT.LoadFromDataSource();

                                //detalle del LOTE
                                sourceLo.InsertRecord(sourceLo.Size);
                                sourceLo.Offset = sourceLo.Size - 1;
                                sourceLo.SetValue("U_ItemCode", filaNueva, v_ItemCode);
                                sourceLo.SetValue("U_Descripcion", filaNueva, v_Descripcion);
                                sourceLo.SetValue("U_Quantity", filaNueva, v_quantity);
                                MatrixRTLote.LoadFromDataSource();
                                filaNueva++;
                            }

                            filaitem++;

                        }
                    }

                }
                #endregion

                //FACTURA RESERVA
                #region FACTURA RESERVA
                if (pVal.FormTypeEx == "-60091")
                {
                    oFormUDF = SBO_Application.Forms.Item(FormUID);
                }

                if (pVal.FormTypeEx == "60091")
                {
                    SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);

                    //creamos el boton para lectura del PDF
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        Item oItem;
                        SAPbouiCOM.Button oButton;
                        oItem = oForm.Items.Add("btnPDF", BoFormItemTypes.it_BUTTON);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton = (SAPbouiCOM.Button)oItem.Specific;
                        //Agregando propiedades al boton
                        oButton.Caption = "PDF";
                        //agregando posicio del boton
                        oItem.Top = oForm.Height - (oItem.Height + 9);
                        oItem.Left = (oItem.Width + 20) + 60;

                    }

                    //evento el presionar el boton de PDF
                    if (pVal.ItemUID == "btnPDF" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED)
                    {
                        string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                        try
                        {
                            EditText ocod = (EditText)oForm.Items.Item("8").Specific;
                            string codi = ocod.Value;
                            //desplegamos el PDF
                            SAPbobsCOM.Recordset query;
                            query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            query.DoQuery("SELECT \"U_KUDE\" FROM OINV WHERE \"DocNum\"=" + codi);

                            string KUDE = query.Fields.Item(0).Value.ToString();
                            byte[] bytes = Convert.FromBase64String(KUDE);
                            //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            File.Delete(Path.Combine(path + "\\temporal.pdf"));
                            FileStream obj = File.Create(path + "\\temporal.pdf");
                            obj.Write(bytes, 0, bytes.Length);
                            obj.Flush();
                            obj.Close();
                            System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                        }
                        catch (Exception ex)
                        {
                            MessageBox.Show(ex.Message.ToString());
                        }
                    }

                    if (pVal.EventType == BoEventTypes.et_CLICK && pVal.ItemUID == "1" && pVal.BeforeAction == false)
                    {
                        Item oItem;
                        Item SNCode;

                        oItem = oForm.Items.Item("8");
                        oText = (SAPbouiCOM.EditText)oItem.Specific;
                        codigo = oText.Value;
                        SAPbouiCOM.EditText oRT = (SAPbouiCOM.EditText)oFormUDF.Items.Item("U_RT").Specific;
                        p_RT = oRT.Value;
                        SAPbouiCOM.EditText oRTa = (SAPbouiCOM.EditText)oFormUDF.Items.Item("U_RTa").Specific;
                        v_RTa = oRTa.Value;



                        //buscamos el numero de remision
                        Recordset oRemi;
                        oRemi = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oRemi.DoQuery("SELECT T0.\"U_ESTA\"||'-'||T0.\"U_PEMI\"||'-'||RIGHT('0000000'||CAST(T0.\"U_FolioNum\" AS CHAR),7)  FROM \"@REMI_CAB\" T0 WHERE T0.\"Code\"='" + codigo + "'");
                        v_AdicionalInfo = oRemi.Fields.Item(0).Value.ToString();
                    }

                    //evento cuando se graba una factura reserva
                    if (pVal.BeforeAction == false && pVal.ActionSuccess == true && pVal.ItemUID == "1" && pVal.FormTypeEx == "60091" && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3)
                    {
                        //mandamos los datos a la set
                        CrearDocumento(codigo, "OINV", "INV1", "1", "FACTURA", "Factura electrónica");
                        v_AdicionalInfo = "";

                        SAPbouiCOM.Form oFormEnt = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.Button oBtnR = (SAPbouiCOM.Button)oFormEnt.Items.Item("btnPDF").Specific;

                        if (!string.IsNullOrEmpty(p_RT))
                        {
                            //realcionamos la orden a la entrega
                            //buscamos el docentry del documento
                            //REMISION TEMPORAL
                            SAPbobsCOM.Recordset oRT;
                            oRT = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oRT.DoQuery("SELECT \"U_FolioPref\",\"U_FolioNum\",\"U_Order\",\"U_DocTotal\",\"U_ESTA\",\"U_PEMI\",\"U_TIMB\" FROM \"@REMI_CAB\" WHERE \"Code\"='" + p_RT + "'");
                            string v_pref = oRT.Fields.Item(0).Value.ToString();
                            int v_folioEnt = int.Parse(oRT.Fields.Item(1).Value.ToString());
                            string v_order = oRT.Fields.Item(2).Value.ToString();
                            string v_totalRT = oRT.Fields.Item(3).Value.ToString();
                            string v_ESTA = oRT.Fields.Item(4).Value.ToString();
                            string v_PEMI = oRT.Fields.Item(5).Value.ToString();
                            string v_TIMB = oRT.Fields.Item(6).Value.ToString();

                            SAPbobsCOM.Recordset oRTDet;
                            oRTDet = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oRTDet.DoQuery("SELECT COUNT(*) FROM \"@REMI_DET\" WHERE \"Code\"='" + p_RT + "'");
                            int v_cant = int.Parse(oRTDet.Fields.Item(0).Value.ToString());


                            //ORDEN DE VENTA
                            SAPbobsCOM.Recordset oEntry;
                            oEntry = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oEntry.DoQuery("SELECT \"DocEntry\",\"DocTotal\" FROM ORDR WHERE \"DocNum\"='" + v_order + "'");
                            int v_DocEntryOV = int.Parse(oEntry.Fields.Item(0).Value.ToString());
                            string v_DocTotalOV = oEntry.Fields.Item(1).Value.ToString();


                            SAPbobsCOM.Recordset oEntryEnt;
                            oEntryEnt = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oEntryEnt.DoQuery("SELECT \"DocEntry\" FROM OINV WHERE \"DocNum\"='" + codigo + "'");
                            int v_EntDE = int.Parse(oEntryEnt.Fields.Item(0).Value.ToString());

                            //si es de una orden a una entrega
                            if (v_RTa.Equals("FACTURA"))
                            {
                                //grabamos el mapa de relaciones
                                SAPbobsCOM.Recordset oUpEnt;
                                oUpEnt = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oUpEnt.DoQuery("UPDATE INV1 SET \"BaseEntry\"='" + v_DocEntryOV + "',\"BaseType\"='17',\"BaseRef\"='" + v_order + "' WHERE \"DocEntry\"='" + v_EntDE + "' ");

                                //verificamos si hay que cerrar la ordern de venta
                                SAPbobsCOM.Recordset oMontos;
                                oMontos = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                oMontos.DoQuery("SELECT SUM(IFNULL(T0.\"DocTotal\",0)) FROM OINV T0 " +
                                                "INNER JOIN INV1 T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                                "INNER JOIN ORDR T2 ON T2.\"DocNum\"=T1.\"BaseRef\" " +
                                                "WHERE T1.\"BaseRef\"='" + v_order + "' AND T0.\"DocStatus\"='O' ");
                                string v_montoET = oMontos.Fields.Item(0).Value.ToString();
                                decimal v_monto = decimal.Parse(v_montoET);
                                decimal v_montoOV = decimal.Parse(v_DocTotalOV);
                                if (v_montoOV == v_monto)
                                {
                                    SAPbobsCOM.Recordset oOV;
                                    oOV = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                                    oOV.DoQuery("UPDATE ORDR SET \"DocStatus\"='C' WHERE \"DocEntry\"='" + v_DocEntryOV + "'");
                                }
                            }


                        }

                        //buscamos el documento creado
                        oForm.Mode = BoFormMode.fm_FIND_MODE;
                        EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("8").Specific;
                        SAPbouiCOM.Button oButton = (SAPbouiCOM.Button)oForm.Items.Item("1").Specific;
                        SAPbouiCOM.Button oPDF = (SAPbouiCOM.Button)oForm.Items.Item("btnPDF").Specific;

                        oDocNum.Value = codigo;
                        oButton.Item.Click();
                        oPDF.Item.Click();
                    }

                    //cambiar de nombre el boton PDF a REENVIAR
                    if (pVal.FormMode == 1 && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.ItemUID == "57")
                    {
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPreview").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM OINV WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O") && (v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO") || v_estadoSet.Equals("")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }

                    }
                    //cambiar el boton buscando un documento
                    if (pVal.FormMode == 0 && pVal.BeforeAction == true && pVal.ItemUID == "1" && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        SAPbouiCOM.Button btnreenviar = (SAPbouiCOM.Button)oForm.Items.Item("btnPreview").Specific;
                        Item oItem;
                        oItem = oForm.Items.Item("8");
                        SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oItem.Specific;
                        string v_docnum = oDocNum.Value;
                        //buscamos los datos del documento
                        SAPbobsCOM.Recordset query;
                        query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        query.DoQuery("SELECT \"DocStatus\",\"FolioNum\",\"U_ESTADO\" FROM OINV WHERE \"DocNum\"=" + v_docnum + " ");
                        if (query.BoF)
                        {
                            //cargamos las variables con los datos buscados
                            string v_estado, v_folio, v_estadoSet;
                            v_estado = query.Fields.Item(0).Value.ToString();
                            v_folio = query.Fields.Item(1).Value.ToString();
                            v_estadoSet = query.Fields.Item(2).Value.ToString();

                            if (v_estado.Equals("O") && (v_estadoSet.Equals("NO PROCESADO") || v_estadoSet.Equals("RECHAZADO") || v_estadoSet.Equals("")))
                            {
                                btnreenviar.Caption = "Re-enviar";
                            }
                            else
                            {
                                btnreenviar.Caption = "PDF";
                            }
                        }
                        else
                        {
                            btnreenviar.Caption = "PDF";
                        }
                    }
                }
                if (pVal.FormTypeEx == "-60091")
                {
                    oFormUDF = oFormUDF = SBO_Application.Forms.Item(FormUID);
                }
                #endregion

                //REMISION TEMPORAL
                #region REMISION TEMPORAL

                if (pVal.FormTypeEx == "UDO_FT_REMI_TEMP" && v_permiso == true)
                {
                    //comprobamos si tiene permiso para abrir el formulario
                    //if (v_permiso == false && pVal.BeforeAction == true && pVal.EventType==BoEventTypes.et_FORM_LOAD)
                    //{
                    //    MessageBox.Show("No posee autorización, comuniquese con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                    //    SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                    //    oForm1.Close();
                    //}
                    //agarramos el codigo del form
                    SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(FormUID);

                    //cargar boton de enviar a remision
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem1;
                        SAPbouiCOM.ButtonCombo oButton1;
                        oItem1 = oForm1.Items.Add("btnEnt", BoFormItemTypes.it_BUTTON_COMBO);
                        //Inicializando el objeto boton con la referencia del objeto item
                        oButton1 = (SAPbouiCOM.ButtonCombo)oItem1.Specific;
                        //Agregando propiedades al boton
                        oButton1.Caption = "Copiar a";
                        oButton1.ValidValues.Add("1", "Entrega");
                        oButton1.ValidValues.Add("2", "Factura res.");
                        oButton1.Item.DisplayDesc = true;
                        //agregando posicio del boton
                        oItem1.Top = oForm1.Height - (oItem1.Height - 180);
                        oItem1.Left = (oItem1.Width + 20) + 60;

                        Item oItem2;
                        SAPbouiCOM.Button oBtnPdf;
                        oItem2 = oForm1.Items.Add("BtnPdf", BoFormItemTypes.it_BUTTON);
                        oBtnPdf = (SAPbouiCOM.Button)oItem2.Specific;
                        oBtnPdf.Caption = "PDF";
                        oItem2.Top = oForm1.Height - (oItem2.Height - 180);
                        oItem2.Left = (oItem2.Width + 20) + 130;
                    }

                    if (pVal.EventType == BoEventTypes.et_FORM_VISIBLE && pVal.BeforeAction == false)
                    {
                        //mandamos las variables a la RT
                        EditText DocNum = (EditText)oForm.Items.Item("0_U_E").Specific;
                        EditText CardCode = (EditText)oForm.Items.Item("14_U_E").Specific;
                        EditText Serie = (EditText)oForm.Items.Item("39_U_E").Specific;
                        Recordset oNewDocEntryRT;
                        oNewDocEntryRT = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oNewDocEntryRT.DoQuery("SELECT MAX(\"DocEntry\")+1 FROM \"@REMI_CAB\" ");
                        string v_NewDocEntryRT = oNewDocEntryRT.Fields.Item(0).Value.ToString();
                        DocNum.Value = v_NewDocEntryRT;
                        CardCode.Item.Click();
                        DocNum.Item.Enabled = false;

                        //SERIE PARA RT
                        Recordset oSerieRT;
                        oSerieRT = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oSerieRT.DoQuery("SELECT \"U_Valor\" FROM \"FG_PROD\".\"@APP_CONFIG\" WHERE \"U_Empresa\"='RT' AND \"Name\"='" + oCompany.UserName + "' ");
                        string v_serieRT = oSerieRT.Fields.Item(0).Value.ToString();
                        Serie.Value = v_serieRT;


                    }

                    //actualizar el total 
                    //if (pVal.ItemUID == "0_U_G"  && pVal.BeforeAction == false && pVal.EventType==BoEventTypes.et_ITEM_PRESSED)
                    //{
                    //    SAPbouiCOM.Matrix MatrixRT = (SAPbouiCOM.Matrix)oForm.Items.Item("0_U_G").Specific;
                    //    EditText oTotal = (EditText)oForm.Items.Item("26_U_E").Specific;
                    //    EditText oTotalIva = (EditText)oForm.Items.Item("27_U_E").Specific;
                    //    int v_rowcount = MatrixRT.RowCount;
                    //    int fila = 1;
                    //    decimal v_total = 0;
                    //    decimal v_imp = 0;
                    //    if (v_rowcount > 0)
                    //    {
                    //        while (fila <= v_rowcount)
                    //        {
                    //            //total del documento
                    //            EditText oPrice = (EditText)MatrixRT.Columns.Item("C_0_9").Cells.Item(fila).Specific;
                    //            string v_Price = oPrice.Value;
                    //            decimal d_price = decimal.Parse(v_Price.Replace(".",","));
                    //            v_total = v_total + d_price;

                    //            //impuesto del documento
                    //            EditText oImpuesto = (EditText)MatrixRT.Columns.Item("C_0_7").Cells.Item(fila).Specific;
                    //            string v_impuesto = oImpuesto.Value;
                    //            decimal d_impuesto = decimal.Parse(v_impuesto.Replace(".", ","));
                    //            v_imp = v_imp + d_impuesto;

                    //            fila++;
                    //        }                               
                    //    }
                    //    oTotal.Value = v_total.ToString().Replace(",",".");
                    //    oTotalIva.Value=v_imp.ToString().Replace(",", ".");
                    //}

                    //agarramos el Code de la RT
                    if (pVal.ItemUID == "1" && pVal.BeforeAction == true && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        EditText oCode = (EditText)oForm.Items.Item("0_U_E").Specific;
                        codigo = oCode.Value;

                    }
                    //enviar documento a la SET
                    if (pVal.ItemUID == "1" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 3 && pVal.ActionSuccess == true)
                    {
                        NotaRemisionGranusa(codigo, "@REMI_CAB", "@REMI_DET");

                        //buscamos el documento creado
                        oForm.Mode = BoFormMode.fm_FIND_MODE;
                        EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("0_U_E").Specific;
                        SAPbouiCOM.Button oButton = (SAPbouiCOM.Button)oForm.Items.Item("1").Specific;
                        SAPbouiCOM.Button oPDF = (SAPbouiCOM.Button)oForm.Items.Item("BtnPdf").Specific;
                        oDocNum.Value = codigo;
                        oButton.Item.Click();
                        oPDF.Item.Click();
                    }

                    //controlar que no se pueda actualizar una vez mandado a la set la RT
                    if (pVal.ItemUID == "1" && pVal.BeforeAction == true && pVal.EventType == BoEventTypes.et_ITEM_PRESSED && pVal.FormMode == 2)
                    {

                        SAPbouiCOM.EditText oFolioRT = (EditText)oForm.Items.Item("18_U_E").Specific;
                        string v_folioRT = oFolioRT.Value;
                        if (!string.IsNullOrEmpty(v_folioRT))
                        {
                            MessageBox.Show("No se puede actualizar una RT enviado a la SET!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            try
                            {
                                oForm.Mode = BoFormMode.fm_OK_MODE;
                                //volvemos a abrir el form
                                //SBO_Application.ActivateMenuItem("47634");//47660
                                SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "REMI_TEMP", "");
                                SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
                                form.Mode = BoFormMode.fm_FIND_MODE;
                                EditText oDocFolio = (SAPbouiCOM.EditText)form.Items.Item("18_U_E").Specific;
                                SAPbouiCOM.Button oButton = (SAPbouiCOM.Button)form.Items.Item("1").Specific;
                                oDocFolio.Value = v_folioRT;
                                oButton.Item.Click();

                            }
                            catch (Exception e)
                            {

                            }
                            return;
                        }

                    }

                    //evento el presionar el boton de PDF
                    if (pVal.ItemUID == "BtnPdf" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED)
                    {
                        //NotaRemisionGranusa("68", "@REMI_CAB", "@REMI_DET");
                        string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                        try
                        {
                            //agarramos el reporte correspondiente
                            SAPbouiCOM.EditText v_code = (SAPbouiCOM.EditText)oForm.Items.Item("0_U_E").Specific;
                            string v_RTCode = v_code.Value;
                            SBO_Application.ActivateMenuItem("48e5cf6611fe409694006658153d381a");
                            SAPbouiCOM.Form formReport = SBO_Application.Forms.ActiveForm;
                            EditText oCodeReport = (EditText)formReport.Items.Item("1000003").Specific;
                            SAPbouiCOM.Button obtnReport = (SAPbouiCOM.Button)formReport.Items.Item("1").Specific;
                            oCodeReport.Value = v_RTCode;
                            obtnReport.Item.Click();

                            //desplegamos el PDF
                            SAPbobsCOM.Recordset query;
                            query = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            query.DoQuery("SELECT \"U_KUDE\" FROM \"@REMI_CAB\" WHERE \"Code\"=" + v_RTCode);

                            string KUDE = query.Fields.Item(0).Value.ToString();
                            byte[] bytes = Convert.FromBase64String(KUDE);
                            //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                            File.Delete(Path.Combine(path + "\\temporal.pdf"));
                            FileStream obj = File.Create(path + "\\temporal.pdf");
                            obj.Write(bytes, 0, bytes.Length);
                            obj.Flush();
                            obj.Close();
                            System.Diagnostics.Process.Start(path + "\\temporal.pdf");
                        }
                        catch (Exception ex)
                        {
                            MessageBox.Show(ex.Message.ToString());
                        }
                    }

                    //evento para levantar el form de Entrega o Factura reserva
                    if (pVal.ItemUID == "btnEnt" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED)
                    {
                        //actualizamos la condicion del SN
                        EditText oCardCode = (EditText)oForm.Items.Item("14_U_E").Specific;
                        EditText oOrden = (EditText)oForm.Items.Item("25_U_E").Specific;
                        string v_cardcode = oCardCode.Value;
                        string v_orden = oOrden.Value;

                        Recordset oCV;
                        oCV = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oCV.DoQuery("SELECT \"GroupNum\" FROM ORDR WHERE \"DocNum\"='" + v_orden + "' ");
                        int v_condicion = int.Parse(oCV.Fields.Item(0).Value.ToString());
                        //funcion para actualizar
                        ActualizarCondi(v_cardcode, v_condicion);

                        //Items del formulario que desplegamos
                        SAPbouiCOM.Form oForm2 = SBO_Application.Forms.Item(FormUID);
                        SAPbouiCOM.ButtonCombo oBtn = (SAPbouiCOM.ButtonCombo)oForm2.Items.Item("btnEnt").Specific;
                        string v_buttonValor = oBtn.Selected.Value.ToString();
                        if (v_buttonValor.Equals("1"))
                        {
                            //desplegamos el formulario de RT
                            //agarramos el numero de orden
                            EditText oOrder = (EditText)oForm.Items.Item("25_U_E").Specific;
                            EditText oCode = (EditText)oForm.Items.Item("0_U_E").Specific;
                            string v_OrderNum = oOrder.Value;
                            string v_Code = oCode.Value;
                            //llamamos al form de entrega
                            SBO_Application.ActivateMenuItem("2051");//47660
                            SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
                            form.Mode = BoFormMode.fm_ADD_MODE;
                            RTaEntrega(form, v_OrderNum, v_Code, oFormUDF);
                        }
                        if (v_buttonValor.Equals("2"))
                        {
                            //agarramos el numero de orden
                            EditText oOrder = (EditText)oForm.Items.Item("25_U_E").Specific;
                            EditText oCode = (EditText)oForm.Items.Item("0_U_E").Specific;
                            string v_OrderNum = oOrder.Value;
                            string v_Code = oCode.Value;
                            //llamamos al form de entrega
                            SBO_Application.ActivateMenuItem("2056");//47660
                            SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
                            RTaReserva(form, v_OrderNum, v_Code, oFormUDF);
                        }

                    }

                    //funcion LINK para el cliente
                    if (pVal.ItemUID == "Item_0" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED)
                    {
                        EditText oCliente = (EditText)oForm.Items.Item("14_U_E").Specific;
                        string v_client = oCliente.Value;

                        //abrimos el form de socio de negocio
                        SBO_Application.OpenForm(BoFormObjectEnum.fo_BusinessPartner, "2", v_client);
                    }

                    //funcion LINK para el transportista
                    if (pVal.ItemUID == "Item_1" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED)
                    {
                        EditText oCliente = (EditText)oForm.Items.Item("33_U_E").Specific;
                        string v_client = oCliente.Value;

                        //abrimos el form de socio de negocio
                        SBO_Application.OpenForm(BoFormObjectEnum.fo_BusinessPartner, "2", v_client);
                    }

                    //funcion para reenviar
                    if (pVal.ItemUID == "Item_2" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_ITEM_PRESSED)
                    {
                        EditText oCode = (EditText)oForm.Items.Item("0_U_E").Specific;
                        codigo = oCode.Value;
                        SAPbouiCOM.EditText oFolio = (SAPbouiCOM.EditText)oForm.Items.Item("18_U_E").Specific;
                        string v_Folio = oFolio.Value;
                        if (v_Folio.Equals("") || v_Folio.Equals("0"))
                        {
                            NotaRemisionGranusa(codigo, "@REMI_CAB", "@REMI_DET");
                        }
                        //buscamos el documento creado
                        oForm.Mode = BoFormMode.fm_FIND_MODE;
                        EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("0_U_E").Specific;
                        SAPbouiCOM.Button oButton = (SAPbouiCOM.Button)oForm.Items.Item("1").Specific;
                        // SAPbouiCOM.Button oPDF = (SAPbouiCOM.Button)oForm.Items.Item("BtnPdf").Specific;
                        oDocNum.Value = codigo;
                        oButton.Item.Click();
                        //oPDF.Item.Click();
                    }
                }

                #endregion

                //FORM VEHICULO
                #region FORM VEHICULO
                if (pVal.FormTypeEx == "2000040")
                {
                    //cargar boton de enviar a remision
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem2;
                        SAPbouiCOM.Button oBtnPdf;
                        oItem2 = oForm1.Items.Add("BtnCrear", BoFormItemTypes.it_BUTTON);
                        oBtnPdf = (SAPbouiCOM.Button)oItem2.Specific;
                        oBtnPdf.Caption = "Nuevo";
                        oItem2.Top = oForm1.Height - (oItem2.Height + 4);
                        oItem2.Left = (oItem2.Width + 20) + 60;
                    }

                    //abrir form de vehiculo
                    if (pVal.ItemUID == "BtnCrear" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        //SBO_Application.ActivateMenuItem("47627");
                        SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "VEHICULOS", "");
                        SAPbouiCOM.Form formReport = SBO_Application.Forms.ActiveForm;
                    }
                }
                #endregion

                //FORM CHOFER
                #region FORM CHOFER
                if (pVal.FormTypeEx == "2000041")
                {
                    //cargar boton de enviar a remision
                    if (pVal.EventType == BoEventTypes.et_FORM_LOAD && pVal.BeforeAction == true)
                    {
                        SAPbouiCOM.Form oForm1 = SBO_Application.Forms.Item(FormUID);
                        Item oItem2;
                        SAPbouiCOM.Button oBtnPdf;
                        oItem2 = oForm1.Items.Add("BtnCrear", BoFormItemTypes.it_BUTTON);
                        oBtnPdf = (SAPbouiCOM.Button)oItem2.Specific;
                        oBtnPdf.Caption = "Nuevo";
                        oItem2.Top = oForm1.Height - (oItem2.Height + 4);
                        oItem2.Left = (oItem2.Width + 20) + 60;
                    }

                    //abrir form de vehiculo
                    if (pVal.ItemUID == "BtnCrear" && pVal.BeforeAction == false && pVal.EventType == BoEventTypes.et_CLICK)
                    {
                        //SBO_Application.ActivateMenuItem("47619");
                        SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "CHOFERES", "");
                        SAPbouiCOM.Form formReport = SBO_Application.Forms.ActiveForm;
                    }
                }
                #endregion



            }
            catch (Exception ex)
            {

                //SBO_Application.StatusBar.SetText("Error General - " + ex.ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //MessageBox.Show(ex.ToString());
                if (oCompany.InTransaction)
                {
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                }
                //}

            }
        }

        #region EVENTOS DEL MENU
        //eventos del menu
        public static void SBO_Application_MenuEvent(ref SAPbouiCOM.MenuEvent pVal, out bool BubbleEvent)
        {
            BubbleEvent = true;
            try
            {
                //visualizar form de anular
                if (pVal.BeforeAction && (pVal.MenuUID == "botonSAP.anular"))
                {
                    if (v_permiso == true)
                    {
                        SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "ANULAR", "");
                    }
                    else
                    {
                        MessageBox.Show("No posee autorización, comuniquese con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                        return;
                    }

            }
                //visualizar form de cancelar
                if (pVal.BeforeAction && (pVal.MenuUID == "botonSAP.cancelar"))
                {
                    if (v_permiso == true)
                    {
                        SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "CANCELAR", "");
                    }
                    else
                    {
                        MessageBox.Show("No posee autorización, comuniquese con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                        return;
                    }

                }
                //viualizar form de auditoria
                if (pVal.BeforeAction && (pVal.MenuUID == "auditoria"))
                {
                    if (v_permiso == true)
                    {
                        SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "AUDITORIAFE", "");
                    }
                    else
                    {
                        MessageBox.Show("No posee autorización, comuniquese con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                        return;
                    }
                }
                //visualizar form de RT
                if (pVal.BeforeAction && (pVal.MenuUID == "RemiTemp"))
                {
                    if (v_permiso == true)
                    {
                        SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "REMI_TEMP", "");
                    }
                    else
                    {
                        MessageBox.Show("No posee autorización, comuniquese con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                        return;
                    }
                }
                //viualizar form de inutilizar
                if (pVal.BeforeAction && (pVal.MenuUID == "inutilizar"))
                {
                    if (v_permiso == true)
                    {
                        SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "INUTILIZAR", "");
                    }
                    else
                    {
                        MessageBox.Show("No posee autorización, comuniquese con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                        return;
                    }
                }
                //visualizar form de numeracion
                if (pVal.BeforeAction && (pVal.MenuUID == "numeracion"))
                {
                    if (v_permiso == true)
                    {
                        SBO_Application.OpenForm(BoFormObjectEnum.fo_UserDefinedObject, "NUMERACION", "");
                    }
                    else
                    {
                        MessageBox.Show("No posee autorización, comuniquese con el administrador!!", "Atención", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                        return;
                    }
                }


            }
            catch (Exception ex)
            {

            }
        }
        #endregion

        #region FUNCIONES
        //funcion para consultar al web servce de Efirma
        private static void CrearDocumento(string codigo, string tablacab, string tabladet, string documento, string template, string descdoc)
        {
            try
            {
                //BasicHttpBinding httpBinding = new BasicHttpBinding();
                //httpBinding.MaxReceivedMessageSize = Int32.MaxValue;
                //httpBinding.MaxBufferSize = Int32.MaxValue;

                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //consultamos cual direccion se eligio              

                #region QUERY DOCUMENTO
                //if (!string.IsNullOrEmpty(direPay))
                //{

                //    //GRANUSA
                //    oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                //                   "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                //                   "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                //                   "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                //                   "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                //                   "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)   " +
                //                   "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                //                   "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                //                   "T0.\"U_TRANSPORTISTA\",T12.\"U_Nombre\"||','||T12.\"U_Apellido\",CASE WHEN T11.\"U_CHAPA_CARRE\" IS NULL THEN  T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END ,T11.\"U_MARCA\",T12.\"U_Documento\",T12.\"U_Direccion\",T13.\"U_SET_FE\", " +
                //                   "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                //                   "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                //                   "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\"  " +
                //                   "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                //                   "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                //                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                //                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                //                   "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                //                   "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                //                   "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                //                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                //                   "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                //                   "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                //                   "LEFT JOIN \"@CHOFERES\" T12 ON T12.\"Code\"=T0.\"U_CHOFERES\" " +
                //                   //"LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                //                   "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                //                   "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                //                   "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                //                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                //                   "WHERE T0.\"DocNum\"='" + codigo + "'");
                //    // }
                //}
                if (!string.IsNullOrEmpty(direPay))
                {

                    //GRANUSA
                    oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                   "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                   "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                   "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                   "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                   "T0.\"U_TRANSPORTISTA\",T12.\"U_Nombre\"||','||T12.\"U_Apellido\",CASE WHEN T11.\"U_CHAPA_CARRE\" IS NULL THEN  T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T12.\"U_Documento\",T12.\"U_Direccion\",T13.\"U_SET_FE\", " +
                                   "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                   "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                   "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\",T2.\"E_Mail\"  " +
                                   "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                   "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                   "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                   "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                   "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                   "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                   "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                   "LEFT JOIN \"@CHOFERES\" T12 ON T12.\"Code\"=T0.\"U_CHOFERES\" " +
                                   //"LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                   "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                   "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                   "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                   "WHERE T0.\"DocNum\"='" + codigo + "'");
                    // }
                }
                #endregion

                string Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(46).Value.ToString();
                string rec_dist = oDatos.Fields.Item(47).Value.ToString();
                string rec_loc = oDatos.Fields.Item(48).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(49).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string RespFlete = oDatos.Fields.Item(50).Value.ToString();
                string CodLicitacion = oDatos.Fields.Item(51).Value.ToString();
                string transId = oDatos.Fields.Item(52).Value.ToString();
                string infoadicional = oDatos.Fields.Item(53).Value.ToString();

                string direccionRec = oDatos.Fields.Item(5).Value.ToString();
                string correo = oDatos.Fields.Item(58).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                //actualizamos el folio de la factura
                Recordset oActUDF;
                oActUDF = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oActUDF.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"U_TIMB\"='" + timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                // //actualizamos la numeracion de la serie           
                // Recordset oActSerie;
                // oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());         
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                    //instaciamos los objetos que vutilizaremos
                }

                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[2];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                //linea 36
                servicio.gCamItem gCamItem36 = new servicio.gCamItem();
                servicio.gValorItem gValorItem36 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem36 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA36 = new servicio.gCamIVA();
                //linea 37
                servicio.gCamItem gCamItem37 = new servicio.gCamItem();
                servicio.gValorItem gValorItem37 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem37 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA37 = new servicio.gCamIVA();
                //linea 38
                servicio.gCamItem gCamItem38 = new servicio.gCamItem();
                servicio.gValorItem gValorItem38 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem38 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA38 = new servicio.gCamIVA();
                //linea 39
                servicio.gCamItem gCamItem39 = new servicio.gCamItem();
                servicio.gValorItem gValorItem39 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem39 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA39 = new servicio.gCamIVA();
                //linea 40
                servicio.gCamItem gCamItem40 = new servicio.gCamItem();
                servicio.gValorItem gValorItem40 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem40 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA40 = new servicio.gCamIVA();
                //linea 41
                servicio.gCamItem gCamItem41 = new servicio.gCamItem();
                servicio.gValorItem gValorItem41 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem41 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA41 = new servicio.gCamIVA();
                //linea 42
                servicio.gCamItem gCamItem42 = new servicio.gCamItem();
                servicio.gValorItem gValorItem42 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem42 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA42 = new servicio.gCamIVA();
                //linea 43
                servicio.gCamItem gCamItem43 = new servicio.gCamItem();
                servicio.gValorItem gValorItem43 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem43 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA43 = new servicio.gCamIVA();
                //linea 44
                servicio.gCamItem gCamItem44 = new servicio.gCamItem();
                servicio.gValorItem gValorItem44 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem44 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA44 = new servicio.gCamIVA();
                //linea 45
                servicio.gCamItem gCamItem45 = new servicio.gCamItem();
                servicio.gValorItem gValorItem45 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem45 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA45 = new servicio.gCamIVA();
                #endregion
                #endregion

                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                string oper = oDatos.Fields.Item(25).Value.ToString();
                if (!string.IsNullOrEmpty(infoadicional))
                {
                    gOpeDE.dInfoEmi = infoadicional;
                }
                //gTimb
                gTimb.iTiDE = documento;
                gTimb.dDesTiDE = descdoc;
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }

                if (tablacab.Equals("OINV"))
                {
                    gOpeCom.iTipTra = TipTra;// oDatos.Fields.Item(23).Value.ToString();
                    gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                }
                
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";
                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                    gOpeCom.dTiCamSpecified = true;
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                if (oDatos.Fields.Item(26).Value.ToString() == "2")
                {
                    gDatRec.iTiOpe = "2";
                    //gDatRec.iTiContRec = "1";
                }
                else
                {
                    gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                }
                if (!string.IsNullOrEmpty(correo))
                {
                    gDatRec.dEmailRec = correo;
                }              
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //validad si el pais esta vacio, enviar PRY por defecto
                string pais = oDatos.Fields.Item(16).Value.ToString();
                if (string.IsNullOrEmpty(pais))
                {
                    gDatRec.cPaisRec = "PRY";
                }
                else
                {
                    gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                }

                //gDatRec.dDesPaisRe = "Paraguay";

                if (tablacab.Equals("ORIN"))
                {
                    gCamNCDE.iMotEmi = "1";//hay que modificar
                }
                //si es contribuyente le pasamos el ruc sino la cedula
                if (oDatos.Fields.Item(26).Value.ToString() == "1" || oDatos.Fields.Item(26).Value.ToString() == "3")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }
                else
                {
                    gDatRec.dNumIDRec = oDatos.Fields.Item(4).Value.ToString();
                    gDatRec.iTipIDRec = "1";
                }

                if (tablacab.Equals("OINV"))
                {
                    //REMITO
                    #region REMITO
                    if (!string.IsNullOrEmpty(trans))
                    {
                        string chof = oDatos.Fields.Item(32).Value.ToString();
                        if (!chof.Equals("PERSONAL"))
                        {
                            string CedChofer = oDatos.Fields.Item(35).Value.ToString();
                            if (!string.IsNullOrEmpty(CedChofer))
                            {
                                string dirReceptor = oDatos.Fields.Item(5).Value.ToString();
                                string NewDirRec = null;
                                if (!Regex.IsMatch(dirReceptor, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    NewDirRec = Regex.Replace(dirReceptor, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    NewDirRec = dirReceptor;

                                }
                                string salDire = oDatos.Fields.Item(37).Value.ToString();
                                string newsalDire = null;
                                if (!Regex.IsMatch(salDire, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newsalDire = Regex.Replace(salDire, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newsalDire = salDire;

                                }
                                string DomFiscal = oDatos.Fields.Item(42).Value.ToString();
                                string newDomFiscal = null;
                                if (!Regex.IsMatch(DomFiscal, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newDomFiscal = Regex.Replace(DomFiscal, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newDomFiscal = DomFiscal;

                                }
                                string DireChofer = oDatos.Fields.Item(36).Value.ToString();
                                string newDireChofer = null;
                                if (!Regex.IsMatch(DireChofer, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newDireChofer = Regex.Replace(DireChofer, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newDireChofer = DireChofer;

                                }
                                string codTransp = null;
                                string descTrans = null;
                                if (oDatos.Fields.Item(38).Value.ToString() == varE)
                                {
                                    codTransp = "1";
                                    descTrans = "Propio";
                                }
                                else
                                {
                                    codTransp = "2";
                                    descTrans = "Tercero";
                                }
                                gDatRec.dDirRec = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                                gDatRec.dNumCasRec = "0";
                                gDatRec.cDepRec = rec_dep;
                                gDatRec.cDisRec = rec_dist;
                                gDatRec.cCiuRec = rec_loc;
                                //gCamSal               
                                gCamSal.dDirLocSal = newsalDire;// oDatos.Fields.Item(37).Value.ToString();
                                gCamSal.dNumCasSal = "0";
                                //gCamSal.dComp1Sal =  "aviadores del chaco";
                                gCamSal.cDepSal = sal_dep;
                                gCamSal.cCiuSal = sal_loc;
                                gCamSal.cDisSal = sal_dist;
                                //gCamEnt
                                gCamEnt.dDirLocEnt = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                                gCamEnt.dNumCasEnt = "0";
                                gCamEnt.cDepEnt = rec_dep;
                                gCamEnt.cCiuEnt = rec_loc;
                                gCamEnt.cDisEnt = rec_dist;
                                gCamEnt1[0] = gCamEnt;
                                gTransp.iTipTrans = codTransp;// "2";
                                gTransp.dDesTipTrans = descTrans;// "Tercero";
                                gTransp.iModTrans = "1";
                                gTransp.iRespFlete = RespFlete;
                                gTransp.dIniTras = fe;
                                gTransp.dIniTrasSpecified = true;
                                gTransp.dFinTras = fe;
                                gTransp.dFinTrasSpecified = true;
                                //gVehTras
                                //gTransp.gVehTras = gVehTras1;
                                gVehTras1[0] = gVehTras;
                                gVehTras.dTiVehTras = "Terrestre";
                                gVehTras.dMarVeh = oDatos.Fields.Item(34).Value.ToString();
                                gVehTras.dTipIdenVeh = "2";
                                gVehTras.dNroMatVeh = oDatos.Fields.Item(33).Value.ToString();
                                //gCamTrans
                                gCamTrans.iNatTrans = oDatos.Fields.Item(40).Value.ToString();
                                gCamTrans.dNomTrans = oDatos.Fields.Item(39).Value.ToString();
                                //deconstruimos el RUC del transportista
                                string varCam = oDatos.Fields.Item(38).Value.ToString();
                                int indexCam = varCam.IndexOf("-");
                                int canCam = oDatos.Fields.Item(38).Value.ToString().Length;
                                string rucCam = oDatos.Fields.Item(38).Value.ToString().Remove(indexCam, canCam - indexCam);
                                string dvCam = oDatos.Fields.Item(38).Value.ToString().Remove(0, indexCam + 1);
                                gCamTrans.dRucTrans = rucCam;
                                gCamTrans.dDVTrans = dvCam;
                                gCamTrans.cNacTrans = oDatos.Fields.Item(43).Value.ToString();
                                gCamTrans.dDesNacTrans = oDatos.Fields.Item(44).Value.ToString();
                                gCamTrans.dDomFisc = newDomFiscal;// oDatos.Fields.Item(42).Value.ToString();
                                gCamTrans.dNumIDChof = oDatos.Fields.Item(35).Value.ToString();
                                gCamTrans.dNomChof = oDatos.Fields.Item(32).Value.ToString();
                                gCamTrans.dDirChof = newDireChofer;// oDatos.Fields.Item(36).Value.ToString();
                                                                   //gCamNRE
                                                                   //gCamNRE.iMotEmiNR = "1";
                                                                   //gCamNRE.dDesMotEmiNR = "Traslado por ventas";
                                                                   //gCamNRE.iRespEmiNR = "1";
                                                                   //gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                                gCamNRE.dKmR = "3";
                                //gDtipDE.gCamNRE = gCamNRE;
                                gTransp.gCamTrans = gCamTrans;
                                gTransp.gCamSal = gCamSal;
                                gTransp.gCamEnt = gCamEnt1;
                                gTransp.gVehTras = gVehTras1;
                                gDtipDE.gTransp = gTransp;
                            }

                        }


                    }
                    #endregion
                }

                //LICITACION
                #region LICITACION
                if (oDatos.Fields.Item(25).Value.ToString() == "3")
                {
                    Recordset oLicitacion;
                    oLicitacion = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oLicitacion.DoQuery("SELECT \"U_dModCont\",\"U_dEntCont\",\"U_dAnoCont\",\"U_dSecCont\",\"U_dFeCodCont\" FROM \"@LICITACION\" WHERE \"U_LICI\"='" + CodLicitacion + "'");

                    gCompPub.dModCont = oLicitacion.Fields.Item(0).Value.ToString();//"LP";
                    gCompPub.dEntCont = oLicitacion.Fields.Item(1).Value.ToString(); //"12009";
                    gCompPub.dAnoCont = oLicitacion.Fields.Item(2).Value.ToString(); //"22";
                    int sec = int.Parse(oLicitacion.Fields.Item(3).Value.ToString());
                    gCompPub.dSecCont = sec.ToString("D7");// oLicitacion.Fields.Item(3).Value.ToString(); //"218529";
                    DateTime v_fechaLic = DateTime.Parse(oLicitacion.Fields.Item(4).Value.ToString());
                    string fechalic_v = v_fechaLic.ToString("yyyy-MM-dd");
                    gCompPub.dFeCodCont = DateTime.Parse(fechalic_v);//DateTime.Parse("2022-08-31");
                    gCompPub.dFeCodContSpecified = true;
                    gCamFE.gCompPub = gCompPub;
                    //gDtipDE.gCamFE = gCamFE;
                }
                #endregion



                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                                                                         //gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                                                                         //gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //gDatRec.dCelRec = "0981888493";
                                                                         //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                if (tablacab.Equals("OINV"))
                {
                    //gCamFE
                    gCamFE.iIndPres = oDatos.Fields.Item(22).Value.ToString();
                    //gCamCond
                    gCamCond.iCondOpe = oDatos.Fields.Item(9).Value.ToString(); //"2";               

                    if (oDatos.Fields.Item(9).Value.ToString() == "2")
                    {
                        //consultamos si el campo de cuota es mayor a cero
                        int Cuota = int.Parse(oDatos.Fields.Item(20).Value.ToString());
                        string concred = null;
                        if (Cuota > 0)
                        {
                            concred = "2";
                        }
                        else
                        {
                            concred = "1";
                        }
                        if (concred.Equals("2"))
                        {
                            gPagCred.dCuotas = Cuota.ToString();
                            gPagCred.iCondCred = concred;
                        }
                        else
                        {
                            //gPagCred
                            int plazo = int.Parse(oDatos.Fields.Item(10).Value.ToString());
                            gPagCred.dPlazoCre = plazo.ToString("D2");//oDatos.Fields.Item(10).Value.ToString(); //"12";
                            gPagCred.iCondCred = concred;
                        }
                    }
                }
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                    {
                        gPaConEIni.dTiCamTiPag = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                        gPaConEIni.dTiCamTiPagSpecified = true;
                    }
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                //gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto

                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //convertir el decimall a int
                int v_deciGR = int.Parse(v_DecimalGR);
                string v_monedaDoc = oDatos.Fields.Item(8).Value.ToString();
                while (!oDatos.EoF)
                {
                    //calculo para la gravada e iva
                    decimal c_gravada10 = Math.Round(decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()))) / decimal.Parse("1,1"));
                    decimal c_iva10 = Math.Round(decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"))));
                    decimal c_gravada5 = Math.Round(decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()))) / decimal.Parse("1,05"));
                    decimal c_iva5 = Math.Round(decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"))));

                    #region DETALLE DOCUMENTO
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem

                        string pp = oDatos.Fields.Item(14).Value.ToString();
                        gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem.dDescItem = 0;
                            gValorRestaItem.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem.dDescItem = 0;
                            gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        //gValorItem
                        //gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        //gValorRestaItem.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;
                        //gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA.iAfecIVA = "1";
                            gCamIVA.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = c_gravada10;// Math.Round(decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()))) / decimal.Parse("1,1"));
                                    gCamIVA.dLiqIVAItem = c_iva10;//Math.Round(decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"))));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA.dBasGravIVA = c_gravada5;// Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA.iAfecIVA = "3";
                            gCamIVA.dBasGravIVA = 0;
                            gCamIVA.dLiqIVAItem = 0;
                        }
                        gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem.gValorRestaItem = gValorRestaItem;
                        gCamItem.gValorItem = gValorItem;
                        gCamItem.gCamIVA = gCamIVA;
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem2.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem2.dDncpG = dncpNum.ToString();
                        }

                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem2.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem2.dDescItem = 0;
                            gValorRestaItem2.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem2.dDescItem = 0;
                            gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem                       
                        //gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA2.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA2.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA2.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA2.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA2.iAfecIVA = "3";
                            gCamIVA2.dBasGravIVA = 0;
                            gCamIVA2.dLiqIVAItem = 0;
                        }
                        gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem2.gValorRestaItem = gValorRestaItem2;
                        gCamItem2.gValorItem = gValorItem2;
                        gCamItem2.gCamIVA = gCamIVA2;
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {
                        gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem3.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem3.dDncpG = dncpNum.ToString();
                        }

                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem3.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem3.dDescItem = 0;
                            gValorRestaItem3.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem3.dDescItem = 0;
                            gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem3.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA3.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA3.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA3.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA3.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA3.iAfecIVA = "3";
                            gCamIVA3.dBasGravIVA = 0;
                            gCamIVA3.dLiqIVAItem = 0;
                        }
                        gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem3.gValorRestaItem = gValorRestaItem3;
                        gCamItem3.gValorItem = gValorItem3;
                        gCamItem3.gCamIVA = gCamIVA3;
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem4.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem4.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem4.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem4.dDescItem = 0;
                            gValorRestaItem4.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem4.dDescItem = 0;
                            gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem4.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA4.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA4.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA4.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA4.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA4.iAfecIVA = "3";
                            gCamIVA4.dBasGravIVA = 0;
                            gCamIVA4.dLiqIVAItem = 0;
                        }
                        gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem4.gValorRestaItem = gValorRestaItem4;
                        gCamItem4.gValorItem = gValorItem4;
                        gCamItem4.gCamIVA = gCamIVA4;
                        gCamItem1[f] = gCamItem4;
                    }
                    if (f == 4)
                    {
                        gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem5.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem5.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem5.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem5.dDescItem = 0;
                            gValorRestaItem5.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem5.dDescItem = 0;
                            gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem5.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA5.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA5.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA5.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA5.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA5.iAfecIVA = "3";
                            gCamIVA5.dBasGravIVA = 0;
                            gCamIVA5.dLiqIVAItem = 0;
                        }
                        gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem5.gValorRestaItem = gValorRestaItem5;
                        gCamItem5.gValorItem = gValorItem5;
                        gCamItem5.gCamIVA = gCamIVA5;
                        gCamItem1[f] = gCamItem5;
                    }
                    if (f == 5)
                    {
                        gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem6.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem6.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem6.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem6.dDescItem = 0;
                            gValorRestaItem6.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem6.dDescItem = 0;
                            gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem6.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA6.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA6.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA6.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA6.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA6.iAfecIVA = "3";
                            gCamIVA6.dBasGravIVA = 0;
                            gCamIVA6.dLiqIVAItem = 0;
                        }
                        gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem6.gValorRestaItem = gValorRestaItem6;
                        gCamItem6.gValorItem = gValorItem6;
                        gCamItem6.gCamIVA = gCamIVA6;
                        gCamItem1[f] = gCamItem6;
                    }
                    if (f == 6)
                    {
                        gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem7.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem7.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem7.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem7.dDescItem = 0;
                            gValorRestaItem7.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem7.dDescItem = 0;
                            gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem7.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA7.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA7.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA7.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA7.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA7.iAfecIVA = "3";
                            gCamIVA7.dBasGravIVA = 0;
                            gCamIVA7.dLiqIVAItem = 0;
                        }
                        gCamIVA7.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem7.gValorRestaItem = gValorRestaItem7;
                        gCamItem7.gValorItem = gValorItem7;
                        gCamItem7.gCamIVA = gCamIVA7;
                        gCamItem1[f] = gCamItem7;
                    }
                    if (f == 7)
                    {
                        gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem8.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem8.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem8.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem8.dDescItem = 0;
                            gValorRestaItem8.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem8.dDescItem = 0;
                            gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem8.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA8.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA8.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA8.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA8.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA8.iAfecIVA = "3";
                            gCamIVA8.dBasGravIVA = 0;
                            gCamIVA8.dLiqIVAItem = 0;
                        }
                        gCamIVA8.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem8.gValorRestaItem = gValorRestaItem8;
                        gCamItem8.gValorItem = gValorItem8;
                        gCamItem8.gCamIVA = gCamIVA8;
                        gCamItem1[f] = gCamItem8;
                    }
                    if (f == 8)
                    {
                        gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem9.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem9.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem9.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem9.dDescItem = 0;
                            gValorRestaItem9.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem9.dDescItem = 0;
                            gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem9.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA9.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA9.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA9.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA9.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA9.iAfecIVA = "3";
                            gCamIVA9.dBasGravIVA = 0;
                            gCamIVA9.dLiqIVAItem = 0;
                        }
                        gCamIVA9.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem9.gValorRestaItem = gValorRestaItem9;
                        gCamItem9.gValorItem = gValorItem9;
                        gCamItem9.gCamIVA = gCamIVA9;
                        gCamItem1[f] = gCamItem9;
                    }
                    if (f == 9)
                    {
                        gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem10.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem10.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem10.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem10.dDescItem = 0;
                            gValorRestaItem10.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem10.dDescItem = 0;
                            gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem10.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA10.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA10.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA10.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA10.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA10.iAfecIVA = "3";
                            gCamIVA10.dBasGravIVA = 0;
                            gCamIVA10.dLiqIVAItem = 0;
                        }
                        gCamIVA10.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem10.gValorRestaItem = gValorRestaItem10;
                        gCamItem10.gValorItem = gValorItem10;
                        gCamItem10.gCamIVA = gCamIVA10;
                        gCamItem1[f] = gCamItem10;
                    }
                    if (f == 10)
                    {
                        gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem11.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem11.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem11.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem11.dDescItem = 0;
                            gValorRestaItem11.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem11.dDescItem = 0;
                            gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        //gValorItem
                        //gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        //gValorRestaItem11.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;
                        //gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA11.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA11.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA11.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA11.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA11.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA11.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA11.iAfecIVA = "3";
                            gCamIVA11.dBasGravIVA = 0;
                            gCamIVA11.dLiqIVAItem = 0;
                        }
                        gCamIVA11.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem11.gValorRestaItem = gValorRestaItem11;
                        gCamItem11.gValorItem = gValorItem11;
                        gCamItem11.gCamIVA = gCamIVA11;
                        gCamItem1[f] = gCamItem11;
                    }
                    if (f == 11)
                    {
                        gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem12.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem12.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem12.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem12.dDescItem = 0;
                            gValorRestaItem12.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem12.dDescItem = 0;
                            gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem12.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA12.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA12.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA12.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA12.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA12.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA12.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA12.iAfecIVA = "3";
                            gCamIVA12.dBasGravIVA = 0;
                            gCamIVA12.dLiqIVAItem = 0;
                        }
                        gCamIVA12.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem12.gValorRestaItem = gValorRestaItem12;
                        gCamItem12.gValorItem = gValorItem12;
                        gCamItem12.gCamIVA = gCamIVA12;
                        gCamItem1[f] = gCamItem12;
                    }
                    if (f == 12)
                    {
                        gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem13.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem13.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem13.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem13.dDescItem = 0;
                            gValorRestaItem13.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem13.dDescItem = 0;
                            gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem13.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA13.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA13.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA13.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA13.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA13.dLiqIVAItem = c_iva5; Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA13.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA13.iAfecIVA = "3";
                            gCamIVA13.dBasGravIVA = 0;
                            gCamIVA13.dLiqIVAItem = 0;
                        }
                        gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem13.gValorRestaItem = gValorRestaItem13;
                        gCamItem13.gValorItem = gValorItem13;
                        gCamItem13.gCamIVA = gCamIVA13;
                        gCamItem1[f] = gCamItem13;
                    }
                    if (f == 13)
                    {
                        gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem14.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem14.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem14.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem14.dDescItem = 0;
                            gValorRestaItem14.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem14.dDescItem = 0;
                            gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem14.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA14.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA14.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA14.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA14.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA14.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA14.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA14.iAfecIVA = "3";
                            gCamIVA14.dBasGravIVA = 0;
                            gCamIVA14.dLiqIVAItem = 0;
                        }
                        gCamIVA14.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem14.gValorRestaItem = gValorRestaItem14;
                        gCamItem14.gValorItem = gValorItem14;
                        gCamItem14.gCamIVA = gCamIVA14;
                        gCamItem1[f] = gCamItem14;
                    }
                    if (f == 14)
                    {
                        gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem15.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem15.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem15.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem15.dDescItem = 0;
                            gValorRestaItem15.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem15.dDescItem = 0;
                            gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem15.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA15.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA15.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA15.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA15.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA15.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA15.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA15.iAfecIVA = "3";
                            gCamIVA15.dBasGravIVA = 0;
                            gCamIVA15.dLiqIVAItem = 0;
                        }
                        gCamIVA15.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem15.gValorRestaItem = gValorRestaItem15;
                        gCamItem15.gValorItem = gValorItem15;
                        gCamItem15.gCamIVA = gCamIVA15;
                        gCamItem1[f] = gCamItem15;
                    }
                    if (f == 15)
                    {
                        gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem16.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem16.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem16.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem16.dDescItem = 0;
                            gValorRestaItem16.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem16.dDescItem = 0;
                            gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem16.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA16.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA16.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA16.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA16.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA16.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA16.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA16.iAfecIVA = "3";
                            gCamIVA16.dBasGravIVA = 0;
                            gCamIVA16.dLiqIVAItem = 0;
                        }
                        gCamIVA16.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem16.gValorRestaItem = gValorRestaItem16;
                        gCamItem16.gValorItem = gValorItem16;
                        gCamItem16.gCamIVA = gCamIVA16;
                        gCamItem1[f] = gCamItem16;
                    }
                    if (f == 16)
                    {
                        gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem17.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem17.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem17.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem17.dDescItem = 0;
                            gValorRestaItem17.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem17.dDescItem = 0;
                            gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem17.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA17.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA17.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA17.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA17.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA17.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA17.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA17.iAfecIVA = "3";
                            gCamIVA17.dBasGravIVA = 0;
                            gCamIVA17.dLiqIVAItem = 0;
                        }
                        gCamIVA17.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem17.gValorRestaItem = gValorRestaItem17;
                        gCamItem17.gValorItem = gValorItem17;
                        gCamItem17.gCamIVA = gCamIVA17;
                        gCamItem1[f] = gCamItem17;
                    }
                    if (f == 17)
                    {
                        gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem18.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem18.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem18.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem18.dDescItem = 0;
                            gValorRestaItem18.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem18.dDescItem = 0;
                            gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem18.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA18.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA18.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA18.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA18.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA18.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA18.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA18.iAfecIVA = "3";
                            gCamIVA18.dBasGravIVA = 0;
                            gCamIVA18.dLiqIVAItem = 0;
                        }
                        gCamIVA18.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem18.gValorRestaItem = gValorRestaItem18;
                        gCamItem18.gValorItem = gValorItem18;
                        gCamItem18.gCamIVA = gCamIVA18;
                        gCamItem1[f] = gCamItem18;
                    }
                    if (f == 18)
                    {
                        gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());                                                                                 //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem19.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem19.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem19.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem19.dDescItem = 0;
                            gValorRestaItem19.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem19.dDescItem = 0;
                            gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem19.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA19.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA19.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA19.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA19.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA19.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA19.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA19.iAfecIVA = "3";
                            gCamIVA19.dBasGravIVA = 0;
                            gCamIVA19.dLiqIVAItem = 0;
                        }
                        gCamIVA19.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem19.gValorRestaItem = gValorRestaItem19;
                        gCamItem19.gValorItem = gValorItem19;
                        gCamItem19.gCamIVA = gCamIVA19;
                        gCamItem1[f] = gCamItem19;
                    }
                    if (f == 19)
                    {
                        gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem20.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem20.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem20.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem20.dDescItem = 0;
                            gValorRestaItem20.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem20.dDescItem = 0;
                            gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem20.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA20.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA20.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA20.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA20.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA20.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA20.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA20.iAfecIVA = "3";
                            gCamIVA20.dBasGravIVA = 0;
                            gCamIVA20.dLiqIVAItem = 0;
                        }
                        gCamIVA20.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem20.gValorRestaItem = gValorRestaItem20;
                        gCamItem20.gValorItem = gValorItem20;
                        gCamItem20.gCamIVA = gCamIVA20;
                        gCamItem1[f] = gCamItem20;
                    }
                    if (f == 20)
                    {
                        gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem21.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem21.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem21.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem21.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA21.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA21.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA21.iAfecIVA = "3";
                            gCamIVA21.dBasGravIVA = 0;
                            gCamIVA21.dLiqIVAItem = 0;
                        }
                        gCamIVA21.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem21.gValorRestaItem = gValorRestaItem21;
                        gCamItem21.gValorItem = gValorItem21;
                        gCamItem21.gCamIVA = gCamIVA21;
                        gCamItem1[f] = gCamItem21;
                    }
                    if (f == 21)
                    {
                        gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem22.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem22.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem22.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem22.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA22.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA22.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA22.iAfecIVA = "3";
                            gCamIVA22.dBasGravIVA = 0;
                            gCamIVA22.dLiqIVAItem = 0;
                        }
                        gCamIVA22.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem22.gValorRestaItem = gValorRestaItem22;
                        gCamItem22.gValorItem = gValorItem22;
                        gCamItem22.gCamIVA = gCamIVA22;
                        gCamItem1[f] = gCamItem22;
                    }
                    if (f == 22)
                    {
                        gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem23.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem23.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem23.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem23.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA23.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA23.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA23.iAfecIVA = "3";
                            gCamIVA23.dBasGravIVA = 0;
                            gCamIVA23.dLiqIVAItem = 0;
                        }
                        gCamIVA23.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem23.gValorRestaItem = gValorRestaItem23;
                        gCamItem23.gValorItem = gValorItem23;
                        gCamItem23.gCamIVA = gCamIVA23;
                        gCamItem1[f] = gCamItem23;
                    }
                    if (f == 23)
                    {
                        gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem24.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem24.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem24.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem24.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA24.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA24.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA24.iAfecIVA = "3";
                            gCamIVA24.dBasGravIVA = 0;
                            gCamIVA24.dLiqIVAItem = 0;
                        }
                        gCamIVA24.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem24.gValorRestaItem = gValorRestaItem24;
                        gCamItem24.gValorItem = gValorItem24;
                        gCamItem24.gCamIVA = gCamIVA24;
                        gCamItem1[f] = gCamItem24;
                    }
                    if (f == 24)
                    {
                        gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem25.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem25.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem25.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem25.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA25.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA25.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA25.iAfecIVA = "3";
                            gCamIVA25.dBasGravIVA = 0;
                            gCamIVA25.dLiqIVAItem = 0;
                        }
                        gCamIVA25.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem25.gValorRestaItem = gValorRestaItem25;
                        gCamItem25.gValorItem = gValorItem25;
                        gCamItem25.gCamIVA = gCamIVA25;
                        gCamItem1[f] = gCamItem25;
                    }
                    if (f == 25)
                    {
                        gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem26.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem26.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem26.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem26.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA26.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA26.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA26.iAfecIVA = "3";
                            gCamIVA26.dBasGravIVA = 0;
                            gCamIVA26.dLiqIVAItem = 0;
                        }
                        gCamIVA26.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem26.gValorRestaItem = gValorRestaItem26;
                        gCamItem26.gValorItem = gValorItem26;
                        gCamItem26.gCamIVA = gCamIVA26;
                        gCamItem1[f] = gCamItem26;
                    }
                    if (f == 26)
                    {
                        gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem27.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem27.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem27.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem27.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA27.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA27.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA27.iAfecIVA = "3";
                            gCamIVA27.dBasGravIVA = 0;
                            gCamIVA27.dLiqIVAItem = 0;
                        }
                        gCamIVA27.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem27.gValorRestaItem = gValorRestaItem27;
                        gCamItem27.gValorItem = gValorItem27;
                        gCamItem27.gCamIVA = gCamIVA27;
                        gCamItem1[f] = gCamItem27;
                    }
                    if (f == 27)
                    {
                        gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem28.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem28.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem28.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem28.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA28.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA28.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA28.iAfecIVA = "3";
                            gCamIVA28.dBasGravIVA = 0;
                            gCamIVA28.dLiqIVAItem = 0;
                        }
                        gCamIVA28.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem28.gValorRestaItem = gValorRestaItem28;
                        gCamItem28.gValorItem = gValorItem28;
                        gCamItem28.gCamIVA = gCamIVA28;
                        gCamItem1[f] = gCamItem28;
                    }
                    if (f == 28)
                    {
                        gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem29.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem29.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem29.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem29.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA29.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA29.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA29.iAfecIVA = "3";
                            gCamIVA29.dBasGravIVA = 0;
                            gCamIVA29.dLiqIVAItem = 0;
                        }
                        gCamIVA29.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem29.gValorRestaItem = gValorRestaItem29;
                        gCamItem29.gValorItem = gValorItem29;
                        gCamItem29.gCamIVA = gCamIVA29;
                        gCamItem1[f] = gCamItem29;
                    }
                    if (f == 29)
                    {
                        gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem30.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem30.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem30.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem30.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA30.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA30.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA30.iAfecIVA = "3";
                            gCamIVA30.dBasGravIVA = 0;
                            gCamIVA30.dLiqIVAItem = 0;
                        }
                        gCamIVA30.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem30.gValorRestaItem = gValorRestaItem30;
                        gCamItem30.gValorItem = gValorItem30;
                        gCamItem30.gCamIVA = gCamIVA30;
                        gCamItem1[f] = gCamItem30;
                    }
                    if (f == 30)
                    {
                        gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem31.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem31.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem31.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem31.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA31.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA31.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA31.iAfecIVA = "3";
                            gCamIVA31.dBasGravIVA = 0;
                            gCamIVA31.dLiqIVAItem = 0;
                        }
                        gCamIVA31.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem31.gValorRestaItem = gValorRestaItem31;
                        gCamItem31.gValorItem = gValorItem31;
                        gCamItem31.gCamIVA = gCamIVA31;
                        gCamItem1[f] = gCamItem31;
                    }
                    if (f == 31)
                    {
                        gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem32.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem32.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem32.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem32.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA32.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA32.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA32.iAfecIVA = "3";
                            gCamIVA32.dBasGravIVA = 0;
                            gCamIVA32.dLiqIVAItem = 0;
                        }
                        gCamIVA32.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem32.gValorRestaItem = gValorRestaItem32;
                        gCamItem32.gValorItem = gValorItem32;
                        gCamItem32.gCamIVA = gCamIVA32;
                        gCamItem1[f] = gCamItem32;
                    }
                    if (f == 32)
                    {
                        gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem33.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem33.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem33.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem33.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA33.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA33.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA33.iAfecIVA = "3";
                            gCamIVA33.dBasGravIVA = 0;
                            gCamIVA33.dLiqIVAItem = 0;
                        }
                        gCamIVA33.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem33.gValorRestaItem = gValorRestaItem33;
                        gCamItem33.gValorItem = gValorItem33;
                        gCamItem33.gCamIVA = gCamIVA33;
                        gCamItem1[f] = gCamItem33;
                    }
                    if (f == 33)
                    {
                        gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem34.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem34.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem34.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem34.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA34.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA34.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA34.iAfecIVA = "3";
                            gCamIVA34.dBasGravIVA = 0;
                            gCamIVA34.dLiqIVAItem = 0;
                        }
                        gCamIVA34.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem34.gValorRestaItem = gValorRestaItem34;
                        gCamItem34.gValorItem = gValorItem34;
                        gCamItem34.gCamIVA = gCamIVA34;
                        gCamItem1[f] = gCamItem34;
                    }
                    if (f == 34)
                    {
                        gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem35.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem35.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem35.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem35.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA35.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA35.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA35.iAfecIVA = "3";
                            gCamIVA35.dBasGravIVA = 0;
                            gCamIVA35.dLiqIVAItem = 0;
                        }
                        gCamIVA35.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem35.gValorRestaItem = gValorRestaItem35;
                        gCamItem35.gValorItem = gValorItem35;
                        gCamItem35.gCamIVA = gCamIVA35;
                        gCamItem1[f] = gCamItem35;
                    }
                    if (f == 35)
                    {
                        gCamItem36.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem36.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem36.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem36.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem36.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem36.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem36.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA36.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA36.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA36.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA36.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA36.iAfecIVA = "3";
                            gCamIVA36.dBasGravIVA = 0;
                            gCamIVA36.dLiqIVAItem = 0;
                        }
                        gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem36.gValorRestaItem = gValorRestaItem36;
                        gCamItem36.gValorItem = gValorItem36;
                        gCamItem36.gCamIVA = gCamIVA36;
                        gCamItem1[f] = gCamItem36;
                    }
                    if (f == 36)
                    {
                        gCamItem37.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem37.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem37.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem37.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem37.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem37.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem37.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA37.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA37.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA37.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA37.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA37.iAfecIVA = "3";
                            gCamIVA37.dBasGravIVA = 0;
                            gCamIVA37.dLiqIVAItem = 0;
                        }
                        gCamIVA37.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem37.gValorRestaItem = gValorRestaItem37;
                        gCamItem37.gValorItem = gValorItem37;
                        gCamItem37.gCamIVA = gCamIVA37;
                        gCamItem1[f] = gCamItem37;
                    }
                    if (f == 37)
                    {
                        gCamItem38.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem38.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem38.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem38.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem38.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem38.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem38.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA38.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA38.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA38.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA38.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA38.iAfecIVA = "3";
                            gCamIVA38.dBasGravIVA = 0;
                            gCamIVA38.dLiqIVAItem = 0;
                        }
                        gCamIVA38.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem38.gValorRestaItem = gValorRestaItem38;
                        gCamItem38.gValorItem = gValorItem38;
                        gCamItem38.gCamIVA = gCamIVA38;
                        gCamItem1[f] = gCamItem38;
                    }
                    if (f == 38)
                    {
                        gCamItem39.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem39.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem39.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem39.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem39.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem39.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem39.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA39.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA39.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA39.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA39.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA39.iAfecIVA = "3";
                            gCamIVA39.dBasGravIVA = 0;
                            gCamIVA39.dLiqIVAItem = 0;
                        }
                        gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem39.gValorRestaItem = gValorRestaItem39;
                        gCamItem39.gValorItem = gValorItem39;
                        gCamItem39.gCamIVA = gCamIVA39;
                        gCamItem1[f] = gCamItem39;
                    }
                    if (f == 39)
                    {
                        gCamItem40.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem40.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem40.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem40.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem40.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem40.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem40.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA40.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA40.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA40.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA40.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA40.iAfecIVA = "3";
                            gCamIVA40.dBasGravIVA = 0;
                            gCamIVA40.dLiqIVAItem = 0;
                        }
                        gCamIVA40.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem40.gValorRestaItem = gValorRestaItem40;
                        gCamItem40.gValorItem = gValorItem40;
                        gCamItem40.gCamIVA = gCamIVA40;
                        gCamItem1[f] = gCamItem40;
                    }
                    if (f == 40)
                    {
                        gCamItem41.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem41.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem41.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem41.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem41.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem41.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem41.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA41.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA41.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA41.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA41.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA41.iAfecIVA = "3";
                            gCamIVA41.dBasGravIVA = 0;
                            gCamIVA41.dLiqIVAItem = 0;
                        }
                        gCamIVA41.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem41.gValorRestaItem = gValorRestaItem41;
                        gCamItem41.gValorItem = gValorItem41;
                        gCamItem41.gCamIVA = gCamIVA41;
                        gCamItem1[f] = gCamItem41;
                    }
                    if (f == 41)
                    {
                        gCamItem42.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem42.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem42.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem42.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem42.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem42.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem42.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA42.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA42.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA42.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA42.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA42.iAfecIVA = "3";
                            gCamIVA42.dBasGravIVA = 0;
                            gCamIVA42.dLiqIVAItem = 0;
                        }
                        gCamIVA42.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem42.gValorRestaItem = gValorRestaItem42;
                        gCamItem42.gValorItem = gValorItem42;
                        gCamItem42.gCamIVA = gCamIVA42;
                        gCamItem1[f] = gCamItem42;
                    }
                    if (f == 42)
                    {
                        gCamItem43.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem43.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem43.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem43.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem43.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem43.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem43.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA43.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA43.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA43.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA43.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA43.iAfecIVA = "3";
                            gCamIVA43.dBasGravIVA = 0;
                            gCamIVA43.dLiqIVAItem = 0;
                        }
                        gCamIVA43.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem43.gValorRestaItem = gValorRestaItem43;
                        gCamItem43.gValorItem = gValorItem43;
                        gCamItem43.gCamIVA = gCamIVA43;
                        gCamItem1[f] = gCamItem43;
                    }
                    if (f == 43)
                    {
                        gCamItem44.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem44.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem44.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem44.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem44.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem44.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem44.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA44.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA44.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA44.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA44.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA44.iAfecIVA = "3";
                            gCamIVA44.dBasGravIVA = 0;
                            gCamIVA44.dLiqIVAItem = 0;
                        }
                        gCamIVA44.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem44.gValorRestaItem = gValorRestaItem44;
                        gCamItem44.gValorItem = gValorItem44;
                        gCamItem44.gCamIVA = gCamIVA44;
                        gCamItem1[f] = gCamItem44;
                    }
                    if (f == 44)
                    {
                        gCamItem45.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem45.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem45.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem45.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem45.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem45.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem45.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA45.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA45.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA45.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA45.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA45.iAfecIVA = "3";
                            gCamIVA45.dBasGravIVA = 0;
                            gCamIVA45.dLiqIVAItem = 0;
                        }
                        gCamIVA45.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem45.gValorRestaItem = gValorRestaItem45;
                        gCamItem45.gValorItem = gValorItem45;
                        gCamItem45.gCamIVA = gCamIVA45;
                        gCamItem1[f] = gCamItem45;
                    }
                    #endregion


                    f++;
                    oDatos.MoveNext();
                    if (false == oCompany.InTransaction)
                    {
                        oCompany.StartTransaction();
                    }
                }
                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                if (tablacab.Equals("OINV"))
                {
                    if (string.IsNullOrEmpty(trans))
                    {
                        parametros.templateKuDE = "FACTURA_SIMPLE";
                    }
                    else
                    {
                        parametros.templateKuDE = template;
                    }
                }
                else
                {
                    parametros.templateKuDE = template;
                }

                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                if (tablacab.Equals("OINV"))
                {
                    gDtipDE.gCamFE = gCamFE;
                    gDtipDE.gCamCond = gCamCond;
                }

                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;
                if (condicion.Equals("2") && tablacab.Equals("OINV"))
                {
                    gCamCond.gPagCred = gPagCred;

                }
                if (tablacab.Equals("ORIN") && electronico.Equals("Si"))
                {

                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //DocAsoc.DoQuery("SELECT T2.\"U_CDC\" FROM ORIN T0 INNER JOIN RIN1 T1 ON T0.\"DocEntry\"=t1.\"DocEntry\" INNER JOIN OINV T2 ON T1.\"BaseEntry\"=t2.\"DocEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_CDC\" FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "1";
                        gCamDEAsoc.dCdCDERef = DocAsoc.Fields.Item(0).Value.ToString();
                        DocAsoc.MoveNext();
                    }
                }
                if (tablacab.Equals("ORIN") && electronico.Equals("No"))
                {
                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    // DocAsoc.DoQuery("SELECT T1.\"U_TIMB\",T1.\"U_ESTA\",T1.\"U_PEMI\",T1.\"FolioNum\",T1.\"DocDate\" FROM RIN1 T0 LEFT JOIN OINV T1 ON T1.\"DocEntry\"=T0.\"BaseEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_TIMB\",T0.\"U_ESTA\",T0.\"U_PEMI\",T0.\"FolioNum\",T0.\"DocDate\", " +
                                    "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\" " +
                                    "FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "2";
                        gCamDEAsoc.dNTimDI = DocAsoc.Fields.Item(0).Value.ToString();//timbrado
                        gCamDEAsoc.dEstDocAso = DocAsoc.Fields.Item(1).Value.ToString();//establecimiento
                        gCamDEAsoc.dPExpDocAso = DocAsoc.Fields.Item(2).Value.ToString();//punto de expedicion
                        gCamDEAsoc.dNumDocAso = DocAsoc.Fields.Item(3).Value.ToString(); ;//folio
                        gCamDEAsoc.iTipoDocAso = "1";//factura
                        DateTime FechaDA = DateTime.Parse(DocAsoc.Fields.Item(4).Value.ToString());
                        string hora2 = DocAsoc.Fields.Item(5).Value.ToString();
                        string DAfecha = FechaDA.ToString("yyyy-MM-dd");//fecha de la factura YYYY-mm-DD
                        gCamDEAsoc.dFecEmiDI = DateTime.Parse(DAfecha);
                        gCamDEAsoc.dFecEmiDISpecified = true;
                        DocAsoc.MoveNext();

                    }


                }



                gCamCond.gPaConEIni = gPaConEIni1;
                //gDtipDE.gCamCond = gCamCond;
                gDtipDE.gCamItem = gCamItem1;
                //gValorItem.gValorRestaItem = gValorRestaItem;
                //gCamItem.gValorItem = gValorItem;
                //gCamItem.gCamIVA = gCamIVA;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento

                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    //actualizamos el folio de la factura
                    Recordset oActFolio;
                    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocNum\"='" + codigo + "'");
                    //actualizamos el folio del asiento
                    Recordset oActAsiento;
                    oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");

                    //actualizamos la numeracion de la serie           
                    Recordset oActSerie;
                    oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 278)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");//
                                                                                                                                                                                                                                                                                                                 //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
                //oCompany.EndTransaction(BoWfTransOpt.wf_Commit);
            }

        }

        //funcion para anular documento
        private static void AnularDocumento(string esta, string pemi, string fol, string moti, string tabla, string SubType)
        {
            Cursor.Current = Cursors.WaitCursor;
            //instnciamos las variables
            servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
            servicio.anularRequest anular = new servicio.anularRequest();
            servicio.anularResponse response = new servicio.anularResponse();

            //realizamos el query para traer el CDC correspondiente
            string tim = null;
            if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
            {
                tim = "16094946";
            }
            else
            {
                tim = "16148774";
            }
            string type = null;
            //if (!string.IsNullOrEmpty(SubType))
            //{
            //    type = " \"DocSubType\"='IX' ";
            //}
            SAPbobsCOM.Recordset query;
            query = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            string v_entry = null;
            if (tabla.Equals("\"@REMI_CAB\""))
            {
                query.DoQuery("SELECT \"U_CDC\",\"DocEntry\" FROM " + tabla + " WHERE \"U_ESTA\"='" + esta + "' AND \"U_PEMI\"='" + pemi + "' AND \"U_FolioNum\"='" + fol + "' AND \"U_TIMB\"='" + tim + "' ");
                v_entry = query.Fields.Item(1).Value.ToString();                           
            }
            else
            {
                query.DoQuery("SELECT \"U_CDC\",\"DocEntry\" FROM " + tabla + " WHERE \"U_ESTA\"='" + esta + "' AND \"U_PEMI\"='" + pemi + "' AND \"FolioNum\"='" + fol + "' AND \"U_TIMB\"='" + tim + "' " + SubType);
            }
            //consultamos si existe el numero de documento
            if (query.EoF)
            {
                //BOTONSAP.Program.SBO_Application.SetStatusBarMessage("No existe el Documento!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                SBO_Application.StatusBar.SetText("No existe el documento!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                return;
            }
            //enviamos las variables al servicio
            anular.cdc = query.Fields.Item(0).Value.ToString();
            anular.motivo = moti;
            //ejecutamos el servicio
            response = cliente.anular(anular);
            bool resp = response.ok;

            if (resp == true)
            {
                int nrodocu = int.Parse(query.Fields.Item(1).Value.ToString());
                if (tabla.Equals("OINV") && string.IsNullOrEmpty(type))
                {
                    anularFactura(nrodocu);
                }
                else if (tabla.Equals("ORIN"))
                {
                    anularNC(nrodocu);
                }
                else if (tabla.Equals("ODLN"))
                {
                    anularEntrega(nrodocu);
                }
                else if (tabla.Equals("OWTR"))
                {
                    anularTraslado(nrodocu);
                }
                if (tabla.Equals("OINV") && !string.IsNullOrEmpty(type))
                {
                    anularFacturaExport(nrodocu);
                }
                if (tabla.Equals("\"@REMI_CAB\""))
                {
                    SAPbobsCOM.UserTable oUserT;
                    oUserT = oCompany.UserTables.Item("REMI_CAB");
                    if (oUserT.GetByKey(v_entry))
                    {
                        SAPbobsCOM.Recordset cancelUDO;
                        cancelUDO = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        cancelUDO.DoQuery("UPDATE \"@REMI_CAB\" SET \"Canceled\"='Y',\"U_ESTADO\"='CANCELADO' WHERE \"Code\"='" + v_entry + "'");
                    }
                    SBO_Application.StatusBar.SetText("Documento anulado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                }


            }
            else
            {
                SBO_Application.StatusBar.SetText("Documento ya se encuentra anulado!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //SBO_Application.SetStatusBarMessage("Documento ya se encuentra anulado", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                return;
            }
            Cursor.Current = Cursors.Default;
        }

        //funcion para remision
        private static void NotaRemision(string codigo, string tablacab, string tabladet)
        {
            try
            {
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();

                Recordset oDireTras;
                oDireTras = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                string direTras = null;
                if (tablacab.Equals("OWTR"))
                {
                    oDireTras.DoQuery("SELECT T2.\"Address\" FROM OWTR T0 LEFT JOIN OCRD T1 ON T1.\"CardCode\"=T0.\"CardCode\" " +
                                      "LEFT JOIN CRD1 T2 ON T2.\"CardCode\"=T1.\"CardCode\" AND T2.\"AdresType\"='B' WHERE T0.\"DocNum\"='" + codigo + "'");
                    direTras = oDireTras.Fields.Item(0).Value.ToString();
                    if (string.IsNullOrEmpty(direTras))
                    {
                        SBO_Application.StatusBar.SetText("Cargar direccion al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                }
                //proceso para mandar documento
                //consultamos los datos del documento              
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);

                #region QUERY REMISION
                if (tablacab.Equals("OWTR"))
                {                   
                    //GRANUSA                  
                        if (!string.IsNullOrEmpty(direTras))
                        {
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",T0.\"Address\",CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                  "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='PYG' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                  "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                  "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                  "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                  "CASE WHEN T11.\"U_CHAPA_CARRE\" is null THEN T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T0.\"U_TRANSPORTISTA\", " +
                                  "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"U_Documento\",T15.\"U_Nombre\"||', '||T15.\"U_Apellido\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                  "T13.\"Street\",T15.\"U_Direccion\", " +
                                  "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                  "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_PerContacto\",T2.\"E_Mail\" " +
                                  "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                  "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"AdresType\"='B' " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                  "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                  "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                  "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                  "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                  "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                  "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                  "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                  "LEFT JOIN \"@CHOFERES\" T15 ON T15.\"Code\"=T0.\"U_CHOFERES\" " +
                                  //"LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_TRANSPORTISTA\" and T15.\"Name\"=T0.\"U_CHOFERES\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                  "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                        else
                        {
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",T0.\"Address\",CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                  "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='PYG' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                  "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                  "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                  "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                  "CASE WHEN T11.\"U_CHAPA_CARRE\" is null THEN T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T0.\"U_TRANSPORTISTA\", " +
                                  "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"U_Documento\",T15.\"U_Nombre\"||', '||T15.\"U_Apellido\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                  "T13.\"Street\",T15.\"U_Direccion\", " +
                                  "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                  "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_PerContacto\",T2.\"E_Mail\" " +
                                  "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                  "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"AdresType\"='S' " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                  "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                  "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                  "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                  "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                  "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                  "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                  "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                  "LEFT JOIN \"@CHOFERES\" T15 ON T15.\"Code\"=T0.\"U_CHOFERES\" " +
                                  //"LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_TRANSPORTISTA\" and T15.\"Name\"=T0.\"U_CHOFERES\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                  "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }

                    
                }
                else
                {
                    //consultamos la direccion que se eligio
                    //if (!string.IsNullOrEmpty(direShip))
                    //{                       
                        
                            //GRANUSA
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                      "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                      "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                      "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                      "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                      "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                      "CASE WHEN T11.\"U_CHAPA_CARRE\" is null THEN T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T0.\"U_TRANSPORTISTA\", " +
                                      "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"U_Documento\",T15.\"U_Nombre\"||', '||T15.\"U_Apellido\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                      "T13.\"Street\",T15.\"U_Direccion\", " +
                                      "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                      "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_PerContacto\",T2.\"E_Mail\" " +
                                      "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                      "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                      "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                      "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                      "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                      "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                      "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                      "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                      "LEFT JOIN \"@CHOFERES\" T15 ON T15.\"Code\"=T0.\"U_CHOFERES\" " +
                                      //"LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_TRANSPORTISTA\" and T15.\"Name\"=T0.\"U_CHOFERES\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                      "WHERE T0.\"DocNum\"='" + codigo + "'");
                        
                    //}
                    //else
                    //{                                             
                            //GRANUSA
                            //oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                            //          "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                            //          "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                            //          "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                            //          "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                            //           "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)   " +
                            //           "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                            //          "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                            //          "CASE WHEN T11.\"U_CHAPA_CARRE\" is null THEN T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T0.\"U_TRANSPORTISTA\", " +
                            //          "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"U_Documento\",T15.\"U_Nombre\"||', '||T15.\"U_Apellido\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                            //          "T13.\"Street\",T15.\"U_Direccion\", " +
                            //          "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                            //          "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_PerContacto\" " +
                            //          "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                            //          "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                            //          "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                            //          "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                            //          "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                            //          "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                            //          "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                            //          "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                            //          "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                            //          "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                            //          "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                            //          "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                            //          "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                            //          "LEFT JOIN \"@CHOFERES\" T15 ON T15.\"Code\"=T0.\"U_CHOFERES\" " +
                            //          //"LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_TRANSPORTISTA\" and T15.\"Name\"=T0.\"U_CHOFERES\" " +
                            //          "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                            //          "WHERE T0.\"DocNum\"='" + codigo + "'");
                        
                    //}
                }

                #endregion

                //validamos los campos obligatorios
                #region VALIDACIONES
                if (tablacab.Equals("ODLN"))
                {
                    if (string.IsNullOrEmpty(direPay))
                    {
                        if (string.IsNullOrEmpty(direShip))
                        {
                            SBO_Application.StatusBar.SetText("Cargar direccion al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                            oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                            return;
                        }
                    }
                }

                string v_natu = oDatos.Fields.Item(26).Value.ToString();
                if (string.IsNullOrEmpty(v_natu))
                {
                    SBO_Application.StatusBar.SetText("Cargar naturaleza al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_ope = oDatos.Fields.Item(25).Value.ToString();
                if (string.IsNullOrEmpty(v_ope) || v_ope.Equals("0"))
                {
                    SBO_Application.StatusBar.SetText("Cargar tipo de operacion al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_cont = oDatos.Fields.Item(27).Value.ToString();
                if (string.IsNullOrEmpty(v_cont))
                {
                    SBO_Application.StatusBar.SetText("Cargar tipo de contribuyente al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    return;
                }
                string v_direSal = oDatos.Fields.Item(39).Value.ToString();
                if (string.IsNullOrEmpty(v_direSal))
                {
                    SBO_Application.StatusBar.SetText("Cargar direccion del establecimiento", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_natTrans = oDatos.Fields.Item(32).Value.ToString();
                if (string.IsNullOrEmpty(v_natTrans))
                {
                    SBO_Application.StatusBar.SetText("Cargar naturaleza del transportista", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_direTrans = oDatos.Fields.Item(41).Value.ToString();
                if (string.IsNullOrEmpty(v_direTrans))
                {
                    SBO_Application.StatusBar.SetText("Cargar direccion del transportista", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_chof = oDatos.Fields.Item(37).Value.ToString();
                if (string.IsNullOrEmpty(v_chof))
                {
                    SBO_Application.StatusBar.SetText("Cargar un chofer a la remision", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_idchof = oDatos.Fields.Item(36).Value.ToString();
                if (string.IsNullOrEmpty(v_idchof))
                {
                    SBO_Application.StatusBar.SetText("Cargar cedula al chofer", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_direChof = oDatos.Fields.Item(42).Value.ToString();
                if (string.IsNullOrEmpty(v_direChof))
                {
                    SBO_Application.StatusBar.SetText("Cargar direccion al chofer", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                #endregion


                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(43).Value.ToString();
                string rec_dist = oDatos.Fields.Item(44).Value.ToString();
                string rec_loc = oDatos.Fields.Item(45).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(46).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string ResFlete = oDatos.Fields.Item(47).Value.ToString();
                string CodLicitacion = oDatos.Fields.Item(48).Value.ToString();
                string transId = oDatos.Fields.Item(49).Value.ToString();
                string infoadicional = oDatos.Fields.Item(51).Value.ToString();
                string correo = oDatos.Fields.Item(52).Value.ToString();
                //string infoExport = oDatos.Fields.Item(51).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //actualizamos los UDF
                Recordset oActUDF;
                oActUDF = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oActUDF.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                ////actualizamos la numeracion de la serie           
                //Recordset oActSerie;
                //oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                string serieremi = oDatos.Fields.Item(17).Value.ToString();
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (!oDatos.Fields.Item(25).Value.ToString().Equals("4"))
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                }
                //instaciamos los objetos que vutilizaremos
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                #endregion
                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                gOpeDE.dInfoFisc = "Remision";
                string oper = oDatos.Fields.Item(25).Value.ToString();
                if (!string.IsNullOrEmpty(infoadicional))
                {
                    gOpeDE.dInfoEmi = infoadicional;
                }
                //gTimb
                gTimb.iTiDE = "7";
                gTimb.dNumTim = timbrado;// timbrado;
                gTimb.dEst = esta;// esta;
                gTimb.dPunExp = pun;// pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                if (!string.IsNullOrEmpty(correo))
                {
                    gDatRec.dEmailRec = correo;
                }
                string pais = oDatos.Fields.Item(16).Value.ToString();
                if (string.IsNullOrEmpty(pais))
                {
                    gDatRec.cPaisRec = "PRY";
                }
                else
                {
                    gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                }
                //gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                gDatRec.dDesPaisRe = oDatos.Fields.Item(38).Value.ToString();

                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                string direRec = oDatos.Fields.Item(5).Value.ToString();
                string newdireRec = null;
                if (!Regex.IsMatch(direRec, @"^[a-zA-Z-0-9]+$") == true)
                {
                    newdireRec = Regex.Replace(direRec, @"[^0-9a-zA-Z ]+", "");
                }
                else
                {
                    newdireRec = direRec;
                }
                gDatRec.dDirRec = newdireRec;// oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                if (oDatos.Fields.Item(16).Value.ToString() == "PRY")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                    gDatRec.cDepRec = rec_dep;
                    gDatRec.cDisRec = rec_dist;
                    gDatRec.cCiuRec = rec_loc;
                    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                }
                //gCamSal
                gCamSal.dDirLocSal = oDatos.Fields.Item(39).Value.ToString();
                gCamSal.dNumCasSal = "0";
                //gCamSal.dComp1Sal =  "aviadores del chaco";
                gCamSal.cDepSal = sal_dep;
                gCamSal.cDisSal = sal_dist;
                gCamSal.cCiuSal = sal_loc;
                //gCamEnt
                gCamEnt.dDirLocEnt = newdireRec;// oDatos.Fields.Item(5).Value.ToString(); //"santa teresa";
                gCamEnt.dNumCasEnt = "0";
                gCamEnt.cDepEnt = rec_dep;
                gCamEnt.cDisEnt = rec_dist;
                gCamEnt.cCiuEnt = rec_loc;
                gCamEnt1[0] = gCamEnt;

                //LICITACION
                #region LICITACION
                if (oDatos.Fields.Item(25).Value.ToString() == "3")
                {
                    Recordset oLicitacion;
                    oLicitacion = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oLicitacion.DoQuery("SELECT \"U_dModCont\",\"U_dEntCont\",\"U_dAnoCont\",\"U_dSecCont\",\"U_dFeCodCont\" FROM \"@LICITACION\" WHERE \"U_LICI\"='" + CodLicitacion + "'");

                    gCompPub.dModCont = oLicitacion.Fields.Item(0).Value.ToString();//"LP";
                    gCompPub.dEntCont = oLicitacion.Fields.Item(1).Value.ToString(); //"12009";
                    gCompPub.dAnoCont = oLicitacion.Fields.Item(2).Value.ToString(); //"22";
                    int sec = int.Parse(oLicitacion.Fields.Item(2).Value.ToString());
                    gCompPub.dSecCont = sec.ToString("D7");// oLicitacion.Fields.Item(3).Value.ToString(); //"218529";
                    DateTime v_fechaLic = DateTime.Parse(oLicitacion.Fields.Item(4).Value.ToString());
                    string fechalic_v = v_fechaLic.ToString("yyyy-MM-dd");
                    gCompPub.dFeCodCont = DateTime.Parse(fechalic_v);//DateTime.Parse("2022-08-31");
                    gCompPub.dFeCodContSpecified = true;
                    gCamFE.gCompPub = gCompPub;
                    //gDtipDE.gCamFE = gCamFE;


                }
                #endregion


                if (oDatos.Fields.Item(34).Value.ToString() == varE)
                {
                    gTransp.iTipTrans = "1";
                    gTransp.dDesTipTrans = "Propio";
                }
                else
                {
                    gTransp.iTipTrans = "2";
                    gTransp.dDesTipTrans = "Tercero";
                }
                gTransp.iModTrans = "1";
                gTransp.iRespFlete = ResFlete;
                gTransp.dIniTras = fe;
                gTransp.dIniTrasSpecified = true;
                gTransp.dFinTras = fe;
                gTransp.dFinTrasSpecified = true;
                //gVehTras
                //gTransp.gVehTras = gVehTras1;
                gVehTras1[0] = gVehTras;
                gVehTras.dTiVehTras = "Terrestre";
                gVehTras.dMarVeh = oDatos.Fields.Item(30).Value.ToString();
                gVehTras.dTipIdenVeh = "2";
                gVehTras.dNroMatVeh = oDatos.Fields.Item(29).Value.ToString();
                //gCamTrans
                gCamTrans.iNatTrans = oDatos.Fields.Item(32).Value.ToString();
                gCamTrans.dNomTrans = oDatos.Fields.Item(33).Value.ToString();
                //deconstruimos el RUC del transportista
                string rucCam = null;
                string dvCam = null;
                if (oDatos.Fields.Item(32).Value.ToString() == "1")
                {
                    string varCam = oDatos.Fields.Item(34).Value.ToString();
                    int indexCam = varCam.IndexOf("-");
                    int canCam = oDatos.Fields.Item(34).Value.ToString().Length;
                    rucCam = oDatos.Fields.Item(34).Value.ToString().Remove(indexCam, canCam - indexCam);
                    dvCam = oDatos.Fields.Item(34).Value.ToString().Remove(0, indexCam + 1);
                }
                string paisTrans = oDatos.Fields.Item(35).Value.ToString();
                if (paisTrans.Equals("PRY"))
                {
                    gCamTrans.dRucTrans = rucCam;
                    gCamTrans.dDVTrans = dvCam;
                }
                else
                {
                    gCamTrans.dNumIDTrans = oDatos.Fields.Item(34).Value.ToString();
                    gCamTrans.iTipIDTrans = "3";
                    gCamTrans.dDTipIDTrans = "Cédula extranjera";
                }
                gCamTrans.cNacTrans = oDatos.Fields.Item(35).Value.ToString();
                gCamTrans.dDesNacTrans = oDatos.Fields.Item(40).Value.ToString();
                gCamTrans.dDomFisc = oDatos.Fields.Item(41).Value.ToString();
                gCamTrans.dNumIDChof = oDatos.Fields.Item(36).Value.ToString();
                gCamTrans.dNomChof = oDatos.Fields.Item(37).Value.ToString();
                string direChofer = oDatos.Fields.Item(42).Value.ToString();
                string newdireChofer = null;
                if (!Regex.IsMatch(direChofer, @"^[a-zA-Z-0-9]+$") == true)
                {
                    newdireChofer = Regex.Replace(direChofer, @"[^0-9a-zA-Z ]+", "");
                }
                else
                {
                    newdireChofer = direChofer;
                }
                gCamTrans.dDirChof = newdireChofer;// oDatos.Fields.Item(42).Value.ToString();
                //gCamNRE
                string motivo = null;
                string codmotivo = null;
                if (tablacab.Equals("OWTR"))
                {
                    codmotivo = "7";
                    motivo = "Traslado entre locales de la empresa";
                }
                else
                {
                    codmotivo = "1";
                    motivo = "Traslado por ventas";
                }
                gCamNRE.iMotEmiNR = codmotivo;// "1";
                gCamNRE.dDesMotEmiNR = motivo;// "Traslado por ventas";
                gCamNRE.iRespEmiNR = "1";
                gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                gCamNRE.dKmR = "3";
                //gCamItem
                int f = 0;
                //recorremos el recordset y mandamos los datos del detalle al objeto
                while (!oDatos.EoF)
                {
                    #region DETALLE
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem.dDncpG = dncpNum.ToString();
                        }
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        decimal ll = decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem2.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();// "024";
                            double dncpNum2 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem2.dDncpG = dncpNum2.ToString();
                        }
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {

                        gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem3.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum3 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem3.dDncpG = dncpNum3.ToString();
                        }
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem4.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum4 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem4.dDncpG = dncpNum4.ToString();
                        }
                        gCamItem1[f] = gCamItem4;
                    }
                    if (f == 4)
                    {
                        gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem5.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum5 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem5.dDncpG = dncpNum5.ToString();
                        }
                        gCamItem1[f] = gCamItem5;
                    }
                    if (f == 5)
                    {
                        gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem6.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum6 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem6.dDncpG = dncpNum6.ToString();
                        }
                        gCamItem1[f] = gCamItem6;
                    }
                    if (f == 6)
                    {
                        gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem7.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); // "024";
                            double dncpNum7 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem7.dDncpG = dncpNum7.ToString();
                        }
                        gCamItem1[f] = gCamItem7;
                    }
                    if (f == 7)
                    {
                        gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem8.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum8 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem8.dDncpG = dncpNum8.ToString();
                        }
                        gCamItem1[f] = gCamItem8;
                    }
                    if (f == 8)
                    {
                        gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem9.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum9 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem9.dDncpG = dncpNum9.ToString();
                        }
                        gCamItem1[f] = gCamItem9;
                    }
                    if (f == 9)
                    {
                        gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem10.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum10 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem10.dDncpG = dncpNum10.ToString();
                        }
                        gCamItem1[f] = gCamItem10;
                    }
                    if (f == 10)
                    {
                        gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem11.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum11 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem11.dDncpG = dncpNum11.ToString();
                        }
                        gCamItem1[f] = gCamItem11;
                    }
                    if (f == 11)
                    {
                        gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem12.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum12 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem12.dDncpG = dncpNum12.ToString();
                        }
                        gCamItem1[f] = gCamItem12;
                    }
                    if (f == 12)
                    {
                        gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem13.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum13 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem13.dDncpG = dncpNum13.ToString();
                        }
                        gCamItem1[f] = gCamItem13;
                    }
                    if (f == 13)
                    {
                        gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem14.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum14 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem14.dDncpG = dncpNum14.ToString();
                        }
                        gCamItem1[f] = gCamItem14;
                    }
                    if (f == 14)
                    {
                        gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem15.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum15 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem15.dDncpG = dncpNum15.ToString();
                        }
                        gCamItem1[f] = gCamItem15;
                    }
                    if (f == 15)
                    {
                        gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem16.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum16 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem16.dDncpG = dncpNum16.ToString();
                        }
                        gCamItem1[f] = gCamItem16;
                    }
                    if (f == 16)
                    {
                        gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem17.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum17 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem17.dDncpG = dncpNum17.ToString();
                        }
                        gCamItem1[f] = gCamItem17;
                    }
                    if (f == 17)
                    {
                        gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem18.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum18 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem18.dDncpG = dncpNum18.ToString();
                        }
                        gCamItem1[f] = gCamItem18;
                    }
                    if (f == 18)
                    {
                        gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem19.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum19 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem19.dDncpG = dncpNum19.ToString();
                        }
                        gCamItem1[f] = gCamItem19;
                    }
                    if (f == 19)
                    {
                        gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem20.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum20 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem20.dDncpG = dncpNum20.ToString();
                        }
                        gCamItem1[f] = gCamItem20;
                    }
                    if (f == 20)
                    {
                        gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem21.dDncpE = "024";
                            int dncpNum21 = 50112001;
                            gCamItem21.dDncpG = dncpNum21.ToString();
                        }
                        gCamItem1[f] = gCamItem21;
                    }
                    if (f == 21)
                    {
                        gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem22.dDncpE = "024";
                            int dncpNum22 = 50112001;
                            gCamItem22.dDncpG = dncpNum22.ToString();
                        }
                        gCamItem1[f] = gCamItem22;
                    }
                    if (f == 22)
                    {
                        gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem23.dDncpE = "024";
                            int dncpNum23 = 50112001;
                            gCamItem23.dDncpG = dncpNum23.ToString("");
                        }
                        gCamItem1[f] = gCamItem23;
                    }
                    if (f == 23)
                    {
                        gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem24.dDncpE = "024";
                            int dncpNum24 = 50112001;
                            gCamItem24.dDncpG = dncpNum24.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem24;
                    }
                    if (f == 24)
                    {
                        gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem25.dDncpE = "024";
                            int dncpNum25 = 50112001;
                            gCamItem25.dDncpG = dncpNum25.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem25;
                    }
                    if (f == 25)
                    {
                        gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem26.dDncpE = "024";
                            int dncpNum26 = 50112001;
                            gCamItem26.dDncpG = dncpNum26.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem26;
                    }
                    if (f == 26)
                    {
                        gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem27.dDncpE = "024";
                            int dncpNum27 = 50112001;
                            gCamItem27.dDncpG = dncpNum27.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem27;
                    }
                    if (f == 27)
                    {
                        gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem28.dDncpE = "024";
                            int dncpNum28 = 50112001;
                            gCamItem28.dDncpG = dncpNum28.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem28;
                    }
                    if (f == 28)
                    {
                        gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem29.dDncpE = "024";
                            int dncpNum29 = 50112001;
                            gCamItem29.dDncpG = dncpNum29.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem29;
                    }
                    if (f == 29)
                    {
                        gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem30.dDncpE = "024";
                            int dncpNum30 = 50112001;
                            gCamItem30.dDncpG = dncpNum30.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem30;
                    }
                    if (f == 30)
                    {
                        gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem31.dDncpE = "024";
                            int dncpNum31 = 50112001;
                            gCamItem31.dDncpG = dncpNum31.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem31;
                    }
                    if (f == 31)
                    {
                        gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem32.dDncpE = "024";
                            int dncpNum32 = 50112001;
                            gCamItem32.dDncpG = dncpNum32.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem32;
                    }
                    if (f == 32)
                    {
                        gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem33.dDncpE = "024";
                            int dncpNum33 = 50112001;
                            gCamItem33.dDncpG = dncpNum33.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem33;
                    }
                    if (f == 33)
                    {
                        gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem34.dDncpE = "024";
                            int dncpNum34 = 50112001;
                            gCamItem34.dDncpG = dncpNum34.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem34;
                    }
                    if (f == 34)
                    {
                        gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem35.dDncpE = "024";
                            int dncpNum35 = 50112001;
                            gCamItem35.dDncpG = dncpNum35.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem35;
                    }
                    #endregion

                    f++;
                    oDatos.MoveNext();
                    if (false == oCompany.InTransaction)
                    {
                        oCompany.StartTransaction();
                    }
                }
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = "NOTA_REMISION";
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;
                gDtipDE.gTransp = gTransp;
                //gDtipDE.gCamCond = gCamCond;
                gDtipDE.gCamItem = gCamItem1;
                gDtipDE.gCamNRE = gCamNRE;
                gTransp.gCamTrans = gCamTrans;
                gTransp.gCamSal = gCamSal;
                gTransp.gCamEnt = gCamEnt1;
                gTransp.gVehTras = gVehTras1;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento
                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (true == oCompany.InTransaction)
                {
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                }
                if (resultadoOK == false)
                {
                    string mensajeError = resultadoProcesamiento[0].mensajeError;
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Remision no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Remision creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    //actualizamos el folio de la factura
                    Recordset oActFolio;
                    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocNum\"='" + codigo + "'");
                    //actualizamos el folio del asiento
                    Recordset oActAsiento;
                    oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");
                    //actualizar el estado del documento si es B2G
                    if (v_ope.Equals("3"))
                    {
                        Recordset oActEstado;
                        oActEstado = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActEstado.DoQuery("UPDATE " + tablacab + " SET \"Printed\"='Y' where \"DocNum\"='" + codigo + "'");
                    }

                    //actualizamos la numeracion de la serie           
                    Recordset oActSerie;
                    oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + serieremi + "'");

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 250)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Remision creada con exito", "", MessageBoxButtons.OK, MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Remision creado con exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
                //oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
            }

        }

        //cargar datos en form de anular
        private static void loadAnular(SAPbouiCOM.Form form)
        {
            //cargar combo de documentos
            SAPbouiCOM.ComboBox cboDocu;
            cboDocu = (SAPbouiCOM.ComboBox)form.Items.Item("cboDocu").Specific;
            cboDocu.ValidValues.Add("1", "Factura");
            cboDocu.ValidValues.Add("2", "Nota Credito");
            cboDocu.ValidValues.Add("3", "Nota Debito");
            cboDocu.ValidValues.Add("4", "Entrega");
            cboDocu.ValidValues.Add("5", "Traslado");
            cboDocu.ValidValues.Add("6", "Factura Exportacion");
            cboDocu.ValidValues.Add("7", "Remisión temporal");
            cboDocu.Item.DisplayDesc = true;
            //cargar combo de motivos
            SAPbouiCOM.ComboBox cbomoti;
            cbomoti = (SAPbouiCOM.ComboBox)form.Items.Item("cboMoti").Specific;
            cbomoti.ValidValues.Add("1", "Documento mal hecho");
            cbomoti.ValidValues.Add("2", "Documento no corresponde al cliente");
            cbomoti.ValidValues.Add("3", "Error en valor de la operacion");
            cbomoti.ValidValues.Add("4", "Producto mal facturado");
            cbomoti.Item.DisplayDesc = true;
            //cboDocu.ExpandType = BoExpandType.et_DescriptionOnly;
            SAPbouiCOM.StaticText descmoti = (SAPbouiCOM.StaticText)form.Items.Item("Item_8").Specific;
            SAPbouiCOM.EditText desc = (SAPbouiCOM.EditText)form.Items.Item("1_U_E").Specific;
            descmoti.Item.Visible = false;
            desc.Item.Visible = false;

        }

        //cargar datos en form cancelar
        private static void loadCancelar(SAPbouiCOM.Form form)
        {
            //cargar combo de documentos
            SAPbouiCOM.ComboBox cboDocu;
            cboDocu = (SAPbouiCOM.ComboBox)form.Items.Item("cboTipo").Specific;
            cboDocu.ValidValues.Add("1", "Factura");
            cboDocu.ValidValues.Add("2", "Nota Credito");
            cboDocu.ValidValues.Add("3", "Nota Debito");
            cboDocu.ValidValues.Add("4", "Entrega");
            cboDocu.ValidValues.Add("5", "Traslado");
            cboDocu.ValidValues.Add("6", "Factura Exportacion");
            cboDocu.Item.DisplayDesc = true;
            ////cargar combo de motivos
            //SAPbouiCOM.ComboBox cbomoti;
            //cbomoti = (SAPbouiCOM.ComboBox)form.Items.Item("cboMoti").Specific;
            //cbomoti.ValidValues.Add("1", "Documento mal hecho");
            //cbomoti.ValidValues.Add("2", "Documento no corresponde al cliente");
            //cbomoti.ValidValues.Add("3", "Error en valor de la operacion");
            //cbomoti.ValidValues.Add("4", "Producto mal facturado");
            //cbomoti.Item.DisplayDesc = true;
            ////cboDocu.ExpandType = BoExpandType.et_DescriptionOnly;
            //SAPbouiCOM.StaticText descmoti = (SAPbouiCOM.StaticText)form.Items.Item("Item_8").Specific;
            //SAPbouiCOM.EditText desc = (SAPbouiCOM.EditText)form.Items.Item("1_U_E").Specific;
            //descmoti.Item.Visible = false;
            //desc.Item.Visible = false;

        }

        //cargar datos en form export
        private static void loadExport(SAPbouiCOM.Form form)
        {
            //cargar columnas en la grilla
            SAPbouiCOM.Grid grilla;
            SAPbouiCOM.Columns columns;
            SAPbouiCOM.ComboBoxColumn col;
            grilla = (SAPbouiCOM.Grid)form.Items.Item("Item_0").Specific;
            form.DataSources.DataTables.Add("data1");
            grilla.DataTable = form.DataSources.DataTables.Item("data1");
            grilla.DataTable.Columns.Add("ItemCode", BoFieldsType.ft_Text, 0);
            grilla.DataTable.Columns.Add("Descripcion", BoFieldsType.ft_Text, 1);
            grilla.DataTable.Columns.Add("Cantidad", BoFieldsType.ft_Text, 2);
            grilla.DataTable.Columns.Add("Monto", BoFieldsType.ft_Text, 3);
            grilla.AutoResizeColumns();
            grilla.Columns.Item("RowsHeader").TitleObject.Caption = "#";
            //grilla.DataTable.Rows.Add();
            EditTextColumn gridCBo = (SAPbouiCOM.EditTextColumn)grilla.Columns.Item(0);
            gridCBo.Type = BoGridColumnType.gct_ComboBox;
            col = (SAPbouiCOM.ComboBoxColumn)grilla.Columns.Item(0);
            col.ValidValues.Add("EXP0001", "Carne Congelada");
            col.ValidValues.Add("EXP0002", "Menudencia vacuna congelada");
            col.ValidValues.Add("EXP0003", "Carne vacuna enfriada");
            col.ValidValues.Add("EXP0004", "Hamburguesa");
            col.ValidValues.Add("EXP0005", "Sebo bovino fundido");
            col.ValidValues.Add("EXP0006", "Hamburguesa gigante sarubbi 4X8X198 GRS");
            col.ValidValues.Add("EXP0007", "Hamburguesa premium sarubbi 6X12X95 GRS");
            col.ValidValues.Add("EXP0008", "Hamburguesa premium sarubbi 2X50X95 GRS");
            col.ValidValues.Add("EXP0009", "Carne 10/1");
            col.ValidValues.Add("EXP0010", "Carne 4/1");
            col.ValidValues.Add("EXP0011", "Hamburguesa de cane vacuna congelada 110 GR");
            col.ValidValues.Add("EXP0012", "Hamburguesa de carne vacuna congelada 216 GR");
            col.ValidValues.Add("EXP0013", "Hamburguesa premium sarubbi 12X6X95 GRS");

            //agregamos el DocNum de la factura export
            SAPbouiCOM.EditText DocNum;
            DocNum = (SAPbouiCOM.EditText)form.Items.Item("1_U_E").Specific;
            DocNum.Value = codigo;

            SAPbouiCOM.EditText TotalDoc;
            TotalDoc = (SAPbouiCOM.EditText)form.Items.Item("0_U_E").Specific;
            TotalDoc.Value = DocTotal;

            //datos extras export
            SAPbouiCOM.ComboBox oCombo;
            oCombo = (SAPbouiCOM.ComboBox)form.Items.Item("Item_13").Specific;
            oCombo.ValidValues.Add("CFR", "CFR VALUES USD");
            oCombo.ValidValues.Add("CIF", "CIF VALUES USD");
            oCombo.ValidValues.Add("CIP", "CIP VALUES USD");
            oCombo.ValidValues.Add("CPT", "CPT VALUES USD");
            oCombo.ValidValues.Add("EXWORKS", "EXWORKS VALUES USD");
            oCombo.ValidValues.Add("FCA", "FCA VALUES USD");
            oCombo.ValidValues.Add("FOB", "FOB VALUES USD");
            oCombo.ValidValues.Add("FOB A", "FOB ASUNCION");
            oCombo.ValidValues.Add("FOB PA", "FOB PARANAGUA");
            oCombo.ValidValues.Add("FOB BA", "FOB BUENOS AIRES");




        }

        //funcion para anular factura
        private static void anularFactura(int nrodocu)
        {
            Cursor.Current = Cursors.WaitCursor;
            //instanciamos el objeto
            SAPbobsCOM.Documents documento;
            SAPbobsCOM.Documents docCancel;
            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);

            if (documento.GetByKey(nrodocu))
            {
                string B_Code = documento.UserFields.Fields.Item("U_RT").Value.ToString();
                //desfoliamos el documento
                string folioAnu = documento.UserFields.Fields.Item("U_ESTA").Value.ToString() + "-" + documento.UserFields.Fields.Item("U_PEMI").Value.ToString() + "-" + documento.FolioNumber.ToString("D7");
                documento.NumAtCard = folioAnu;
                documento.FolioPrefixString = "";
                documento.FolioNumber = 0;
                documento.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                int desfoliar = documento.Update();
                string descerror = oCompany.GetLastErrorDescription().ToString();
                if (desfoliar != 0)
                {
                    SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    //SBO_Application.SetStatusBarMessage("Error al desfoliar el documento", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                    return;
                }
                docCancel = documento.CreateCancellationDocument();
                int cancelado = docCancel.Add();
                if (cancelado == 0)
                {
                    //cancelar RT
                    SAPbobsCOM.UserTable oUserT;
                    oUserT = oCompany.UserTables.Item("REMI_CAB");
                    if (oUserT.GetByKey(B_Code))
                    {
                        SAPbobsCOM.Recordset cancelUDO;
                        cancelUDO = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        cancelUDO.DoQuery("UPDATE \"@REMI_CAB\" SET \"Canceled\"='Y',\"U_ESTADO\"='CANCELADO' WHERE \"Code\"='" + B_Code + "'");
                    }
                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //BOTONSAP.Program.SBO_Application.SetStatusBarMessage("Cancelado correctamente!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
                else
                {
                    SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    //SBO_Application.SetStatusBarMessage("Error al cancelar documento", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
            }
            Cursor.Current = Cursors.Default;
        }

        //funcion para anular factura export
        private static void anularFacturaExport(int nrodocu)
        {
            Cursor.Current = Cursors.WaitCursor;
            //instanciamos el objeto
            SAPbobsCOM.Documents documento;
            SAPbobsCOM.Documents docCancel;
            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);

            if (documento.GetByKey(nrodocu))
            {
                //desfoliamos el documento
                string folioAnu = documento.UserFields.Fields.Item("U_ESTA").Value.ToString() + "-" + documento.UserFields.Fields.Item("U_PEMI").Value.ToString() + "-" + documento.FolioNumber.ToString("D7");
                documento.NumAtCard = folioAnu;
                documento.FolioPrefixString = "";
                documento.FolioNumber = 0;
                documento.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                int desfoliar = documento.Update();
                string descerror = oCompany.GetLastErrorDescription().ToString();
                if (desfoliar != 0)
                {
                    SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    //SBO_Application.SetStatusBarMessage("Error al desfoliar el documento", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                    return;
                }
                docCancel = documento.CreateCancellationDocument();
                int cancelado = docCancel.Add();
                if (cancelado == 0)
                {
                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //BOTONSAP.Program.SBO_Application.SetStatusBarMessage("Cancelado correctamente!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
                else
                {
                    SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    //SBO_Application.SetStatusBarMessage("Error al cancelar documento", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
            }
            Cursor.Current = Cursors.Default;
        }

        //funcion para anular nota de credito
        private static void anularNC(int nrodocu)
        {
            Cursor.Current = Cursors.WaitCursor;
            //instanciamos el objeto
            SAPbobsCOM.Documents documento;
            SAPbobsCOM.Documents docCancel;
            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);

            if (documento.GetByKey(nrodocu))
            {
                //desfoliamos el documento
                string folioAnu = documento.UserFields.Fields.Item("U_ESTA").Value.ToString() + "-" + documento.UserFields.Fields.Item("U_PEMI").Value.ToString() + "-" + documento.FolioNumber.ToString("D7");
                documento.NumAtCard = folioAnu;
                documento.FolioPrefixString = "";
                documento.FolioNumber = 0;
                documento.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                int desfoliar = documento.Update();
                if (desfoliar != 0)
                {
                    SBO_Application.SetStatusBarMessage("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), SAPbouiCOM.BoMessageTime.bmt_Short, true);
                    return;
                }
                docCancel = documento.CreateCancellationDocument();
                int cancelado = docCancel.Add();
                if (cancelado == 0)
                {
                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //BOTONSAP.Program.SBO_Application.SetStatusBarMessage("Cancelado correctamente!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
                else
                {
                    SBO_Application.SetStatusBarMessage("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
            }
            Cursor.Current = Cursors.Default;
        }

        //funcion para anular entrega
        private static void anularEntrega(int nrodocu)
        {
            Cursor.Current = Cursors.WaitCursor;
            //instanciamos el objeto
            SAPbobsCOM.Documents documento;
            SAPbobsCOM.Documents docCancel;
            documento = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
            docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);

            if (documento.GetByKey(nrodocu))
            {
                string B_Code = documento.UserFields.Fields.Item("U_RT").Value.ToString();
                //desfoliamos el documento
                string folioAnu = documento.UserFields.Fields.Item("U_ESTA").Value.ToString() + "-" + documento.UserFields.Fields.Item("U_PEMI").Value.ToString() + "-" + documento.FolioNumber.ToString("D7");
                documento.NumAtCard = folioAnu;
                documento.FolioPrefixString = "";
                documento.FolioNumber = 0;
                documento.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                int desfoliar = documento.Update();
                if (desfoliar != 0)
                {
                    SBO_Application.SetStatusBarMessage("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), SAPbouiCOM.BoMessageTime.bmt_Short, true);
                    return;
                }
                docCancel = documento.CreateCancellationDocument();
                int cancelado = docCancel.Add();
                if (cancelado == 0)
                {
                    //cancelar RT
                    SAPbobsCOM.UserTable oUserT;
                    oUserT = oCompany.UserTables.Item("REMI_CAB");
                    if (oUserT.GetByKey(B_Code))
                    {
                        SAPbobsCOM.Recordset cancelUDO;
                        cancelUDO = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        cancelUDO.DoQuery("UPDATE \"@REMI_CAB\" SET \"Canceled\"='Y',\"U_ESTADO\"='CANCELADO' WHERE \"Code\"='" + B_Code + "'");
                    }
                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //BOTONSAP.Program.SBO_Application.SetStatusBarMessage("Cancelado correctamente!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
                else
                {
                    SBO_Application.SetStatusBarMessage("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
            }
            Cursor.Current = Cursors.Default;
        }

        //funcion para anular traslado
        private static void anularTraslado(int nrodocu)
        {
            Cursor.Current = Cursors.WaitCursor;
            //instanciamos el objeto
            SAPbobsCOM.StockTransfer documento;
            SAPbobsCOM.StockTransfer docCancel;
            documento = (SAPbobsCOM.StockTransfer)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);
            docCancel = (SAPbobsCOM.StockTransfer)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);

            if (documento.GetByKey(nrodocu))
            {
                //desfoliamos el documento
                string folioAnu = documento.UserFields.Fields.Item("U_ESTA").Value.ToString() + "-" + documento.UserFields.Fields.Item("U_PEMI").Value.ToString() + "-" + documento.FolioNumber.ToString("D7");
                documento.Comments = folioAnu;
                documento.FolioPrefixString = "";
                documento.FolioNumber = 0;
                documento.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                int desfoliar = documento.Update();
                if (desfoliar != 0)
                {
                    SBO_Application.SetStatusBarMessage("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), SAPbouiCOM.BoMessageTime.bmt_Short, true);
                    return;
                }
                //docCancel = documento.CreateCancellationDocument();
                int cancelado = documento.Cancel();
                if (cancelado == 0)
                {
                    SBO_Application.StatusBar.SetText("Cancelado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //BOTONSAP.Program.SBO_Application.SetStatusBarMessage("Cancelado correctamente!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
                else
                {
                    SBO_Application.SetStatusBarMessage("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
            }
            Cursor.Current = Cursors.Default;
        }

        //funcion para boquear campos
        private static void bloquearCampos(SAPbouiCOM.Form oForm)
        {
            Item i_cdc = oForm.Items.Item("U_CDC");
            Item i_id = oForm.Items.Item("U_ID");
            Item i_kude = oForm.Items.Item("U_KUDE");
            Item i_xml = oForm.Items.Item("U_XMLFIRMADO");
            Item i_mensaje = oForm.Items.Item("U_MensajeError");
            Item i_estado = oForm.Items.Item("U_ESTADO");
            Item i_fecha = oForm.Items.Item("U_FechaT");
            Item i_qr = oForm.Items.Item("U_CODIGOQR");

            EditText c_cdc = (SAPbouiCOM.EditText)i_cdc.Specific;
            EditText c_id = (SAPbouiCOM.EditText)i_id.Specific;
            EditText c_kude = (SAPbouiCOM.EditText)i_kude.Specific;
            EditText c_xml = (SAPbouiCOM.EditText)i_xml.Specific;
            EditText c_mensaje = (SAPbouiCOM.EditText)i_mensaje.Specific;
            EditText c_estado = (SAPbouiCOM.EditText)i_estado.Specific;
            EditText c_fecha = (SAPbouiCOM.EditText)i_fecha.Specific;
            EditText c_qr = (SAPbouiCOM.EditText)i_qr.Specific;

            c_cdc.Item.Enabled = false;
            c_id.Item.Enabled = false;
            c_kude.Item.Enabled = false;
            c_xml.Item.Enabled = false;
            c_mensaje.Item.Enabled = false;
            c_estado.Item.Enabled = false;
            c_fecha.Item.Enabled = false;
            c_qr.Item.Enabled = false;
        }

        //funcion para autofactura
        private static void CrearAutofactura()
        {

        }

        //funcion para crear nota de debito
        private static void CrearNotaDebito(string codigo)
        {
            try
            {
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM OINV T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE OINV SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from OINV where \"DocNum\"='" + codigo + "'");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);

                #region QUERY NOTA DEBITO
                //consultamos cual direccion se eligio
                if (!string.IsNullOrEmpty(direShip))
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                   "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\"))," +
                                   "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                   "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                   "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                   "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                   "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\",T0.\"TransId\" " +
                                   "FROM OINV T0 INNER JOIN INV1 T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                   "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                   "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                   "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                   "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                   "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                   "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                   "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                   "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                   "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                   "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                   "WHERE T0.\"DocNum\"='" + codigo + "' and T0.\"DocSubType\"='DN'");
                    }
                    else
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                   "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\"))," +
                                   "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                   "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                   "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                   "T0.\"U_TRANSPORTISTA\",T0.\"U_CHOFERES\",T0.\"U_VEHICULOS\",T11.\"U_MARCA\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                   "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\",T0.\"TransId\" " +
                                   "FROM OINV T0 INNER JOIN INV1 T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                   "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                   "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                   "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                   "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                   "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                   "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                   "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                   "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                   "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                   "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                   "WHERE T0.\"DocNum\"='" + codigo + "' and T0.\"DocSubType\"='DN'");
                    }
                }
                else
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                   "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\"))," +
                                   "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                   "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                   "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                   "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                   "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\",T0.\"TransId\" " +
                                   "FROM OINV T0 INNER JOIN INV1 T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                   "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                   "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                   "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                   "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                   "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                   "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                   "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                   "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                   "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                   "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                   "WHERE T0.\"DocNum\"='" + codigo + "' and T0.\"DocSubType\"='DN'");
                    }
                    else
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                   "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\"))," +
                                   "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                   "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                   "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                   "T0.\"U_TRANSPORTISTA\",T0.\"U_CHOFERES\",T0.\"U_VEHICULOS\",T11.\"U_MARCA\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                   "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\",T0.\"TransId\" " +
                                   "FROM OINV T0 INNER JOIN INV1 T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                   "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                   "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                   "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                   "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                   "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                   "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                   "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                   "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                   "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                   "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                   "WHERE T0.\"DocNum\"='" + codigo + "' and T0.\"DocSubType\"='DN'");
                    }
                }
                #endregion


                String Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string transId = oDatos.Fields.Item(46).Value.ToString();
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from INV1 where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                ////actualizamos el folio de la factura
                //Recordset oActFolio;
                //oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oActFolio.DoQuery("UPDATE OINV SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "' and \"DocSubType\"='DN'");
                ////actualizamos la numeracion de la serie           
                //Recordset oActSerie;
                //oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = oDatos.Fields.Item(4).Value.ToString();
                int index = var.IndexOf("-");
                int can = oDatos.Fields.Item(4).Value.ToString().Length;
                string ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                string dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                //instaciamos los objetos que vutilizaremos
                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                #endregion
                #endregion

                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                //gTimb
                gTimb.iTiDE = "6";
                gTimb.dDesTiDE = "Nota de débito electrónica";
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }
                gOpeCom.iTipTra = oDatos.Fields.Item(23).Value.ToString();
                gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";
                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = "1";// oDatos.Fields.Item(26).Value.ToString();
                gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                gDatRec.iTiContRec = "1";// oDatos.Fields.Item(27).Value.ToString();
                                         //si es contribuyente le pasamos el ruc sino la cedula
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }
                else
                {
                    gDatRec.dNumIDRec = oDatos.Fields.Item(4).Value.ToString();
                    gDatRec.iTipIDRec = "1";
                }
                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";  
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //motivo de emision 
                gCamNCDE.iMotEmi = "1";//hay que modificar
                                       //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto
                while (!oDatos.EoF)
                {
                    #region DETALLE DOCUMENTO
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                       //gValorItem
                        gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA.iAfecIVA = "1";
                            gCamIVA.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA.iAfecIVA = "3";
                            gCamIVA.dBasGravIVA = 0;
                            gCamIVA.dLiqIVAItem = 0;
                        }
                        gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem.gValorRestaItem = gValorRestaItem;
                        gCamItem.gValorItem = gValorItem;
                        gCamItem.gCamIVA = gCamIVA;
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem2.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA2.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA2.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA2.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA2.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA2.iAfecIVA = "3";
                            gCamIVA2.dBasGravIVA = 0;
                            gCamIVA2.dLiqIVAItem = 0;
                        }
                        gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem2.gValorRestaItem = gValorRestaItem2;
                        gCamItem2.gValorItem = gValorItem2;
                        gCamItem2.gCamIVA = gCamIVA2;
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {
                        gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem3.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA3.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA3.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA3.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA3.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA3.iAfecIVA = "3";
                            gCamIVA3.dBasGravIVA = 0;
                            gCamIVA3.dLiqIVAItem = 0;
                        }
                        gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem3.gValorRestaItem = gValorRestaItem3;
                        gCamItem3.gValorItem = gValorItem3;
                        gCamItem3.gCamIVA = gCamIVA3;
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem4.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA4.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA4.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA4.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA4.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA4.iAfecIVA = "3";
                            gCamIVA4.dBasGravIVA = 0;
                            gCamIVA4.dLiqIVAItem = 0;
                        }
                        gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem4.gValorRestaItem = gValorRestaItem4;
                        gCamItem4.gValorItem = gValorItem4;
                        gCamItem4.gCamIVA = gCamIVA4;
                        gCamItem1[f] = gCamItem4;
                    }
                    if (f == 4)
                    {
                        gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem5.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA5.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA5.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA5.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA5.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA5.iAfecIVA = "3";
                            gCamIVA5.dBasGravIVA = 0;
                            gCamIVA5.dLiqIVAItem = 0;
                        }
                        gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem5.gValorRestaItem = gValorRestaItem5;
                        gCamItem5.gValorItem = gValorItem5;
                        gCamItem5.gCamIVA = gCamIVA5;
                        gCamItem1[f] = gCamItem5;
                    }
                    if (f == 5)
                    {
                        gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem6.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA4.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA6.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA6.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA6.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA6.iAfecIVA = "3";
                            gCamIVA6.dBasGravIVA = 0;
                            gCamIVA6.dLiqIVAItem = 0;
                        }
                        gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem6.gValorRestaItem = gValorRestaItem6;
                        gCamItem6.gValorItem = gValorItem6;
                        gCamItem6.gCamIVA = gCamIVA6;
                        gCamItem1[f] = gCamItem6;
                    }
                    if (f == 6)
                    {
                        gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem7.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA7.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA7.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA7.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA7.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA7.iAfecIVA = "3";
                            gCamIVA7.dBasGravIVA = 0;
                            gCamIVA7.dLiqIVAItem = 0;
                        }
                        gCamIVA7.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem7.gValorRestaItem = gValorRestaItem7;
                        gCamItem7.gValorItem = gValorItem7;
                        gCamItem7.gCamIVA = gCamIVA7;
                        gCamItem1[f] = gCamItem7;
                    }
                    if (f == 7)
                    {
                        gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem8.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA8.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA8.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA8.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA8.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA8.iAfecIVA = "3";
                            gCamIVA8.dBasGravIVA = 0;
                            gCamIVA8.dLiqIVAItem = 0;
                        }
                        gCamIVA8.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem8.gValorRestaItem = gValorRestaItem8;
                        gCamItem8.gValorItem = gValorItem8;
                        gCamItem8.gCamIVA = gCamIVA8;
                        gCamItem1[f] = gCamItem8;
                    }
                    if (f == 8)
                    {
                        gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem9.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA9.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA9.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA9.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA9.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA9.iAfecIVA = "3";
                            gCamIVA9.dBasGravIVA = 0;
                            gCamIVA9.dLiqIVAItem = 0;
                        }
                        gCamIVA9.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem9.gValorRestaItem = gValorRestaItem9;
                        gCamItem9.gValorItem = gValorItem9;
                        gCamItem9.gCamIVA = gCamIVA9;
                        gCamItem1[f] = gCamItem9;
                    }
                    if (f == 9)
                    {
                        gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem10.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA10.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA10.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA10.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA10.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA10.iAfecIVA = "3";
                            gCamIVA10.dBasGravIVA = 0;
                            gCamIVA10.dLiqIVAItem = 0;
                        }
                        gCamIVA10.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem10.gValorRestaItem = gValorRestaItem10;
                        gCamItem10.gValorItem = gValorItem10;
                        gCamItem10.gCamIVA = gCamIVA10;
                        gCamItem1[f] = gCamItem10;
                    }
                    if (f == 10)
                    {
                        gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem11.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA11.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA11.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA11.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA11.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA11.iAfecIVA = "3";
                            gCamIVA11.dBasGravIVA = 0;
                            gCamIVA11.dLiqIVAItem = 0;
                        }
                        gCamIVA11.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem11.gValorRestaItem = gValorRestaItem11;
                        gCamItem11.gValorItem = gValorItem11;
                        gCamItem11.gCamIVA = gCamIVA11;
                        gCamItem1[f] = gCamItem11;
                    }
                    if (f == 11)
                    {
                        gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem12.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA12.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA12.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA12.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA12.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA12.iAfecIVA = "3";
                            gCamIVA12.dBasGravIVA = 0;
                            gCamIVA12.dLiqIVAItem = 0;
                        }
                        gCamIVA12.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem12.gValorRestaItem = gValorRestaItem12;
                        gCamItem12.gValorItem = gValorItem12;
                        gCamItem12.gCamIVA = gCamIVA12;
                        gCamItem1[f] = gCamItem12;
                    }
                    if (f == 12)
                    {
                        gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem13.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA13.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA13.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA13.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA13.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA13.iAfecIVA = "3";
                            gCamIVA13.dBasGravIVA = 0;
                            gCamIVA13.dLiqIVAItem = 0;
                        }
                        gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem13.gValorRestaItem = gValorRestaItem13;
                        gCamItem13.gValorItem = gValorItem13;
                        gCamItem13.gCamIVA = gCamIVA13;
                        gCamItem1[f] = gCamItem13;
                    }
                    if (f == 13)
                    {
                        gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem14.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA14.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA14.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA14.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA14.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA14.iAfecIVA = "3";
                            gCamIVA14.dBasGravIVA = 0;
                            gCamIVA14.dLiqIVAItem = 0;
                        }
                        gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem14.gValorRestaItem = gValorRestaItem14;
                        gCamItem14.gValorItem = gValorItem14;
                        gCamItem14.gCamIVA = gCamIVA14;
                        gCamItem1[f] = gCamItem14;
                    }
                    if (f == 14)
                    {
                        gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem15.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA15.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA15.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA15.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA15.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA15.iAfecIVA = "3";
                            gCamIVA15.dBasGravIVA = 0;
                            gCamIVA15.dLiqIVAItem = 0;
                        }
                        gCamIVA15.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem15.gValorRestaItem = gValorRestaItem15;
                        gCamItem15.gValorItem = gValorItem15;
                        gCamItem15.gCamIVA = gCamIVA15;
                        gCamItem1[f] = gCamItem15;
                    }
                    if (f == 15)
                    {
                        gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem16.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA16.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA16.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA16.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA16.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA16.iAfecIVA = "3";
                            gCamIVA16.dBasGravIVA = 0;
                            gCamIVA16.dLiqIVAItem = 0;
                        }
                        gCamIVA16.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem16.gValorRestaItem = gValorRestaItem16;
                        gCamItem16.gValorItem = gValorItem16;
                        gCamItem16.gCamIVA = gCamIVA16;
                        gCamItem1[f] = gCamItem16;
                    }
                    if (f == 16)
                    {
                        gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem17.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA17.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA17.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA17.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA17.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA17.iAfecIVA = "3";
                            gCamIVA17.dBasGravIVA = 0;
                            gCamIVA17.dLiqIVAItem = 0;
                        }
                        gCamIVA17.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem17.gValorRestaItem = gValorRestaItem17;
                        gCamItem17.gValorItem = gValorItem17;
                        gCamItem17.gCamIVA = gCamIVA17;
                        gCamItem1[f] = gCamItem17;
                    }
                    if (f == 17)
                    {
                        gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem18.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA18.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA18.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA18.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA18.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA18.iAfecIVA = "3";
                            gCamIVA18.dBasGravIVA = 0;
                            gCamIVA18.dLiqIVAItem = 0;
                        }
                        gCamIVA18.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem18.gValorRestaItem = gValorRestaItem18;
                        gCamItem18.gValorItem = gValorItem18;
                        gCamItem18.gCamIVA = gCamIVA18;
                        gCamItem1[f] = gCamItem18;
                    }
                    if (f == 18)
                    {
                        gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem19.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA19.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA19.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA19.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA19.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA19.iAfecIVA = "3";
                            gCamIVA19.dBasGravIVA = 0;
                            gCamIVA19.dLiqIVAItem = 0;
                        }
                        gCamIVA19.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem19.gValorRestaItem = gValorRestaItem19;
                        gCamItem19.gValorItem = gValorItem19;
                        gCamItem19.gCamIVA = gCamIVA19;
                        gCamItem1[f] = gCamItem19;
                    }
                    if (f == 19)
                    {
                        gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem20.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA20.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA20.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA20.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA20.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA20.iAfecIVA = "3";
                            gCamIVA20.dBasGravIVA = 0;
                            gCamIVA20.dLiqIVAItem = 0;
                        }
                        gCamIVA20.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem20.gValorRestaItem = gValorRestaItem20;
                        gCamItem20.gValorItem = gValorItem20;
                        gCamItem20.gCamIVA = gCamIVA20;
                        gCamItem1[f] = gCamItem20;
                    }
                    if (f == 20)
                    {
                        gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem21.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem21.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem21.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem21.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA21.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA21.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA21.iAfecIVA = "3";
                            gCamIVA21.dBasGravIVA = 0;
                            gCamIVA21.dLiqIVAItem = 0;
                        }
                        gCamIVA21.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem21.gValorRestaItem = gValorRestaItem21;
                        gCamItem21.gValorItem = gValorItem21;
                        gCamItem21.gCamIVA = gCamIVA21;
                        gCamItem1[f] = gCamItem21;
                    }
                    if (f == 21)
                    {
                        gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem22.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem22.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem22.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem22.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA22.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA22.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA22.iAfecIVA = "3";
                            gCamIVA22.dBasGravIVA = 0;
                            gCamIVA22.dLiqIVAItem = 0;
                        }
                        gCamIVA22.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem22.gValorRestaItem = gValorRestaItem22;
                        gCamItem22.gValorItem = gValorItem22;
                        gCamItem22.gCamIVA = gCamIVA22;
                        gCamItem1[f] = gCamItem22;
                    }
                    if (f == 22)
                    {
                        gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem23.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem23.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem23.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem23.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA23.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA23.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA23.iAfecIVA = "3";
                            gCamIVA23.dBasGravIVA = 0;
                            gCamIVA23.dLiqIVAItem = 0;
                        }
                        gCamIVA23.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem23.gValorRestaItem = gValorRestaItem23;
                        gCamItem23.gValorItem = gValorItem23;
                        gCamItem23.gCamIVA = gCamIVA23;
                        gCamItem1[f] = gCamItem23;
                    }
                    if (f == 23)
                    {
                        gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem24.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem24.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem24.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem24.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA24.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA24.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA24.iAfecIVA = "3";
                            gCamIVA24.dBasGravIVA = 0;
                            gCamIVA24.dLiqIVAItem = 0;
                        }
                        gCamIVA24.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem24.gValorRestaItem = gValorRestaItem24;
                        gCamItem24.gValorItem = gValorItem24;
                        gCamItem24.gCamIVA = gCamIVA24;
                        gCamItem1[f] = gCamItem24;
                    }
                    if (f == 24)
                    {
                        gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem25.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem25.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem25.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem25.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA25.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA25.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA25.iAfecIVA = "3";
                            gCamIVA25.dBasGravIVA = 0;
                            gCamIVA25.dLiqIVAItem = 0;
                        }
                        gCamIVA25.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem25.gValorRestaItem = gValorRestaItem25;
                        gCamItem25.gValorItem = gValorItem25;
                        gCamItem25.gCamIVA = gCamIVA25;
                        gCamItem1[f] = gCamItem25;
                    }
                    if (f == 25)
                    {
                        gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem26.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem26.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem26.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem26.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA26.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA26.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA26.iAfecIVA = "3";
                            gCamIVA26.dBasGravIVA = 0;
                            gCamIVA26.dLiqIVAItem = 0;
                        }
                        gCamIVA26.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem26.gValorRestaItem = gValorRestaItem26;
                        gCamItem26.gValorItem = gValorItem26;
                        gCamItem26.gCamIVA = gCamIVA26;
                        gCamItem1[f] = gCamItem26;
                    }
                    if (f == 26)
                    {
                        gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem27.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem27.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem27.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem27.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA27.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA27.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA27.iAfecIVA = "3";
                            gCamIVA27.dBasGravIVA = 0;
                            gCamIVA27.dLiqIVAItem = 0;
                        }
                        gCamIVA27.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem27.gValorRestaItem = gValorRestaItem27;
                        gCamItem27.gValorItem = gValorItem27;
                        gCamItem27.gCamIVA = gCamIVA27;
                        gCamItem1[f] = gCamItem27;
                    }
                    if (f == 27)
                    {
                        gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem28.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem28.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem28.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem28.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA20.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA28.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA28.iAfecIVA = "3";
                            gCamIVA28.dBasGravIVA = 0;
                            gCamIVA28.dLiqIVAItem = 0;
                        }
                        gCamIVA28.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem28.gValorRestaItem = gValorRestaItem28;
                        gCamItem28.gValorItem = gValorItem28;
                        gCamItem28.gCamIVA = gCamIVA28;
                        gCamItem1[f] = gCamItem28;
                    }
                    if (f == 28)
                    {
                        gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem29.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem29.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem29.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem29.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA29.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA29.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA29.iAfecIVA = "3";
                            gCamIVA29.dBasGravIVA = 0;
                            gCamIVA29.dLiqIVAItem = 0;
                        }
                        gCamIVA29.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem29.gValorRestaItem = gValorRestaItem29;
                        gCamItem29.gValorItem = gValorItem29;
                        gCamItem29.gCamIVA = gCamIVA29;
                        gCamItem1[f] = gCamItem29;
                    }
                    if (f == 29)
                    {
                        gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem30.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem30.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem30.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem30.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA30.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA30.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA30.iAfecIVA = "3";
                            gCamIVA30.dBasGravIVA = 0;
                            gCamIVA30.dLiqIVAItem = 0;
                        }
                        gCamIVA30.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem30.gValorRestaItem = gValorRestaItem30;
                        gCamItem30.gValorItem = gValorItem30;
                        gCamItem30.gCamIVA = gCamIVA30;
                        gCamItem1[f] = gCamItem30;
                    }
                    if (f == 30)
                    {
                        gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem31.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem31.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem31.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem31.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA31.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA31.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA31.iAfecIVA = "3";
                            gCamIVA31.dBasGravIVA = 0;
                            gCamIVA31.dLiqIVAItem = 0;
                        }
                        gCamIVA31.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem31.gValorRestaItem = gValorRestaItem31;
                        gCamItem31.gValorItem = gValorItem31;
                        gCamItem31.gCamIVA = gCamIVA31;
                        gCamItem1[f] = gCamItem31;
                    }
                    if (f == 31)
                    {
                        gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem32.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem32.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem32.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem32.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA32.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA32.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA32.iAfecIVA = "3";
                            gCamIVA32.dBasGravIVA = 0;
                            gCamIVA32.dLiqIVAItem = 0;
                        }
                        gCamIVA32.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem32.gValorRestaItem = gValorRestaItem32;
                        gCamItem32.gValorItem = gValorItem32;
                        gCamItem32.gCamIVA = gCamIVA32;
                        gCamItem1[f] = gCamItem32;
                    }
                    if (f == 32)
                    {
                        gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem33.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem33.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem33.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem33.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA33.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA33.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA33.iAfecIVA = "3";
                            gCamIVA33.dBasGravIVA = 0;
                            gCamIVA33.dLiqIVAItem = 0;
                        }
                        gCamIVA33.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem33.gValorRestaItem = gValorRestaItem33;
                        gCamItem33.gValorItem = gValorItem33;
                        gCamItem33.gCamIVA = gCamIVA33;
                        gCamItem1[f] = gCamItem33;
                    }
                    if (f == 33)
                    {
                        gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem34.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem34.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem34.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem34.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA34.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA34.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA34.iAfecIVA = "3";
                            gCamIVA34.dBasGravIVA = 0;
                            gCamIVA34.dLiqIVAItem = 0;
                        }
                        gCamIVA34.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem34.gValorRestaItem = gValorRestaItem34;
                        gCamItem34.gValorItem = gValorItem34;
                        gCamItem34.gCamIVA = gCamIVA34;
                        gCamItem1[f] = gCamItem34;
                    }
                    if (f == 34)
                    {
                        gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem35.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem35.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem35.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem35.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA35.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA35.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA35.iAfecIVA = "3";
                            gCamIVA35.dBasGravIVA = 0;
                            gCamIVA35.dLiqIVAItem = 0;
                        }
                        gCamIVA35.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem35.gValorRestaItem = gValorRestaItem35;
                        gCamItem35.gValorItem = gValorItem35;
                        gCamItem35.gCamIVA = gCamIVA35;
                        gCamItem1[f] = gCamItem35;
                    }
                    #endregion
                    f++;
                    oDatos.MoveNext();
                }

                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = "NOTA_DEBITO";
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;

                if (electronico.Equals("Si"))
                {

                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //DocAsoc.DoQuery("SELECT T1.\"U_CDC\" FROM RIN1 T0 LEFT JOIN OINV T1 ON T1.\"DocEntry\"=T0.\"BaseEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_CDC\" FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "1";
                        gCamDEAsoc.dCdCDERef = DocAsoc.Fields.Item(0).Value.ToString();
                        DocAsoc.MoveNext();
                    }
                }
                if (electronico.Equals("No"))
                {
                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //DocAsoc.DoQuery("SELECT T1.\"U_TIMB\",T1.\"U_ESTA\",T1.\"U_PEMI\",T1.\"FolioNum\",T1.\"DocDate\" FROM RIN1 T0 LEFT JOIN OINV T1 ON T1.\"DocEntry\"=T0.\"BaseEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_TIMB\",T0.\"U_ESTA\",T0.\"U_PEMI\",T0.\"FolioNum\",T0.\"DocDate\", " +
                                    "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\" " +
                                    "FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {

                        //gCamDEAsoc.iTipDocAso = "2";
                        //gCamDEAsoc.dNTimDI = DocAsoc.Fields.Item(0).Value.ToString();//timbrado
                        //gCamDEAsoc.dEstDocAso = DocAsoc.Fields.Item(1).Value.ToString();//establecimiento
                        //gCamDEAsoc.dPExpDocAso = DocAsoc.Fields.Item(2).Value.ToString();//punto de expedicion
                        //gCamDEAsoc.dNumDocAso = DocAsoc.Fields.Item(3).Value.ToString(); ;//folio
                        //gCamDEAsoc.iTipoDocAso = "1";//factura
                        //DateTime FechaDA = DateTime.Parse(DocAsoc.Fields.Item(4).Value.ToString());
                        //string hora2 = DocAsoc.Fields.Item(5).Value.ToString();
                        //string fechaDoc = FechaDA + "T" + hora2;
                        ////string DAfecha = DateTime.Parse();//FechaDA.ToString("YYYY-MM-DD");//fecha de la factura YYYY-mm-DD
                        //gCamDEAsoc.dFecEmiDI = DateTime.Parse(fechaDoc);
                        //gCamDEAsoc.dFecEmiDISpecified = true;
                        //gCamDEAsoc1[0] = gCamDEAsoc;
                        //gDtipDE.gCamNCDE = gCamNCDE;
                        //DE.gCamDEAsoc = gCamDEAsoc1;
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "2";
                        gCamDEAsoc.dNTimDI = DocAsoc.Fields.Item(0).Value.ToString();//timbrado
                        gCamDEAsoc.dEstDocAso = DocAsoc.Fields.Item(1).Value.ToString();//establecimiento
                        gCamDEAsoc.dPExpDocAso = DocAsoc.Fields.Item(2).Value.ToString();//punto de expedicion
                        gCamDEAsoc.dNumDocAso = DocAsoc.Fields.Item(3).Value.ToString(); ;//folio
                        gCamDEAsoc.iTipoDocAso = "1";//factura
                        DateTime FechaDA = DateTime.Parse(DocAsoc.Fields.Item(4).Value.ToString());
                        string hora2 = DocAsoc.Fields.Item(5).Value.ToString();
                        string DAfecha = FechaDA.ToString("yyyy-MM-dd");//fecha de la factura YYYY-mm-DD
                        gCamDEAsoc.dFecEmiDI = DateTime.Parse(DAfecha);
                        gCamDEAsoc.dFecEmiDISpecified = true;
                        DocAsoc.MoveNext();

                    }


                }
                gCamCond.gPaConEIni = gPaConEIni1;
                gDtipDE.gCamItem = gCamItem1;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento
                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE OINV SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "', \"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocEntry\"='" + Entry + "' and \"DocSubType\"='DN'");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con Error!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    //actualizamos el folio de la factura
                    Recordset oActFolio;
                    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActFolio.DoQuery("UPDATE OINV SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocEntry\"='" + Entry + "' and \"DocSubType\"='DN'");
                    //actualizamos el folio del asiento
                    Recordset oActAsiento;
                    oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");


                    //actualizamos la numeracion de la serie           
                    Recordset oActSerie;
                    oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE OINV SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "' and \"DocSubType\"='DN'");
                    //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }

            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
                //oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
            }

        }

        //funcion para crear factura de exportacion
        private static void CrearDocumentoExport(string codigo, string tablacab, string tabladet, string documento, string template, string descdoc, string infoExp, int cantidadGrilla)
        {
            try
            {
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'  AND T0.\"DocSubType\"='IX' ");
                //procedemos a actualizar el documento
                //SAPbobsCOM.Recordset oDocAct;
                //oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "'  AND \"DocSubType\"='IX' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'  AND \"DocSubType\"='IX' ");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //consultamos cual direccion se eligio
                //oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                //                      "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\")) END," +
                //                      "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                //                      "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                //                      "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                //                      "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                //                      "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                //                      "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                //                      "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                //                      "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                //                      "T13.\"U_DESC_SET_FE\",1 " +
                //                      "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                //                      "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                //                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                //                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                //                      "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                //                      "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                //                      "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                //                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                //                      "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                //                      "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                //                      "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                //                      "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                //                      "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                //                      "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                //                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                //                      "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX'");

                #region QUERY DOCUMENTO
                if (!string.IsNullOrEmpty(direShip))
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\" ");
                    }
                    else
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_TRANSPORTISTA\",T0.\"U_CHOFERES\",T0.\"U_VEHICULOS\",T11.\"U_MARCA\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\" ");
                    }
                }
                else
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\" ");
                    }
                    else
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_TRANSPORTISTA\",T0.\"U_CHOFERES\",T0.\"U_VEHICULOS\",T11.\"U_MARCA\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\" ");
                    }
                }
                //DETALLE
                SAPbobsCOM.Recordset oDetalleExp;
                oDetalleExp = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDetalleExp.DoQuery("SELECT \"U_U_ItemCode\",\"U_U_Dscription\",\"U_U_cantidad\",\"U_U_TotalLine\" FROM \"@EXPORT\" WHERE \"U_U_DocEntry\"='" + codigo + "'");
                #endregion

                string Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(46).Value.ToString();
                string rec_dist = oDatos.Fields.Item(47).Value.ToString();
                string rec_loc = oDatos.Fields.Item(48).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(49).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string RespFlete = oDatos.Fields.Item(50).Value.ToString();
                string InfoAdicional = oDatos.Fields.Item(51).Value.ToString();
                string transId = oDatos.Fields.Item(52).Value.ToString();
                string InfoExport = oDatos.Fields.Item(53).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                //actualizamos el folio de la factura
                //Recordset oActFolio;
                //oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                // //actualizamos la numeracion de la serie           
                // Recordset oActSerie;
                // oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());         
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (!oDatos.Fields.Item(25).Value.ToString().Equals("4"))
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                    //instaciamos los objetos que vutilizaremos
                }

                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                //linea 36
                servicio.gCamItem gCamItem36 = new servicio.gCamItem();
                servicio.gValorItem gValorItem36 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem36 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA36 = new servicio.gCamIVA();
                //linea 37
                servicio.gCamItem gCamItem37 = new servicio.gCamItem();
                servicio.gValorItem gValorItem37 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem37 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA37 = new servicio.gCamIVA();
                //linea 38
                servicio.gCamItem gCamItem38 = new servicio.gCamItem();
                servicio.gValorItem gValorItem38 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem38 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA38 = new servicio.gCamIVA();
                //linea 39
                servicio.gCamItem gCamItem39 = new servicio.gCamItem();
                servicio.gValorItem gValorItem39 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem39 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA39 = new servicio.gCamIVA();
                //linea 40
                servicio.gCamItem gCamItem40 = new servicio.gCamItem();
                servicio.gValorItem gValorItem40 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem40 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA40 = new servicio.gCamIVA();
                //linea 41
                servicio.gCamItem gCamItem41 = new servicio.gCamItem();
                servicio.gValorItem gValorItem41 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem41 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA41 = new servicio.gCamIVA();
                //linea 42
                servicio.gCamItem gCamItem42 = new servicio.gCamItem();
                servicio.gValorItem gValorItem42 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem42 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA42 = new servicio.gCamIVA();
                //linea 43
                servicio.gCamItem gCamItem43 = new servicio.gCamItem();
                servicio.gValorItem gValorItem43 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem43 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA43 = new servicio.gCamIVA();
                //linea 44
                servicio.gCamItem gCamItem44 = new servicio.gCamItem();
                servicio.gValorItem gValorItem44 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem44 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA44 = new servicio.gCamIVA();
                //linea 45
                servicio.gCamItem gCamItem45 = new servicio.gCamItem();
                servicio.gValorItem gValorItem45 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem45 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA45 = new servicio.gCamIVA();
                #endregion
                #endregion
                //string lplp = "EXPORTACION, CIP, CHILE, BG TRANSPORTE SRL, BG TRANSPORTE SRL, N/A, N/A, N/A, Intermediary Bank: Wells Fargo Bank N.A. (New York USA) Swift Code: PNBPUS3NNYC ABA Code: 026005092 Banco GNB Paraguay SA (Asunción, Paraguay) Swift Code: BGNBPYPX Account Number in PNBPUS3NNYC: 2000192000673 /1101705086 FRIGORIFICO GUARANI SACI - CIP: 129.136,95 USD - FLETE: 5.000,00 USD - SEGURO: 322,84 USD - FCA: 123.814,11 USD - 28 PALLETS - PESO NETO: KG. 23.914,25 - PESO BRUTO: KG.  24.966,35 - TOTAL PIEZAS: 8.641.-";
                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                gOpeDE.dInfoFisc = infoExp;
                gOpeDE.dInfoEmi = infoExp;
                //gTimb
                gTimb.iTiDE = documento;
                gTimb.dDesTiDE = descdoc;
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }

                gOpeCom.iTipTra = TipTra;// oDatos.Fields.Item(23).Value.ToString();
                gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";

                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                    gOpeCom.dTiCamSpecified = true;
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                //if (oDatos.Fields.Item(26).Value.ToString() == "2")
                //{
                //    gDatRec.iTiOpe = "4";
                //    //gDatRec.iTiContRec = "1";
                //}
                //else
                //{
                //    gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                //    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //}
                gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();
                gDatRec.dNumCasRec = "0";
                //gDatRec.dDesPaisRe = "Paraguay";
                if (oDatos.Fields.Item(16).Value.ToString() == "PRY")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }


                //}


                //REMITO
                #region REMITO
                if (!string.IsNullOrEmpty(trans))
                {
                    string chof = oDatos.Fields.Item(32).Value.ToString();
                    if (!chof.Equals("PERSONAL"))
                    {
                        string CedChofer = oDatos.Fields.Item(35).Value.ToString();
                        if (!string.IsNullOrEmpty(CedChofer))
                        {
                            string dirReceptor = oDatos.Fields.Item(5).Value.ToString();
                            string NewDirRec = null;
                            if (!Regex.IsMatch(dirReceptor, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                NewDirRec = Regex.Replace(dirReceptor, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                NewDirRec = dirReceptor;

                            }
                            string salDire = oDatos.Fields.Item(37).Value.ToString();
                            string newsalDire = null;
                            if (!Regex.IsMatch(salDire, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                newsalDire = Regex.Replace(salDire, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                newsalDire = salDire;

                            }
                            string DomFiscal = oDatos.Fields.Item(42).Value.ToString();
                            string newDomFiscal = null;
                            if (!Regex.IsMatch(DomFiscal, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                newDomFiscal = Regex.Replace(DomFiscal, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                newDomFiscal = DomFiscal;

                            }
                            string DireChofer = oDatos.Fields.Item(36).Value.ToString();
                            string newDireChofer = null;
                            if (!Regex.IsMatch(DireChofer, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                newDireChofer = Regex.Replace(DireChofer, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                newDireChofer = DireChofer;

                            }
                            string codTransp = null;
                            string descTrans = null;
                            if (oDatos.Fields.Item(38).Value.ToString() == varE)
                            {
                                codTransp = "1";
                                descTrans = "Propio";
                            }
                            else
                            {
                                codTransp = "2";
                                descTrans = "Tercero";
                            }
                            gDatRec.dDirRec = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                            gDatRec.dNumCasRec = "0";
                            if (oDatos.Fields.Item(25).Value.ToString() != "4")
                            {
                                gDatRec.cDepRec = rec_dep;
                                gDatRec.cDisRec = rec_dist;
                                gDatRec.cCiuRec = rec_loc;
                            }
                            //gCamSal               
                            gCamSal.dDirLocSal = newsalDire;// oDatos.Fields.Item(37).Value.ToString();
                            gCamSal.dNumCasSal = "0";
                            //gCamSal.dComp1Sal =  "aviadores del chaco";
                            gCamSal.cDepSal = sal_dep;
                            gCamSal.cCiuSal = sal_loc;
                            gCamSal.cDisSal = sal_dist;
                            //gCamEnt
                            gCamEnt.dDirLocEnt = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                            gCamEnt.dNumCasEnt = "0";
                            gCamEnt.cDepEnt = rec_dep;
                            gCamEnt.cCiuEnt = rec_loc;
                            gCamEnt.cDisEnt = rec_dist;
                            gCamEnt1[0] = gCamEnt;
                            gTransp.iTipTrans = codTransp;// "2";
                            gTransp.dDesTipTrans = descTrans;// "Tercero";
                            gTransp.iModTrans = "1";
                            gTransp.iRespFlete = RespFlete;
                            gTransp.dIniTras = fe;
                            gTransp.dIniTrasSpecified = true;
                            gTransp.dFinTras = fe;
                            gTransp.dFinTrasSpecified = true;
                            //gVehTras
                            //gTransp.gVehTras = gVehTras1;
                            gVehTras1[0] = gVehTras;
                            gVehTras.dTiVehTras = "Terrestre";
                            gVehTras.dMarVeh = oDatos.Fields.Item(34).Value.ToString();
                            gVehTras.dTipIdenVeh = "2";
                            gVehTras.dNroMatVeh = oDatos.Fields.Item(33).Value.ToString();
                            //gCamTrans
                            gCamTrans.iNatTrans = oDatos.Fields.Item(40).Value.ToString();
                            gCamTrans.dNomTrans = oDatos.Fields.Item(39).Value.ToString();
                            //deconstruimos el RUC del transportista
                            string rucCam = null;
                            string dvCam = null;
                            if (oDatos.Fields.Item(40).Value.ToString() == "1")
                            {
                                string varCam = oDatos.Fields.Item(38).Value.ToString();
                                int indexCam = varCam.IndexOf("-");
                                int canCam = oDatos.Fields.Item(38).Value.ToString().Length;
                                rucCam = oDatos.Fields.Item(38).Value.ToString().Remove(indexCam, canCam - indexCam);
                                dvCam = oDatos.Fields.Item(38).Value.ToString().Remove(0, indexCam + 1);
                            }

                            string paisTrans = oDatos.Fields.Item(43).Value.ToString();
                            if (paisTrans.Equals("PRY"))
                            {
                                gCamTrans.dRucTrans = rucCam;
                                gCamTrans.dDVTrans = dvCam;
                            }
                            else
                            {
                                gCamTrans.dNumIDTrans = oDatos.Fields.Item(38).Value.ToString();
                                gCamTrans.iTipIDTrans = "3";
                                gCamTrans.dDTipIDTrans = "Cédula extranjera";
                            }
                            gCamTrans.cNacTrans = oDatos.Fields.Item(43).Value.ToString();
                            gCamTrans.dDesNacTrans = oDatos.Fields.Item(44).Value.ToString();
                            gCamTrans.dDomFisc = newDomFiscal;// oDatos.Fields.Item(42).Value.ToString();
                            gCamTrans.dNumIDChof = oDatos.Fields.Item(35).Value.ToString();
                            gCamTrans.dNomChof = oDatos.Fields.Item(32).Value.ToString();
                            gCamTrans.dDirChof = newDireChofer;// oDatos.Fields.Item(36).Value.ToString();
                                                               //gCamNRE
                                                               //gCamNRE.iMotEmiNR = "1";
                                                               //gCamNRE.dDesMotEmiNR = "Traslado por ventas";
                                                               //gCamNRE.iRespEmiNR = "1";
                                                               //gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                            gCamNRE.dKmR = "3";
                            //gDtipDE.gCamNRE = gCamNRE;
                            gTransp.gCamTrans = gCamTrans;
                            gTransp.gCamSal = gCamSal;
                            gTransp.gCamEnt = gCamEnt1;
                            gTransp.gVehTras = gVehTras1;
                            gDtipDE.gTransp = gTransp;
                        }

                    }


                }
                #endregion

                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                                                                         //gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                                                                         //gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //gDatRec.dCelRec = "0981888493";
                                                                         //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                if (tablacab.Equals("OINV"))
                {
                    //gCamFE
                    gCamFE.iIndPres = oDatos.Fields.Item(22).Value.ToString();
                    //gCamCond
                    gCamCond.iCondOpe = oDatos.Fields.Item(9).Value.ToString(); //"2";               

                    if (oDatos.Fields.Item(9).Value.ToString() == "2")
                    {
                        //consultamos si el campo de cuota es mayor a cero
                        int Cuota = int.Parse(oDatos.Fields.Item(20).Value.ToString());
                        string concred = null;
                        if (Cuota > 0)
                        {
                            concred = "2";
                        }
                        else
                        {
                            concred = "1";
                        }
                        if (concred.Equals("2"))
                        {
                            gPagCred.dCuotas = Cuota.ToString();
                            gPagCred.iCondCred = concred;
                        }
                        else
                        {
                            //gPagCred
                            int plazo = int.Parse(oDatos.Fields.Item(10).Value.ToString());
                            gPagCred.dPlazoCre = plazo.ToString("D2");//oDatos.Fields.Item(10).Value.ToString(); //"12";
                            gPagCred.iCondCred = concred;
                        }
                    }
                }
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                    {
                        gPaConEIni.dTiCamTiPag = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                        gPaConEIni.dTiCamTiPagSpecified = true;
                    }
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                //gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto

                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //detalle export
                string codItem = null;
                string descr = null;
                string cant = null;
                string totallinea = null;
                //validad cual detalle mandar
                if (cantidadGrilla > 0)
                {
                    while (!oDetalleExp.EoF)
                    {
                        codItem = oDetalleExp.Fields.Item(0).Value.ToString();
                        descr = oDetalleExp.Fields.Item(1).Value.ToString();
                        cant = oDetalleExp.Fields.Item(2).Value.ToString().Replace(".", ",");
                        totallinea = oDetalleExp.Fields.Item(3).Value.ToString().Replace(".", ",");

                        #region DETALLE EXPORT

                        if (f == 0)
                        {
                            gCamItem.dCodInt = codItem;
                            gCamItem.dDesProSer = descr;
                            gCamItem.dCantProSer = decimal.Parse(cant);
                            gValorItem.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), 7);
                            gValorItem.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA.iAfecIVA = "1";
                                gCamIVA.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA.dPropIVA = 100;
                                        gCamIVA.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA.dPropIVA = 100;
                                        gCamIVA.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), 7);
                                        gCamIVA.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), 7);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA.dPropIVA = 100;
                                        gCamIVA.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA.dPropIVA = 100;
                                        gCamIVA.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), 7);
                                        gCamIVA.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), 7);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA.iAfecIVA = "3";
                                gCamIVA.dBasGravIVA = 0;
                                gCamIVA.dLiqIVAItem = 0;
                            }
                            gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem.gValorRestaItem = gValorRestaItem;
                            gCamItem.gValorItem = gValorItem;
                            gCamItem.gCamIVA = gCamIVA;
                            gCamItem1[f] = gCamItem;
                        }
                        if (f == 1)
                        {
                            gCamItem2.dCodInt = codItem;
                            gCamItem2.dDesProSer = descr;
                            gCamItem2.dCantProSer = decimal.Parse(cant);
                            gValorItem2.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), 4);
                            gValorItem2.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem2.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem2.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA2.iAfecIVA = "1";
                                gCamIVA2.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA2.dPropIVA = 100;
                                        gCamIVA2.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA2.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA2.dPropIVA = 100;
                                        gCamIVA2.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), 4);
                                        gCamIVA2.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), 4);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA2.dPropIVA = 100;
                                        gCamIVA2.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA2.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA2.dPropIVA = 100;
                                        gCamIVA2.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), 4);
                                        gCamIVA2.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), 4);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA2.iAfecIVA = "3";
                                gCamIVA2.dBasGravIVA = 0;
                                gCamIVA2.dLiqIVAItem = 0;
                            }
                            gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem2.gValorRestaItem = gValorRestaItem2;
                            gCamItem2.gValorItem = gValorItem2;
                            gCamItem2.gCamIVA = gCamIVA2;
                            gCamItem1[f] = gCamItem2;
                        }
                        if (f == 2)
                        {
                            gCamItem3.dCodInt = codItem;
                            gCamItem3.dDesProSer = descr;
                            gCamItem3.dCantProSer = decimal.Parse(cant);
                            gValorItem3.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), 4);
                            gValorItem3.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem3.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem3.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA3.iAfecIVA = "1";
                                gCamIVA3.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA3.dPropIVA = 100;
                                        gCamIVA3.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA3.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA3.dPropIVA = 100;
                                        gCamIVA3.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), 4);
                                        gCamIVA3.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), 4);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA3.dPropIVA = 100;
                                        gCamIVA3.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA3.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA3.dPropIVA = 100;
                                        gCamIVA3.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), 4);
                                        gCamIVA3.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), 4);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA3.iAfecIVA = "3";
                                gCamIVA3.dBasGravIVA = 0;
                                gCamIVA3.dLiqIVAItem = 0;
                            }
                            gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem3.gValorRestaItem = gValorRestaItem3;
                            gCamItem3.gValorItem = gValorItem3;
                            gCamItem3.gCamIVA = gCamIVA3;
                            gCamItem1[f] = gCamItem3;
                        }
                        if (f == 3)
                        {
                            gCamItem4.dCodInt = codItem;
                            gCamItem4.dDesProSer = descr;
                            gCamItem4.dCantProSer = decimal.Parse(cant);
                            gValorItem4.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), 4);
                            gValorItem4.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem4.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem4.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA4.iAfecIVA = "1";
                                gCamIVA4.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA4.dPropIVA = 100;
                                        gCamIVA4.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA4.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA4.dPropIVA = 100;
                                        gCamIVA4.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), 4);
                                        gCamIVA4.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), 4);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA4.dPropIVA = 100;
                                        gCamIVA4.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA4.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA4.dPropIVA = 100;
                                        gCamIVA4.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), 4);
                                        gCamIVA4.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), 4);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA4.iAfecIVA = "3";
                                gCamIVA4.dBasGravIVA = 0;
                                gCamIVA4.dLiqIVAItem = 0;
                            }
                            gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem4.gValorRestaItem = gValorRestaItem4;
                            gCamItem4.gValorItem = gValorItem4;
                            gCamItem4.gCamIVA = gCamIVA4;
                            gCamItem1[f] = gCamItem4;
                        }
                        if (f == 4)
                        {
                            gCamItem5.dCodInt = codItem;
                            gCamItem5.dDesProSer = descr;
                            gCamItem5.dCantProSer = decimal.Parse(cant);
                            gValorItem5.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), 4);
                            gValorItem5.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem5.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem5.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA5.iAfecIVA = "1";
                                gCamIVA5.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA5.dPropIVA = 100;
                                        gCamIVA5.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA5.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA5.dPropIVA = 100;
                                        gCamIVA5.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), 4);
                                        gCamIVA5.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), 4);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA5.dPropIVA = 100;
                                        gCamIVA5.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA5.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA5.dPropIVA = 100;
                                        gCamIVA5.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), 4);
                                        gCamIVA5.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), 4);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA5.iAfecIVA = "3";
                                gCamIVA5.dBasGravIVA = 0;
                                gCamIVA5.dLiqIVAItem = 0;
                            }
                            gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem5.gValorRestaItem = gValorRestaItem5;
                            gCamItem5.gValorItem = gValorItem5;
                            gCamItem5.gCamIVA = gCamIVA5;
                            gCamItem1[f] = gCamItem5;
                        }
                        if (f == 5)
                        {
                            gCamItem6.dCodInt = codItem;
                            gCamItem6.dDesProSer = descr;
                            gCamItem6.dCantProSer = decimal.Parse(cant);
                            gValorItem6.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), 4);
                            gValorItem6.dTotBruOpeItem = decimal.Parse(totallinea);
                            //gValorRestaItem
                            gValorRestaItem6.dDescItem = 0;
                            //gValorRestaItem.dAntPreUniIt = 0;
                            //gValorRestaItem.dTotOpeItem = 0;  
                            gValorRestaItem6.dTotOpeItem = decimal.Parse(totallinea);
                            //gCamIVA
                            string IVA = oDatos.Fields.Item(15).Value.ToString();
                            if (IVA.Equals("5") || IVA.Equals("10"))
                            {
                                gCamIVA6.iAfecIVA = "1";
                                gCamIVA6.dPropIVA = 100;
                                if (IVA.Equals("10"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA6.dPropIVA = 100;
                                        gCamIVA6.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                        gCamIVA6.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                    }
                                    else
                                    {
                                        gCamIVA6.dPropIVA = 100;
                                        gCamIVA6.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), 4);
                                        gCamIVA6.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), 4);
                                    }

                                }
                                if (IVA.Equals("5"))
                                {
                                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                    {
                                        gCamIVA6.dPropIVA = 100;
                                        gCamIVA6.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                        gCamIVA6.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                    }
                                    else
                                    {
                                        gCamIVA6.dPropIVA = 100;
                                        gCamIVA6.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), 4);
                                        gCamIVA6.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), 4);
                                    }

                                }

                            }
                            else if (IVA.Equals("0"))
                            {
                                gCamIVA6.iAfecIVA = "3";
                                gCamIVA6.dBasGravIVA = 0;
                                gCamIVA6.dLiqIVAItem = 0;
                            }
                            gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                            gValorItem6.gValorRestaItem = gValorRestaItem6;
                            gCamItem6.gValorItem = gValorItem6;
                            gCamItem6.gCamIVA = gCamIVA6;
                            gCamItem1[f] = gCamItem6;
                        }

                        #endregion
                        f++;
                        oDetalleExp.MoveNext();
                        if (false == oCompany.InTransaction)
                        {
                            oCompany.StartTransaction();
                        }
                    }
                }
                else
                {
                    while (!oDatos.EoF)
                    {
                        if (!oDatos.Fields.Item(11).Value.ToString().Equals("I0000059") && !oDatos.Fields.Item(11).Value.ToString().Equals("I0000060") && !oDatos.Fields.Item(11).Value.ToString().Equals("I0000061"))
                        {
                            #region DETALLE DOCUMENTO
                            if (f == 0)
                            {
                                gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;                       

                                //gValorItem
                                string pp = oDatos.Fields.Item(14).Value.ToString();
                                gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA.iAfecIVA = "1";
                                    gCamIVA.dPropIVA = 100;
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA.dPropIVA = 100;
                                            gCamIVA.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA.dPropIVA = 100;
                                            gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                                            gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA.dPropIVA = 100;
                                            gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                                            gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA.iAfecIVA = "3";
                                    gCamIVA.dBasGravIVA = 0;
                                    gCamIVA.dLiqIVAItem = 0;
                                }
                                gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem.gValorRestaItem = gValorRestaItem;
                                gCamItem.gValorItem = gValorItem;
                                gCamItem.gCamIVA = gCamIVA;
                                gCamItem1[f] = gCamItem;
                            }
                            if (f == 1)
                            {
                                gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem2.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA2.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA2.dPropIVA = 100;
                                            gCamIVA2.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA2.dPropIVA = 100;
                                            gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                                            gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA2.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA2.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA2.dPropIVA = 100;
                                            gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                                            gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA2.iAfecIVA = "3";
                                    gCamIVA2.dBasGravIVA = 0;
                                    gCamIVA2.dLiqIVAItem = 0;
                                }
                                gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem2.gValorRestaItem = gValorRestaItem2;
                                gCamItem2.gValorItem = gValorItem2;
                                gCamItem2.gCamIVA = gCamIVA2;
                                gCamItem1[f] = gCamItem2;
                            }
                            if (f == 2)
                            {
                                gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem3.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA3.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA3.dPropIVA = 100;
                                            gCamIVA3.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA3.dPropIVA = 100;
                                            gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                                            gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA3.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA3.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA3.dPropIVA = 100;
                                            gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                                            gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA3.iAfecIVA = "3";
                                    gCamIVA3.dBasGravIVA = 0;
                                    gCamIVA3.dLiqIVAItem = 0;
                                }
                                gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem3.gValorRestaItem = gValorRestaItem3;
                                gCamItem3.gValorItem = gValorItem3;
                                gCamItem3.gCamIVA = gCamIVA3;
                                gCamItem1[f] = gCamItem3;
                            }
                            if (f == 3)
                            {
                                gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem4.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA4.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA4.dPropIVA = 100;
                                            gCamIVA4.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA4.dPropIVA = 100;
                                            gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                                            gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA4.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA4.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA4.dPropIVA = 100;
                                            gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                                            gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA4.iAfecIVA = "3";
                                    gCamIVA4.dBasGravIVA = 0;
                                    gCamIVA4.dLiqIVAItem = 0;
                                }
                                gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem4.gValorRestaItem = gValorRestaItem4;
                                gCamItem4.gValorItem = gValorItem4;
                                gCamItem4.gCamIVA = gCamIVA4;
                                gCamItem1[f] = gCamItem4;
                            }
                            if (f == 4)
                            {
                                gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                                //gValorItem
                                gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem5.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA5.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA5.dPropIVA = 100;
                                            gCamIVA5.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA5.dPropIVA = 100;
                                            gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                                            gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA5.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA5.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA5.dPropIVA = 100;
                                            gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                                            gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA5.iAfecIVA = "3";
                                    gCamIVA5.dBasGravIVA = 0;
                                    gCamIVA5.dLiqIVAItem = 0;
                                }
                                gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem5.gValorRestaItem = gValorRestaItem5;
                                gCamItem5.gValorItem = gValorItem5;
                                gCamItem5.gCamIVA = gCamIVA5;
                                gCamItem1[f] = gCamItem5;
                            }
                            if (f == 5)
                            {
                                gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                                //gValorItem
                                gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem6.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA6.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA6.dPropIVA = 100;
                                            gCamIVA6.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA6.dPropIVA = 100;
                                            gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                                            gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA6.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA6.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA6.dPropIVA = 100;
                                            gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                                            gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA6.iAfecIVA = "3";
                                    gCamIVA6.dBasGravIVA = 0;
                                    gCamIVA6.dLiqIVAItem = 0;
                                }
                                gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem6.gValorRestaItem = gValorRestaItem6;
                                gCamItem6.gValorItem = gValorItem6;
                                gCamItem6.gCamIVA = gCamIVA6;
                                gCamItem1[f] = gCamItem6;
                            }
                            if (f == 6)
                            {
                                gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem7.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA7.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA7.dPropIVA = 100;
                                            gCamIVA7.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA7.dPropIVA = 100;
                                            gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                                            gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA7.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA7.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA7.dPropIVA = 100;
                                            gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                                            gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA7.iAfecIVA = "3";
                                    gCamIVA7.dBasGravIVA = 0;
                                    gCamIVA7.dLiqIVAItem = 0;
                                }
                                gCamIVA7.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem7.gValorRestaItem = gValorRestaItem7;
                                gCamItem7.gValorItem = gValorItem7;
                                gCamItem7.gCamIVA = gCamIVA7;
                                gCamItem1[f] = gCamItem7;
                            }
                            if (f == 7)
                            {
                                gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                                //gValorItem
                                gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem8.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA8.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA8.dPropIVA = 100;
                                            gCamIVA8.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA8.dPropIVA = 100;
                                            gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                                            gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA8.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA8.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA8.dPropIVA = 100;
                                            gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                                            gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA8.iAfecIVA = "3";
                                    gCamIVA8.dBasGravIVA = 0;
                                    gCamIVA8.dLiqIVAItem = 0;
                                }
                                gCamIVA8.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem8.gValorRestaItem = gValorRestaItem8;
                                gCamItem8.gValorItem = gValorItem8;
                                gCamItem8.gCamIVA = gCamIVA8;
                                gCamItem1[f] = gCamItem8;
                            }
                            if (f == 8)
                            {
                                gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                                //gValorItem
                                gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem9.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA9.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA9.dPropIVA = 100;
                                            gCamIVA9.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA9.dPropIVA = 100;
                                            gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                                            gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA9.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA9.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA9.dPropIVA = 100;
                                            gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                                            gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA9.iAfecIVA = "3";
                                    gCamIVA9.dBasGravIVA = 0;
                                    gCamIVA9.dLiqIVAItem = 0;
                                }
                                gCamIVA9.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem9.gValorRestaItem = gValorRestaItem9;
                                gCamItem9.gValorItem = gValorItem9;
                                gCamItem9.gCamIVA = gCamIVA9;
                                gCamItem1[f] = gCamItem9;
                            }
                            if (f == 9)
                            {
                                gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem10.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA10.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA10.dPropIVA = 100;
                                            gCamIVA10.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA10.dPropIVA = 100;
                                            gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                                            gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA10.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA10.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA10.dPropIVA = 100;
                                            gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                                            gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA10.iAfecIVA = "3";
                                    gCamIVA10.dBasGravIVA = 0;
                                    gCamIVA10.dLiqIVAItem = 0;
                                }
                                gCamIVA10.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem10.gValorRestaItem = gValorRestaItem10;
                                gCamItem10.gValorItem = gValorItem10;
                                gCamItem10.gCamIVA = gCamIVA10;
                                gCamItem1[f] = gCamItem10;
                            }
                            if (f == 10)
                            {
                                gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem11.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA11.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA11.dPropIVA = 100;
                                            gCamIVA11.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA11.dPropIVA = 100;
                                            gCamIVA11.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA11.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA11.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA11.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA11.dPropIVA = 100;
                                            gCamIVA11.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA11.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA11.iAfecIVA = "3";
                                    gCamIVA11.dBasGravIVA = 0;
                                    gCamIVA11.dLiqIVAItem = 0;
                                }
                                gCamIVA11.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem11.gValorRestaItem = gValorRestaItem11;
                                gCamItem11.gValorItem = gValorItem11;
                                gCamItem11.gCamIVA = gCamIVA11;
                                gCamItem1[f] = gCamItem11;
                            }
                            if (f == 11)
                            {
                                gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem12.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA12.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA12.dPropIVA = 100;
                                            gCamIVA12.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA12.dPropIVA = 100;
                                            gCamIVA12.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA12.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA12.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA12.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA12.dPropIVA = 100;
                                            gCamIVA12.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA12.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA12.iAfecIVA = "3";
                                    gCamIVA12.dBasGravIVA = 0;
                                    gCamIVA12.dLiqIVAItem = 0;
                                }
                                gCamIVA12.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem12.gValorRestaItem = gValorRestaItem12;
                                gCamItem12.gValorItem = gValorItem12;
                                gCamItem12.gCamIVA = gCamIVA12;
                                gCamItem1[f] = gCamItem12;
                            }
                            if (f == 12)
                            {
                                gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem13.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA13.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA13.dPropIVA = 100;
                                            gCamIVA13.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA13.dPropIVA = 100;
                                            gCamIVA13.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA13.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA13.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA13.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA13.dPropIVA = 100;
                                            gCamIVA13.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA13.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA13.iAfecIVA = "3";
                                    gCamIVA13.dBasGravIVA = 0;
                                    gCamIVA13.dLiqIVAItem = 0;
                                }
                                gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem13.gValorRestaItem = gValorRestaItem13;
                                gCamItem13.gValorItem = gValorItem13;
                                gCamItem13.gCamIVA = gCamIVA13;
                                gCamItem1[f] = gCamItem13;
                            }
                            if (f == 13)
                            {
                                gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem14.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA14.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA14.dPropIVA = 100;
                                            gCamIVA14.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA14.dPropIVA = 100;
                                            gCamIVA14.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA14.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA14.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA14.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA14.dPropIVA = 100;
                                            gCamIVA14.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA14.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA14.iAfecIVA = "3";
                                    gCamIVA14.dBasGravIVA = 0;
                                    gCamIVA14.dLiqIVAItem = 0;
                                }
                                gCamIVA14.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem14.gValorRestaItem = gValorRestaItem14;
                                gCamItem14.gValorItem = gValorItem14;
                                gCamItem14.gCamIVA = gCamIVA14;
                                gCamItem1[f] = gCamItem14;
                            }
                            if (f == 14)
                            {
                                gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem15.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA15.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA15.dPropIVA = 100;
                                            gCamIVA15.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA15.dPropIVA = 100;
                                            gCamIVA15.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA15.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA15.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA15.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA15.dPropIVA = 100;
                                            gCamIVA15.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA15.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA15.iAfecIVA = "3";
                                    gCamIVA15.dBasGravIVA = 0;
                                    gCamIVA15.dLiqIVAItem = 0;
                                }
                                gCamIVA15.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem15.gValorRestaItem = gValorRestaItem15;
                                gCamItem15.gValorItem = gValorItem15;
                                gCamItem15.gCamIVA = gCamIVA15;
                                gCamItem1[f] = gCamItem15;
                            }
                            if (f == 15)
                            {
                                gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem16.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA16.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA16.dPropIVA = 100;
                                            gCamIVA16.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA16.dPropIVA = 100;
                                            gCamIVA16.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA16.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA16.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA16.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA16.dPropIVA = 100;
                                            gCamIVA16.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA16.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA16.iAfecIVA = "3";
                                    gCamIVA16.dBasGravIVA = 0;
                                    gCamIVA16.dLiqIVAItem = 0;
                                }
                                gCamIVA16.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem16.gValorRestaItem = gValorRestaItem16;
                                gCamItem16.gValorItem = gValorItem16;
                                gCamItem16.gCamIVA = gCamIVA16;
                                gCamItem1[f] = gCamItem16;
                            }
                            if (f == 16)
                            {
                                gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem17.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA17.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA17.dPropIVA = 100;
                                            gCamIVA17.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA17.dPropIVA = 100;
                                            gCamIVA17.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA17.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA17.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA17.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA17.dPropIVA = 100;
                                            gCamIVA17.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA17.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA17.iAfecIVA = "3";
                                    gCamIVA17.dBasGravIVA = 0;
                                    gCamIVA17.dLiqIVAItem = 0;
                                }
                                gCamIVA17.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem17.gValorRestaItem = gValorRestaItem17;
                                gCamItem17.gValorItem = gValorItem17;
                                gCamItem17.gCamIVA = gCamIVA17;
                                gCamItem1[f] = gCamItem17;
                            }
                            if (f == 17)
                            {
                                gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem18.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA18.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA18.dPropIVA = 100;
                                            gCamIVA18.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA18.dPropIVA = 100;
                                            gCamIVA18.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA18.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA18.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA18.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA18.dPropIVA = 100;
                                            gCamIVA18.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA18.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA18.iAfecIVA = "3";
                                    gCamIVA18.dBasGravIVA = 0;
                                    gCamIVA18.dLiqIVAItem = 0;
                                }
                                gCamIVA18.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem18.gValorRestaItem = gValorRestaItem18;
                                gCamItem18.gValorItem = gValorItem18;
                                gCamItem18.gCamIVA = gCamIVA18;
                                gCamItem1[f] = gCamItem18;
                            }
                            if (f == 18)
                            {
                                gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem19.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA19.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA19.dPropIVA = 100;
                                            gCamIVA19.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA19.dPropIVA = 100;
                                            gCamIVA19.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA19.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA19.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA19.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA19.dPropIVA = 100;
                                            gCamIVA19.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA19.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA19.iAfecIVA = "3";
                                    gCamIVA19.dBasGravIVA = 0;
                                    gCamIVA19.dLiqIVAItem = 0;
                                }
                                gCamIVA19.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem19.gValorRestaItem = gValorRestaItem19;
                                gCamItem19.gValorItem = gValorItem19;
                                gCamItem19.gCamIVA = gCamIVA19;
                                gCamItem1[f] = gCamItem19;
                            }
                            if (f == 19)
                            {
                                gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                                //gValorItem
                                gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem20.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA20.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA20.dPropIVA = 100;
                                            gCamIVA20.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA20.dPropIVA = 100;
                                            gCamIVA20.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA20.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA20.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA20.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA20.dPropIVA = 100;
                                            gCamIVA20.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA20.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA20.iAfecIVA = "3";
                                    gCamIVA20.dBasGravIVA = 0;
                                    gCamIVA20.dLiqIVAItem = 0;
                                }
                                gCamIVA20.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem20.gValorRestaItem = gValorRestaItem20;
                                gCamItem20.gValorItem = gValorItem20;
                                gCamItem20.gCamIVA = gCamIVA20;
                                gCamItem1[f] = gCamItem20;
                            }
                            if (f == 20)
                            {
                                gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem21.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem21.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem21.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem21.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA21.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA21.dPropIVA = 100;
                                            gCamIVA21.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA21.dPropIVA = 100;
                                            gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA21.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA21.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA21.dPropIVA = 100;
                                            gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA21.iAfecIVA = "3";
                                    gCamIVA21.dBasGravIVA = 0;
                                    gCamIVA21.dLiqIVAItem = 0;
                                }
                                gCamIVA21.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem21.gValorRestaItem = gValorRestaItem21;
                                gCamItem21.gValorItem = gValorItem21;
                                gCamItem21.gCamIVA = gCamIVA21;
                                gCamItem1[f] = gCamItem21;
                            }
                            if (f == 21)
                            {
                                gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem22.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem22.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem22.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem22.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA22.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA22.dPropIVA = 100;
                                            gCamIVA22.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA22.dPropIVA = 100;
                                            gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA22.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA22.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA22.dPropIVA = 100;
                                            gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA22.iAfecIVA = "3";
                                    gCamIVA22.dBasGravIVA = 0;
                                    gCamIVA22.dLiqIVAItem = 0;
                                }
                                gCamIVA22.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem22.gValorRestaItem = gValorRestaItem22;
                                gCamItem22.gValorItem = gValorItem22;
                                gCamItem22.gCamIVA = gCamIVA22;
                                gCamItem1[f] = gCamItem22;
                            }
                            if (f == 22)
                            {
                                gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem23.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem23.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem23.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem23.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA23.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA23.dPropIVA = 100;
                                            gCamIVA23.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA23.dPropIVA = 100;
                                            gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA23.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA23.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA23.dPropIVA = 100;
                                            gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA23.iAfecIVA = "3";
                                    gCamIVA23.dBasGravIVA = 0;
                                    gCamIVA23.dLiqIVAItem = 0;
                                }
                                gCamIVA23.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem23.gValorRestaItem = gValorRestaItem23;
                                gCamItem23.gValorItem = gValorItem23;
                                gCamItem23.gCamIVA = gCamIVA23;
                                gCamItem1[f] = gCamItem23;
                            }
                            if (f == 23)
                            {
                                gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem24.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem24.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem24.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem24.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA24.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA24.dPropIVA = 100;
                                            gCamIVA24.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA24.dPropIVA = 100;
                                            gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA24.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA24.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA24.dPropIVA = 100;
                                            gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA24.iAfecIVA = "3";
                                    gCamIVA24.dBasGravIVA = 0;
                                    gCamIVA24.dLiqIVAItem = 0;
                                }
                                gCamIVA24.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem24.gValorRestaItem = gValorRestaItem24;
                                gCamItem24.gValorItem = gValorItem24;
                                gCamItem24.gCamIVA = gCamIVA24;
                                gCamItem1[f] = gCamItem24;
                            }
                            if (f == 24)
                            {
                                gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem25.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem25.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem25.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem25.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA25.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA25.dPropIVA = 100;
                                            gCamIVA25.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA25.dPropIVA = 100;
                                            gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA25.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA25.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA25.dPropIVA = 100;
                                            gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA25.iAfecIVA = "3";
                                    gCamIVA25.dBasGravIVA = 0;
                                    gCamIVA25.dLiqIVAItem = 0;
                                }
                                gCamIVA25.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem25.gValorRestaItem = gValorRestaItem25;
                                gCamItem25.gValorItem = gValorItem25;
                                gCamItem25.gCamIVA = gCamIVA25;
                                gCamItem1[f] = gCamItem25;
                            }
                            if (f == 25)
                            {
                                gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem26.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem26.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem26.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem26.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA26.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA26.dPropIVA = 100;
                                            gCamIVA26.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA26.dPropIVA = 100;
                                            gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA26.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA26.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA26.dPropIVA = 100;
                                            gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA26.iAfecIVA = "3";
                                    gCamIVA26.dBasGravIVA = 0;
                                    gCamIVA26.dLiqIVAItem = 0;
                                }
                                gCamIVA26.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem26.gValorRestaItem = gValorRestaItem26;
                                gCamItem26.gValorItem = gValorItem26;
                                gCamItem26.gCamIVA = gCamIVA26;
                                gCamItem1[f] = gCamItem26;
                            }
                            if (f == 26)
                            {
                                gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem27.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem27.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem27.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem27.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA27.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA27.dPropIVA = 100;
                                            gCamIVA27.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA27.dPropIVA = 100;
                                            gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA27.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA27.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA27.dPropIVA = 100;
                                            gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA27.iAfecIVA = "3";
                                    gCamIVA27.dBasGravIVA = 0;
                                    gCamIVA27.dLiqIVAItem = 0;
                                }
                                gCamIVA27.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem27.gValorRestaItem = gValorRestaItem27;
                                gCamItem27.gValorItem = gValorItem27;
                                gCamItem27.gCamIVA = gCamIVA27;
                                gCamItem1[f] = gCamItem27;
                            }
                            if (f == 27)
                            {
                                gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem28.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem28.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem28.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem28.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA28.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA28.dPropIVA = 100;
                                            gCamIVA28.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA28.dPropIVA = 100;
                                            gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA28.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA28.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA28.dPropIVA = 100;
                                            gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA28.iAfecIVA = "3";
                                    gCamIVA28.dBasGravIVA = 0;
                                    gCamIVA28.dLiqIVAItem = 0;
                                }
                                gCamIVA28.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem28.gValorRestaItem = gValorRestaItem28;
                                gCamItem28.gValorItem = gValorItem28;
                                gCamItem28.gCamIVA = gCamIVA28;
                                gCamItem1[f] = gCamItem28;
                            }
                            if (f == 28)
                            {
                                gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem29.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem29.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem29.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem29.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA29.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA29.dPropIVA = 100;
                                            gCamIVA29.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA29.dPropIVA = 100;
                                            gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA29.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA29.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA29.dPropIVA = 100;
                                            gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA29.iAfecIVA = "3";
                                    gCamIVA29.dBasGravIVA = 0;
                                    gCamIVA29.dLiqIVAItem = 0;
                                }
                                gCamIVA29.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem29.gValorRestaItem = gValorRestaItem29;
                                gCamItem29.gValorItem = gValorItem29;
                                gCamItem29.gCamIVA = gCamIVA29;
                                gCamItem1[f] = gCamItem29;
                            }
                            if (f == 29)
                            {
                                gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem30.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem30.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem30.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem30.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA30.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA30.dPropIVA = 100;
                                            gCamIVA30.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA30.dPropIVA = 100;
                                            gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA30.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA30.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA30.dPropIVA = 100;
                                            gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA30.iAfecIVA = "3";
                                    gCamIVA30.dBasGravIVA = 0;
                                    gCamIVA30.dLiqIVAItem = 0;
                                }
                                gCamIVA30.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem30.gValorRestaItem = gValorRestaItem30;
                                gCamItem30.gValorItem = gValorItem30;
                                gCamItem30.gCamIVA = gCamIVA30;
                                gCamItem1[f] = gCamItem30;
                            }
                            if (f == 30)
                            {
                                gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem31.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem31.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem31.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem31.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA31.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA31.dPropIVA = 100;
                                            gCamIVA31.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA31.dPropIVA = 100;
                                            gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA31.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA31.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA31.dPropIVA = 100;
                                            gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA31.iAfecIVA = "3";
                                    gCamIVA31.dBasGravIVA = 0;
                                    gCamIVA31.dLiqIVAItem = 0;
                                }
                                gCamIVA31.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem31.gValorRestaItem = gValorRestaItem31;
                                gCamItem31.gValorItem = gValorItem31;
                                gCamItem31.gCamIVA = gCamIVA31;
                                gCamItem1[f] = gCamItem31;
                            }
                            if (f == 31)
                            {
                                gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem32.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem32.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem32.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem32.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA32.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA32.dPropIVA = 100;
                                            gCamIVA32.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA32.dPropIVA = 100;
                                            gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA32.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA32.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA32.dPropIVA = 100;
                                            gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA32.iAfecIVA = "3";
                                    gCamIVA32.dBasGravIVA = 0;
                                    gCamIVA32.dLiqIVAItem = 0;
                                }
                                gCamIVA32.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem32.gValorRestaItem = gValorRestaItem32;
                                gCamItem32.gValorItem = gValorItem32;
                                gCamItem32.gCamIVA = gCamIVA32;
                                gCamItem1[f] = gCamItem32;
                            }
                            if (f == 32)
                            {
                                gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem33.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem33.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem33.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem33.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA33.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA33.dPropIVA = 100;
                                            gCamIVA33.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA33.dPropIVA = 100;
                                            gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA33.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA33.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA33.dPropIVA = 100;
                                            gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA33.iAfecIVA = "3";
                                    gCamIVA33.dBasGravIVA = 0;
                                    gCamIVA33.dLiqIVAItem = 0;
                                }
                                gCamIVA33.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem33.gValorRestaItem = gValorRestaItem33;
                                gCamItem33.gValorItem = gValorItem33;
                                gCamItem33.gCamIVA = gCamIVA33;
                                gCamItem1[f] = gCamItem33;
                            }
                            if (f == 33)
                            {
                                gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem34.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem34.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem34.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem34.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA34.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA34.dPropIVA = 100;
                                            gCamIVA34.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA34.dPropIVA = 100;
                                            gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA34.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA34.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA34.dPropIVA = 100;
                                            gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA34.iAfecIVA = "3";
                                    gCamIVA34.dBasGravIVA = 0;
                                    gCamIVA34.dLiqIVAItem = 0;
                                }
                                gCamIVA34.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem34.gValorRestaItem = gValorRestaItem34;
                                gCamItem34.gValorItem = gValorItem34;
                                gCamItem34.gCamIVA = gCamIVA34;
                                gCamItem1[f] = gCamItem34;
                            }
                            if (f == 34)
                            {
                                gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem35.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem35.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem35.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem35.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA35.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA35.dPropIVA = 100;
                                            gCamIVA35.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA35.dPropIVA = 100;
                                            gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA35.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA35.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA35.dPropIVA = 100;
                                            gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA35.iAfecIVA = "3";
                                    gCamIVA35.dBasGravIVA = 0;
                                    gCamIVA35.dLiqIVAItem = 0;
                                }
                                gCamIVA35.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem35.gValorRestaItem = gValorRestaItem35;
                                gCamItem35.gValorItem = gValorItem35;
                                gCamItem35.gCamIVA = gCamIVA35;
                                gCamItem1[f] = gCamItem35;
                            }
                            if (f == 35)
                            {
                                gCamItem36.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem36.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem36.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem36.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem36.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem36.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem36.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA36.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA36.dPropIVA = 100;
                                            gCamIVA36.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA36.dPropIVA = 100;
                                            gCamIVA36.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA36.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA36.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA36.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA36.dPropIVA = 100;
                                            gCamIVA36.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA36.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA36.iAfecIVA = "3";
                                    gCamIVA36.dBasGravIVA = 0;
                                    gCamIVA36.dLiqIVAItem = 0;
                                }
                                gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem36.gValorRestaItem = gValorRestaItem36;
                                gCamItem36.gValorItem = gValorItem36;
                                gCamItem36.gCamIVA = gCamIVA36;
                                gCamItem1[f] = gCamItem36;
                            }
                            if (f == 36)
                            {
                                gCamItem37.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem37.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem37.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem37.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem37.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem37.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem37.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA37.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA37.dPropIVA = 100;
                                            gCamIVA37.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA37.dPropIVA = 100;
                                            gCamIVA37.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA37.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA37.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA37.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA37.dPropIVA = 100;
                                            gCamIVA37.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA37.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA37.iAfecIVA = "3";
                                    gCamIVA37.dBasGravIVA = 0;
                                    gCamIVA37.dLiqIVAItem = 0;
                                }
                                gCamIVA37.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem37.gValorRestaItem = gValorRestaItem37;
                                gCamItem37.gValorItem = gValorItem37;
                                gCamItem37.gCamIVA = gCamIVA37;
                                gCamItem1[f] = gCamItem37;
                            }
                            if (f == 37)
                            {
                                gCamItem38.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem38.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem38.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem38.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem38.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem38.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem38.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA38.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA38.dPropIVA = 100;
                                            gCamIVA38.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA38.dPropIVA = 100;
                                            gCamIVA38.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA38.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA38.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA38.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA38.dPropIVA = 100;
                                            gCamIVA38.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA38.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA38.iAfecIVA = "3";
                                    gCamIVA38.dBasGravIVA = 0;
                                    gCamIVA38.dLiqIVAItem = 0;
                                }
                                gCamIVA38.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem38.gValorRestaItem = gValorRestaItem38;
                                gCamItem38.gValorItem = gValorItem38;
                                gCamItem38.gCamIVA = gCamIVA38;
                                gCamItem1[f] = gCamItem38;
                            }
                            if (f == 38)
                            {
                                gCamItem39.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem39.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem39.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem39.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem39.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem39.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem39.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA39.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA39.dPropIVA = 100;
                                            gCamIVA39.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA39.dPropIVA = 100;
                                            gCamIVA39.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA39.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA39.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA39.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA39.dPropIVA = 100;
                                            gCamIVA39.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA39.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA39.iAfecIVA = "3";
                                    gCamIVA39.dBasGravIVA = 0;
                                    gCamIVA39.dLiqIVAItem = 0;
                                }
                                gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem39.gValorRestaItem = gValorRestaItem39;
                                gCamItem39.gValorItem = gValorItem39;
                                gCamItem39.gCamIVA = gCamIVA39;
                                gCamItem1[f] = gCamItem39;
                            }
                            if (f == 39)
                            {
                                gCamItem40.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem40.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem40.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem40.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem40.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem40.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem40.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA40.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA40.dPropIVA = 100;
                                            gCamIVA40.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA40.dPropIVA = 100;
                                            gCamIVA40.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA40.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA40.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA40.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA40.dPropIVA = 100;
                                            gCamIVA40.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA40.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA40.iAfecIVA = "3";
                                    gCamIVA40.dBasGravIVA = 0;
                                    gCamIVA40.dLiqIVAItem = 0;
                                }
                                gCamIVA40.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem40.gValorRestaItem = gValorRestaItem40;
                                gCamItem40.gValorItem = gValorItem40;
                                gCamItem40.gCamIVA = gCamIVA40;
                                gCamItem1[f] = gCamItem40;
                            }
                            if (f == 40)
                            {
                                gCamItem41.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem41.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem41.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem41.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem41.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem41.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem41.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA41.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA41.dPropIVA = 100;
                                            gCamIVA41.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA41.dPropIVA = 100;
                                            gCamIVA41.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA41.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA41.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA41.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA41.dPropIVA = 100;
                                            gCamIVA41.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA41.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA41.iAfecIVA = "3";
                                    gCamIVA41.dBasGravIVA = 0;
                                    gCamIVA41.dLiqIVAItem = 0;
                                }
                                gCamIVA41.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem41.gValorRestaItem = gValorRestaItem41;
                                gCamItem41.gValorItem = gValorItem41;
                                gCamItem41.gCamIVA = gCamIVA41;
                                gCamItem1[f] = gCamItem41;
                            }
                            if (f == 41)
                            {
                                gCamItem42.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem42.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem42.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem42.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem42.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem42.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem42.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA42.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA42.dPropIVA = 100;
                                            gCamIVA42.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA42.dPropIVA = 100;
                                            gCamIVA42.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA42.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA42.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA42.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA42.dPropIVA = 100;
                                            gCamIVA42.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA42.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA42.iAfecIVA = "3";
                                    gCamIVA42.dBasGravIVA = 0;
                                    gCamIVA42.dLiqIVAItem = 0;
                                }
                                gCamIVA42.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem42.gValorRestaItem = gValorRestaItem42;
                                gCamItem42.gValorItem = gValorItem42;
                                gCamItem42.gCamIVA = gCamIVA42;
                                gCamItem1[f] = gCamItem42;
                            }
                            if (f == 42)
                            {
                                gCamItem43.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem43.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem43.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem43.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem43.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem43.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem43.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA43.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA43.dPropIVA = 100;
                                            gCamIVA43.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA43.dPropIVA = 100;
                                            gCamIVA43.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA43.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA43.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA43.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA43.dPropIVA = 100;
                                            gCamIVA43.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA43.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA43.iAfecIVA = "3";
                                    gCamIVA43.dBasGravIVA = 0;
                                    gCamIVA43.dLiqIVAItem = 0;
                                }
                                gCamIVA43.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem43.gValorRestaItem = gValorRestaItem43;
                                gCamItem43.gValorItem = gValorItem43;
                                gCamItem43.gCamIVA = gCamIVA43;
                                gCamItem1[f] = gCamItem43;
                            }
                            if (f == 43)
                            {
                                gCamItem44.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem44.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem44.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem44.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem44.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem44.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem44.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA44.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA44.dPropIVA = 100;
                                            gCamIVA44.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA44.dPropIVA = 100;
                                            gCamIVA44.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA44.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA44.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA44.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA44.dPropIVA = 100;
                                            gCamIVA44.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA44.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA44.iAfecIVA = "3";
                                    gCamIVA44.dBasGravIVA = 0;
                                    gCamIVA44.dLiqIVAItem = 0;
                                }
                                gCamIVA44.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem44.gValorRestaItem = gValorRestaItem44;
                                gCamItem44.gValorItem = gValorItem44;
                                gCamItem44.gCamIVA = gCamIVA44;
                                gCamItem1[f] = gCamItem44;
                            }
                            if (f == 44)
                            {
                                gCamItem45.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                                gCamItem45.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                                gCamItem45.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                                 //gValorItem
                                gValorItem45.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                                gValorItem45.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gValorRestaItem
                                gValorRestaItem45.dDescItem = 0;
                                //gValorRestaItem.dAntPreUniIt = 0;
                                //gValorRestaItem.dTotOpeItem = 0;  
                                gValorRestaItem45.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                //gCamIVA
                                string IVA = oDatos.Fields.Item(15).Value.ToString();
                                if (IVA.Equals("5") || IVA.Equals("10"))
                                {
                                    gCamIVA45.iAfecIVA = "1";
                                    if (IVA.Equals("10"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA45.dPropIVA = 100;
                                            gCamIVA45.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                            gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                        }
                                        else
                                        {
                                            gCamIVA45.dPropIVA = 100;
                                            gCamIVA45.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                            gCamIVA45.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                        }

                                    }
                                    if (IVA.Equals("5"))
                                    {
                                        if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                        {
                                            gCamIVA45.dPropIVA = 100;
                                            decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                            gCamIVA45.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                            gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                        }
                                        else
                                        {
                                            gCamIVA45.dPropIVA = 100;
                                            gCamIVA45.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                            gCamIVA45.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                        }

                                    }

                                }
                                else if (IVA.Equals("0"))
                                {
                                    gCamIVA45.iAfecIVA = "3";
                                    gCamIVA45.dBasGravIVA = 0;
                                    gCamIVA45.dLiqIVAItem = 0;
                                }
                                gCamIVA45.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                                gValorItem45.gValorRestaItem = gValorRestaItem45;
                                gCamItem45.gValorItem = gValorItem45;
                                gCamItem45.gCamIVA = gCamIVA45;
                                gCamItem1[f] = gCamItem45;
                            }
                            #endregion
                        }

                        f++;
                        oDatos.MoveNext();
                        if (false == oCompany.InTransaction)
                        {
                            oCompany.StartTransaction();
                        }
                    }
                }


                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = "FACTURA_SIMPLE";
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                if (tablacab.Equals("OINV"))
                {
                    gDtipDE.gCamFE = gCamFE;
                    gDtipDE.gCamCond = gCamCond;
                }
                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;
                if (condicion.Equals("2") && tablacab.Equals("OINV"))
                {
                    gCamCond.gPagCred = gPagCred;

                }

                gCamCond.gPaConEIni = gPaConEIni1;
                gDtipDE.gCamItem = gCamItem1;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento

                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "' AND \"DocSubType\"='IX' ");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    //actualizamos el folio de la factura
                    Recordset oActFolio;
                    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "',\"Printed\"='Y',\"U_Info_Export\"='" + infoExp + "' where \"DocNum\"='" + codigo + "' AND \"DocSubType\"='IX'");
                    //actualizamos el folio del asiento
                    Recordset oActAsiento;
                    oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");


                    //actualizamos la numeracion de la serie           
                    Recordset oActSerie;
                    oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 278)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");//
                                                                                                                                                                                                                                                                                                                 //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
                //oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
            }
        }

        //funcion para cambiar los mensajes de botones
        public class MessageBoxManager
        {
            private delegate IntPtr HookProc(int nCode, IntPtr wParam, IntPtr lParam);
            private delegate bool EnumChildProc(IntPtr hWnd, IntPtr lParam);

            private const int WH_CALLWNDPROCRET = 12;
            private const int WM_DESTROY = 0x0002;
            private const int WM_INITDIALOG = 0x0110;
            private const int WM_TIMER = 0x0113;
            private const int WM_USER = 0x400;
            private const int DM_GETDEFID = WM_USER + 0;

            private const int MBOK = 1;
            private const int MBCancel = 2;
            private const int MBAbort = 3;
            private const int MBRetry = 4;
            private const int MBIgnore = 5;
            private const int MBYes = 6;
            private const int MBNo = 7;


            [DllImport("user32.dll")]
            private static extern IntPtr SendMessage(IntPtr hWnd, int Msg, IntPtr wParam, IntPtr lParam);

            [DllImport("user32.dll")]
            private static extern IntPtr SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hInstance, int threadId);

            [DllImport("user32.dll")]
            private static extern int UnhookWindowsHookEx(IntPtr idHook);

            [DllImport("user32.dll")]
            private static extern IntPtr CallNextHookEx(IntPtr idHook, int nCode, IntPtr wParam, IntPtr lParam);

            [DllImport("user32.dll", EntryPoint = "GetWindowTextLengthW", CharSet = CharSet.Unicode)]
            private static extern int GetWindowTextLength(IntPtr hWnd);

            [DllImport("user32.dll", EntryPoint = "GetWindowTextW", CharSet = CharSet.Unicode)]
            private static extern int GetWindowText(IntPtr hWnd, StringBuilder text, int maxLength);

            [DllImport("user32.dll")]
            private static extern int EndDialog(IntPtr hDlg, IntPtr nResult);

            [DllImport("user32.dll")]
            private static extern bool EnumChildWindows(IntPtr hWndParent, EnumChildProc lpEnumFunc, IntPtr lParam);

            [DllImport("user32.dll", EntryPoint = "GetClassNameW", CharSet = CharSet.Unicode)]
            private static extern int GetClassName(IntPtr hWnd, StringBuilder lpClassName, int nMaxCount);

            [DllImport("user32.dll")]
            private static extern int GetDlgCtrlID(IntPtr hwndCtl);

            [DllImport("user32.dll")]
            private static extern IntPtr GetDlgItem(IntPtr hDlg, int nIDDlgItem);

            [DllImport("user32.dll", EntryPoint = "SetWindowTextW", CharSet = CharSet.Unicode)]
            private static extern bool SetWindowText(IntPtr hWnd, string lpString);


            [StructLayout(LayoutKind.Sequential)]
            public struct CWPRETSTRUCT
            {
                public IntPtr lResult;
                public IntPtr lParam;
                public IntPtr wParam;
                public uint message;
                public IntPtr hwnd;
            };

            private static HookProc hookProc;
            private static EnumChildProc enumProc;
            [ThreadStatic]
            private static IntPtr hHook;
            [ThreadStatic]
            private static int nButton;

            /// <summary>
            /// OK text
            /// </summary>
            public static string OK = "&OK";
            /// <summary>
            /// Cancel text
            /// </summary>
            public static string Cancel = "&Cancel";
            /// <summary>
            /// Abort text
            /// </summary>
            public static string Abort = "&Abort";
            /// <summary>
            /// Retry text
            /// </summary>
            public static string Retry = "&Retry";
            /// <summary>
            /// Ignore text
            /// </summary>
            public static string Ignore = "&Ignore";
            /// <summary>
            /// Yes text
            /// </summary>
            public static string Yes = "&Yes";
            /// <summary>
            /// No text
            /// </summary>
            public static string No = "&No";

            static MessageBoxManager()
            {
                hookProc = new HookProc(MessageBoxHookProc);
                enumProc = new EnumChildProc(MessageBoxEnumProc);
                hHook = IntPtr.Zero;
            }

            /// <summary>
            /// Enables MessageBoxManager functionality
            /// </summary>
            /// <remarks>
            /// MessageBoxManager functionality is enabled on current thread only.
            /// Each thread that needs MessageBoxManager functionality has to call this method.
            /// </remarks>
            public static void Register()
            {
                if (hHook != IntPtr.Zero)
                    throw new NotSupportedException("One hook per thread allowed.");
                hHook = SetWindowsHookEx(WH_CALLWNDPROCRET, hookProc, IntPtr.Zero, AppDomain.GetCurrentThreadId());
            }

            /// <summary>
            /// Disables MessageBoxManager functionality
            /// </summary>
            /// <remarks>
            /// Disables MessageBoxManager functionality on current thread only.
            /// </remarks>
            public static void Unregister()
            {
                if (hHook != IntPtr.Zero)
                {
                    UnhookWindowsHookEx(hHook);
                    hHook = IntPtr.Zero;
                }
            }

            private static IntPtr MessageBoxHookProc(int nCode, IntPtr wParam, IntPtr lParam)
            {
                if (nCode < 0)
                    return CallNextHookEx(hHook, nCode, wParam, lParam);

                CWPRETSTRUCT msg = (CWPRETSTRUCT)Marshal.PtrToStructure(lParam, typeof(CWPRETSTRUCT));
                IntPtr hook = hHook;

                if (msg.message == WM_INITDIALOG)
                {
                    int nLength = GetWindowTextLength(msg.hwnd);
                    StringBuilder className = new StringBuilder(10);
                    GetClassName(msg.hwnd, className, className.Capacity);
                    if (className.ToString() == "#32770")
                    {
                        nButton = 0;
                        EnumChildWindows(msg.hwnd, enumProc, IntPtr.Zero);
                        if (nButton == 1)
                        {
                            IntPtr hButton = GetDlgItem(msg.hwnd, MBCancel);
                            if (hButton != IntPtr.Zero)
                                SetWindowText(hButton, OK);
                        }
                    }
                }

                return CallNextHookEx(hook, nCode, wParam, lParam);
            }

            private static bool MessageBoxEnumProc(IntPtr hWnd, IntPtr lParam)
            {
                StringBuilder className = new StringBuilder(10);
                GetClassName(hWnd, className, className.Capacity);
                if (className.ToString() == "Button")
                {
                    int ctlId = GetDlgCtrlID(hWnd);
                    switch (ctlId)
                    {
                        case MBOK:
                            SetWindowText(hWnd, OK);
                            break;
                        case MBCancel:
                            SetWindowText(hWnd, Cancel);
                            break;
                        case MBAbort:
                            SetWindowText(hWnd, Abort);
                            break;
                        case MBRetry:
                            SetWindowText(hWnd, Retry);
                            break;
                        case MBIgnore:
                            SetWindowText(hWnd, Ignore);
                            break;
                        case MBYes:
                            SetWindowText(hWnd, Yes);
                            break;
                        case MBNo:
                            SetWindowText(hWnd, No);
                            break;

                    }
                    nButton++;
                }

                return true;
            }


        }

        //funcion para auditoria
        private static void loadAuditoria(SAPbouiCOM.Form oForm)
        {
            SAPbouiCOM.EditText oFechaD = (SAPbouiCOM.EditText)oForm.Items.Item("Item_2").Specific;
            SAPbouiCOM.EditText oFechaH = (SAPbouiCOM.EditText)oForm.Items.Item("Item_3").Specific;
            SAPbouiCOM.EditText oSerie = (SAPbouiCOM.EditText)oForm.Items.Item("Item_6").Specific;
            SAPbouiCOM.ComboBox oCboDoc = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_8").Specific;
            SAPbouiCOM.ComboBox oEstado = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_11").Specific;
            SAPbouiCOM.StaticText oLabel1 = (SAPbouiCOM.StaticText)oForm.Items.Item("Item_15").Specific;
            SAPbouiCOM.StaticText oLabel2 = (SAPbouiCOM.StaticText)oForm.Items.Item("Item_27").Specific;
            SAPbouiCOM.StaticText oLabel3 = (SAPbouiCOM.StaticText)oForm.Items.Item("Item_28").Specific;
            SAPbouiCOM.StaticText oLabel4 = (SAPbouiCOM.StaticText)oForm.Items.Item("Item_26").Specific;
            SAPbouiCOM.StaticText oLabel5 = (SAPbouiCOM.StaticText)oForm.Items.Item("Item_32").Specific;
            SAPbouiCOM.StaticText oLabel6 = (SAPbouiCOM.StaticText)oForm.Items.Item("Item_33").Specific;
            SAPbouiCOM.EditText oSN = (SAPbouiCOM.EditText)oForm.Items.Item("Item_36").Specific;
            SAPbouiCOM.Button btndesc = (SAPbouiCOM.Button)oForm.Items.Item("Item_37").Specific;
            SAPbouiCOM.Button btncorreo = (SAPbouiCOM.Button)oForm.Items.Item("Item_39").Specific;
            SAPbouiCOM.CheckBox chkcorreo = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_34").Specific;
            oForm.DataSources.UserDataSources.Add("chkcorreo", BoDataType.dt_SHORT_TEXT, 1);
            chkcorreo.ValOff = "N";
            chkcorreo.ValOn = "Y";
            chkcorreo.DataBind.SetBound(true, "", "chkcorreo");
            oForm.DataSources.UserDataSources.Item("chkcorreo").Value = "Y";
            SAPbouiCOM.CheckBox chktodos = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_40").Specific;
            oForm.DataSources.UserDataSources.Add("chktodos", BoDataType.dt_SHORT_TEXT, 1);
            chktodos.ValOff = "N";
            chktodos.ValOn = "Y";
            chktodos.DataBind.SetBound(true, "", "chktodos");
            oForm.DataSources.UserDataSources.Item("chktodos").Value = "N";
            chktodos.Caption = "Marcar todos";

            btncorreo.Item.Enabled = false;


            oForm.DataSources.DataTables.Add("data1");
            //tamaño de los labels
            oLabel1.Item.FontSize = 25;
            oLabel1.Item.Height = 25;
            oLabel1.Item.RightJustified = true;
            //oLabel1.Item.ForeColor = Color.Green.G;
            string colorcode = "#FF008000";
            int argb = Int32.Parse(colorcode.Replace("#", ""), NumberStyles.HexNumber);
            oLabel1.Item.ForeColor = argb;

            oLabel2.Item.FontSize = 25;
            oLabel2.Item.Height = 25;
            oLabel2.Item.RightJustified = true;
            oLabel2.Item.ForeColor = Color.Red.A;

            oLabel3.Item.FontSize = 25;
            oLabel3.Item.Height = 25;
            oLabel3.Item.RightJustified = true;

            oLabel4.Item.FontSize = 25;
            oLabel4.Item.Height = 25;
            oLabel4.Item.RightJustified = true;

            oLabel5.Item.FontSize = 25;
            oLabel5.Item.Height = 25;
            oLabel5.Item.RightJustified = true;

            oLabel6.Item.FontSize = 25;
            oLabel6.Item.Height = 25;
            oLabel6.Item.RightJustified = true;
            //oLabelF.Item.ForeColor = 128;// Color.FromArgb(0,128,0).B;
            //listado de documentos.
            oCboDoc.ValidValues.Add("1", "Factura");
            oCboDoc.ValidValues.Add("2", "Nota de Crédito");
            oCboDoc.ValidValues.Add("3", "Remisión Entrega");
            oCboDoc.ValidValues.Add("4", "Remisión Traslado");
            oCboDoc.ValidValues.Add("5", "Nota de Débito");
            oCboDoc.ValidValues.Add("6", "Autofactura");
            oCboDoc.ValidValues.Add("7", "Factura Export");
            oCboDoc.Item.DisplayDesc = true;
            //listado de estados
            oEstado.ValidValues.Add("1", "APROBADO");
            oEstado.ValidValues.Add("2", "RECHAZADO");
            oEstado.Item.DisplayDesc = true;

            //cargamos los valores aprobados
            SAPbobsCOM.Recordset oFacApro;
            oFacApro = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oFacApro.DoQuery("select count(*) from OINV where \"U_ESTADO\"='APROBADO' and \"CANCELED\"='N' ");

            SAPbobsCOM.Recordset oNCApro;
            oNCApro = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oNCApro.DoQuery("select count(*) from ORIN where \"U_ESTADO\"='APROBADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oEntApro;
            oEntApro = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oEntApro.DoQuery("select count(*) from ODLN where \"U_ESTADO\"='APROBADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oTrasApro;
            oTrasApro = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oTrasApro.DoQuery("select count(*) from OWTR where \"U_ESTADO\"='APROBADO' and \"CANCELED\"='N'");

            double v_valor = double.Parse(oFacApro.Fields.Item(0).Value.ToString()) + double.Parse(oNCApro.Fields.Item(0).Value.ToString()) + double.Parse(oEntApro.Fields.Item(0).Value.ToString()) + double.Parse(oTrasApro.Fields.Item(0).Value.ToString());
            oLabel1.Caption = v_valor.ToString();

            //cargamos los valores rechazados
            SAPbobsCOM.Recordset oFacRech;
            oFacRech = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oFacRech.DoQuery("select count(*) from OINV where \"U_ESTADO\"='RECHAZADO' and \"CANCELED\"='N' ");

            SAPbobsCOM.Recordset oNCRech;
            oNCRech = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oNCRech.DoQuery("select count(*) from ORIN where \"U_ESTADO\"='RECHAZADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oEntRech;
            oEntRech = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oEntRech.DoQuery("select count(*) from ODLN where \"U_ESTADO\"='RECHAZADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oTrasRech;
            oTrasRech = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oTrasRech.DoQuery("select count(*) from OWTR where \"U_ESTADO\"='RECHAZADO' and \"CANCELED\"='N'");

            double v_valor2 = double.Parse(oFacRech.Fields.Item(0).Value.ToString()) + double.Parse(oNCRech.Fields.Item(0).Value.ToString()) + double.Parse(oEntRech.Fields.Item(0).Value.ToString()) + double.Parse(oTrasRech.Fields.Item(0).Value.ToString());
            oLabel2.Caption = v_valor2.ToString();

            //cargamos los documentos inutilizados
            SAPbobsCOM.Recordset oFacInu;
            oFacInu = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oFacInu.DoQuery("select count(*) from OINV where \"U_ESTADO\"='INUTILIZADO'");

            SAPbobsCOM.Recordset oNCInu;
            oNCInu = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oNCInu.DoQuery("select count(*) from ORIN where \"U_ESTADO\"='INUTILIZADO'");

            SAPbobsCOM.Recordset oEntInu;
            oEntInu = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oEntInu.DoQuery("select count(*) from ODLN where \"U_ESTADO\"='INUTILIZADO'");

            SAPbobsCOM.Recordset oTrasInu;
            oTrasInu = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oTrasInu.DoQuery("select count(*) from OWTR where \"U_ESTADO\"='INUTILIZADO'");

            double v_valor4 = double.Parse(oFacInu.Fields.Item(0).Value.ToString()) + double.Parse(oNCInu.Fields.Item(0).Value.ToString()) + double.Parse(oEntInu.Fields.Item(0).Value.ToString()) + double.Parse(oTrasInu.Fields.Item(0).Value.ToString());
            oLabel4.Caption = v_valor4.ToString();

            //cargamos los documentos cancelados
            SAPbobsCOM.Recordset oFacCan;
            oFacCan = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oFacCan.DoQuery("select count(*) from OINV where \"U_ESTADO\"='CANCELADO'");

            SAPbobsCOM.Recordset oNCCan;
            oNCCan = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oNCCan.DoQuery("select count(*) from ORIN where \"U_ESTADO\"='CANCELADO'");

            SAPbobsCOM.Recordset oEntCan;
            oEntCan = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oEntCan.DoQuery("select count(*) from ODLN where \"U_ESTADO\"='CANCELADO'");

            SAPbobsCOM.Recordset oTrasCan;
            oTrasCan = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oTrasCan.DoQuery("select count(*) from OWTR where \"U_ESTADO\"='CANCELADO'");

            double v_valor5 = double.Parse(oFacCan.Fields.Item(0).Value.ToString()) + double.Parse(oNCCan.Fields.Item(0).Value.ToString()) + double.Parse(oEntCan.Fields.Item(0).Value.ToString()) + double.Parse(oTrasCan.Fields.Item(0).Value.ToString());
            oLabel5.Caption = v_valor5.ToString();

            //cargamos los documentos procesados
            SAPbobsCOM.Recordset oFacProc;
            oFacProc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oFacProc.DoQuery("select count(*) from OINV where \"U_ESTADO\"='PROCESADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oNCProc;
            oNCProc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oNCProc.DoQuery("select count(*) from ORIN where \"U_ESTADO\"='PROCESADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oEntProc;
            oEntProc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oEntProc.DoQuery("select count(*) from ODLN where \"U_ESTADO\"='PROCESADO' and \"CANCELED\"='N'");

            SAPbobsCOM.Recordset oTrasProc;
            oTrasProc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oTrasProc.DoQuery("select count(*) from OWTR where \"U_ESTADO\"='PROCESADO' and \"CANCELED\"='N'");

            double v_valor6 = double.Parse(oFacProc.Fields.Item(0).Value.ToString()) + double.Parse(oNCProc.Fields.Item(0).Value.ToString()) + double.Parse(oEntProc.Fields.Item(0).Value.ToString()) + double.Parse(oTrasProc.Fields.Item(0).Value.ToString());
            oLabel6.Caption = v_valor6.ToString();


        }

        //funcion para inutilizacion
        private static void loadinutilizacion(SAPbouiCOM.Form oForm)
        {
            //combobox de tipo de documento
            SAPbouiCOM.ComboBox cbodocu = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_20").Specific;
            cbodocu.ValidValues.Add("1", "Factura");
            cbodocu.ValidValues.Add("2", "Factura Export");
            cbodocu.ValidValues.Add("3", "Factura importación");
            cbodocu.ValidValues.Add("4", "Autofactura");
            cbodocu.ValidValues.Add("5", "Nota de crédito");
            cbodocu.ValidValues.Add("6", "Nota de débito");
            cbodocu.ValidValues.Add("7", "Remisión Entrega");
            cbodocu.ValidValues.Add("8", "Remisión Traslado");
            cbodocu.Item.DisplayDesc = true;

            //combobox de motivo
            SAPbouiCOM.ComboBox cbomoti = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_23").Specific;
            cbomoti.ValidValues.Add("1", "Folio inutilizado");
            cbomoti.Item.DisplayDesc = true;

            //folders
            SAPbouiCOM.Folder folder1 = (SAPbouiCOM.Folder)oForm.Items.Item("Item_5").Specific;
            SAPbouiCOM.Folder folder2 = (SAPbouiCOM.Folder)oForm.Items.Item("Item_6").Specific;
            //folder2.Item.Enabled = false;

            //checkbox
            //SAPbouiCOM.CheckBox chk1 = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_0").Specific;
            //oForm.DataSources.UserDataSources.Add("chk1", BoDataType.dt_SHORT_TEXT, 1);
            //chk1.ValOn = "Y";
            //chk1.ValOff = "N";
            //chk1.DataBind.SetBound(true, "", "chk1");
            //oForm.DataSources.UserDataSources.Item("chk1").Value = "Y";
            //SAPbouiCOM.CheckBox chk2 = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_1").Specific;
            //oForm.DataSources.UserDataSources.Add("chk2", BoDataType.dt_SHORT_TEXT, 1);
            //chk2.ValOn = "Y";
            //chk2.ValOff = "N";
            //chk2.DataBind.SetBound(true, "", "chk2");
            //oForm.DataSources.UserDataSources.Item("chk2").Value = "N";

            //Buscamos el timbrado y ruc de la empresa logeada
            //SAPbobsCOM.Recordset oDatos;
            //oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            //oDatos.DoQuery("");

            string v_ruc = null;
            string v_timbrado = null;
            if (oCompany.CompanyName.Equals("FRIGORIFICO GUARANI S.A.C.I."))
            {
                v_ruc = "80003232-2";
                v_timbrado = "16094946";
            }
            else
            {
                v_ruc = "80082380-0";
                v_timbrado = "16148774";
            }
            SAPbouiCOM.EditText ruc = (SAPbouiCOM.EditText)oForm.Items.Item("Item_16").Specific;
            SAPbouiCOM.EditText timb = (SAPbouiCOM.EditText)oForm.Items.Item("Item_17").Specific;
            ruc.Value = v_ruc;
            timb.Value = v_timbrado;

        }

        //funcion para objetivos
        private static void loadObjetivos(SAPbouiCOM.Form oForm)
        {
            SAPbouiCOM.EditText v_texto = (SAPbouiCOM.EditText)oForm.Items.Item("Item_5").Specific;
            SAPbouiCOM.EditText v_periodo = (SAPbouiCOM.EditText)oForm.Items.Item("20_U_E").Specific;
            v_periodo.Item.Click();
            v_texto.Item.Visible = false;

        }

        //funcion para formulario de contro FE
        private static void ControlFE(SAPbouiCOM.Form oForm)
        {
            //SAPbouiCOM.Form oForm = SBO_Application.Forms.Item(oform);
            SAPbouiCOM.Grid grilla;
            SAPbouiCOM.EditText oFechaD = (SAPbouiCOM.EditText)oForm.Items.Item("Item_2").Specific;
            SAPbouiCOM.EditText oFechaH = (SAPbouiCOM.EditText)oForm.Items.Item("Item_3").Specific;
            SAPbouiCOM.EditText oSerie = (SAPbouiCOM.EditText)oForm.Items.Item("Item_6").Specific;
            SAPbouiCOM.ComboBox oDoc = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_8").Specific;
            SAPbouiCOM.ComboBox oEstado = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_11").Specific;
            SAPbouiCOM.EditText oCardCode = (SAPbouiCOM.EditText)oForm.Items.Item("Item_36").Specific;
            SAPbouiCOM.CheckBox chkcorreo = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_34").Specific;
            SAPbouiCOM.CheckBox chktodos = (SAPbouiCOM.CheckBox)oForm.Items.Item("Item_40").Specific;


            string v_fechaD = oFechaD.Value;
            string v_fechaH = oFechaH.Value;
            string v_serie = oSerie.Value;
            string v_doc = oDoc.Selected.Value.ToString();
            string v_estadoD = oEstado.Selected.Description.ToString();
            string v_CardCode = oCardCode.Value;
            bool v_chkcorreo = chkcorreo.Checked;
            bool v_chktodos = chktodos.Checked;
            string v_tabla = null, v_sub = null;
            string q_serie = null, v_object = null, v_SeriBusq = null, v_docu = null; string v_busqsn = null;
            //tabla que corresponde la busqueda
            if (v_doc.Equals("1")) { v_tabla = "OINV"; v_object = "13"; v_docu = "Factura"; }
            if (v_doc.Equals("2")) { v_tabla = "ORIN"; v_object = "14"; v_docu = "Nota de crédito"; }
            if (v_doc.Equals("3")) { v_tabla = "ODLN"; v_object = "15"; v_docu = "Remisión entrega"; }
            if (v_doc.Equals("4")) { v_tabla = "OWTR"; v_object = "67"; v_docu = "Remisión traslado"; }
            if (v_doc.Equals("5")) { v_tabla = "OINV"; v_object = "13"; v_sub = " AND T0.\"DocSubType\"='ND' "; v_docu = "Nota de débito"; }
            if (v_doc.Equals("6")) { v_tabla = "@OAFE"; v_docu = "Autofactura"; }
            if (v_doc.Equals("7")) { v_tabla = "OINV"; v_object = "13"; v_sub = " AND T0.\"DocSubType\"='IX' "; v_docu = "Factura Export"; }

            //para buscar por serie
            q_serie = " AND \"ObjectCode\"='" + v_object + "' ";
            //buscamos el nombre de la serie para realizar la busqueda en el query
            if (!string.IsNullOrEmpty(v_serie))
            {
                SAPbobsCOM.Recordset oCodSerie;
                oCodSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oCodSerie.DoQuery("SELECT \"Series\" FROM NNM1 WHERE \"SeriesName\"='" + v_serie + "' " + q_serie + " ");

                v_SeriBusq = " AND T0.\"Series\"='" + oCodSerie.Fields.Item(0).Value.ToString() + "' ";
            }
            //busqueda de socio de negocio
            if (!string.IsNullOrEmpty(v_CardCode)) { v_busqsn = " AND T1.\"LicTradNum\"='" + v_CardCode + "' "; }
            //para buscar solo los clientes que tengan correo
            string v_busqcorreo = null;
            if (v_chkcorreo == true) { v_busqcorreo = " AND T1.\"E_Mail\" IS NOT NULL "; }

            //DataTable datos = new DataTable();
            string tim = null;
            if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
            {
                tim = "16094946";
            }
            else
            {
                tim = "16148774";
            }
            string query = "SELECT T0.\"DocDate\" as \"FECHA\",'" + v_docu + "' AS \"TIPO DOCUMENTO\",T0.\"DocNum\" as \"# INTERNO\",T1.\"LicTradNum\" as \"RUC\",T1.\"CardName\" as \"RAZON SOCIAL\",T0.\"U_ESTA\"||'-'||T0.\"U_PEMI\"||'-'||LPAD(T0.\"FolioNum\",7,'0') AS \"# DOCUMENTO\",T0.\"U_CDC\" as \"CDC\",T1.\"E_Mail\" as \"Correo Electrónico\",T0.\"ReceiptNum\" as \"COBRO\",T0.\"U_ESTADO\" as \"ESTADO\",\"U_MensajeError\" AS \"MENSAJE DE ERROR\",T2.\"CORREO_CLIENTE\" as \"CORREO ENVIADO\", CASE WHEN T2.\"ESTADO_ENVIO\" IS NULL THEN 'N' ELSE T2.\"ESTADO_ENVIO\"  END AS \"ESTADO ENVIO\",'' AS \"Chek\" " +
                           "FROM " + v_tabla + " T0 " +
                           "INNER JOIN OCRD T1 ON T1.\"CardCode\"=T0.\"CardCode\" " +
                           "LEFT JOIN \"INF_HOLDING\".\"DOC_ELECTRONICO\" T2 ON T2.\"CDC\"=T0.\"U_CDC\" " +
                           "WHERE T0.\"DocDate\" BETWEEN '" + v_fechaD + "' AND '" + v_fechaH + "' AND T0.\"U_TIMB\"='" + tim + "' AND T0.\"U_ESTADO\" ='" + v_estadoD + "' AND T0.\"CANCELED\"='N' " + v_sub + v_SeriBusq + v_busqsn + v_busqcorreo + "   ORDER BY 1,4 ASC";
            SAPbobsCOM.Recordset oDatosDoc;
            oDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oDatosDoc.DoQuery(query);
            int cantdatos = oDatosDoc.RecordCount;
            //consultas.ConsultasClient cliente = new consultas.ConsultasClient();
            //consultas.consultaRequest consultaEstado = new consultas.consultaRequest();
            //consultas.consultaRequest1[] consultaEstado1 = new consultas.consultaRequest1[1];
            //consultas.consultaResponse consultaResp = new consultas.consultaResponse();
            //consultas.consultaResponse1 consultaResp1 = new consultas.consultaResponse1();
            //consultas.numeroTipoDocumento numTipo = new consultas.numeroTipoDocumento();
            //consultas.numeroTipoDocumento[] numTipo1 = new consultas.numeroTipoDocumento[1];


            string[] v_cdc = new string[1];
            int fila = 0;
            string v_estado = null;

            grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_13").Specific;
            //grilla.DataTable.Clear();

            grilla.DataTable = oForm.DataSources.DataTables.Item("data1");
            grilla.DataTable.Columns.Add("Fecha", BoFieldsType.ft_Text, 0);
            grilla.DataTable.Columns.Add("Tipo Documento", BoFieldsType.ft_Text, 1);
            grilla.DataTable.Columns.Add("# INTERNO", BoFieldsType.ft_Text, 2);
            grilla.DataTable.Columns.Add("Numero Documento", BoFieldsType.ft_Text, 3);
            grilla.DataTable.Columns.Add("CDC", BoFieldsType.ft_Text, 4);
            grilla.DataTable.Columns.Add("Correo electrónico", BoFieldsType.ft_Text, 5);
            grilla.DataTable.Columns.Add("Estado", BoFieldsType.ft_Text, 6);
            grilla.DataTable.Columns.Add("Mensaje de error", BoFieldsType.ft_Text, 7);
            grilla.DataTable.Columns.Add("ENLACE", BoFieldsType.ft_Text, 8);
            grilla.AutoResizeColumns();
            grilla.Columns.Item("RowsHeader").TitleObject.Caption = "#";
            //grilla.DataTable.Rows.Add();
            oForm.DataSources.DataTables.Item("data1").ExecuteQuery(query);
            grilla.DataTable = oForm.DataSources.DataTables.Item("data1");
            string v_fecha, v_tipodoc, v_interno, v_numdoc, v_factura;

            //while (!oDatosDoc.EoF)
            //{
            //    v_fecha = oDatosDoc.Fields.Item(0).Value.ToString();
            //    v_tipodoc = oDatosDoc.Fields.Item(1).Value.ToString();
            //    v_interno = oDatosDoc.Fields.Item(2).Value.ToString();
            //    v_factura = oDatosDoc.Fields.Item(4).Value.ToString();
            //    // consumimos el servicio para saber el estado del documento
            //    string msjError = null;
            //    v_cdc[0] = oDatosDoc.Fields.Item(3).Value.ToString();//"01800032322017002000726312023011717496606328";
            //    consultaEstado.cdc = v_cdc;
            //    consultaEstado.ruc = 80003232;
            //    consultaResp = cliente.consulta(consultaEstado);
            //    v_estado = consultaResp.documento[0].estado;
            //    if (v_estado.Equals("RECHAZADO") || v_estado.Equals("RECHAZADO_REINGRESADO"))
            //    {
            //        msjError = consultaResp.documento[0].documentoError[0].mensaje.ToString();
            //    }
            //    //grilla.DataTable.Rows.Add();
            //    //grilla.DataTable.SetValue(0, fila, v_fecha);
            //    //grilla.DataTable.SetValue(1, fila, v_tipodoc);
            //    //grilla.DataTable.SetValue(2, fila, v_interno);
            //    //grilla.DataTable.SetValue(3, fila, v_factura);
            //    grilla.DataTable.SetValue(5, fila, v_estado);
            //    grilla.DataTable.SetValue(6, fila, msjError);
            //    //grilla.DataTable.SetValue(6, fila, v_fecha);
            //    oDatosDoc.MoveNext();
            //    fila++;
            //}
            //consultaEstado.ruc = 80003232;
            //consultaEstado.rucSpecified = true;
            //consultaEstado.dv = "2";           
            //consultaEstado.fechaEmisionDesde = DateTime.Parse("2023-01-13");
            //consultaEstado.fechaEmisionDesdeSpecified = true;
            //consultaEstado.fechaEmisionHasta = DateTime.Parse("2023-01-14");
            //consultaEstado.fechaEmisionHastaSpecified = true;
            //numTipo.tipo = "1";
            //numTipo1[0] = numTipo;
            //consultaEstado.numeroTipoDocumento = numTipo1;
            //consultaResp = cliente.consulta(consultaEstado);
            //string v_cant = consultaResp.cantidadTotalResultados;



            //agregar check box a la columna
            SAPbouiCOM.CheckBoxColumn col;
            EditTextColumn gridbutton = (SAPbouiCOM.EditTextColumn)grilla.Columns.Item(13);
            gridbutton.Type = BoGridColumnType.gct_CheckBox;
            col = (SAPbouiCOM.CheckBoxColumn)grilla.Columns.Item(13);
        }

        //funcion para actualizar los estados
        private static void ActualizarEstados()
        {

            //prueba actualizar estados
            consultas.ConsultasClient cliente = new consultas.ConsultasClient();
            consultas.consultaRequest consultaEstado = new consultas.consultaRequest();
            consultas.consultaRequest1[] consultaEstado1 = new consultas.consultaRequest1[1];
            consultas.consultaResponse consultaResp = new consultas.consultaResponse();
            consultas.consultaResponse1 consultaResp1 = new consultas.consultaResponse1();
            consultas.numeroTipoDocumento numTipo = new consultas.numeroTipoDocumento();
            consultas.numeroTipoDocumento[] numTipo1 = new consultas.numeroTipoDocumento[1];
            string[] v_cdc = new string[1];//AND T0.\"U_CDC\" !='' AND \"CANCELED\"='N' T0.\"DocDate\" BETWEEN '20230101' AND '20230131' AND

            //FACTURAS
            string tim = null;
            if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
            {
                tim = "16094946";
            }
            else
            {
                tim = "16148774";
            }
            string query = "SELECT T0.\"DocNum\",T0.\"U_CDC\" " +
                           "FROM OINV T0 " +
                           "WHERE  \"U_TIMB\"='" + tim + "' AND  ( \"U_ESTADO\"='RECHAZADO'  or \"U_ESTADO\"='PROCESADO' or \"U_ESTADO\"='PENDIENTE') AND T0.\"U_CDC\" is not null ORDER BY 1 ASC";
            SAPbobsCOM.Recordset oDatosDoc;
            oDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oDatosDoc.DoQuery(query);
            int cantdatos = oDatosDoc.RecordCount;
            string v_est = null;
            Cursor.Current = Cursors.WaitCursor;
            while (!oDatosDoc.EoF)

            {
                //consumimos el servicio para saber el estado del documento
                string msjError = null;
                v_cdc[0] = oDatosDoc.Fields.Item(1).Value.ToString();//"01800032322017002000726312023011717496606328";
                consultaEstado.cdc = v_cdc;
                consultaEstado.ruc = 80082380;
                consultaEstado.dv = "0";
                consultaResp = cliente.consulta(consultaEstado);
                int canResu = int.Parse(consultaResp.cantidadResultados.ToString());
                if (canResu == 1)
                {
                    v_est = consultaResp.documento[0].estado;
                }
                else
                {
                    v_est = consultaResp.documento[canResu - 1].estado;
                }

                string estadoFac = null;
                if (v_est.Equals("RECHAZADO") || v_est.Equals("RECHAZADO_REINGRESADO") || v_est.Equals("RECHAZADO_INUTILIZADO"))
                {
                    msjError = consultaResp.documento[canResu - 1].documentoError[0].mensaje.ToString();
                    estadoFac = "RECHAZADO";
                }
                else
                {
                    estadoFac = v_est;
                    msjError = "";
                }
                //actualizamos el estado del documento
                SAPbobsCOM.Recordset oAct;
                oAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAct.DoQuery("UPDATE OINV SET \"U_ESTADO\"='" + estadoFac + "',\"U_MensajeError\"='" + msjError + "' WHERE \"DocNum\"='" + oDatosDoc.Fields.Item(0).Value.ToString() + "' ");
                //buscamos si existe o no el documento en la tabla de auditoria
                SAPbobsCOM.Recordset oAuditoria;
                oAuditoria = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAuditoria.DoQuery("SELECT * FROM \"INF_HOLDING\".\"DOC_ELECTRONICO\" T0 INNER JOIN OINV T1 ON T0.\"CDC\"=T1.\"U_CDC\" WHERE T1.\"DocNum\"='" + oDatosDoc.Fields.Item(0).Value.ToString() + "' AND T0.\"TIPO_DOCUMENTO\"='1'  ");
                int contDoc = oAuditoria.RecordCount;
                if (contDoc > 0)
                {
                    //realizamos un UPDATE
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("UPDATE \"INF_HOLDING\".\"DOC_ELECTRONICO\" SET  \"ESTADO\"='" + estadoFac + "' WHERE \"NRO_DOCUMENTO\"='" + oDatosDoc.Fields.Item(0).Value.ToString() + "' AND \"TIPO_DOCUMENTO\"='1' ");
                }
                else
                {
                    //buscamos los datos del documento
                    SAPbobsCOM.Recordset pDatosDoc;
                    pDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    string queryDoc = "SELECT T2.\"TaxIdNum\",'1',T0.\"U_ID\",T0.\"CardCode\",T1.\"LicTradNum\",T0.\"U_CDC\",T0.\"DocNum\",T0.\"DocDate\",T0.\"DocTotal\",T0.\"U_ESTADO\",t0.\"U_MensajeError\",T1.\"E_Mail\",T1.\"Cellular\",'N' FROM OINV T0 " +
                                      "INNER JOIN OCRD T1 ON T0.\"CardCode\"=t1.\"CardCode\" " +
                                      "LEFT JOIN OADM T2 ON T2.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "WHERE T0.\"DocNum\"='" + oDatosDoc.Fields.Item(0).Value.ToString() + "' ";
                    pDatosDoc.DoQuery(queryDoc);
                    //DateTime fecha = DateTime.Parse(pDatosDoc.Fields.Item(7).Value.ToString());
                    //string v_fecha = fecha.ToString("yyyy-MM-dd");
                    //DateTime fecha_v = DateTime.Parse(v_fecha);
                    //realizamos un INSERT
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("INSERT INTO \"INF_HOLDING\".\"DOC_ELECTRONICO\" (\"RUC_EMISOR\",\"TIPO_DOCUMENTO\",\"ID_DOC\",\"CLIENTE_CODIGO\",\"RUC_CLIENTE\",\"CDC\",\"NRO_DOCUMENTO\",\"FECHA\",\"TOTAL_DOCUMENTO\",\"ESTADO\",\"MENSAJE_ERROR\",\"CORREO_CLIENTE\",\"CELULAR_CLIENTE\",\"ESTADO_ENVIO\")" +
                                          " VALUES ('" + pDatosDoc.Fields.Item(0).Value.ToString() + "','" + pDatosDoc.Fields.Item(1).Value.ToString() + "','" + pDatosDoc.Fields.Item(2).Value.ToString() + "','" + pDatosDoc.Fields.Item(3).Value.ToString() + "','" + pDatosDoc.Fields.Item(4).Value.ToString() + "','" + pDatosDoc.Fields.Item(5).Value.ToString() + "','" + pDatosDoc.Fields.Item(6).Value.ToString() + "','" + pDatosDoc.Fields.Item(7).Value.ToString() + "','" + pDatosDoc.Fields.Item(8).Value.ToString() + "','" + pDatosDoc.Fields.Item(9).Value.ToString() + "','" + pDatosDoc.Fields.Item(10).Value.ToString() + "','" + pDatosDoc.Fields.Item(11).Value.ToString() + "','" + pDatosDoc.Fields.Item(12).Value.ToString() + "','" + pDatosDoc.Fields.Item(13).Value.ToString() + "') ");
                }


                oDatosDoc.MoveNext();
            }

            //NOTA DE CREDITO
            string query2 = "SELECT T0.\"DocNum\",T0.\"U_CDC\" " +
                           "FROM ORIN T0 " +
                           "WHERE \"U_TIMB\"='" + tim + "' AND  ( \"U_ESTADO\"='RECHAZADO'  or \"U_ESTADO\"='PROCESADO' or \"U_ESTADO\"='PENDIENTE') AND T0.\"U_CDC\" is not null  ORDER BY 1 ASC";
            SAPbobsCOM.Recordset oDatosDocNC;
            oDatosDocNC = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oDatosDocNC.DoQuery(query2);
            int cantdatosNC = oDatosDocNC.RecordCount;
            string v_est2 = null;
            while (!oDatosDocNC.EoF)
            {
                //consumimos el servicio para saber el estado del documento
                string msjError2 = null;
                v_cdc[0] = oDatosDocNC.Fields.Item(1).Value.ToString();//"01800032322017002000726312023011717496606328";
                consultaEstado.cdc = v_cdc;
                consultaEstado.ruc = 80082380;
                consultaEstado.dv = "0";
                consultaResp = cliente.consulta(consultaEstado);
                int canResu = int.Parse(consultaResp.cantidadResultados.ToString());
                if (canResu == 1)
                {
                    v_est2 = consultaResp.documento[0].estado;
                }
                else
                {
                    v_est2 = consultaResp.documento[canResu - 1].estado;
                }

                string estadoNC = null;
                if (v_est2.Equals("RECHAZADO") || v_est2.Equals("RECHAZADO_REINGRESADO") || v_est2.Equals("RECHAZADO_INUTILIZADO"))
                {
                    msjError2 = consultaResp.documento[canResu - 1].documentoError[0].mensaje.ToString();
                    estadoNC = "RECHAZADO";

                }
                else
                {
                    msjError2 = "";
                    estadoNC = v_est2;
                }
                //actualizamos el estado del documento
                SAPbobsCOM.Recordset oAct;
                oAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAct.DoQuery("UPDATE ORIN SET \"U_ESTADO\"='" + estadoNC + "',\"U_MensajeError\"='" + msjError2 + "' WHERE \"DocNum\"='" + oDatosDocNC.Fields.Item(0).Value.ToString() + "' ");
                //buscamos si existe o no el documento en la tabla de auditoria
                SAPbobsCOM.Recordset oAuditoria;
                oAuditoria = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAuditoria.DoQuery("SELECT * FROM \"INF_HOLDING\".\"DOC_ELECTRONICO\" T0 INNER JOIN ORIN T1 ON T0.\"CDC\"=T1.\"U_CDC\" WHERE T1.\"DocNum\"='" + oDatosDocNC.Fields.Item(0).Value.ToString() + "' AND T0.\"TIPO_DOCUMENTO\"='5'  ");
                string pp = oDatosDocNC.Fields.Item(0).Value.ToString();
                int contDoc = oAuditoria.RecordCount;
                if (contDoc > 0)
                {
                    //realizamos un UPDATE
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("UPDATE \"INF_HOLDING\".\"DOC_ELECTRONICO\" SET  \"ESTADO\"='" + estadoNC + "' WHERE \"NRO_DOCUMENTO\"='" + oDatosDocNC.Fields.Item(0).Value.ToString() + "' AND \"TIPO_DOCUMENTO\"='5' ");
                }
                else
                {
                    //buscamos los datos del documento
                    SAPbobsCOM.Recordset pDatosDoc;
                    pDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    string queryDoc = "SELECT T2.\"TaxIdNum\",'5',T0.\"U_ID\",T0.\"CardCode\",T1.\"LicTradNum\",T0.\"U_CDC\",T0.\"DocNum\",T0.\"DocDate\",T0.\"DocTotal\",T0.\"U_ESTADO\",t0.\"U_MensajeError\",T1.\"E_Mail\",T1.\"Cellular\",'N' FROM ORIN T0 " +
                                      "INNER JOIN OCRD T1 ON T0.\"CardCode\"=t1.\"CardCode\" " +
                                      "LEFT JOIN OADM T2 ON T2.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "WHERE T0.\"DocNum\"='" + oDatosDocNC.Fields.Item(0).Value.ToString() + "' ";
                    pDatosDoc.DoQuery(queryDoc);
                    string fecha = pDatosDoc.Fields.Item(7).Value.ToString();
                    string ll = pDatosDoc.Fields.Item(2).Value.ToString();
                    //realizamos un INSERT
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("INSERT INTO \"INF_HOLDING\".\"DOC_ELECTRONICO\" (\"RUC_EMISOR\",\"TIPO_DOCUMENTO\",\"ID_DOC\",\"CLIENTE_CODIGO\",\"RUC_CLIENTE\",\"CDC\",\"NRO_DOCUMENTO\",\"FECHA\",\"TOTAL_DOCUMENTO\",\"ESTADO\",\"MENSAJE_ERROR\",\"CORREO_CLIENTE\",\"CELULAR_CLIENTE\",\"ESTADO_ENVIO\")" +
                                          " VALUES ('" + pDatosDoc.Fields.Item(0).Value.ToString() + "','" + pDatosDoc.Fields.Item(1).Value.ToString() + "','" + pDatosDoc.Fields.Item(2).Value.ToString() + "','" + pDatosDoc.Fields.Item(3).Value.ToString() + "','" + pDatosDoc.Fields.Item(4).Value.ToString() + "','" + pDatosDoc.Fields.Item(5).Value.ToString() + "','" + pDatosDoc.Fields.Item(6).Value.ToString() + "','" + fecha + "','" + pDatosDoc.Fields.Item(8).Value.ToString() + "','" + pDatosDoc.Fields.Item(9).Value.ToString() + "','" + pDatosDoc.Fields.Item(10).Value.ToString() + "','" + pDatosDoc.Fields.Item(11).Value.ToString() + "','" + pDatosDoc.Fields.Item(12).Value.ToString() + "','" + pDatosDoc.Fields.Item(13).Value.ToString() + "') ");
                }

                oDatosDocNC.MoveNext();
            }

            //Traslado
            string query3 = "SELECT T0.\"DocNum\",T0.\"U_CDC\" " +
                           "FROM OWTR T0 " +
                           "WHERE  \"U_TIMB\"='" + tim + "'  AND  ( \"U_ESTADO\"='RECHAZADO'  or \"U_ESTADO\"='PROCESADO' or \"U_ESTADO\"='PENDIENTE')  ORDER BY 1 ASC";
            SAPbobsCOM.Recordset oDatosDocTras;
            oDatosDocTras = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oDatosDocTras.DoQuery(query3);
            int cantdatosT = oDatosDocTras.RecordCount;
            string v_est3 = null;
            while (!oDatosDocTras.EoF)
            {
                //consumimos el servicio para saber el estado del documento
                string msjError3 = null;
                v_cdc[0] = oDatosDocTras.Fields.Item(1).Value.ToString();//"01800032322017002000726312023011717496606328";
                consultaEstado.cdc = v_cdc;
                consultaEstado.ruc = 80082380;
                consultaEstado.dv = "0";
                consultaResp = cliente.consulta(consultaEstado);
                int canResu = int.Parse(consultaResp.cantidadResultados.ToString());
                if (canResu == 1)
                {
                    v_est3 = consultaResp.documento[0].estado;
                }
                else
                {
                    v_est3 = consultaResp.documento[canResu - 1].estado;
                }
                string estadoTras = null;
                if (v_est3.Equals("RECHAZADO") || v_est3.Equals("RECHAZADO_REINGRESADO") || v_est3.Equals("RECHAZADO_INUTILIZADO"))
                {
                    msjError3 = consultaResp.documento[canResu - 1].documentoError[0].mensaje.ToString();
                    estadoTras = "RECHAZADO";
                }
                else
                {
                    estadoTras = v_est3;
                    msjError3 = "";
                }

                SAPbobsCOM.Recordset oAct;
                oAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAct.DoQuery("UPDATE OWTR SET \"U_ESTADO\"='" + estadoTras + "',\"U_MensajeError\"='" + msjError3 + "' WHERE \"DocNum\"='" + oDatosDocTras.Fields.Item(0).Value.ToString() + "' ");
                //buscamos si existe o no el documento en la tabla de auditoria
                SAPbobsCOM.Recordset oAuditoria;
                oAuditoria = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAuditoria.DoQuery("SELECT * FROM \"INF_HOLDING\".\"DOC_ELECTRONICO\" T0 INNER JOIN OWTR T1 ON T0.\"CDC\"=T1.\"U_CDC\" WHERE T1.\"DocNum\"='" + oDatosDocTras.Fields.Item(0).Value.ToString() + "' AND T0.\"TIPO_DOCUMENTO\"='7'  ");
                int contDoc = oAuditoria.RecordCount;
                if (contDoc > 0)
                {
                    //realizamos un UPDATE
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("UPDATE \"INF_HOLDING\".\"DOC_ELECTRONICO\" SET  \"ESTADO\"='" + estadoTras + "' WHERE \"NRO_DOCUMENTO\"='" + oDatosDocTras.Fields.Item(0).Value.ToString() + "' AND \"TIPO_DOCUMENTO\"='7' ");
                }
                else
                {
                    //buscamos los datos del documento
                    SAPbobsCOM.Recordset pDatosDoc;
                    pDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    string queryDoc = "SELECT T2.\"TaxIdNum\",'7',T0.\"U_ID\",T0.\"CardCode\",T1.\"LicTradNum\",T0.\"U_CDC\",T0.\"DocNum\",T0.\"DocDate\",T0.\"DocTotal\",T0.\"U_ESTADO\",t0.\"U_MensajeError\",T1.\"E_Mail\",T1.\"Cellular\",'N' FROM OWTR T0 " +
                                      "INNER JOIN OCRD T1 ON T0.\"CardCode\"=t1.\"CardCode\" " +
                                      "LEFT JOIN OADM T2 ON T2.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "WHERE T0.\"DocNum\"='" + oDatosDocTras.Fields.Item(0).Value.ToString() + "' ";
                    pDatosDoc.DoQuery(queryDoc);
                    string fecha = pDatosDoc.Fields.Item(7).Value.ToString();
                    //realizamos un INSERT
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("INSERT INTO \"INF_HOLDING\".\"DOC_ELECTRONICO\" (\"RUC_EMISOR\",\"TIPO_DOCUMENTO\",\"ID_DOC\",\"CLIENTE_CODIGO\",\"RUC_CLIENTE\",\"CDC\",\"NRO_DOCUMENTO\",\"FECHA\",\"TOTAL_DOCUMENTO\",\"ESTADO\",\"MENSAJE_ERROR\",\"CORREO_CLIENTE\",\"CELULAR_CLIENTE\",\"ESTADO_ENVIO\")" +
                                          " VALUES ('" + pDatosDoc.Fields.Item(0).Value.ToString() + "','" + pDatosDoc.Fields.Item(1).Value.ToString() + "','" + pDatosDoc.Fields.Item(2).Value.ToString() + "','" + pDatosDoc.Fields.Item(3).Value.ToString() + "','" + pDatosDoc.Fields.Item(4).Value.ToString() + "','" + pDatosDoc.Fields.Item(5).Value.ToString() + "','" + pDatosDoc.Fields.Item(6).Value.ToString() + "','" + fecha + "','" + pDatosDoc.Fields.Item(8).Value.ToString() + "','" + pDatosDoc.Fields.Item(9).Value.ToString() + "','" + pDatosDoc.Fields.Item(10).Value.ToString() + "','" + pDatosDoc.Fields.Item(11).Value.ToString() + "','" + pDatosDoc.Fields.Item(12).Value.ToString() + "','" + pDatosDoc.Fields.Item(13).Value.ToString() + "') ");
                }

                oDatosDocTras.MoveNext();
            }

            //ENTREGA
            string query4 = "SELECT T0.\"DocNum\",T0.\"U_CDC\" " +
                           "FROM ODLN T0 " +
                           "WHERE  \"U_TIMB\"='" + tim + "'  AND  ( \"U_ESTADO\"='RECHAZADO'  or \"U_ESTADO\"='PROCESADO' or \"U_ESTADO\"='PENDIENTE')  ORDER BY 1 ASC";
            SAPbobsCOM.Recordset oDatosDocEnt;
            oDatosDocEnt = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            oDatosDocEnt.DoQuery(query4);
            int cantdatosEnt = oDatosDocEnt.RecordCount;
            string v_est4 = null;
            while (!oDatosDocEnt.EoF)
            {
                //consumimos el servicio para saber el estado del documento
                string msjError4 = null;
                v_cdc[0] = oDatosDocEnt.Fields.Item(1).Value.ToString();//"01800032322017002000726312023011717496606328";
                consultaEstado.cdc = v_cdc;
                consultaEstado.ruc = 80082380;
                consultaEstado.dv = "0";
                consultaResp = cliente.consulta(consultaEstado);
                int canResu = int.Parse(consultaResp.cantidadResultados.ToString());
                if (canResu == 1)
                {
                    v_est4 = consultaResp.documento[0].estado;
                }
                else
                {
                    v_est4 = consultaResp.documento[canResu - 1].estado;
                }
                string estadoEnt = null;
                if (v_est4.Equals("RECHAZADO") || v_est4.Equals("RECHAZADO_REINGRESADO") || v_est4.Equals("RECHAZADO_INUTILIZADO"))
                {
                    msjError4 = consultaResp.documento[canResu - 1].documentoError[0].mensaje.ToString();
                    estadoEnt = "RECHAZADO";
                }
                else
                {
                    estadoEnt = v_est4;
                    msjError4 = "";
                }

                SAPbobsCOM.Recordset oAct;
                oAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAct.DoQuery("UPDATE ODLN SET \"U_ESTADO\"='" + estadoEnt + "',\"U_MensajeError\"='" + msjError4 + "' WHERE \"DocNum\"='" + oDatosDocEnt.Fields.Item(0).Value.ToString() + "' ");
                //buscamos si existe o no el documento en la tabla de auditoria
                SAPbobsCOM.Recordset oAuditoria;
                oAuditoria = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oAuditoria.DoQuery("SELECT * FROM \"INF_HOLDING\".\"DOC_ELECTRONICO\" T0 INNER JOIN ODLN T1 ON T0.\"CDC\"=T1.\"U_CDC\" WHERE T1.\"DocNum\"='" + oDatosDocEnt.Fields.Item(0).Value.ToString() + "'AND T0.\"TIPO_DOCUMENTO\"='7'  ");
                int contDoc = oAuditoria.RecordCount;
                if (contDoc > 0)
                {
                    //realizamos un UPDATE
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("UPDATE \"INF_HOLDING\".\"DOC_ELECTRONICO\" SET  \"ESTADO\"='" + estadoEnt + "' WHERE \"NRO_DOCUMENTO\"='" + oDatosDocEnt.Fields.Item(0).Value.ToString() + "' AND \"TIPO_DOCUMENTO\"='7' ");
                }
                else
                {
                    //buscamos los datos del documento
                    SAPbobsCOM.Recordset pDatosDoc;
                    pDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    string queryDoc = "SELECT T2.\"TaxIdNum\",'7',T0.\"U_ID\",T0.\"CardCode\",T1.\"LicTradNum\",T0.\"U_CDC\",T0.\"DocNum\",T0.\"DocDate\",T0.\"DocTotal\",T0.\"U_ESTADO\",t0.\"U_MensajeError\",T1.\"E_Mail\",T1.\"Cellular\",'N' FROM ODLN T0 " +
                                      "INNER JOIN OCRD T1 ON T0.\"CardCode\"=t1.\"CardCode\" " +
                                      "LEFT JOIN OADM T2 ON T2.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "WHERE T0.\"DocNum\"='" + oDatosDocEnt.Fields.Item(0).Value.ToString() + "' ";
                    pDatosDoc.DoQuery(queryDoc);
                    string fecha = pDatosDoc.Fields.Item(7).Value.ToString();
                    //realizamos un INSERT
                    SAPbobsCOM.Recordset oAuditoriaAct;
                    oAuditoriaAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oAuditoriaAct.DoQuery("INSERT INTO \"INF_HOLDING\".\"DOC_ELECTRONICO\" (\"RUC_EMISOR\",\"TIPO_DOCUMENTO\",\"ID_DOC\",\"CLIENTE_CODIGO\",\"RUC_CLIENTE\",\"CDC\",\"NRO_DOCUMENTO\",\"FECHA\",\"TOTAL_DOCUMENTO\",\"ESTADO\",\"MENSAJE_ERROR\",\"CORREO_CLIENTE\",\"CELULAR_CLIENTE\",\"ESTADO_ENVIO\")" +
                                          " VALUES ('" + pDatosDoc.Fields.Item(0).Value.ToString() + "','" + pDatosDoc.Fields.Item(1).Value.ToString() + "','" + pDatosDoc.Fields.Item(2).Value.ToString() + "','" + pDatosDoc.Fields.Item(3).Value.ToString() + "','" + pDatosDoc.Fields.Item(4).Value.ToString() + "','" + pDatosDoc.Fields.Item(5).Value.ToString() + "','" + pDatosDoc.Fields.Item(6).Value.ToString() + "','" + fecha + "','" + pDatosDoc.Fields.Item(8).Value.ToString() + "','" + pDatosDoc.Fields.Item(9).Value.ToString() + "','" + pDatosDoc.Fields.Item(10).Value.ToString() + "','" + pDatosDoc.Fields.Item(11).Value.ToString() + "','" + pDatosDoc.Fields.Item(12).Value.ToString() + "','" + pDatosDoc.Fields.Item(13).Value.ToString() + "') ");
                }

                oDatosDocEnt.MoveNext();
            }

            Cursor.Current = Cursors.Default;
            SBO_Application.StatusBar.SetText("Documentos actualizados!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
        }

        //funcion para exportar a excel
        private static void ExportarExcel(SAPbouiCOM.Form oForm)
        {
            Microsoft.Office.Interop.Excel.Application aplicacion;
            Microsoft.Office.Interop.Excel.Workbook libro;
            Microsoft.Office.Interop.Excel.Worksheet hoja;
            Microsoft.Office.Interop.Excel.Worksheet hoja2;
            Microsoft.Office.Interop.Excel.Range rango;
            object misvalue = System.Reflection.Missing.Value;
            SAPbouiCOM.Grid grilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_13").Specific;

            try
            {
                //configuramos los elementos para el excel
                aplicacion = new Microsoft.Office.Interop.Excel.Application();
                aplicacion.Visible = false;
                libro = (Microsoft.Office.Interop.Excel.Workbook)(aplicacion.Workbooks.Add(""));
                hoja = (Microsoft.Office.Interop.Excel.Worksheet)libro.ActiveSheet;
                //agregamos los titulos al excel
                hoja.Cells[1, 1] = "FECHA";
                hoja.Cells[1, 2] = "TIPO DOCUMENTO";
                hoja.Cells[1, 3] = "# INTERNO";
                hoja.Cells[1, 4] = "RUC";
                hoja.Cells[1, 5] = "RAZON SOCIAL";
                hoja.Cells[1, 6] = "# DOCUMENTO";
                hoja.Cells[1, 7] = "CDC";
                hoja.Cells[1, 8] = "CORREO ELECTRONICO";
                hoja.Cells[1, 9] = "COBRO";
                hoja.Cells[1, 10] = "ESTADO";
                hoja.Cells[1, 11] = "MENSJAE DE ERROR";
                hoja.Cells[1, 12] = "CORREO ENVIADO";
                hoja.Cells[1, 13] = "ESTADO ENVIO";
                //ponemos en negrita los titulos
                hoja.Range["A1", "I1"].Font.Bold = true;

                int fila = 1;
                int filacelda = 2;
                int filamatrix = 0;
                int countgrid = grilla.Rows.Count;
                //recorremos la grilla
                while (fila <= countgrid)
                {
                    hoja.Cells[filacelda, 1] = grilla.DataTable.GetValue(0, filamatrix);
                    hoja.Cells[filacelda, 2] = grilla.DataTable.GetValue(1, filamatrix);
                    hoja.Cells[filacelda, 3] = grilla.DataTable.GetValue(2, filamatrix);
                    hoja.Cells[filacelda, 4] = grilla.DataTable.GetValue(3, filamatrix);
                    hoja.Cells[filacelda, 5] = grilla.DataTable.GetValue(4, filamatrix);
                    hoja.Cells[filacelda, 6] = grilla.DataTable.GetValue(5, filamatrix);
                    hoja.Cells[filacelda, 7] = grilla.DataTable.GetValue(6, filamatrix);
                    hoja.Cells[filacelda, 8] = grilla.DataTable.GetValue(7, filamatrix);
                    hoja.Cells[filacelda, 9] = grilla.DataTable.GetValue(8, filamatrix);
                    hoja.Cells[filacelda, 10] = grilla.DataTable.GetValue(9, filamatrix);
                    hoja.Cells[filacelda, 11] = grilla.DataTable.GetValue(10, filamatrix);
                    hoja.Cells[filacelda, 12] = grilla.DataTable.GetValue(11, filamatrix);
                    hoja.Cells[filacelda, 13] = grilla.DataTable.GetValue(12, filamatrix);

                    filacelda = filacelda + 1;
                    filamatrix = filamatrix + 1;
                    fila = fila + 1;
                }
                //creamos una carpeta en el escritorio para guardar el excel
                string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
                string CarpEscr = path + "\\DescargasExcel-FE";
                if (!Directory.Exists(CarpEscr))
                {
                    Directory.CreateDirectory(CarpEscr);
                }

                aplicacion.Visible = false;
                aplicacion.UserControl = false;
                string archivo = CarpEscr + "\\DocumentosFE_" + DateTime.Now.Hour.ToString("D2") + "" + DateTime.Now.Minute.ToString("D2") + "" + DateTime.Now.Second.ToString("D2") + ".xls";
                libro.SaveAs(archivo);
                libro.Close();
                aplicacion.Quit();
                SAPbouiCOM.Framework.Application.SBO_Application.StatusBar.SetText("Exportado con éxito", SAPbouiCOM.BoMessageTime.bmt_Short, SAPbouiCOM.BoStatusBarMessageType.smt_Success);

            }
            catch (Exception e)
            {

            }

        }

        //funcion para descargar PDF y XML
        private static void descargarPdfXml(SAPbouiCOM.Form oForm)
        {
            SAPbouiCOM.Grid oGrilla = (SAPbouiCOM.Grid)oForm.Items.Item("Item_13").Specific;
            SAPbouiCOM.ComboBox oCombo = (SAPbouiCOM.ComboBox)oForm.Items.Item("Item_8").Specific;
            string v_selecCombo = oCombo.Selected.Value.ToString();
            int GrillaCount = oGrilla.DataTable.Rows.Count;
            string v_tipoDoc = null;
            string v_SubType = null;
            if (v_selecCombo.Equals("1")) { v_tipoDoc = "OINV"; }
            if (v_selecCombo.Equals("2")) { v_tipoDoc = "ORIN"; }
            if (v_selecCombo.Equals("3")) { v_tipoDoc = "ODLN"; }
            if (v_selecCombo.Equals("4")) { v_tipoDoc = "OWTR"; }
            if (v_selecCombo.Equals("5")) { v_tipoDoc = "OINV"; v_SubType = " AND \"DocSubType\"='DN' "; }
            if (v_selecCombo.Equals("6")) { v_tipoDoc = ""; }
            if (v_selecCombo.Equals("7")) { v_tipoDoc = "OINV"; v_SubType = " AND \"DocSubType\"='IX'"; }
            int contador = 0;
            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
            string CarpEscr = path + "\\Documentos Electronicos";
            if (!Directory.Exists(CarpEscr))
            {
                Directory.CreateDirectory(CarpEscr);
            }

            while (GrillaCount > contador)
            {
                string valorchk = oGrilla.DataTable.GetValue(13, contador).ToString();
                if (valorchk.Equals("Y"))
                {
                    string v_numInterno = oGrilla.DataTable.GetValue(2, contador).ToString();
                    string v_docu = oGrilla.DataTable.GetValue(6, contador).ToString();
                    SAPbobsCOM.Recordset oDoc;
                    oDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oDoc.DoQuery("select \"U_KUDE\",\"U_XMLFIRMADO\" from " + v_tipoDoc + " where \"DocNum\"=" + v_numInterno + v_SubType);

                    string KUDE = oDoc.Fields.Item(0).Value.ToString();
                    byte[] bytes = Convert.FromBase64String(KUDE);
                    string XML = oDoc.Fields.Item(1).Value.ToString();
                    byte[] bytesxml = Convert.FromBase64String(XML);

                    string v_carpPdf = CarpEscr + "\\" + v_docu + ".pdf";
                    if (!File.Exists(CarpEscr + "\\" + v_docu + ".pdf"))
                    {
                        //guardar el PDF
                        File.Delete(Path.Combine(path + "\\Documentos Electronicos\\" + v_docu + ".pdf"));
                        FileStream obj = File.Create(path + "\\Documentos Electronicos\\" + v_docu + ".pdf");
                        obj.Write(bytes, 0, bytes.Length);
                        obj.Flush();
                        obj.Close();
                        //guardar el XML
                        File.Delete(Path.Combine(path + "\\Documentos Electronicos\\" + v_docu + ".xml"));
                        FileStream obj2 = File.Create(path + "\\Documentos Electronicos\\" + v_docu + ".xml");
                        obj2.Write(bytesxml, 0, bytesxml.Length);
                        obj2.Flush();
                        obj2.Close();
                    }
                    ////guardar el PDF
                    //File.Delete(Path.Combine(path + "\\Documentos Electronicos\\" + v_docu + ".pdf"));
                    //FileStream obj = File.Create(path + "\\Documentos Electronicos\\" + v_docu + ".pdf");
                    //obj.Write(bytes, 0, bytes.Length);
                    //obj.Flush();
                    //obj.Close();
                    ////guardar el XML
                    //File.Delete(Path.Combine(path + "\\Documentos Electronicos\\" + v_docu + ".xml"));
                    //FileStream obj2 = File.Create(path + "\\Documentos Electronicos\\" + v_docu + ".xml");
                    //obj2.Write(bytesxml, 0, bytesxml.Length);
                    //obj2.Flush();
                    //obj2.Close();

                }

                contador++;
            }
            SBO_Application.StatusBar.SetText("Documentos Descargados correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
        }

        //funcion para mandar correo
        private static void enviarcorreo(string mail, string cdc, string doc, string fecha, string moneda, string total, string tipoDoc)
        {
            //ruta de acceso a los documentos
            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
            string CarpEscr = path + "\\Documentos Electronicos\\";

            //string correoOrigen = "kokechaparro1992@gmail.com";
            //string correoOrigen = "contabilidad@fguarani.com.py";
            string correoOrigen = "documentoselectronicosd@granusa.com";
            string correoDestino = mail; //"kokechaparro1992@gmail.com";
            //string correoDestino =  "payala@fguarani.com.py";
            //string pass = "lkioiccnnlskdorc";
            //string pass = "wxvgyhbmlwjqtzkm";
            string pass = "Granusa2023";
            string cuerpo = "Estimado cliente, \n\n" +
                            "En el presente correo se adjunta el siguiente documento: \n\n" +
                            "- " + tipoDoc + " \n" +
                            "- Número: " + doc + " \n" +
                            "- Fecha de emisión: " + fecha + " \n" +
                            "- Moneda: " + moneda + " \n" +
                            "- Monto: " + total + "\n\n" +
                            "Muchas gracias \n\n" +
                            "Este mensaje y sus anexos pertenecen al Frigorífico Guarani y son de carácter estrictamente confidencial. \n" +
                            "Si usted recibe esta información por error, por favor contacte inmediatamente con el remitente, respondiendo el correo y eliminándolo. No use la información, ni la copie, ni tome " +
                            "acciones basadas en ésta, ni divulgue su contenido a ninguna persona y/o sociedad. El incumplimiento podría constituir responsabilidades penales dispuestas por las Leyes.";

            string v_nombrecompa = "";
            if (oCompany.CompanyName.Equals("FRIGORIFICO GUARANI S.A.C.I."))
            {
                v_nombrecompa = "Frigorífico Guarani";
            }
            else
            {
                v_nombrecompa = "Granos y Nutrición S.A.";
            }
            MailMessage correo = new MailMessage(correoOrigen, correoDestino, v_nombrecompa, "Envío de DE emitido por " + v_nombrecompa);
            System.Net.Mail.Attachment adjunto = new System.Net.Mail.Attachment(CarpEscr + cdc + ".pdf");
            correo.Attachments.Add(adjunto);
            System.Net.Mail.Attachment adjunto2 = new System.Net.Mail.Attachment(CarpEscr + cdc + ".xml");
            correo.Attachments.Add(adjunto2);
            correo.Body = cuerpo;

            //SmtpClient smtp = new SmtpClient("smtp.gmail.com");
            SmtpClient smtp = new SmtpClient("smtp.office365.com");
            smtp.EnableSsl = true;
            System.Net.ServicePointManager.SecurityProtocol |= SecurityProtocolType.Tls11 | SecurityProtocolType.Tls12;

            smtp.UseDefaultCredentials = false;
            smtp.Port = 587;
            smtp.Credentials = new System.Net.NetworkCredential(correoOrigen, pass);

            try
            {
                //smtp.Send(correo);
                //actualizamos el estado de correo en hana
                SAPbobsCOM.Recordset oActEstado;
                oActEstado = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oActEstado.DoQuery("UPDATE \"INF_HOLDING\".\"DOC_ELECTRONICO\" SET \"ESTADO_ENVIO\"='N',\"CORREO_CLIENTE\"='" + mail + "' WHERE \"CDC\"='" + cdc + "' ");

                SBO_Application.StatusBar.SetText("Correo enviado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

            }
            catch (Exception e)
            {

            }

        }

        //funcion para inutilizar documento
        private static void inutilizarDoc(string ruc, string timbrado, string esta, string pemi, string documento, string desde, string hasta, string motivo)
        {
            servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
            servicio.inutilizarNumeracionRequest inutilizar = new servicio.inutilizarNumeracionRequest();
            servicio.inutilizarNumeracionResponse inuresponse = new servicio.inutilizarNumeracionResponse();
            try
            {
                //mandamos los parametros al servicio
                inutilizar.ruc = ruc;
                inutilizar.timbrado = timbrado;
                inutilizar.establecimiento = esta;
                inutilizar.puntoExpedicion = pemi;
                if (documento.Equals("8"))
                {
                    inutilizar.tipoDocumento = "7";
                }
                if (documento.Equals("2"))
                {
                    inutilizar.tipoDocumento = "1";
                }
                else
                {
                    inutilizar.tipoDocumento = documento;
                }

                inutilizar.rangoDesde = desde;
                inutilizar.rangoHasta = hasta;
                inutilizar.motivo = motivo;
                //ejecutamos el servicio
                inuresponse = cliente.inutilizarNumeracion(inutilizar);
                bool resp = inuresponse.ok;
                //string erroresp = inuresponse.mensajeError.ToString();
                if (resp == true)
                {
                    //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

                    //evento para cancelar el documento
                    string v_tabla = null;
                    if (documento.Equals("1")) { v_tabla = "OINV"; }
                    if (documento.Equals("2")) { v_tabla = "OINV"; }
                    if (documento.Equals("5")) { v_tabla = "ORIN"; }
                    if (documento.Equals("7")) { v_tabla = "ODLN"; }
                    if (documento.Equals("8")) { v_tabla = "OWTR"; }
                    //if (documento.Equals("7")) { v_tabla = "OWTR"; }
                    //realizamos el query para la busqueda
                    Recordset Doc;
                    Doc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    if (documento.Equals("2"))
                    {
                        Doc.DoQuery("SELECT \"DocEntry\",\"DocNum\",\"FolioNum\" FROM " + v_tabla + " WHERE \"U_ESTA\"='" + esta + "' AND \"U_PEMI\"='" + pemi + "' AND \"FolioNum\"='" + desde + "' AND \"U_TIMB\"='" + timbrado + "' AND \"DocSubType\"='IX' ");
                    }
                    else
                    {
                        Doc.DoQuery("SELECT \"DocEntry\",\"DocNum\",\"FolioNum\" FROM " + v_tabla + " WHERE \"U_ESTA\"='" + esta + "' AND \"U_PEMI\"='" + pemi + "' AND \"FolioNum\"='" + desde + "' AND \"U_TIMB\"='" + timbrado + "' ");
                    }

                    //comprobamos 
                    while (!Doc.EoF)
                    {
                        string v_folio = Doc.Fields.Item(2).Value.ToString();
                        string v_docentry = Doc.Fields.Item(0).Value.ToString();

                        try
                        {
                            //proceso para factura
                            #region OINV
                            //si es factura
                            if (v_tabla.Equals("OINV"))
                            {
                                //instanciamos el documento
                                SAPbobsCOM.Documents document;
                                SAPbobsCOM.Documents docCancel;
                                document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                                docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                                //validamos que el folio no este vacio
                                if (!string.IsNullOrEmpty(v_folio))
                                {
                                    if (document.GetByKey(int.Parse(v_docentry)))
                                    {
                                        //desfoliamos el documento
                                        string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                                        document.NumAtCard = folioAnu;
                                        document.FolioPrefixString = "";
                                        document.FolioNumber = 0;
                                        document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                                        int desfoliar = document.Update();
                                        string descerror = oCompany.GetLastErrorDescription().ToString();
                                        if (desfoliar != 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                            return;
                                        }
                                        docCancel = document.CreateCancellationDocument();
                                        int cancelado = docCancel.Add();
                                        if (cancelado == 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                        }
                                        else
                                        {
                                            SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                        }
                                    }
                                }
                                else
                                {
                                    docCancel = document.CreateCancellationDocument();
                                    int cancelado = docCancel.Add();
                                    if (cancelado == 0)
                                    {
                                        SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                    }
                                    else
                                    {
                                        SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                    }
                                }
                            }
                            #endregion

                            //proceso para nota de credito
                            #region ORIN
                            //si es nota de credito
                            if (v_tabla.Equals("ORIN"))
                            {
                                //instanciamos el documento
                                SAPbobsCOM.Documents document;
                                SAPbobsCOM.Documents docCancel;
                                document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
                                docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
                                //validamos que el folio no este vacio
                                if (!string.IsNullOrEmpty(v_folio))
                                {
                                    if (document.GetByKey(int.Parse(v_docentry)))
                                    {
                                        //desfoliamos el documento
                                        string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                                        document.NumAtCard = folioAnu;
                                        document.FolioPrefixString = "";
                                        document.FolioNumber = 0;
                                        document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                                        int desfoliar = document.Update();
                                        string descerror = oCompany.GetLastErrorDescription().ToString();
                                        if (desfoliar != 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                            return;
                                        }
                                        docCancel = document.CreateCancellationDocument();
                                        int cancelado = docCancel.Add();
                                        if (cancelado == 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                        }
                                        else
                                        {
                                            SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                        }
                                    }
                                }
                                else
                                {
                                    docCancel = document.CreateCancellationDocument();
                                    int cancelado = docCancel.Add();
                                    if (cancelado == 0)
                                    {
                                        SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                    }
                                    else
                                    {
                                        SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                    }
                                }
                            }
                            #endregion

                            //proceso para entrega
                            #region ODLN
                            //si es entrega
                            if (v_tabla.Equals("ODLN"))
                            {
                                //instanciamos el documento
                                SAPbobsCOM.Documents document;
                                SAPbobsCOM.Documents docCancel;
                                document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
                                docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
                                //validamos que el folio no este vacio
                                if (!string.IsNullOrEmpty(v_folio))
                                {
                                    if (document.GetByKey(int.Parse(v_docentry)))
                                    {
                                        //desfoliamos el documento
                                        string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                                        document.NumAtCard = folioAnu;
                                        document.FolioPrefixString = "";
                                        document.FolioNumber = 0;
                                        document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                                        int desfoliar = document.Update();
                                        string descerror = oCompany.GetLastErrorDescription().ToString();
                                        if (desfoliar != 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                            return;
                                        }
                                        docCancel = document.CreateCancellationDocument();
                                        int cancelado = docCancel.Add();
                                        if (cancelado == 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                        }
                                        else
                                        {
                                            SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                        }
                                    }
                                }
                                else
                                {
                                    docCancel = document.CreateCancellationDocument();
                                    int cancelado = docCancel.Add();
                                    if (cancelado == 0)
                                    {
                                        SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                    }
                                    else
                                    {
                                        SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                    }
                                }
                            }
                            #endregion

                            //proceso para traslado
                            #region OWTR
                            //si es traslado
                            if (v_tabla.Equals("OWTR"))
                            {
                                //instanciamos el documento
                                SAPbobsCOM.Documents document;
                                SAPbobsCOM.Documents docCancel;
                                document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);
                                docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);
                                //validamos que el folio no este vacio
                                if (!string.IsNullOrEmpty(v_folio))
                                {
                                    if (document.GetByKey(int.Parse(v_docentry)))
                                    {
                                        //desfoliamos el documento
                                        string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                                        document.NumAtCard = folioAnu;
                                        document.FolioPrefixString = "";
                                        document.FolioNumber = 0;
                                        document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                                        int desfoliar = document.Update();
                                        string descerror = oCompany.GetLastErrorDescription().ToString();
                                        if (desfoliar != 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                            return;
                                        }
                                        docCancel = document.CreateCancellationDocument();
                                        int cancelado = docCancel.Add();
                                        if (cancelado == 0)
                                        {
                                            SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                        }
                                        else
                                        {
                                            SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                        }
                                    }
                                }
                                else
                                {
                                    docCancel = document.CreateCancellationDocument();
                                    int cancelado = docCancel.Add();
                                    if (cancelado == 0)
                                    {
                                        SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                                    }
                                    else
                                    {
                                        SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                                    }
                                }
                            }
                            #endregion
                        }
                        catch (Exception e)
                        {

                        }

                        Doc.MoveNext();
                    }
                }
                else
                {
                    SBO_Application.StatusBar.SetText("Error al inutilizar numeración!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                }
            }
            catch (Exception e)
            {

            }

        }

        //funcion para cargar grilla de objetivos
        private static void cargarGrillaObj(string url, SAPbouiCOM.Form oForm)
        {
            //variables
            string v_legajo = null, v_codcliente = null, v_metrica = null, v_UM = null, v_kilos = null, v_valor = null, v_periodo = null, v_feInicial = null, v_feFinal = null, v_terri = null, v_canal = null, v_subcanal = null, v_Estado = null, v_tipo = null;
            //instaciamos los servicios de excel
            Microsoft.Office.Interop.Excel.Application xlApp = new Microsoft.Office.Interop.Excel.Application();
            Microsoft.Office.Interop.Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(url);
            Microsoft.Office.Interop.Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
            Microsoft.Office.Interop.Excel.Range xlRange = xlWorksheet.UsedRange;
            xlWorkbook.Activate();
            SAPbouiCOM.Matrix oMatrix;
            oMatrix = (SAPbouiCOM.Matrix)oForm.Items.Item("0_U_G").Specific;
            SAPbouiCOM.DBDataSource source = oForm.DataSources.DBDataSources.Item("@JOBJETIVOS");
            oMatrix.FlushToDataSource();
            source.Clear();
            SAPbouiCOM.EditText oPeriodo;
            oPeriodo = (SAPbouiCOM.EditText)oForm.Items.Item("20_U_E").Specific;

            int rowCount = xlRange.Rows.Count;
            int colCount = xlRange.Columns.Count;
            int filagrid = 0;
            //recorremos el excel
            for (int i = 2; i <= rowCount; i++)
            {
                try
                {
                    //cargamos las variables del excel
                    v_legajo = xlRange.Cells[i, 1].Value2.ToString();
                    v_codcliente = xlRange.Cells[i, 2].Value2.ToString();
                    v_metrica = xlRange.Cells[i, 3].Value2.ToString();
                    v_UM = xlRange.Cells[i, 4].Value2.ToString();
                    v_kilos = xlRange.Cells[i, 5].Value2.ToString();
                    v_valor = xlRange.Cells[i, 6].Value2.ToString();
                    double valor_v = double.Parse(v_valor);
                    v_periodo = xlRange.Cells[i, 7].Value2.ToString();
                    v_feInicial = xlRange.Cells[i, 8].Value2.ToString();
                    v_feFinal = xlRange.Cells[i, 9].Value2.ToString();
                    v_terri = xlRange.Cells[i, 10].Value2.ToString();
                    v_canal = xlRange.Cells[i, 11].Value2.ToString();
                    v_subcanal = xlRange.Cells[i, 12].Value2.ToString();
                    v_Estado = xlRange.Cells[i, 13].Value2.ToString();
                    v_tipo = xlRange.Cells[i, 14].Value2.ToString();
                    //mandamos las variables en la grilla
                    source.InsertRecord(source.Size);
                    source.Offset = source.Size - 1;
                    source.SetValue(5, filagrid, v_legajo);
                    source.SetValue(6, filagrid, v_codcliente);
                    source.SetValue(7, filagrid, v_metrica);
                    source.SetValue(8, filagrid, v_UM);
                    source.SetValue(9, filagrid, v_valor);
                    source.SetValue(10, filagrid, v_periodo);
                    source.SetValue(11, filagrid, v_feInicial);
                    source.SetValue(12, filagrid, v_feFinal);
                    source.SetValue(13, filagrid, v_canal);
                    source.SetValue(14, filagrid, v_Estado);
                    source.SetValue(15, filagrid, v_tipo);
                    //source.SetValue(16, filagrid, v_kilos);
                    //source.SetValue(17, filagrid, v_subcanal);
                    //source.SetValue(18, filagrid, v_terri);
                    oMatrix.LoadFromDataSource();
                    filagrid++;
                }
                catch (Exception e)
                {

                }


            }
            oPeriodo.Value = v_periodo;
        }

        //funcion par ainutilizar de forma masiva
        private static void inutilizarMasivo(string urlDirectorio)
        {
            //instaciamos los servicios de excel
            Microsoft.Office.Interop.Excel.Application xlApp = new Microsoft.Office.Interop.Excel.Application();
            Microsoft.Office.Interop.Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(urlDirectorio);
            Microsoft.Office.Interop.Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
            Microsoft.Office.Interop.Excel.Range xlRange = xlWorksheet.UsedRange;
            xlWorkbook.Activate();


            int rowCount = xlRange.Rows.Count;
            int colCount = xlRange.Columns.Count;
            //variables
            string ruc = null;
            string timbrado = null;
            string esta = null;
            string pemi = null;
            string documento = null;
            string desde = null;
            string hasta = null;
            string motivo = null;
            //instaciamos el servicio
            servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
            servicio.inutilizarNumeracionRequest inutilizar = new servicio.inutilizarNumeracionRequest();
            servicio.inutilizarNumeracionResponse inuresponse = new servicio.inutilizarNumeracionResponse();

            //SAPbobsCOM.Documents document;
            //document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
            string v_cardcode = null;
            string v_serie = null;
            string v_fecha = null;
            string v_esta = null;
            string v_pemi = null;
            //string v_folio = null;
            string v_timbrado = null;
            string v_cond = null;
            string v_arti = null;
            string v_cant = null;
            string v_iva = null;
            string v_total = null;
            string v_almacen = null;
            string v_vend = null;
            string v_numero = null;
            string v_aux = "1";
            int linea = 1;
            string v_cdc = null;
            string aux = "1";
            //recorremos el excel
            for (int i = 2; i <= rowCount; i++)
            {
                try
                {
                    string v_docu = xlRange.Cells[i, 1].Value2.ToString();
                    string v_pref = xlRange.Cells[i, 2].Value2.ToString();
                    ReenviarDocumento(v_docu, "OINV", "INV1", "1", "FACTURA", "Factura electrónica", v_pref);
                    //string v_fol = xlRange.Cells[i, 3].Value2.ToString();
                    ////string v_tim = xlRange.Cells[i, 4].Value2.ToString();
                    //string v_CDC = xlRange.Cells[i, 4].Value2.ToString();
                    //SAPbobsCOM.Recordset oDatosDocAct;
                    //oDatosDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //oDatosDocAct.DoQuery("update OINV set \"FolioPref\"='" + v_pref + "',\"FolioNum\"='" + v_fol + "',\"U_CDC\"='" + v_CDC + "' where \"DocNum\"='" + v_docu + "'");

                    //v_cardcode = xlRange.Cells[i, 2].Value2.ToString();
                    //v_serie = xlRange.Cells[i, 3].Value2.ToString();
                    //v_fecha = xlRange.Cells[i, 4].Value2.ToString() + "-01-" + "2023";
                    //v_esta = xlRange.Cells[i, 5].Value2.ToString();
                    //DateTime fecha_v = Convert.ToDateTime(v_fecha);
                    //string v_FECHA = fecha_v.ToString("dd-MM-yyyy");
                    //v_pemi = xlRange.Cells[i, 6].Value2.ToString();
                    //string v_FFolio = xlRange.Cells[i, 7].Value2.ToString();
                    //v_numero = xlRange.Cells[i, 1].Value2.ToString();
                    //v_cdc = xlRange.Cells[i, 5].Value2.ToString();
                    //v_timbrado = xlRange.Cells[i, 8].Value2.ToString();
                    //v_cond = xlRange.Cells[i, 10].Value2.ToString();
                    //v_arti = xlRange.Cells[i, 11].Value2.ToString();
                    //v_cant = xlRange.Cells[i, 12].Value2.ToString();
                    //v_iva = xlRange.Cells[i, 13].Value2.ToString();
                    //v_total = xlRange.Cells[i, 14].Value2.ToString();
                    //v_almacen = xlRange.Cells[i, 15].Value2.ToString();
                    //v_vend = xlRange.Cells[i, 16].Value2.ToString();

                    //SAPbobsCOM.Recordset oDatosDoc;
                    //oDatosDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //oDatosDoc.DoQuery("select \"DocStatus\" from OINV where \"DocNum\"='" + v_numero + "'");
                    //string c = oDatosDoc.Fields.Item(0).Value.ToString();
                    //if (c.Equals("O"))
                    //{
                    //    SAPbobsCOM.Recordset oDatosDocAct;
                    //    oDatosDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //    oDatosDocAct.DoQuery("update OINV set \"FolioPref\"='" + v_esta + "',\"FolioNum\"='" + v_folio + "' where \"DocNum\"='" + v_numero + "'");
                    //}

                    //document.CardCode = v_cardcode;
                    //document.Series = int.Parse(v_serie);
                    //document.DocDate = fecha_v;// DateTime.Parse(v_FECHA);
                    //document.UserFields.Fields.Item("U_ESTA").Value = v_esta;
                    //document.UserFields.Fields.Item("U_PEMI").Value = v_pemi;
                    //document.FolioPrefixString = v_esta;
                    //document.FolioNumber = int.Parse(v_folio);
                    //document.UserFields.Fields.Item("U_TIMB").Value = v_timbrado;
                    //document.PaymentGroupCode = int.Parse(v_cond);
                    //document.SalesPersonCode = int.Parse(v_vend);
                    //document.DocCurrency = "GS";
                    //document.DocType = BoDocumentTypes.dDocument_Items;
                    ////agregamos el detalle
                    //for (int f = 3; f <= rowCount; f++)
                    //{
                    //    v_arti = xlRange.Cells[f, 11].Value2.ToString();
                    //    v_cant = xlRange.Cells[f, 12].Value2.ToString();
                    //    v_iva = xlRange.Cells[f, 13].Value2.ToString();
                    //    v_total = xlRange.Cells[f, 14].Value2.ToString();
                    //    v_almacen = xlRange.Cells[f, 15].Value2.ToString();
                    //    string v_umdetalle = xlRange.Cells[f, 1].Value2.ToString();
                    //    if (v_numero == v_umdetalle)
                    //    {
                    //        document.Lines.ItemCode = v_arti;
                    //        document.Lines.WarehouseCode = v_almacen;
                    //        document.Lines.TaxCode = v_iva;
                    //        document.Lines.Quantity = int.Parse(v_cant);
                    //        document.Lines.Price = double.Parse(v_total) / double.Parse(v_cant);
                    //        document.Lines.LineTotal = double.Parse(v_total);
                    //        document.Lines.Add();
                    //    }

                    //}

                    //int error = document.Add();
                    //string oo = oCompany.GetLastErrorDescription().ToString();
                    //if (error != 0)
                    //{
                    //    MessageBox.Show("error :" + v_esta + "-" + v_pemi + "-" + v_folio);
                    //}


                }
                catch (Exception e)
                {

                }

                //try
                //{
                //    //extraemos los valores 
                //    ruc = xlRange.Cells[i, 1].Value2.ToString();
                //    timbrado = xlRange.Cells[i, 2].Value2.ToString();
                //    esta = xlRange.Cells[i, 3].Value2.ToString();
                //    pemi = xlRange.Cells[i, 4].Value2.ToString();
                //    documento = xlRange.Cells[i, 5].Value2.ToString();
                //    desde = xlRange.Cells[i, 6].Value2.ToString();
                //    hasta = xlRange.Cells[i, 7].Value2.ToString();
                //    motivo = xlRange.Cells[i, 8].Value2.ToString();
                //    //mandamos los parametros al servicio
                //    inutilizar.ruc = ruc;
                //    inutilizar.timbrado = timbrado;
                //    inutilizar.establecimiento = esta;
                //    inutilizar.puntoExpedicion = pemi;
                //    if (documento.Equals("8"))
                //    {
                //        inutilizar.tipoDocumento = "7";
                //    }
                //    else
                //    {
                //        inutilizar.tipoDocumento = documento;
                //    }
                //    inutilizar.rangoDesde = desde;
                //    inutilizar.rangoHasta = hasta;
                //    inutilizar.motivo = motivo;
                //    //ejecutamos el servicio
                //    inuresponse = cliente.inutilizarNumeracion(inutilizar);
                //    bool resp = inuresponse.ok;
                //    if (resp == true)
                //    {
                //        //evento para cancelar el documento
                //        string v_tabla = null;
                //        if (documento.Equals("1")) { v_tabla = "OINV"; }
                //        if (documento.Equals("5")) { v_tabla = "ORIN"; }
                //        if (documento.Equals("7")) { v_tabla = "ODLN"; }
                //        if (documento.Equals("8")) { v_tabla = "OWTR"; }
                //        //realizamos el query para la busqueda
                //        Recordset Doc;
                //        Doc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //        Doc.DoQuery("SELECT \"DocEntry\",\"DocNum\",\"FolioNum\" FROM " + v_tabla + " WHERE \"U_ESTA\"='" + esta + "' AND \"U_PEMI\"='" + pemi + "' AND \"FolioNum\"='" + desde + "' AND \"U_TIMB\"='" + timbrado + "' ");
                //        //comprobamos 
                //        while (!Doc.EoF)
                //        {
                //            string v_folio = Doc.Fields.Item(2).Value.ToString();
                //            string v_docentry = Doc.Fields.Item(0).Value.ToString();

                //            try
                //            {
                //                //proceso para factura
                //                #region OINV
                //                //si es factura
                //                if (v_tabla.Equals("OINV"))
                //                {
                //                    //instanciamos el documento
                //                    SAPbobsCOM.Documents document;
                //                    SAPbobsCOM.Documents docCancel;
                //                    document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                //                    docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oInvoices);
                //                    //validamos que el folio no este vacio
                //                    if (!string.IsNullOrEmpty(v_folio))
                //                    {
                //                        if (document.GetByKey(int.Parse(v_docentry)))
                //                        {
                //                            //desfoliamos el documento
                //                            string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                //                            document.NumAtCard = folioAnu;
                //                            document.FolioPrefixString = "";
                //                            document.FolioNumber = 0;
                //                            document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                //                            int desfoliar = document.Update();
                //                            string descerror = oCompany.GetLastErrorDescription().ToString();
                //                            if (desfoliar != 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                                //return;
                //                            }
                //                            docCancel = document.CreateCancellationDocument();
                //                            int cancelado = docCancel.Add();
                //                            if (cancelado == 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                            }
                //                            else
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                            }
                //                        }
                //                    }
                //                    else
                //                    {
                //                        docCancel = document.CreateCancellationDocument();
                //                        int cancelado = docCancel.Add();
                //                        if (cancelado == 0)
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                        }
                //                        else
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                        }
                //                    }
                //                }
                //                #endregion

                //                //proceso para nota de credito
                //                #region ORIN
                //                //si es nota de credito
                //                if (v_tabla.Equals("ORIN"))
                //                {
                //                    //instanciamos el documento
                //                    SAPbobsCOM.Documents document;
                //                    SAPbobsCOM.Documents docCancel;
                //                    document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
                //                    docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oCreditNotes);
                //                    //validamos que el folio no este vacio
                //                    if (!string.IsNullOrEmpty(v_folio))
                //                    {
                //                        if (document.GetByKey(int.Parse(v_docentry)))
                //                        {
                //                            //desfoliamos el documento
                //                            string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                //                            document.NumAtCard = folioAnu;
                //                            document.FolioPrefixString = "";
                //                            document.FolioNumber = 0;
                //                            document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                //                            int desfoliar = document.Update();
                //                            string descerror = oCompany.GetLastErrorDescription().ToString();
                //                            if (desfoliar != 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                                //return;
                //                            }
                //                            docCancel = document.CreateCancellationDocument();
                //                            int cancelado = docCancel.Add();
                //                            if (cancelado == 0)
                //                            {
                //                                // SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                            }
                //                            else
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                            }
                //                        }
                //                    }
                //                    else
                //                    {
                //                        docCancel = document.CreateCancellationDocument();
                //                        int cancelado = docCancel.Add();
                //                        if (cancelado == 0)
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                        }
                //                        else
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                        }
                //                    }
                //                }
                //                #endregion

                //                //proceso para entrega
                //                #region ODLN
                //                //si es entrega
                //                if (v_tabla.Equals("ODLN"))
                //                {
                //                    //instanciamos el documento
                //                    SAPbobsCOM.Documents document;
                //                    SAPbobsCOM.Documents docCancel;
                //                    document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
                //                    docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oDeliveryNotes);
                //                    //validamos que el folio no este vacio
                //                    if (!string.IsNullOrEmpty(v_folio))
                //                    {
                //                        if (document.GetByKey(int.Parse(v_docentry)))
                //                        {
                //                            //desfoliamos el documento
                //                            string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                //                            document.NumAtCard = folioAnu;
                //                            document.FolioPrefixString = "";
                //                            document.FolioNumber = 0;
                //                            document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                //                            int desfoliar = document.Update();
                //                            string descerror = oCompany.GetLastErrorDescription().ToString();
                //                            if (desfoliar != 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                                //return;
                //                            }
                //                            docCancel = document.CreateCancellationDocument();
                //                            int cancelado = docCancel.Add();
                //                            if (cancelado == 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                            }
                //                            else
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                            }
                //                        }
                //                    }
                //                    else
                //                    {
                //                        docCancel = document.CreateCancellationDocument();
                //                        int cancelado = docCancel.Add();
                //                        if (cancelado == 0)
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                        }
                //                        else
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                        }
                //                    }
                //                }
                //                #endregion

                //                //proceso para traslado
                //                #region OWTR
                //                //si es traslado
                //                if (v_tabla.Equals("OWTR"))
                //                {
                //                    //instanciamos el documento
                //                    SAPbobsCOM.Documents document;
                //                    SAPbobsCOM.Documents docCancel;
                //                    document = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);
                //                    docCancel = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oStockTransfer);
                //                    //validamos que el folio no este vacio
                //                    if (!string.IsNullOrEmpty(v_folio))
                //                    {
                //                        if (document.GetByKey(int.Parse(v_docentry)))
                //                        {
                //                            //desfoliamos el documento
                //                            string folioAnu = esta + "-" + pemi + "-" + document.FolioNumber.ToString("D7");
                //                            document.NumAtCard = folioAnu;
                //                            document.FolioPrefixString = "";
                //                            document.FolioNumber = 0;
                //                            document.UserFields.Fields.Item("U_ESTADO").Value = "CANCELADO";
                //                            int desfoliar = document.Update();
                //                            string descerror = oCompany.GetLastErrorDescription().ToString();
                //                            if (desfoliar != 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al desfoliar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                                // return;
                //                            }
                //                            docCancel = document.CreateCancellationDocument();
                //                            int cancelado = docCancel.Add();
                //                            if (cancelado == 0)
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                            }
                //                            else
                //                            {
                //                                //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                            }
                //                        }
                //                    }
                //                    else
                //                    {
                //                        docCancel = document.CreateCancellationDocument();
                //                        int cancelado = docCancel.Add();
                //                        if (cancelado == 0)
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                //                        }
                //                        else
                //                        {
                //                            //SBO_Application.StatusBar.SetText("Error al cancelar: " + oCompany.GetLastErrorDescription().ToString(), BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //                        }
                //                    }
                //                }
                //                #endregion
                //            }
                //            catch (Exception e)
                //            {

                //            }

                //            Doc.MoveNext();
                //        }


                //        xlRange.Cells[i, 9].Value2 = "Inutilizado";
                //        xlRange = xlWorksheet.get_Range("I9", "I9");
                //        xlRange = xlWorksheet.Range["I9:I9"];
                //        xlRange.Value = "Inutilizado";
                //        xlWorkbook.SaveAs(urlDirectorio);
                //        xlWorkbook.Close();

                //    }
                //    else
                //    {
                //        MessageBox.Show(esta + "-" + pemi + "-" + desde);

                //        xlRange.Cells[i, 9].Value2 = "Error";
                //    }
                //}
                //catch (Exception e)
                //{

                //}

            }

            SBO_Application.StatusBar.SetText("Numeracion inutilizado correctamente!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);

        }

        //funcion para descargar plantilla excel para inutilizacion
        private static void descargarPlantilla()
        {
            Microsoft.Office.Interop.Excel.Application aplicacion;
            Microsoft.Office.Interop.Excel.Workbook libro;
            Microsoft.Office.Interop.Excel.Worksheet hoja;
            Microsoft.Office.Interop.Excel.Range rango;
            object misvalue = System.Reflection.Missing.Value;
            //configuramos los elementos para el excel
            aplicacion = new Microsoft.Office.Interop.Excel.Application();
            aplicacion.Visible = true;
            libro = (Microsoft.Office.Interop.Excel.Workbook)(aplicacion.Workbooks.Add(""));
            hoja = (Microsoft.Office.Interop.Excel.Worksheet)libro.ActiveSheet;
            //agregar los títulos al excel
            hoja.Cells[1, 1] = "RUC";
            hoja.Cells[1, 2] = "TIMBRADO";
            hoja.Cells[1, 3] = "ESTABLECIMIENTO";
            hoja.Cells[1, 4] = "PUNTO DE EXPEDICION";
            hoja.Cells[1, 5] = "DOCUMENTO";
            hoja.Cells[1, 6] = "DESDE";
            hoja.Cells[1, 7] = "HASTA";
            hoja.Cells[1, 8] = "MOTIVO";
            hoja.Cells[1, 9] = "ESTADO";
            hoja.Range["A1", "I1"].Font.Bold = true;
            hoja.Range["A1", "H1"].Interior.Color = Color.YellowGreen;
            hoja.Range["I1", "I1"].Interior.Color = Color.LightGray;
            aplicacion.Visible = false;
            aplicacion.UserControl = false;
            //creamos una carpeta en el escritorio
            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
            string CarpEscr = path + "\\InutilizacionPlantilla";
            if (!Directory.Exists(CarpEscr))
            {
                Directory.CreateDirectory(CarpEscr);
            }
            //guardamos el archivo
            //string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
            string fecha = DateTime.Now.Hour.ToString("D2") + "" + DateTime.Now.Minute.ToString("D2") + "" + DateTime.Now.Second.ToString("D2");
            string archivo = "\\inutilizacion_" + fecha + ".xls";
            libro.SaveAs(CarpEscr + archivo);
            libro.Close();
            aplicacion.Quit();
            SBO_Application.StatusBar.SetText("Plantilla descargada con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
        }

        //reenviar documento
        private static void ReenviarDocumento(string codigo, string tablacab, string tabladet, string documento, string template, string descdoc, string v_folio)
        {
            try
            {
                //BasicHttpBinding httpBinding = new BasicHttpBinding();
                //httpBinding.MaxReceivedMessageSize = Int32.MaxValue;
                //httpBinding.MaxBufferSize = Int32.MaxValue;

                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //consultamos cual direccion se eligio              

                #region QUERY DOCUMENTO
                //if (!string.IsNullOrEmpty(direShip))
                //{
                //    //GRANUSA
                //    oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                //                   "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                //                   "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                //                   "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                //                   "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                //                   "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)   " +
                //                   "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                //                   "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                //                   "T0.\"U_TRANSPORTISTA\",T12.\"U_Nombre\"||','||T12.\"U_Apellido\",CASE WHEN T11.\"U_CHAPA_CARRE\" IS NULL THEN  T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END ,T11.\"U_MARCA\",T12.\"U_Documento\",T12.\"U_Direccion\",T13.\"U_SET_FE\", " +
                //                   "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                //                   "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                //                   "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\"  " +
                //                   "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                //                   "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                //                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                //                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                //                   "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                //                   "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                //                   "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                //                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                //                   "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                //                   "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                //                   "LEFT JOIN \"@CHOFERES\" T12 ON T12.\"Code\"=T0.\"U_CHOFERES\" " +
                //                   //"LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                //                   "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                //                   "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                //                   "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                //                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                //                   "WHERE T0.\"DocNum\"='" + codigo + "'");

                //}
                //else
                //{
                    //GRANUSA
                    oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                   "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",\"PriceAfVAT\"," +
                                   "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                   "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                   "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                   "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                   "T0.\"U_TRANSPORTISTA\",T12.\"U_Nombre\"||','||T12.\"U_Apellido\",CASE WHEN T11.\"U_CHAPA_CARRE\" IS NULL THEN  T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T12.\"U_Documento\",T12.\"U_Direccion\",T13.\"U_SET_FE\", " +
                                   "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                   "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                   "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T1.\"DiscPrcnt\",T1.\"Price\",T1.\"PriceBefDi\",T1.\"PriceBefDi\"-T1.\"Price\"  " +
                                   "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                   "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                   "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                   "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                   "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                   "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                   "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                   "LEFT JOIN \"@CHOFERES\" T12 ON T12.\"Code\"=T0.\"U_CHOFERES\" " +
                                   //"LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                   "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                   "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                   "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                   "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                   "WHERE T0.\"DocNum\"='" + codigo + "'");

                //}
                #endregion

                string Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(46).Value.ToString();
                string rec_dist = oDatos.Fields.Item(47).Value.ToString();
                string rec_loc = oDatos.Fields.Item(48).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(49).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string RespFlete = oDatos.Fields.Item(50).Value.ToString();
                string CodLicitacion = oDatos.Fields.Item(51).Value.ToString();
                string transId = oDatos.Fields.Item(52).Value.ToString();
                string infoadicional = oDatos.Fields.Item(53).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                //actualizamos el folio de la factura
                Recordset oActUDF;
                oActUDF = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oActUDF.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"U_TIMB\"='" + timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                // //actualizamos la numeracion de la serie           
                // Recordset oActSerie;
                // oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());         
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                    //instaciamos los objetos que vutilizaremos
                }

                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                //linea 36
                servicio.gCamItem gCamItem36 = new servicio.gCamItem();
                servicio.gValorItem gValorItem36 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem36 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA36 = new servicio.gCamIVA();
                //linea 37
                servicio.gCamItem gCamItem37 = new servicio.gCamItem();
                servicio.gValorItem gValorItem37 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem37 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA37 = new servicio.gCamIVA();
                //linea 38
                servicio.gCamItem gCamItem38 = new servicio.gCamItem();
                servicio.gValorItem gValorItem38 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem38 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA38 = new servicio.gCamIVA();
                //linea 39
                servicio.gCamItem gCamItem39 = new servicio.gCamItem();
                servicio.gValorItem gValorItem39 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem39 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA39 = new servicio.gCamIVA();
                //linea 40
                servicio.gCamItem gCamItem40 = new servicio.gCamItem();
                servicio.gValorItem gValorItem40 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem40 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA40 = new servicio.gCamIVA();
                //linea 41
                servicio.gCamItem gCamItem41 = new servicio.gCamItem();
                servicio.gValorItem gValorItem41 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem41 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA41 = new servicio.gCamIVA();
                //linea 42
                servicio.gCamItem gCamItem42 = new servicio.gCamItem();
                servicio.gValorItem gValorItem42 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem42 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA42 = new servicio.gCamIVA();
                //linea 43
                servicio.gCamItem gCamItem43 = new servicio.gCamItem();
                servicio.gValorItem gValorItem43 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem43 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA43 = new servicio.gCamIVA();
                //linea 44
                servicio.gCamItem gCamItem44 = new servicio.gCamItem();
                servicio.gValorItem gValorItem44 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem44 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA44 = new servicio.gCamIVA();
                //linea 45
                servicio.gCamItem gCamItem45 = new servicio.gCamItem();
                servicio.gValorItem gValorItem45 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem45 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA45 = new servicio.gCamIVA();
                #endregion
                #endregion

                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                string oper = oDatos.Fields.Item(25).Value.ToString();
                if (!string.IsNullOrEmpty(infoadicional))
                {
                    gOpeDE.dInfoEmi = infoadicional;
                }
                //gTimb
                gTimb.iTiDE = documento;
                gTimb.dDesTiDE = descdoc;
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                if (v_folio.Equals("") || v_folio.Equals("0"))
                {
                    gTimb.dNumDoc = folio.ToString("D7");
                }
                else
                {
                    gTimb.dNumDoc = v_folio;
                }

                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }

                if (tablacab.Equals("OINV"))
                {
                    gOpeCom.iTipTra = TipTra;// oDatos.Fields.Item(23).Value.ToString();
                    gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                }
                    
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";
                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                    gOpeCom.dTiCamSpecified = true;
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                if (oDatos.Fields.Item(26).Value.ToString() == "2")
                {
                    gDatRec.iTiOpe = "2";
                    //gDatRec.iTiContRec = "1";
                }
                else
                {
                    gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                }
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //validad si el pais esta vacio, enviar PRY por defecto
                string pais = oDatos.Fields.Item(16).Value.ToString();
                if (string.IsNullOrEmpty(pais))
                {
                    gDatRec.cPaisRec = "PRY";
                }
                else
                {
                    gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                }

                //gDatRec.dDesPaisRe = "Paraguay";

                if (tablacab.Equals("ORIN"))
                {
                    gCamNCDE.iMotEmi = "1";//hay que modificar
                }
                //si es contribuyente le pasamos el ruc sino la cedula
                if (oDatos.Fields.Item(26).Value.ToString() == "1" || oDatos.Fields.Item(26).Value.ToString() == "3")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }
                else
                {
                    gDatRec.dNumIDRec = oDatos.Fields.Item(4).Value.ToString();
                    gDatRec.iTipIDRec = "1";
                }

                if (tablacab.Equals("OINV"))
                {
                    //REMITO
                    #region REMITO
                    if (!string.IsNullOrEmpty(trans))
                    {
                        string chof = oDatos.Fields.Item(32).Value.ToString();
                        if (!chof.Equals("PERSONAL"))
                        {
                            string CedChofer = oDatos.Fields.Item(35).Value.ToString();
                            if (!string.IsNullOrEmpty(CedChofer))
                            {
                                string dirReceptor = oDatos.Fields.Item(5).Value.ToString();
                                string NewDirRec = null;
                                if (!Regex.IsMatch(dirReceptor, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    NewDirRec = Regex.Replace(dirReceptor, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    NewDirRec = dirReceptor;

                                }
                                string salDire = oDatos.Fields.Item(37).Value.ToString();
                                string newsalDire = null;
                                if (!Regex.IsMatch(salDire, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newsalDire = Regex.Replace(salDire, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newsalDire = salDire;

                                }
                                string DomFiscal = oDatos.Fields.Item(42).Value.ToString();
                                string newDomFiscal = null;
                                if (!Regex.IsMatch(DomFiscal, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newDomFiscal = Regex.Replace(DomFiscal, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newDomFiscal = DomFiscal;

                                }
                                string DireChofer = oDatos.Fields.Item(36).Value.ToString();
                                string newDireChofer = null;
                                if (!Regex.IsMatch(DireChofer, @"^[a-zA-Z-0-9]+$") == true)
                                {
                                    newDireChofer = Regex.Replace(DireChofer, @"[^0-9a-zA-Z ]+", "");

                                }
                                else
                                {
                                    newDireChofer = DireChofer;

                                }
                                string codTransp = null;
                                string descTrans = null;
                                if (oDatos.Fields.Item(38).Value.ToString() == varE)
                                {
                                    codTransp = "1";
                                    descTrans = "Propio";
                                }
                                else
                                {
                                    codTransp = "2";
                                    descTrans = "Tercero";
                                }
                                gDatRec.dDirRec = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                                gDatRec.dNumCasRec = "0";
                                gDatRec.cDepRec = rec_dep;
                                gDatRec.cDisRec = rec_dist;
                                gDatRec.cCiuRec = rec_loc;
                                //gCamSal               
                                gCamSal.dDirLocSal = newsalDire;// oDatos.Fields.Item(37).Value.ToString();
                                gCamSal.dNumCasSal = "0";
                                //gCamSal.dComp1Sal =  "aviadores del chaco";
                                gCamSal.cDepSal = sal_dep;
                                gCamSal.cCiuSal = sal_loc;
                                gCamSal.cDisSal = sal_dist;
                                //gCamEnt
                                gCamEnt.dDirLocEnt = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                                gCamEnt.dNumCasEnt = "0";
                                gCamEnt.cDepEnt = rec_dep;
                                gCamEnt.cCiuEnt = rec_loc;
                                gCamEnt.cDisEnt = rec_dist;
                                gCamEnt1[0] = gCamEnt;
                                gTransp.iTipTrans = codTransp;// "2";
                                gTransp.dDesTipTrans = descTrans;// "Tercero";
                                gTransp.iModTrans = "1";
                                gTransp.iRespFlete = RespFlete;
                                gTransp.dIniTras = fe;
                                gTransp.dIniTrasSpecified = true;
                                gTransp.dFinTras = fe;
                                gTransp.dFinTrasSpecified = true;
                                //gVehTras
                                //gTransp.gVehTras = gVehTras1;
                                gVehTras1[0] = gVehTras;
                                gVehTras.dTiVehTras = "Terrestre";
                                gVehTras.dMarVeh = oDatos.Fields.Item(34).Value.ToString();
                                gVehTras.dTipIdenVeh = "2";
                                gVehTras.dNroMatVeh = oDatos.Fields.Item(33).Value.ToString();
                                //gCamTrans
                                gCamTrans.iNatTrans = oDatos.Fields.Item(40).Value.ToString();
                                gCamTrans.dNomTrans = oDatos.Fields.Item(39).Value.ToString();
                                //deconstruimos el RUC del transportista
                                string varCam = oDatos.Fields.Item(38).Value.ToString();
                                int indexCam = varCam.IndexOf("-");
                                int canCam = oDatos.Fields.Item(38).Value.ToString().Length;
                                string rucCam = oDatos.Fields.Item(38).Value.ToString().Remove(indexCam, canCam - indexCam);
                                string dvCam = oDatos.Fields.Item(38).Value.ToString().Remove(0, indexCam + 1);
                                gCamTrans.dRucTrans = rucCam;
                                gCamTrans.dDVTrans = dvCam;
                                gCamTrans.cNacTrans = oDatos.Fields.Item(43).Value.ToString();
                                gCamTrans.dDesNacTrans = oDatos.Fields.Item(44).Value.ToString();
                                gCamTrans.dDomFisc = newDomFiscal;// oDatos.Fields.Item(42).Value.ToString();
                                gCamTrans.dNumIDChof = oDatos.Fields.Item(35).Value.ToString();
                                gCamTrans.dNomChof = oDatos.Fields.Item(32).Value.ToString();
                                gCamTrans.dDirChof = newDireChofer;// oDatos.Fields.Item(36).Value.ToString();
                                                                   //gCamNRE
                                                                   //gCamNRE.iMotEmiNR = "1";
                                                                   //gCamNRE.dDesMotEmiNR = "Traslado por ventas";
                                                                   //gCamNRE.iRespEmiNR = "1";
                                                                   //gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                                gCamNRE.dKmR = "3";
                                //gDtipDE.gCamNRE = gCamNRE;
                                gTransp.gCamTrans = gCamTrans;
                                gTransp.gCamSal = gCamSal;
                                gTransp.gCamEnt = gCamEnt1;
                                gTransp.gVehTras = gVehTras1;
                                gDtipDE.gTransp = gTransp;
                            }

                        }


                    }
                    #endregion
                }

                //LICITACION
                #region LICITACION
                if (oDatos.Fields.Item(25).Value.ToString() == "3")
                {
                    Recordset oLicitacion;
                    oLicitacion = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oLicitacion.DoQuery("SELECT \"U_dModCont\",\"U_dEntCont\",\"U_dAnoCont\",\"U_dSecCont\",\"U_dFeCodCont\" FROM \"@LICITACION\" WHERE \"U_LICI\"='" + CodLicitacion + "'");

                    gCompPub.dModCont = oLicitacion.Fields.Item(0).Value.ToString();//"LP";
                    gCompPub.dEntCont = oLicitacion.Fields.Item(1).Value.ToString(); //"12009";
                    gCompPub.dAnoCont = oLicitacion.Fields.Item(2).Value.ToString(); //"22";
                    int sec = int.Parse(oLicitacion.Fields.Item(3).Value.ToString());
                    gCompPub.dSecCont = sec.ToString("D7");// oLicitacion.Fields.Item(3).Value.ToString(); //"218529";
                    DateTime v_fechaLic = DateTime.Parse(oLicitacion.Fields.Item(4).Value.ToString());
                    string fechalic_v = v_fechaLic.ToString("yyyy-MM-dd");
                    gCompPub.dFeCodCont = DateTime.Parse(fechalic_v);//DateTime.Parse("2022-08-31");
                    gCompPub.dFeCodContSpecified = true;
                    gCamFE.gCompPub = gCompPub;
                    //gDtipDE.gCamFE = gCamFE;
                }
                #endregion



                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                                                                         //gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                                                                         //gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //gDatRec.dCelRec = "0981888493";
                                                                         //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                if (tablacab.Equals("OINV"))
                {
                    //gCamFE
                    gCamFE.iIndPres = oDatos.Fields.Item(22).Value.ToString();
                    //gCamCond
                    gCamCond.iCondOpe = oDatos.Fields.Item(9).Value.ToString(); //"2";               

                    if (oDatos.Fields.Item(9).Value.ToString() == "2")
                    {
                        //consultamos si el campo de cuota es mayor a cero
                        int Cuota = int.Parse(oDatos.Fields.Item(20).Value.ToString());
                        string concred = null;
                        if (Cuota > 0)
                        {
                            concred = "2";
                        }
                        else
                        {
                            concred = "1";
                        }
                        if (concred.Equals("2"))
                        {
                            gPagCred.dCuotas = Cuota.ToString();
                            gPagCred.iCondCred = concred;
                        }
                        else
                        {
                            //gPagCred
                            int plazo = int.Parse(oDatos.Fields.Item(10).Value.ToString());
                            gPagCred.dPlazoCre = plazo.ToString("D2");//oDatos.Fields.Item(10).Value.ToString(); //"12";
                            gPagCred.iCondCred = concred;
                        }
                    }
                }
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                    {
                        gPaConEIni.dTiCamTiPag = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                        gPaConEIni.dTiCamTiPagSpecified = true;
                    }
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                //gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto

                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //convertir el decimall a int
                int v_deciGR = int.Parse(v_DecimalGR);
                string v_monedaDoc = oDatos.Fields.Item(8).Value.ToString();

                while (!oDatos.EoF)
                {
                    //calculo para la gravada e iva
                    decimal c_totalOpe = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                    decimal c_gravada10 = Math.Round(decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()))) / decimal.Parse("1,1"));
                    decimal c_iva10 = Math.Round(decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"))));
                    decimal c_gravada5 = Math.Round(decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()))) / decimal.Parse("1,05"));
                    decimal c_iva5 = Math.Round(decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"))));

                    #region DETALLE DOCUMENTO
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem.dDncpG = dncpNum.ToString();
                        }

                        //gValorItem

                        string pp = oDatos.Fields.Item(14).Value.ToString();
                        gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem.dDescItem = 0;
                            gValorRestaItem.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem.dDescItem = 0;
                            gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        //gValorItem
                        //gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        //gValorRestaItem.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;
                        //gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA.iAfecIVA = "1";
                            gCamIVA.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = c_gravada10;// Math.Round(decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()))) / decimal.Parse("1,1"));
                                    gCamIVA.dLiqIVAItem = c_iva10;//Math.Round(decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"))));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA.dBasGravIVA = c_gravada5;// Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA.iAfecIVA = "3";
                            gCamIVA.dBasGravIVA = 0;
                            gCamIVA.dLiqIVAItem = 0;
                        }
                        gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem.gValorRestaItem = gValorRestaItem;
                        gCamItem.gValorItem = gValorItem;
                        gCamItem.gCamIVA = gCamIVA;
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem2.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem2.dDncpG = dncpNum.ToString();
                        }

                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem2.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem2.dDescItem = 0;
                            gValorRestaItem2.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem2.dDescItem = 0;
                            gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem2.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA2.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA2.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA2.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA2.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA2.iAfecIVA = "3";
                            gCamIVA2.dBasGravIVA = 0;
                            gCamIVA2.dLiqIVAItem = 0;
                        }
                        gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem2.gValorRestaItem = gValorRestaItem2;
                        gCamItem2.gValorItem = gValorItem2;
                        gCamItem2.gCamIVA = gCamIVA2;
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {
                        gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem3.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem3.dDncpG = dncpNum.ToString();
                        }

                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem3.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem3.dDescItem = 0;
                            gValorRestaItem3.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem3.dDescItem = 0;
                            gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem3.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA3.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA3.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA3.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA3.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA3.iAfecIVA = "3";
                            gCamIVA3.dBasGravIVA = 0;
                            gCamIVA3.dLiqIVAItem = 0;
                        }
                        gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem3.gValorRestaItem = gValorRestaItem3;
                        gCamItem3.gValorItem = gValorItem3;
                        gCamItem3.gCamIVA = gCamIVA3;
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem4.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem4.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem4.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem4.dDescItem = 0;
                            gValorRestaItem4.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem4.dDescItem = 0;
                            gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem4.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA4.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA4.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA4.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA4.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA4.iAfecIVA = "3";
                            gCamIVA4.dBasGravIVA = 0;
                            gCamIVA4.dLiqIVAItem = 0;
                        }
                        gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem4.gValorRestaItem = gValorRestaItem4;
                        gCamItem4.gValorItem = gValorItem4;
                        gCamItem4.gCamIVA = gCamIVA4;
                        gCamItem1[f] = gCamItem4;
                    }
                    if (f == 4)
                    {
                        gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem5.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem5.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem5.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem5.dDescItem = 0;
                            gValorRestaItem5.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem5.dDescItem = 0;
                            gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem5.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA5.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA5.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA5.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA5.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA5.iAfecIVA = "3";
                            gCamIVA5.dBasGravIVA = 0;
                            gCamIVA5.dLiqIVAItem = 0;
                        }
                        gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem5.gValorRestaItem = gValorRestaItem5;
                        gCamItem5.gValorItem = gValorItem5;
                        gCamItem5.gCamIVA = gCamIVA5;
                        gCamItem1[f] = gCamItem5;
                    }
                    if (f == 5)
                    {
                        gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem6.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem6.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem6.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem6.dDescItem = 0;
                            gValorRestaItem6.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem6.dDescItem = 0;
                            gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem6.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA6.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA6.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA6.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA6.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA6.iAfecIVA = "3";
                            gCamIVA6.dBasGravIVA = 0;
                            gCamIVA6.dLiqIVAItem = 0;
                        }
                        gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem6.gValorRestaItem = gValorRestaItem6;
                        gCamItem6.gValorItem = gValorItem6;
                        gCamItem6.gCamIVA = gCamIVA6;
                        gCamItem1[f] = gCamItem6;
                    }
                    if (f == 6)
                    {
                        gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem7.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem7.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem7.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem7.dDescItem = 0;
                            gValorRestaItem7.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem7.dDescItem = 0;
                            gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem7.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA7.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA7.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA7.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA7.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA7.iAfecIVA = "3";
                            gCamIVA7.dBasGravIVA = 0;
                            gCamIVA7.dLiqIVAItem = 0;
                        }
                        gCamIVA7.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem7.gValorRestaItem = gValorRestaItem7;
                        gCamItem7.gValorItem = gValorItem7;
                        gCamItem7.gCamIVA = gCamIVA7;
                        gCamItem1[f] = gCamItem7;
                    }
                    if (f == 7)
                    {
                        gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem8.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem8.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem8.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem8.dDescItem = 0;
                            gValorRestaItem8.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem8.dDescItem = 0;
                            gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem8.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA8.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA8.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA8.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA8.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA8.iAfecIVA = "3";
                            gCamIVA8.dBasGravIVA = 0;
                            gCamIVA8.dLiqIVAItem = 0;
                        }
                        gCamIVA8.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem8.gValorRestaItem = gValorRestaItem8;
                        gCamItem8.gValorItem = gValorItem8;
                        gCamItem8.gCamIVA = gCamIVA8;
                        gCamItem1[f] = gCamItem8;
                    }
                    if (f == 8)
                    {
                        gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem9.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem9.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem9.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem9.dDescItem = 0;
                            gValorRestaItem9.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem9.dDescItem = 0;
                            gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem9.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA9.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA9.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA9.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA9.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA9.iAfecIVA = "3";
                            gCamIVA9.dBasGravIVA = 0;
                            gCamIVA9.dLiqIVAItem = 0;
                        }
                        gCamIVA9.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem9.gValorRestaItem = gValorRestaItem9;
                        gCamItem9.gValorItem = gValorItem9;
                        gCamItem9.gCamIVA = gCamIVA9;
                        gCamItem1[f] = gCamItem9;
                    }
                    if (f == 9)
                    {
                        gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem10.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem10.dDncpG = dncpNum.ToString();
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem10.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem10.dDescItem = 0;
                            gValorRestaItem10.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem10.dDescItem = 0;
                            gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem10.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA10.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA10.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA10.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA10.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA10.iAfecIVA = "3";
                            gCamIVA10.dBasGravIVA = 0;
                            gCamIVA10.dLiqIVAItem = 0;
                        }
                        gCamIVA10.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem10.gValorRestaItem = gValorRestaItem10;
                        gCamItem10.gValorItem = gValorItem10;
                        gCamItem10.gCamIVA = gCamIVA10;
                        gCamItem1[f] = gCamItem10;
                    }
                    if (f == 10)
                    {
                        gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem11.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem11.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem11.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem11.dDescItem = 0;
                            gValorRestaItem11.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem11.dDescItem = 0;
                            gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        //gValorItem
                        //gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        //gValorRestaItem11.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;
                        //gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA11.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA11.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA11.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA11.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA11.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA11.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA11.iAfecIVA = "3";
                            gCamIVA11.dBasGravIVA = 0;
                            gCamIVA11.dLiqIVAItem = 0;
                        }
                        gCamIVA11.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem11.gValorRestaItem = gValorRestaItem11;
                        gCamItem11.gValorItem = gValorItem11;
                        gCamItem11.gCamIVA = gCamIVA11;
                        gCamItem1[f] = gCamItem11;
                    }
                    if (f == 11)
                    {
                        gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem12.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem12.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem12.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem12.dDescItem = 0;
                            gValorRestaItem12.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem12.dDescItem = 0;
                            gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem12.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA12.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA12.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA12.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA12.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA12.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA12.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA12.iAfecIVA = "3";
                            gCamIVA12.dBasGravIVA = 0;
                            gCamIVA12.dLiqIVAItem = 0;
                        }
                        gCamIVA12.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem12.gValorRestaItem = gValorRestaItem12;
                        gCamItem12.gValorItem = gValorItem12;
                        gCamItem12.gCamIVA = gCamIVA12;
                        gCamItem1[f] = gCamItem12;
                    }
                    if (f == 12)
                    {
                        gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem13.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem13.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem13.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem13.dDescItem = 0;
                            gValorRestaItem13.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem13.dDescItem = 0;
                            gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem13.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA13.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA13.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA13.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA13.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA13.dLiqIVAItem = c_iva5; Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA13.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA13.iAfecIVA = "3";
                            gCamIVA13.dBasGravIVA = 0;
                            gCamIVA13.dLiqIVAItem = 0;
                        }
                        gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem13.gValorRestaItem = gValorRestaItem13;
                        gCamItem13.gValorItem = gValorItem13;
                        gCamItem13.gCamIVA = gCamIVA13;
                        gCamItem1[f] = gCamItem13;
                    }
                    if (f == 13)
                    {
                        gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem14.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem14.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem14.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem14.dDescItem = 0;
                            gValorRestaItem14.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem14.dDescItem = 0;
                            gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem14.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA14.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA14.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA14.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA14.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA14.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA14.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA14.iAfecIVA = "3";
                            gCamIVA14.dBasGravIVA = 0;
                            gCamIVA14.dLiqIVAItem = 0;
                        }
                        gCamIVA14.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem14.gValorRestaItem = gValorRestaItem14;
                        gCamItem14.gValorItem = gValorItem14;
                        gCamItem14.gCamIVA = gCamIVA14;
                        gCamItem1[f] = gCamItem14;
                    }
                    if (f == 14)
                    {
                        gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem15.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem15.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem15.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem15.dDescItem = 0;
                            gValorRestaItem15.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem15.dDescItem = 0;
                            gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem15.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA15.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA15.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA15.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA15.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA15.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA15.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA15.iAfecIVA = "3";
                            gCamIVA15.dBasGravIVA = 0;
                            gCamIVA15.dLiqIVAItem = 0;
                        }
                        gCamIVA15.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem15.gValorRestaItem = gValorRestaItem15;
                        gCamItem15.gValorItem = gValorItem15;
                        gCamItem15.gCamIVA = gCamIVA15;
                        gCamItem1[f] = gCamItem15;
                    }
                    if (f == 15)
                    {
                        gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem16.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem16.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem16.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem16.dDescItem = 0;
                            gValorRestaItem16.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem16.dDescItem = 0;
                            gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem16.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA16.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA16.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA16.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA16.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA16.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA16.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA16.iAfecIVA = "3";
                            gCamIVA16.dBasGravIVA = 0;
                            gCamIVA16.dLiqIVAItem = 0;
                        }
                        gCamIVA16.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem16.gValorRestaItem = gValorRestaItem16;
                        gCamItem16.gValorItem = gValorItem16;
                        gCamItem16.gCamIVA = gCamIVA16;
                        gCamItem1[f] = gCamItem16;
                    }
                    if (f == 16)
                    {
                        gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem17.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem17.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem17.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem17.dDescItem = 0;
                            gValorRestaItem17.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem17.dDescItem = 0;
                            gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem17.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA17.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA17.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA17.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA17.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA17.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA17.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA17.iAfecIVA = "3";
                            gCamIVA17.dBasGravIVA = 0;
                            gCamIVA17.dLiqIVAItem = 0;
                        }
                        gCamIVA17.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem17.gValorRestaItem = gValorRestaItem17;
                        gCamItem17.gValorItem = gValorItem17;
                        gCamItem17.gCamIVA = gCamIVA17;
                        gCamItem1[f] = gCamItem17;
                    }
                    if (f == 17)
                    {
                        gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem18.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem18.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem18.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem18.dDescItem = 0;
                            gValorRestaItem18.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem18.dDescItem = 0;
                            gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem18.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA18.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA18.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA18.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA18.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA18.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA18.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA18.iAfecIVA = "3";
                            gCamIVA18.dBasGravIVA = 0;
                            gCamIVA18.dLiqIVAItem = 0;
                        }
                        gCamIVA18.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem18.gValorRestaItem = gValorRestaItem18;
                        gCamItem18.gValorItem = gValorItem18;
                        gCamItem18.gCamIVA = gCamIVA18;
                        gCamItem1[f] = gCamItem18;
                    }
                    if (f == 18)
                    {
                        gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());                                                                               //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem19.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem19.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem19.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem19.dDescItem = 0;
                            gValorRestaItem19.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem19.dDescItem = 0;
                            gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem19.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA19.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA19.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA19.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA19.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA19.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA19.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA19.iAfecIVA = "3";
                            gCamIVA19.dBasGravIVA = 0;
                            gCamIVA19.dLiqIVAItem = 0;
                        }
                        gCamIVA19.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem19.gValorRestaItem = gValorRestaItem19;
                        gCamItem19.gValorItem = gValorItem19;
                        gCamItem19.gCamIVA = gCamIVA19;
                        gCamItem1[f] = gCamItem19;
                    }
                    if (f == 19)
                    {
                        gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString());
                        //Si es licitacion
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem20.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem20.dDncpG = dncpNum.ToString("D8");
                        }
                        if (v_monedaDoc.Equals("PYG"))
                        {
                            gValorItem20.dTotBruOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                            gValorRestaItem20.dDescItem = 0;
                            gValorRestaItem20.dTotOpeItem = decimal.Round(decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString()));
                        }
                        else
                        {
                            gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                            gValorRestaItem20.dDescItem = 0;
                            gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        }
                        ////gValorItem
                        //gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        //gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        ////gValorRestaItem
                        //gValorRestaItem20.dDescItem = 0;
                        ////gValorRestaItem.dAntPreUniIt = 0;
                        ////gValorRestaItem.dTotOpeItem = 0;  
                        //gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA20.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = c_gravada10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA20.dLiqIVAItem = c_iva10;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), v_deciGR);
                                    gCamIVA20.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), v_deciGR);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA20.dBasGravIVA = c_gravada5;//Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA20.dLiqIVAItem = c_iva5;//Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), v_deciGR);
                                    gCamIVA20.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), v_deciGR);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA20.iAfecIVA = "3";
                            gCamIVA20.dBasGravIVA = 0;
                            gCamIVA20.dLiqIVAItem = 0;
                        }
                        gCamIVA20.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem20.gValorRestaItem = gValorRestaItem20;
                        gCamItem20.gValorItem = gValorItem20;
                        gCamItem20.gCamIVA = gCamIVA20;
                        gCamItem1[f] = gCamItem20;
                    }
                    if (f == 20)
                    {
                        gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem21.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem21.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem21.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem21.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA21.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA21.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA21.iAfecIVA = "3";
                            gCamIVA21.dBasGravIVA = 0;
                            gCamIVA21.dLiqIVAItem = 0;
                        }
                        gCamIVA21.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem21.gValorRestaItem = gValorRestaItem21;
                        gCamItem21.gValorItem = gValorItem21;
                        gCamItem21.gCamIVA = gCamIVA21;
                        gCamItem1[f] = gCamItem21;
                    }
                    if (f == 21)
                    {
                        gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem22.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem22.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem22.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem22.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA22.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA22.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA22.iAfecIVA = "3";
                            gCamIVA22.dBasGravIVA = 0;
                            gCamIVA22.dLiqIVAItem = 0;
                        }
                        gCamIVA22.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem22.gValorRestaItem = gValorRestaItem22;
                        gCamItem22.gValorItem = gValorItem22;
                        gCamItem22.gCamIVA = gCamIVA22;
                        gCamItem1[f] = gCamItem22;
                    }
                    if (f == 22)
                    {
                        gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem23.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem23.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem23.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem23.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA23.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA23.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA23.iAfecIVA = "3";
                            gCamIVA23.dBasGravIVA = 0;
                            gCamIVA23.dLiqIVAItem = 0;
                        }
                        gCamIVA23.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem23.gValorRestaItem = gValorRestaItem23;
                        gCamItem23.gValorItem = gValorItem23;
                        gCamItem23.gCamIVA = gCamIVA23;
                        gCamItem1[f] = gCamItem23;
                    }
                    if (f == 23)
                    {
                        gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem24.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem24.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem24.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem24.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA24.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA24.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA24.iAfecIVA = "3";
                            gCamIVA24.dBasGravIVA = 0;
                            gCamIVA24.dLiqIVAItem = 0;
                        }
                        gCamIVA24.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem24.gValorRestaItem = gValorRestaItem24;
                        gCamItem24.gValorItem = gValorItem24;
                        gCamItem24.gCamIVA = gCamIVA24;
                        gCamItem1[f] = gCamItem24;
                    }
                    if (f == 24)
                    {
                        gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem25.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem25.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem25.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem25.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA25.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA25.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA25.iAfecIVA = "3";
                            gCamIVA25.dBasGravIVA = 0;
                            gCamIVA25.dLiqIVAItem = 0;
                        }
                        gCamIVA25.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem25.gValorRestaItem = gValorRestaItem25;
                        gCamItem25.gValorItem = gValorItem25;
                        gCamItem25.gCamIVA = gCamIVA25;
                        gCamItem1[f] = gCamItem25;
                    }
                    if (f == 25)
                    {
                        gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem26.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem26.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem26.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem26.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA26.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA26.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA26.iAfecIVA = "3";
                            gCamIVA26.dBasGravIVA = 0;
                            gCamIVA26.dLiqIVAItem = 0;
                        }
                        gCamIVA26.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem26.gValorRestaItem = gValorRestaItem26;
                        gCamItem26.gValorItem = gValorItem26;
                        gCamItem26.gCamIVA = gCamIVA26;
                        gCamItem1[f] = gCamItem26;
                    }
                    if (f == 26)
                    {
                        gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem27.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem27.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem27.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem27.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA27.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA27.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA27.iAfecIVA = "3";
                            gCamIVA27.dBasGravIVA = 0;
                            gCamIVA27.dLiqIVAItem = 0;
                        }
                        gCamIVA27.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem27.gValorRestaItem = gValorRestaItem27;
                        gCamItem27.gValorItem = gValorItem27;
                        gCamItem27.gCamIVA = gCamIVA27;
                        gCamItem1[f] = gCamItem27;
                    }
                    if (f == 27)
                    {
                        gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem28.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem28.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem28.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem28.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA28.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA28.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA28.iAfecIVA = "3";
                            gCamIVA28.dBasGravIVA = 0;
                            gCamIVA28.dLiqIVAItem = 0;
                        }
                        gCamIVA28.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem28.gValorRestaItem = gValorRestaItem28;
                        gCamItem28.gValorItem = gValorItem28;
                        gCamItem28.gCamIVA = gCamIVA28;
                        gCamItem1[f] = gCamItem28;
                    }
                    if (f == 28)
                    {
                        gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem29.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem29.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem29.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem29.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA29.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA29.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA29.iAfecIVA = "3";
                            gCamIVA29.dBasGravIVA = 0;
                            gCamIVA29.dLiqIVAItem = 0;
                        }
                        gCamIVA29.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem29.gValorRestaItem = gValorRestaItem29;
                        gCamItem29.gValorItem = gValorItem29;
                        gCamItem29.gCamIVA = gCamIVA29;
                        gCamItem1[f] = gCamItem29;
                    }
                    if (f == 29)
                    {
                        gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem30.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem30.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem30.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem30.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA30.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA30.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA30.iAfecIVA = "3";
                            gCamIVA30.dBasGravIVA = 0;
                            gCamIVA30.dLiqIVAItem = 0;
                        }
                        gCamIVA30.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem30.gValorRestaItem = gValorRestaItem30;
                        gCamItem30.gValorItem = gValorItem30;
                        gCamItem30.gCamIVA = gCamIVA30;
                        gCamItem1[f] = gCamItem30;
                    }
                    if (f == 30)
                    {
                        gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem31.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem31.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem31.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem31.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA31.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA31.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA31.iAfecIVA = "3";
                            gCamIVA31.dBasGravIVA = 0;
                            gCamIVA31.dLiqIVAItem = 0;
                        }
                        gCamIVA31.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem31.gValorRestaItem = gValorRestaItem31;
                        gCamItem31.gValorItem = gValorItem31;
                        gCamItem31.gCamIVA = gCamIVA31;
                        gCamItem1[f] = gCamItem31;
                    }
                    if (f == 31)
                    {
                        gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem32.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem32.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem32.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem32.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA32.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA32.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA32.iAfecIVA = "3";
                            gCamIVA32.dBasGravIVA = 0;
                            gCamIVA32.dLiqIVAItem = 0;
                        }
                        gCamIVA32.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem32.gValorRestaItem = gValorRestaItem32;
                        gCamItem32.gValorItem = gValorItem32;
                        gCamItem32.gCamIVA = gCamIVA32;
                        gCamItem1[f] = gCamItem32;
                    }
                    if (f == 32)
                    {
                        gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem33.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem33.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem33.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem33.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA33.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA33.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA33.iAfecIVA = "3";
                            gCamIVA33.dBasGravIVA = 0;
                            gCamIVA33.dLiqIVAItem = 0;
                        }
                        gCamIVA33.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem33.gValorRestaItem = gValorRestaItem33;
                        gCamItem33.gValorItem = gValorItem33;
                        gCamItem33.gCamIVA = gCamIVA33;
                        gCamItem1[f] = gCamItem33;
                    }
                    if (f == 33)
                    {
                        gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem34.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem34.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem34.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem34.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA34.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA34.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA34.iAfecIVA = "3";
                            gCamIVA34.dBasGravIVA = 0;
                            gCamIVA34.dLiqIVAItem = 0;
                        }
                        gCamIVA34.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem34.gValorRestaItem = gValorRestaItem34;
                        gCamItem34.gValorItem = gValorItem34;
                        gCamItem34.gCamIVA = gCamIVA34;
                        gCamItem1[f] = gCamItem34;
                    }
                    if (f == 34)
                    {
                        gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem35.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem35.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem35.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem35.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA35.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA35.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA35.iAfecIVA = "3";
                            gCamIVA35.dBasGravIVA = 0;
                            gCamIVA35.dLiqIVAItem = 0;
                        }
                        gCamIVA35.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem35.gValorRestaItem = gValorRestaItem35;
                        gCamItem35.gValorItem = gValorItem35;
                        gCamItem35.gCamIVA = gCamIVA35;
                        gCamItem1[f] = gCamItem35;
                    }
                    if (f == 35)
                    {
                        gCamItem36.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem36.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem36.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem36.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem36.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem36.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem36.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA36.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA36.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA36.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA36.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA36.iAfecIVA = "3";
                            gCamIVA36.dBasGravIVA = 0;
                            gCamIVA36.dLiqIVAItem = 0;
                        }
                        gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem36.gValorRestaItem = gValorRestaItem36;
                        gCamItem36.gValorItem = gValorItem36;
                        gCamItem36.gCamIVA = gCamIVA36;
                        gCamItem1[f] = gCamItem36;
                    }
                    if (f == 36)
                    {
                        gCamItem37.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem37.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem37.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem37.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem37.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem37.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem37.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA37.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA37.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA37.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA37.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA37.iAfecIVA = "3";
                            gCamIVA37.dBasGravIVA = 0;
                            gCamIVA37.dLiqIVAItem = 0;
                        }
                        gCamIVA37.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem37.gValorRestaItem = gValorRestaItem37;
                        gCamItem37.gValorItem = gValorItem37;
                        gCamItem37.gCamIVA = gCamIVA37;
                        gCamItem1[f] = gCamItem37;
                    }
                    if (f == 37)
                    {
                        gCamItem38.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem38.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem38.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem38.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem38.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem38.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem38.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA38.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA38.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA38.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA38.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA38.iAfecIVA = "3";
                            gCamIVA38.dBasGravIVA = 0;
                            gCamIVA38.dLiqIVAItem = 0;
                        }
                        gCamIVA38.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem38.gValorRestaItem = gValorRestaItem38;
                        gCamItem38.gValorItem = gValorItem38;
                        gCamItem38.gCamIVA = gCamIVA38;
                        gCamItem1[f] = gCamItem38;
                    }
                    if (f == 38)
                    {
                        gCamItem39.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem39.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem39.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem39.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem39.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem39.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem39.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA39.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA39.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA39.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA39.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA39.iAfecIVA = "3";
                            gCamIVA39.dBasGravIVA = 0;
                            gCamIVA39.dLiqIVAItem = 0;
                        }
                        gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem39.gValorRestaItem = gValorRestaItem39;
                        gCamItem39.gValorItem = gValorItem39;
                        gCamItem39.gCamIVA = gCamIVA39;
                        gCamItem1[f] = gCamItem39;
                    }
                    if (f == 39)
                    {
                        gCamItem40.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem40.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem40.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem40.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem40.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem40.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem40.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA40.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA40.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA40.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA40.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA40.iAfecIVA = "3";
                            gCamIVA40.dBasGravIVA = 0;
                            gCamIVA40.dLiqIVAItem = 0;
                        }
                        gCamIVA40.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem40.gValorRestaItem = gValorRestaItem40;
                        gCamItem40.gValorItem = gValorItem40;
                        gCamItem40.gCamIVA = gCamIVA40;
                        gCamItem1[f] = gCamItem40;
                    }
                    if (f == 40)
                    {
                        gCamItem41.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem41.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem41.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem41.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem41.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem41.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem41.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA41.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA41.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA41.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA41.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA41.iAfecIVA = "3";
                            gCamIVA41.dBasGravIVA = 0;
                            gCamIVA41.dLiqIVAItem = 0;
                        }
                        gCamIVA41.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem41.gValorRestaItem = gValorRestaItem41;
                        gCamItem41.gValorItem = gValorItem41;
                        gCamItem41.gCamIVA = gCamIVA41;
                        gCamItem1[f] = gCamItem41;
                    }
                    if (f == 41)
                    {
                        gCamItem42.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem42.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem42.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem42.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem42.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem42.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem42.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA42.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA42.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA42.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA42.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA42.iAfecIVA = "3";
                            gCamIVA42.dBasGravIVA = 0;
                            gCamIVA42.dLiqIVAItem = 0;
                        }
                        gCamIVA42.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem42.gValorRestaItem = gValorRestaItem42;
                        gCamItem42.gValorItem = gValorItem42;
                        gCamItem42.gCamIVA = gCamIVA42;
                        gCamItem1[f] = gCamItem42;
                    }
                    if (f == 42)
                    {
                        gCamItem43.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem43.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem43.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem43.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem43.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem43.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem43.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA43.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA43.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA43.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA43.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA43.iAfecIVA = "3";
                            gCamIVA43.dBasGravIVA = 0;
                            gCamIVA43.dLiqIVAItem = 0;
                        }
                        gCamIVA43.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem43.gValorRestaItem = gValorRestaItem43;
                        gCamItem43.gValorItem = gValorItem43;
                        gCamItem43.gCamIVA = gCamIVA43;
                        gCamItem1[f] = gCamItem43;
                    }
                    if (f == 43)
                    {
                        gCamItem44.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem44.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem44.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem44.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem44.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem44.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem44.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA44.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA44.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA44.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA44.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA44.iAfecIVA = "3";
                            gCamIVA44.dBasGravIVA = 0;
                            gCamIVA44.dLiqIVAItem = 0;
                        }
                        gCamIVA44.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem44.gValorRestaItem = gValorRestaItem44;
                        gCamItem44.gValorItem = gValorItem44;
                        gCamItem44.gCamIVA = gCamIVA44;
                        gCamItem1[f] = gCamItem44;
                    }
                    if (f == 44)
                    {
                        gCamItem45.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem45.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem45.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem45.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem45.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem45.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem45.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA45.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA45.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA45.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA45.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA45.iAfecIVA = "3";
                            gCamIVA45.dBasGravIVA = 0;
                            gCamIVA45.dLiqIVAItem = 0;
                        }
                        gCamIVA45.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem45.gValorRestaItem = gValorRestaItem45;
                        gCamItem45.gValorItem = gValorItem45;
                        gCamItem45.gCamIVA = gCamIVA45;
                        gCamItem1[f] = gCamItem45;
                    }
                    #endregion


                    f++;
                    oDatos.MoveNext();
                    if (false == oCompany.InTransaction)
                    {
                        oCompany.StartTransaction();
                    }
                }
                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                if (tablacab.Equals("OINV"))
                {
                    if (string.IsNullOrEmpty(trans))
                    {
                        parametros.templateKuDE = "FACTURA_SIMPLE";
                    }
                    else
                    {
                        parametros.templateKuDE = template;
                    }
                }
                else
                {
                    parametros.templateKuDE = template;
                }

                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                if (tablacab.Equals("OINV"))
                {
                    gDtipDE.gCamFE = gCamFE;
                    gDtipDE.gCamCond = gCamCond;
                }

                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;
                if (condicion.Equals("2") && tablacab.Equals("OINV"))
                {
                    gCamCond.gPagCred = gPagCred;

                }
                if (tablacab.Equals("ORIN") && electronico.Equals("Si"))
                {

                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //DocAsoc.DoQuery("SELECT T2.\"U_CDC\" FROM ORIN T0 INNER JOIN RIN1 T1 ON T0.\"DocEntry\"=t1.\"DocEntry\" INNER JOIN OINV T2 ON T1.\"BaseEntry\"=t2.\"DocEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_CDC\" FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "1";
                        gCamDEAsoc.dCdCDERef = DocAsoc.Fields.Item(0).Value.ToString();
                        DocAsoc.MoveNext();
                    }
                }
                if (tablacab.Equals("ORIN") && electronico.Equals("No"))
                {
                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    // DocAsoc.DoQuery("SELECT T1.\"U_TIMB\",T1.\"U_ESTA\",T1.\"U_PEMI\",T1.\"FolioNum\",T1.\"DocDate\" FROM RIN1 T0 LEFT JOIN OINV T1 ON T1.\"DocEntry\"=T0.\"BaseEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_TIMB\",T0.\"U_ESTA\",T0.\"U_PEMI\",T0.\"FolioNum\",T0.\"DocDate\", " +
                                    "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\" " +
                                    "FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "2";
                        gCamDEAsoc.dNTimDI = DocAsoc.Fields.Item(0).Value.ToString();//timbrado
                        gCamDEAsoc.dEstDocAso = DocAsoc.Fields.Item(1).Value.ToString();//establecimiento
                        gCamDEAsoc.dPExpDocAso = DocAsoc.Fields.Item(2).Value.ToString();//punto de expedicion
                        gCamDEAsoc.dNumDocAso = DocAsoc.Fields.Item(3).Value.ToString(); ;//folio
                        gCamDEAsoc.iTipoDocAso = "1";//factura
                        DateTime FechaDA = DateTime.Parse(DocAsoc.Fields.Item(4).Value.ToString());
                        string hora2 = DocAsoc.Fields.Item(5).Value.ToString();
                        string DAfecha = FechaDA.ToString("yyyy-MM-dd");//fecha de la factura YYYY-mm-DD
                        gCamDEAsoc.dFecEmiDI = DateTime.Parse(DAfecha);
                        gCamDEAsoc.dFecEmiDISpecified = true;
                        DocAsoc.MoveNext();

                    }


                }



                gCamCond.gPaConEIni = gPaConEIni1;
                //gDtipDE.gCamCond = gCamCond;
                gDtipDE.gCamItem = gCamItem1;
                //gValorItem.gValorRestaItem = gValorRestaItem;
                //gCamItem.gValorItem = gValorItem;
                //gCamItem.gCamIVA = gCamIVA;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento

                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }

                    if (string.IsNullOrEmpty(v_folio))
                    {
                        //actualizamos el folio de la factura
                        Recordset oActFolio;
                        oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocNum\"='" + codigo + "'");
                        //actualizamos el folio del asiento
                        Recordset oActAsiento;
                        oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");

                        //actualizamos la numeracion de la serie           
                        Recordset oActSerie;
                        oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");
                    }

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 278)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");//
                                                                                                                                                                                                                                                                                                                 //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);

                }
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
                //oCompany.EndTransaction(BoWfTransOpt.wf_Commit);
            }

        }

        //load form numeración
        private static void loadNumeracion(SAPbouiCOM.Form form)
        {
            //cargar columnas en la grilla
            SAPbouiCOM.Grid grilla;
            SAPbouiCOM.Columns columns;
            SAPbouiCOM.ComboBoxColumn col;

            //datos extras export
            SAPbouiCOM.ComboBox oCombo;
            oCombo = (SAPbouiCOM.ComboBox)form.Items.Item("Item_5").Specific;
            oCombo.ValidValues.Add("FT", "Factura");
            oCombo.ValidValues.Add("NC", "Nota de crédito");
            oCombo.ValidValues.Add("RE", "Remision Entrega");
            oCombo.ValidValues.Add("RT", "Remisión Traslado");
            oCombo.ValidValues.Add("EX", "Factura export");
            oCombo.Item.DisplayDesc = true;

        }

        //funcion para actualizar la serie
        private static void actualizarSerie(string v_serie, string v_folio)
        {
            try
            {
                SAPbobsCOM.Recordset oQuery;
                oQuery = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oQuery.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + v_folio + "' WHERE \"SeriesName\"='" + v_serie + "' ");
                SBO_Application.StatusBar.SetText("Documento actualizado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
            }

        }

        //funcion para foliar o desfoliar
        private static void foliarDesfoliar(string v_pref, string v_folio, string v_cdc, string v_docu, string v_interno)
        {
            try
            {
                string v_tabla = null;
                string v_type = null;
                if (v_docu.Equals("FT")) { v_tabla = "OINV"; }
                if (v_docu.Equals("NC")) { v_tabla = "ORIN"; }
                if (v_docu.Equals("RE")) { v_tabla = "ODLN"; }
                if (v_docu.Equals("RT")) { v_tabla = "OWTR"; }
                if (v_docu.Equals("EX")) { v_tabla = "OINV"; v_type = " AND \"DocSubType\"='IX' "; }
                //armamos el query
                string v_consulta = "UPDATE " + v_tabla + " SET \"FolioPref\"='" + v_pref + "', \"FolioNum\"='" + v_folio + "'  ";
                if (!string.IsNullOrEmpty(v_cdc))
                {
                    v_consulta = v_consulta + " ,\"U_CDC\"='" + v_cdc + "' ";
                }
                v_consulta = v_consulta + " WHERE \"DocNum\"='" + v_interno + "' ";
                if (!string.IsNullOrEmpty(v_type))
                {
                    v_consulta = v_consulta + v_type;
                }


                SAPbobsCOM.Recordset oQuery;
                oQuery = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oQuery.DoQuery(v_consulta);
                SBO_Application.StatusBar.SetText("Serie actualizado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
            }

        }

        //reenviar documento export
        private static void reenviarDocumentoExport(string codigo, string tablacab, string tabladet, string documento, string template, string descdoc, string infoExp, string folioReenvio)
        {
            try
            {
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'  AND T0.\"DocSubType\"='IX' ");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "'  AND \"DocSubType\"='IX' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'  AND \"DocSubType\"='IX' ");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //consultamos cual direccion se eligio              

                #region QUERY DOCUMENTO
                if (!string.IsNullOrEmpty(direShip))
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\" ");
                    }
                    else
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_TRANSPORTISTA\",T0.\"U_CHOFERES\",T0.\"U_VEHICULOS\",T11.\"U_MARCA\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\" ");
                    }
                }
                else
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {

                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",T11.\"U_Marca\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\" ");
                    }
                    else
                    {
                        oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                       "T0.\"U_TRANSPORTISTA\",T0.\"U_CHOFERES\",T0.\"U_VEHICULOS\",T11.\"U_MARCA\",T12.\"Pager\",T12.\"Address\",T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\",T14.\"CardName\",T14.\"U_iNatRec\",T15.\"Country\",T15.\"Street\",T16.\"U_SET_FE\",T16.\"U_DESC_SET_FE\",T0.\"NumAtCard\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,'',T0.\"TransId\",'' " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                       "LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" AND T12.\"Name\"=T0.\"U_CHOFERES\" " +
                                       "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                       "LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "' AND T0.\"DocSubType\"='IX' " +
                                       "GROUP BY T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\", T3.\"Street\", T2.\"Cellular\", T0.\"DocDate\", T5.\"U_SET_FE\", T0.\"GroupNum\", T0.\"ExtraDays\", T1.\"ItemCode\", T1.\"Dscription\", " +
                                       "T1.\"Quantity\", T0.\"DocCur\", T1.\"TaxCode\", T4.\"U_SET_FE\", T0.\"Series\", T6.\"TaxIdNum\", T0.\"CreateTS\", T7.\"InstNum\",  T0.\"CreateTS\",  T0.\"U_iIndPres\", T0.\"U_iTipTra\", T0.\"U_iTImp\", T9.\"U_SET_FE\", " +
                                       "T2.\"U_iNatRec\", T2.\"U_iTipCont\", T10.\"Rate\", T0.\"DocTotal\", T0.\"U_docElectronico\",  T0.\"U_Trans\", T0.\"U_Chofer\", T0.\"U_Vehiculo\", T11.\"U_Marca\", T12.\"Pager\", T12.\"Address\", T13.\"U_SET_FE\", " +
                                       "T14.\"LicTradNum\", T14.\"CardName\", T14.\"U_iNatRec\", T15.\"Country\", T15.\"Street\", T16.\"U_SET_FE\", T16.\"U_DESC_SET_FE\", T0.\"NumAtCard\", T3.\"U_CdepSet\", T3.\"U_CdisSet\", T3.\"U_ClocSet\", T13.\"U_DESC_SET_FE\", " +
                                       "T0.\"U_ResFlete\", T1.\"Price\", T0.\"TransId\", T1.\"VatSumFrgn\", T1.\"VatSum\" ");
                    }
                }
                //DETALLE
                SAPbobsCOM.Recordset oDetalleExp;
                oDetalleExp = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDetalleExp.DoQuery("SELECT \"U_U_ItemCode\",\"U_U_Dscription\",\"U_U_cantidad\",\"U_U_TotalLine\" FROM \"@EXPORT\" WHERE \"U_U_DocEntry\"='" + codigo + "'");
                #endregion

                string Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(46).Value.ToString();
                string rec_dist = oDatos.Fields.Item(47).Value.ToString();
                string rec_loc = oDatos.Fields.Item(48).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(49).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string RespFlete = oDatos.Fields.Item(50).Value.ToString();
                string InfoAdicional = oDatos.Fields.Item(51).Value.ToString();
                string transId = oDatos.Fields.Item(52).Value.ToString();
                string InfoExport = oDatos.Fields.Item(53).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                //actualizamos el folio de la factura
                //Recordset oActFolio;
                //oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                // //actualizamos la numeracion de la serie           
                // Recordset oActSerie;
                // oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());         
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                    //instaciamos los objetos que vutilizaremos
                }

                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                //linea 36
                servicio.gCamItem gCamItem36 = new servicio.gCamItem();
                servicio.gValorItem gValorItem36 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem36 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA36 = new servicio.gCamIVA();
                //linea 37
                servicio.gCamItem gCamItem37 = new servicio.gCamItem();
                servicio.gValorItem gValorItem37 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem37 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA37 = new servicio.gCamIVA();
                //linea 38
                servicio.gCamItem gCamItem38 = new servicio.gCamItem();
                servicio.gValorItem gValorItem38 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem38 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA38 = new servicio.gCamIVA();
                //linea 39
                servicio.gCamItem gCamItem39 = new servicio.gCamItem();
                servicio.gValorItem gValorItem39 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem39 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA39 = new servicio.gCamIVA();
                //linea 40
                servicio.gCamItem gCamItem40 = new servicio.gCamItem();
                servicio.gValorItem gValorItem40 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem40 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA40 = new servicio.gCamIVA();
                //linea 41
                servicio.gCamItem gCamItem41 = new servicio.gCamItem();
                servicio.gValorItem gValorItem41 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem41 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA41 = new servicio.gCamIVA();
                //linea 42
                servicio.gCamItem gCamItem42 = new servicio.gCamItem();
                servicio.gValorItem gValorItem42 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem42 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA42 = new servicio.gCamIVA();
                //linea 43
                servicio.gCamItem gCamItem43 = new servicio.gCamItem();
                servicio.gValorItem gValorItem43 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem43 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA43 = new servicio.gCamIVA();
                //linea 44
                servicio.gCamItem gCamItem44 = new servicio.gCamItem();
                servicio.gValorItem gValorItem44 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem44 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA44 = new servicio.gCamIVA();
                //linea 45
                servicio.gCamItem gCamItem45 = new servicio.gCamItem();
                servicio.gValorItem gValorItem45 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem45 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA45 = new servicio.gCamIVA();
                #endregion
                #endregion
                //string lplp = "Intermediary (56 A) PNBPUS3NNYC Wells Fargo Bank NA New York, USA ABA 026005092 Account with Inst. (57 A) UBBRPYPX Banco Itaú Paraguay S.A. Asunción, Paraguay (59) Beneficiary account Nr. 0.5.001281/7 - CAJAS: 1.428 - PESO NETO: 24.619,00 – PESO BRUTO: 25.361,00 - CPT: 118.417,39 - FLETE: 5.300,00 - FCA: 113.117,39 - PLACAS: BNC469 / AAJZ 945 - PRECINTOS: SENACSA 722594 - SENACSA 722595 - PALLETS: 28";
                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                gOpeDE.dInfoFisc = infoExp;
                gOpeDE.dInfoEmi = infoExp;
                //gTimb
                gTimb.iTiDE = documento;
                gTimb.dDesTiDE = descdoc;
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                if (string.IsNullOrEmpty(folioReenvio))
                {
                    gTimb.dNumDoc = folio.ToString("D7");
                }
                else
                {
                    gTimb.dNumDoc = folioReenvio;
                }

                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }

                gOpeCom.iTipTra = TipTra;// oDatos.Fields.Item(23).Value.ToString();
                gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";

                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                    gOpeCom.dTiCamSpecified = true;
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                //if (oDatos.Fields.Item(26).Value.ToString() == "2")
                //{
                //    gDatRec.iTiOpe = "4";
                //    //gDatRec.iTiContRec = "1";
                //}
                //else
                //{
                //    gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                //    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //}
                gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();
                gDatRec.dNumCasRec = "0";
                //gDatRec.dDesPaisRe = "Paraguay";
                if (oDatos.Fields.Item(16).Value.ToString() == "PRY")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }


                //}


                //REMITO
                #region REMITO
                if (!string.IsNullOrEmpty(trans))
                {
                    string chof = oDatos.Fields.Item(32).Value.ToString();
                    if (!chof.Equals("PERSONAL"))
                    {
                        string CedChofer = oDatos.Fields.Item(35).Value.ToString();
                        if (!string.IsNullOrEmpty(CedChofer))
                        {
                            string dirReceptor = oDatos.Fields.Item(5).Value.ToString();
                            string NewDirRec = null;
                            if (!Regex.IsMatch(dirReceptor, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                NewDirRec = Regex.Replace(dirReceptor, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                NewDirRec = dirReceptor;

                            }
                            string salDire = oDatos.Fields.Item(37).Value.ToString();
                            string newsalDire = null;
                            if (!Regex.IsMatch(salDire, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                newsalDire = Regex.Replace(salDire, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                newsalDire = salDire;

                            }
                            string DomFiscal = oDatos.Fields.Item(42).Value.ToString();
                            string newDomFiscal = null;
                            if (!Regex.IsMatch(DomFiscal, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                newDomFiscal = Regex.Replace(DomFiscal, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                newDomFiscal = DomFiscal;

                            }
                            string DireChofer = oDatos.Fields.Item(36).Value.ToString();
                            string newDireChofer = null;
                            if (!Regex.IsMatch(DireChofer, @"^[a-zA-Z-0-9]+$") == true)
                            {
                                newDireChofer = Regex.Replace(DireChofer, @"[^0-9a-zA-Z ]+", "");

                            }
                            else
                            {
                                newDireChofer = DireChofer;

                            }
                            string codTransp = null;
                            string descTrans = null;
                            if (oDatos.Fields.Item(38).Value.ToString() == varE)
                            {
                                codTransp = "1";
                                descTrans = "Propio";
                            }
                            else
                            {
                                codTransp = "2";
                                descTrans = "Tercero";
                            }
                            gDatRec.dDirRec = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                            gDatRec.dNumCasRec = "0";
                            if (oDatos.Fields.Item(25).Value.ToString() != "4")
                            {
                                gDatRec.cDepRec = rec_dep;
                                gDatRec.cDisRec = rec_dist;
                                gDatRec.cCiuRec = rec_loc;
                            }
                            //gCamSal               
                            gCamSal.dDirLocSal = newsalDire;// oDatos.Fields.Item(37).Value.ToString();
                            gCamSal.dNumCasSal = "0";
                            //gCamSal.dComp1Sal =  "aviadores del chaco";
                            gCamSal.cDepSal = sal_dep;
                            gCamSal.cCiuSal = sal_loc;
                            gCamSal.cDisSal = sal_dist;
                            //gCamEnt
                            gCamEnt.dDirLocEnt = NewDirRec;// oDatos.Fields.Item(5).Value.ToString();
                            gCamEnt.dNumCasEnt = "0";
                            gCamEnt.cDepEnt = rec_dep;
                            gCamEnt.cCiuEnt = rec_loc;
                            gCamEnt.cDisEnt = rec_dist;
                            gCamEnt1[0] = gCamEnt;
                            gTransp.iTipTrans = codTransp;// "2";
                            gTransp.dDesTipTrans = descTrans;// "Tercero";
                            gTransp.iModTrans = "1";
                            gTransp.iRespFlete = RespFlete;
                            gTransp.dIniTras = fe;
                            gTransp.dIniTrasSpecified = true;
                            gTransp.dFinTras = fe;
                            gTransp.dFinTrasSpecified = true;
                            //gVehTras
                            //gTransp.gVehTras = gVehTras1;
                            gVehTras1[0] = gVehTras;
                            gVehTras.dTiVehTras = "Terrestre";
                            gVehTras.dMarVeh = oDatos.Fields.Item(34).Value.ToString();
                            gVehTras.dTipIdenVeh = "2";
                            gVehTras.dNroMatVeh = oDatos.Fields.Item(33).Value.ToString();
                            //gCamTrans
                            gCamTrans.iNatTrans = oDatos.Fields.Item(40).Value.ToString();
                            gCamTrans.dNomTrans = oDatos.Fields.Item(39).Value.ToString();
                            //deconstruimos el RUC del transportista
                            string rucCam = null;
                            string dvCam = null;
                            if (oDatos.Fields.Item(40).Value.ToString() == "1")
                            {
                                string varCam = oDatos.Fields.Item(38).Value.ToString();
                                int indexCam = varCam.IndexOf("-");
                                int canCam = oDatos.Fields.Item(38).Value.ToString().Length;
                                rucCam = oDatos.Fields.Item(38).Value.ToString().Remove(indexCam, canCam - indexCam);
                                dvCam = oDatos.Fields.Item(38).Value.ToString().Remove(0, indexCam + 1);
                            }

                            string paisTrans = oDatos.Fields.Item(43).Value.ToString();
                            if (paisTrans.Equals("PRY"))
                            {
                                gCamTrans.dRucTrans = rucCam;
                                gCamTrans.dDVTrans = dvCam;
                            }
                            else
                            {
                                gCamTrans.dNumIDTrans = oDatos.Fields.Item(38).Value.ToString();
                                gCamTrans.iTipIDTrans = "3";
                                gCamTrans.dDTipIDTrans = "Cédula extranjera";
                            }
                            gCamTrans.cNacTrans = oDatos.Fields.Item(43).Value.ToString();
                            gCamTrans.dDesNacTrans = oDatos.Fields.Item(44).Value.ToString();
                            gCamTrans.dDomFisc = newDomFiscal;// oDatos.Fields.Item(42).Value.ToString();
                            gCamTrans.dNumIDChof = oDatos.Fields.Item(35).Value.ToString();
                            gCamTrans.dNomChof = oDatos.Fields.Item(32).Value.ToString();
                            gCamTrans.dDirChof = newDireChofer;// oDatos.Fields.Item(36).Value.ToString();
                                                               //gCamNRE
                                                               //gCamNRE.iMotEmiNR = "1";
                                                               //gCamNRE.dDesMotEmiNR = "Traslado por ventas";
                                                               //gCamNRE.iRespEmiNR = "1";
                                                               //gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                            gCamNRE.dKmR = "3";
                            //gDtipDE.gCamNRE = gCamNRE;
                            gTransp.gCamTrans = gCamTrans;
                            gTransp.gCamSal = gCamSal;
                            gTransp.gCamEnt = gCamEnt1;
                            gTransp.gVehTras = gVehTras1;
                            gDtipDE.gTransp = gTransp;
                        }

                    }


                }
                #endregion

                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                                                                         //gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                                                                         //gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //gDatRec.dCelRec = "0981888493";
                                                                         //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                if (tablacab.Equals("OINV"))
                {
                    //gCamFE
                    gCamFE.iIndPres = oDatos.Fields.Item(22).Value.ToString();
                    //gCamCond
                    gCamCond.iCondOpe = oDatos.Fields.Item(9).Value.ToString(); //"2";               

                    if (oDatos.Fields.Item(9).Value.ToString() == "2")
                    {
                        //consultamos si el campo de cuota es mayor a cero
                        int Cuota = int.Parse(oDatos.Fields.Item(20).Value.ToString());
                        string concred = null;
                        if (Cuota > 0)
                        {
                            concred = "2";
                        }
                        else
                        {
                            concred = "1";
                        }
                        if (concred.Equals("2"))
                        {
                            gPagCred.dCuotas = Cuota.ToString();
                            gPagCred.iCondCred = concred;
                        }
                        else
                        {
                            //gPagCred
                            int plazo = int.Parse(oDatos.Fields.Item(10).Value.ToString());
                            gPagCred.dPlazoCre = plazo.ToString("D2");//oDatos.Fields.Item(10).Value.ToString(); //"12";
                            gPagCred.iCondCred = concred;
                        }
                    }
                }
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                    {
                        gPaConEIni.dTiCamTiPag = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                        gPaConEIni.dTiCamTiPagSpecified = true;
                    }
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                //gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto

                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //detalle export
                string codItem = null;
                string descr = null;
                string cant = null;
                string totallinea = null;
                while (!oDetalleExp.EoF)
                {
                    codItem = oDetalleExp.Fields.Item(0).Value.ToString();
                    descr = oDetalleExp.Fields.Item(1).Value.ToString();
                    cant = oDetalleExp.Fields.Item(2).Value.ToString().Replace(".", ",");
                    totallinea = oDetalleExp.Fields.Item(3).Value.ToString().Replace(".", ",");

                    #region DETALLE EXPORT

                    if (f == 0)
                    {
                        gCamItem.dCodInt = codItem;
                        gCamItem.dDesProSer = descr;
                        gCamItem.dCantProSer = decimal.Parse(cant);
                        gValorItem.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), 7);
                        gValorItem.dTotBruOpeItem = decimal.Parse(totallinea);
                        //gValorRestaItem
                        gValorRestaItem.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem.dTotOpeItem = decimal.Parse(totallinea);
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA.iAfecIVA = "1";
                            gCamIVA.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                    gCamIVA.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), 7);
                                    gCamIVA.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), 7);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                    gCamIVA.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), 7);
                                    gCamIVA.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), 7);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA.iAfecIVA = "3";
                            gCamIVA.dBasGravIVA = 0;
                            gCamIVA.dLiqIVAItem = 0;
                        }
                        gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem.gValorRestaItem = gValorRestaItem;
                        gCamItem.gValorItem = gValorItem;
                        gCamItem.gCamIVA = gCamIVA;
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        gCamItem2.dCodInt = codItem;
                        gCamItem2.dDesProSer = descr;
                        gCamItem2.dCantProSer = decimal.Parse(cant);
                        gValorItem2.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), 4);
                        gValorItem2.dTotBruOpeItem = decimal.Parse(totallinea);
                        //gValorRestaItem
                        gValorRestaItem2.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem2.dTotOpeItem = decimal.Parse(totallinea);
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA2.iAfecIVA = "1";
                            gCamIVA2.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                    gCamIVA2.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), 4);
                                    gCamIVA2.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), 4);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                    gCamIVA2.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), 4);
                                    gCamIVA2.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), 4);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA2.iAfecIVA = "3";
                            gCamIVA2.dBasGravIVA = 0;
                            gCamIVA2.dLiqIVAItem = 0;
                        }
                        gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem2.gValorRestaItem = gValorRestaItem2;
                        gCamItem2.gValorItem = gValorItem2;
                        gCamItem2.gCamIVA = gCamIVA2;
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {
                        gCamItem3.dCodInt = codItem;
                        gCamItem3.dDesProSer = descr;
                        gCamItem3.dCantProSer = decimal.Parse(cant);
                        gValorItem3.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), 4);
                        gValorItem3.dTotBruOpeItem = decimal.Parse(totallinea);
                        //gValorRestaItem
                        gValorRestaItem3.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem3.dTotOpeItem = decimal.Parse(totallinea);
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA3.iAfecIVA = "1";
                            gCamIVA3.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                    gCamIVA3.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), 4);
                                    gCamIVA3.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), 4);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                    gCamIVA3.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), 4);
                                    gCamIVA3.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), 4);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA3.iAfecIVA = "3";
                            gCamIVA3.dBasGravIVA = 0;
                            gCamIVA3.dLiqIVAItem = 0;
                        }
                        gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem3.gValorRestaItem = gValorRestaItem3;
                        gCamItem3.gValorItem = gValorItem3;
                        gCamItem3.gCamIVA = gCamIVA3;
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = codItem;
                        gCamItem4.dDesProSer = descr;
                        gCamItem4.dCantProSer = decimal.Parse(cant);
                        gValorItem4.dPUniProSer = decimal.Round(decimal.Parse(totallinea) / decimal.Parse(cant), 4);
                        gValorItem4.dTotBruOpeItem = decimal.Parse(totallinea);
                        //gValorRestaItem
                        gValorRestaItem4.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem4.dTotOpeItem = decimal.Parse(totallinea);
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA4.iAfecIVA = "1";
                            gCamIVA4.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"));
                                    gCamIVA4.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,1"), 4);
                                    gCamIVA4.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,1")), 4);
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = Math.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"));
                                    gCamIVA4.dLiqIVAItem = Math.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = decimal.Round(decimal.Parse(totallinea) / decimal.Parse("1,05"), 4);
                                    gCamIVA4.dLiqIVAItem = decimal.Round(decimal.Parse(totallinea) - (decimal.Parse(totallinea) / decimal.Parse("1,05")), 4);
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA4.iAfecIVA = "3";
                            gCamIVA4.dBasGravIVA = 0;
                            gCamIVA4.dLiqIVAItem = 0;
                        }
                        gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem4.gValorRestaItem = gValorRestaItem4;
                        gCamItem4.gValorItem = gValorItem4;
                        gCamItem4.gCamIVA = gCamIVA4;
                        gCamItem1[f] = gCamItem4;
                    }

                    #endregion
                    f++;
                    oDetalleExp.MoveNext();
                    if (false == oCompany.InTransaction)
                    {
                        oCompany.StartTransaction();
                    }
                }


                //while (!oDatos.EoF)
                //{
                //    if (!oDatos.Fields.Item(11).Value.ToString().Equals("I0000059") && !oDatos.Fields.Item(11).Value.ToString().Equals("I0000060") && !oDatos.Fields.Item(11).Value.ToString().Equals("I0000061"))
                //    {
                //        #region DETALLE DOCUMENTO
                //        if (f == 0)
                //        {
                //            gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //            gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //            gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;                       

                //            //gValorItem
                //            string pp = oDatos.Fields.Item(14).Value.ToString();
                //            gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //            gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //            //gValorRestaItem
                //            gValorRestaItem.dDescItem = 0;
                //            //gValorRestaItem.dAntPreUniIt = 0;
                //            //gValorRestaItem.dTotOpeItem = 0;  
                //            gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //            //gCamIVA
                //            string IVA = oDatos.Fields.Item(15).Value.ToString();
                //            if (IVA.Equals("5") || IVA.Equals("10"))
                //            {
                //                gCamIVA.iAfecIVA = "1";
                //                gCamIVA.dPropIVA = 100;
                //                if (IVA.Equals("10"))
                //                {
                //                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //                    {
                //                        gCamIVA.dPropIVA = 100;
                //                        gCamIVA.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //                        gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //                    }
                //                    else
                //                    {
                //                        gCamIVA.dPropIVA = 100;
                //                        gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                //                        gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                //                    }

                //                }
                //                if (IVA.Equals("5"))
                //                {
                //                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //                    {
                //                        gCamIVA.dPropIVA = 100;
                //                        decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //                        gCamIVA.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //                        gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //                    }
                //                    else
                //                    {
                //                        gCamIVA.dPropIVA = 100;
                //                        gCamIVA.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                //                        gCamIVA.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                //                    }

                //                }

                //            }
                //            else if (IVA.Equals("0"))
                //            {
                //                gCamIVA.iAfecIVA = "3";
                //                gCamIVA.dBasGravIVA = 0;
                //                gCamIVA.dLiqIVAItem = 0;
                //            }
                //            gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //            gValorItem.gValorRestaItem = gValorRestaItem;
                //            gCamItem.gValorItem = gValorItem;
                //            gCamItem.gCamIVA = gCamIVA;
                //            gCamItem1[f] = gCamItem;
                //        }
                //        if (f == 1)
                //        {
                //            gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //            gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //            gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //            //gValorItem
                //            gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //            gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //            //gValorRestaItem
                //            gValorRestaItem2.dDescItem = 0;
                //            //gValorRestaItem.dAntPreUniIt = 0;
                //            //gValorRestaItem.dTotOpeItem = 0;  
                //            gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //            //gCamIVA
                //            string IVA = oDatos.Fields.Item(15).Value.ToString();
                //            if (IVA.Equals("5") || IVA.Equals("10"))
                //            {
                //                gCamIVA2.iAfecIVA = "1";
                //                if (IVA.Equals("10"))
                //                {
                //                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //                    {
                //                        gCamIVA2.dPropIVA = 100;
                //                        gCamIVA2.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //                        gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //                    }
                //                    else
                //                    {
                //                        gCamIVA2.dPropIVA = 100;
                //                        gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                //                        gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                //                    }

                //                }
                //                if (IVA.Equals("5"))
                //                {
                //                    if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //                    {
                //                        gCamIVA2.dPropIVA = 100;
                //                        decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //                        gCamIVA2.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //                        gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //                    }
                //                    else
                //                    {
                //                        gCamIVA2.dPropIVA = 100;
                //                        gCamIVA2.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                //                        gCamIVA2.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                //                    }

                //                }

                //            }
                //            else if (IVA.Equals("0"))
                //            {
                //                gCamIVA2.iAfecIVA = "3";
                //                gCamIVA2.dBasGravIVA = 0;
                //                gCamIVA2.dLiqIVAItem = 0;
                //            }
                //            gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //            gValorItem2.gValorRestaItem = gValorRestaItem2;
                //            gCamItem2.gValorItem = gValorItem2;
                //            gCamItem2.gCamIVA = gCamIVA2;
                //            gCamItem1[f] = gCamItem2;
                //        }
                //        //if (f == 2)
                //        //{
                //        //    gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem3.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA3.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA3.dPropIVA = 100;
                //        //                gCamIVA3.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA3.dPropIVA = 100;
                //        //                gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                //        //                gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA3.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA3.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA3.dPropIVA = 100;
                //        //                gCamIVA3.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                //        //                gCamIVA3.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA3.iAfecIVA = "3";
                //        //        gCamIVA3.dBasGravIVA = 0;
                //        //        gCamIVA3.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem3.gValorRestaItem = gValorRestaItem3;
                //        //    gCamItem3.gValorItem = gValorItem3;
                //        //    gCamItem3.gCamIVA = gCamIVA3;
                //        //    gCamItem1[f] = gCamItem3;
                //        //}
                //        //if (f == 3)
                //        //{
                //        //    gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem4.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA4.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA4.dPropIVA = 100;
                //        //                gCamIVA4.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA4.dPropIVA = 100;
                //        //                gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                //        //                gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA4.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA4.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA4.dPropIVA = 100;
                //        //                gCamIVA4.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                //        //                gCamIVA4.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA4.iAfecIVA = "3";
                //        //        gCamIVA4.dBasGravIVA = 0;
                //        //        gCamIVA4.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem4.gValorRestaItem = gValorRestaItem4;
                //        //    gCamItem4.gValorItem = gValorItem4;
                //        //    gCamItem4.gCamIVA = gCamIVA4;
                //        //    gCamItem1[f] = gCamItem4;
                //        //}
                //        //if (f == 4)
                //        //{
                //        //    gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                //        //    //gValorItem
                //        //    gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem5.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA5.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA5.dPropIVA = 100;
                //        //                gCamIVA5.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA5.dPropIVA = 100;
                //        //                gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                //        //                gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA5.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA5.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA5.dPropIVA = 100;
                //        //                gCamIVA5.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                //        //                gCamIVA5.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA5.iAfecIVA = "3";
                //        //        gCamIVA5.dBasGravIVA = 0;
                //        //        gCamIVA5.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem5.gValorRestaItem = gValorRestaItem5;
                //        //    gCamItem5.gValorItem = gValorItem5;
                //        //    gCamItem5.gCamIVA = gCamIVA5;
                //        //    gCamItem1[f] = gCamItem5;
                //        //}
                //        //if (f == 5)
                //        //{
                //        //    gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                //        //    //gValorItem
                //        //    gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem6.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA6.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA6.dPropIVA = 100;
                //        //                gCamIVA6.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA6.dPropIVA = 100;
                //        //                gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                //        //                gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA6.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA6.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA6.dPropIVA = 100;
                //        //                gCamIVA6.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                //        //                gCamIVA6.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA6.iAfecIVA = "3";
                //        //        gCamIVA6.dBasGravIVA = 0;
                //        //        gCamIVA6.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem6.gValorRestaItem = gValorRestaItem6;
                //        //    gCamItem6.gValorItem = gValorItem6;
                //        //    gCamItem6.gCamIVA = gCamIVA6;
                //        //    gCamItem1[f] = gCamItem6;
                //        //}
                //        //if (f == 6)
                //        //{
                //        //    gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem7.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA7.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA7.dPropIVA = 100;
                //        //                gCamIVA7.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA7.dPropIVA = 100;
                //        //                gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                //        //                gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA7.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA7.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA7.dPropIVA = 100;
                //        //                gCamIVA7.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                //        //                gCamIVA7.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA7.iAfecIVA = "3";
                //        //        gCamIVA7.dBasGravIVA = 0;
                //        //        gCamIVA7.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA7.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem7.gValorRestaItem = gValorRestaItem7;
                //        //    gCamItem7.gValorItem = gValorItem7;
                //        //    gCamItem7.gCamIVA = gCamIVA7;
                //        //    gCamItem1[f] = gCamItem7;
                //        //}
                //        //if (f == 7)
                //        //{
                //        //    gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                //        //    //gValorItem
                //        //    gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem8.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA8.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA8.dPropIVA = 100;
                //        //                gCamIVA8.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA8.dPropIVA = 100;
                //        //                gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                //        //                gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA8.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA8.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA8.dPropIVA = 100;
                //        //                gCamIVA8.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                //        //                gCamIVA8.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA8.iAfecIVA = "3";
                //        //        gCamIVA8.dBasGravIVA = 0;
                //        //        gCamIVA8.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA8.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem8.gValorRestaItem = gValorRestaItem8;
                //        //    gCamItem8.gValorItem = gValorItem8;
                //        //    gCamItem8.gCamIVA = gCamIVA8;
                //        //    gCamItem1[f] = gCamItem8;
                //        //}
                //        //if (f == 8)
                //        //{
                //        //    gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;


                //        //    //gValorItem
                //        //    gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem9.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA9.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA9.dPropIVA = 100;
                //        //                gCamIVA9.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA9.dPropIVA = 100;
                //        //                gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                //        //                gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA9.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA9.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA9.dPropIVA = 100;
                //        //                gCamIVA9.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                //        //                gCamIVA9.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA9.iAfecIVA = "3";
                //        //        gCamIVA9.dBasGravIVA = 0;
                //        //        gCamIVA9.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA9.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem9.gValorRestaItem = gValorRestaItem9;
                //        //    gCamItem9.gValorItem = gValorItem9;
                //        //    gCamItem9.gCamIVA = gCamIVA9;
                //        //    gCamItem1[f] = gCamItem9;
                //        //}
                //        //if (f == 9)
                //        //{
                //        //    gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem10.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA10.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA10.dPropIVA = 100;
                //        //                gCamIVA10.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA10.dPropIVA = 100;
                //        //                gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"), 2);
                //        //                gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")), 2);
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA10.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA10.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA10.dPropIVA = 100;
                //        //                gCamIVA10.dBasGravIVA = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"), 2);
                //        //                gCamIVA10.dLiqIVAItem = decimal.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")), 2);
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA10.iAfecIVA = "3";
                //        //        gCamIVA10.dBasGravIVA = 0;
                //        //        gCamIVA10.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA10.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem10.gValorRestaItem = gValorRestaItem10;
                //        //    gCamItem10.gValorItem = gValorItem10;
                //        //    gCamItem10.gCamIVA = gCamIVA10;
                //        //    gCamItem1[f] = gCamItem10;
                //        //}
                //        //if (f == 10)
                //        //{
                //        //    gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem11.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA11.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA11.dPropIVA = 100;
                //        //                gCamIVA11.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA11.dPropIVA = 100;
                //        //                gCamIVA11.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA11.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA11.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA11.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA11.dPropIVA = 100;
                //        //                gCamIVA11.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA11.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA11.iAfecIVA = "3";
                //        //        gCamIVA11.dBasGravIVA = 0;
                //        //        gCamIVA11.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA11.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem11.gValorRestaItem = gValorRestaItem11;
                //        //    gCamItem11.gValorItem = gValorItem11;
                //        //    gCamItem11.gCamIVA = gCamIVA11;
                //        //    gCamItem1[f] = gCamItem11;
                //        //}
                //        //if (f == 11)
                //        //{
                //        //    gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem12.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA12.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA12.dPropIVA = 100;
                //        //                gCamIVA12.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA12.dPropIVA = 100;
                //        //                gCamIVA12.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA12.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA12.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA12.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA12.dPropIVA = 100;
                //        //                gCamIVA12.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA12.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA12.iAfecIVA = "3";
                //        //        gCamIVA12.dBasGravIVA = 0;
                //        //        gCamIVA12.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA12.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem12.gValorRestaItem = gValorRestaItem12;
                //        //    gCamItem12.gValorItem = gValorItem12;
                //        //    gCamItem12.gCamIVA = gCamIVA12;
                //        //    gCamItem1[f] = gCamItem12;
                //        //}
                //        //if (f == 12)
                //        //{
                //        //    gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem13.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA13.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA13.dPropIVA = 100;
                //        //                gCamIVA13.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA13.dPropIVA = 100;
                //        //                gCamIVA13.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA13.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA13.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA13.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA13.dPropIVA = 100;
                //        //                gCamIVA13.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA13.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA13.iAfecIVA = "3";
                //        //        gCamIVA13.dBasGravIVA = 0;
                //        //        gCamIVA13.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem13.gValorRestaItem = gValorRestaItem13;
                //        //    gCamItem13.gValorItem = gValorItem13;
                //        //    gCamItem13.gCamIVA = gCamIVA13;
                //        //    gCamItem1[f] = gCamItem13;
                //        //}
                //        //if (f == 13)
                //        //{
                //        //    gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem14.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA14.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA14.dPropIVA = 100;
                //        //                gCamIVA14.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA14.dPropIVA = 100;
                //        //                gCamIVA14.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA14.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA14.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA14.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA14.dPropIVA = 100;
                //        //                gCamIVA14.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA14.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA14.iAfecIVA = "3";
                //        //        gCamIVA14.dBasGravIVA = 0;
                //        //        gCamIVA14.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA14.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem14.gValorRestaItem = gValorRestaItem14;
                //        //    gCamItem14.gValorItem = gValorItem14;
                //        //    gCamItem14.gCamIVA = gCamIVA14;
                //        //    gCamItem1[f] = gCamItem14;
                //        //}
                //        //if (f == 14)
                //        //{
                //        //    gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem15.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA15.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA15.dPropIVA = 100;
                //        //                gCamIVA15.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA15.dPropIVA = 100;
                //        //                gCamIVA15.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA15.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA15.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA15.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA15.dPropIVA = 100;
                //        //                gCamIVA15.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA15.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA15.iAfecIVA = "3";
                //        //        gCamIVA15.dBasGravIVA = 0;
                //        //        gCamIVA15.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA15.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem15.gValorRestaItem = gValorRestaItem15;
                //        //    gCamItem15.gValorItem = gValorItem15;
                //        //    gCamItem15.gCamIVA = gCamIVA15;
                //        //    gCamItem1[f] = gCamItem15;
                //        //}
                //        //if (f == 15)
                //        //{
                //        //    gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem16.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA16.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA16.dPropIVA = 100;
                //        //                gCamIVA16.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA16.dPropIVA = 100;
                //        //                gCamIVA16.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA16.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA16.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA16.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA16.dPropIVA = 100;
                //        //                gCamIVA16.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA16.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA16.iAfecIVA = "3";
                //        //        gCamIVA16.dBasGravIVA = 0;
                //        //        gCamIVA16.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA16.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem16.gValorRestaItem = gValorRestaItem16;
                //        //    gCamItem16.gValorItem = gValorItem16;
                //        //    gCamItem16.gCamIVA = gCamIVA16;
                //        //    gCamItem1[f] = gCamItem16;
                //        //}
                //        //if (f == 16)
                //        //{
                //        //    gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem17.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA17.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA17.dPropIVA = 100;
                //        //                gCamIVA17.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA17.dPropIVA = 100;
                //        //                gCamIVA17.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA17.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA17.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA17.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA17.dPropIVA = 100;
                //        //                gCamIVA17.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA17.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA17.iAfecIVA = "3";
                //        //        gCamIVA17.dBasGravIVA = 0;
                //        //        gCamIVA17.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA17.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem17.gValorRestaItem = gValorRestaItem17;
                //        //    gCamItem17.gValorItem = gValorItem17;
                //        //    gCamItem17.gCamIVA = gCamIVA17;
                //        //    gCamItem1[f] = gCamItem17;
                //        //}
                //        //if (f == 17)
                //        //{
                //        //    gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem18.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA18.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA18.dPropIVA = 100;
                //        //                gCamIVA18.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA18.dPropIVA = 100;
                //        //                gCamIVA18.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA18.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA18.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA18.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA18.dPropIVA = 100;
                //        //                gCamIVA18.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA18.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA18.iAfecIVA = "3";
                //        //        gCamIVA18.dBasGravIVA = 0;
                //        //        gCamIVA18.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA18.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem18.gValorRestaItem = gValorRestaItem18;
                //        //    gCamItem18.gValorItem = gValorItem18;
                //        //    gCamItem18.gCamIVA = gCamIVA18;
                //        //    gCamItem1[f] = gCamItem18;
                //        //}
                //        //if (f == 18)
                //        //{
                //        //    gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem19.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA19.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA19.dPropIVA = 100;
                //        //                gCamIVA19.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA19.dPropIVA = 100;
                //        //                gCamIVA19.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA19.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA19.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA19.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA19.dPropIVA = 100;
                //        //                gCamIVA19.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA19.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA19.iAfecIVA = "3";
                //        //        gCamIVA19.dBasGravIVA = 0;
                //        //        gCamIVA19.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA19.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem19.gValorRestaItem = gValorRestaItem19;
                //        //    gCamItem19.gValorItem = gValorItem19;
                //        //    gCamItem19.gCamIVA = gCamIVA19;
                //        //    gCamItem1[f] = gCamItem19;
                //        //}
                //        //if (f == 19)
                //        //{
                //        //    gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;

                //        //    //gValorItem
                //        //    gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem20.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA20.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA20.dPropIVA = 100;
                //        //                gCamIVA20.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA20.dPropIVA = 100;
                //        //                gCamIVA20.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA20.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA20.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA20.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA20.dPropIVA = 100;
                //        //                gCamIVA20.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA20.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA20.iAfecIVA = "3";
                //        //        gCamIVA20.dBasGravIVA = 0;
                //        //        gCamIVA20.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA20.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem20.gValorRestaItem = gValorRestaItem20;
                //        //    gCamItem20.gValorItem = gValorItem20;
                //        //    gCamItem20.gCamIVA = gCamIVA20;
                //        //    gCamItem1[f] = gCamItem20;
                //        //}
                //        //if (f == 20)
                //        //{
                //        //    gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem21.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem21.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem21.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem21.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA21.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA21.dPropIVA = 100;
                //        //                gCamIVA21.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA21.dPropIVA = 100;
                //        //                gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA21.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA21.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA21.dPropIVA = 100;
                //        //                gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA21.iAfecIVA = "3";
                //        //        gCamIVA21.dBasGravIVA = 0;
                //        //        gCamIVA21.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA21.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem21.gValorRestaItem = gValorRestaItem21;
                //        //    gCamItem21.gValorItem = gValorItem21;
                //        //    gCamItem21.gCamIVA = gCamIVA21;
                //        //    gCamItem1[f] = gCamItem21;
                //        //}
                //        //if (f == 21)
                //        //{
                //        //    gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem22.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem22.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem22.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem22.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA22.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA22.dPropIVA = 100;
                //        //                gCamIVA22.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA22.dPropIVA = 100;
                //        //                gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA22.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA22.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA22.dPropIVA = 100;
                //        //                gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA22.iAfecIVA = "3";
                //        //        gCamIVA22.dBasGravIVA = 0;
                //        //        gCamIVA22.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA22.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem22.gValorRestaItem = gValorRestaItem22;
                //        //    gCamItem22.gValorItem = gValorItem22;
                //        //    gCamItem22.gCamIVA = gCamIVA22;
                //        //    gCamItem1[f] = gCamItem22;
                //        //}
                //        //if (f == 22)
                //        //{
                //        //    gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem23.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem23.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem23.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem23.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA23.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA23.dPropIVA = 100;
                //        //                gCamIVA23.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA23.dPropIVA = 100;
                //        //                gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA23.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA23.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA23.dPropIVA = 100;
                //        //                gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA23.iAfecIVA = "3";
                //        //        gCamIVA23.dBasGravIVA = 0;
                //        //        gCamIVA23.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA23.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem23.gValorRestaItem = gValorRestaItem23;
                //        //    gCamItem23.gValorItem = gValorItem23;
                //        //    gCamItem23.gCamIVA = gCamIVA23;
                //        //    gCamItem1[f] = gCamItem23;
                //        //}
                //        //if (f == 23)
                //        //{
                //        //    gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem24.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem24.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem24.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem24.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA24.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA24.dPropIVA = 100;
                //        //                gCamIVA24.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA24.dPropIVA = 100;
                //        //                gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA24.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA24.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA24.dPropIVA = 100;
                //        //                gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA24.iAfecIVA = "3";
                //        //        gCamIVA24.dBasGravIVA = 0;
                //        //        gCamIVA24.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA24.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem24.gValorRestaItem = gValorRestaItem24;
                //        //    gCamItem24.gValorItem = gValorItem24;
                //        //    gCamItem24.gCamIVA = gCamIVA24;
                //        //    gCamItem1[f] = gCamItem24;
                //        //}
                //        //if (f == 24)
                //        //{
                //        //    gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem25.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem25.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem25.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem25.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA25.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA25.dPropIVA = 100;
                //        //                gCamIVA25.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA25.dPropIVA = 100;
                //        //                gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA25.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA25.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA25.dPropIVA = 100;
                //        //                gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA25.iAfecIVA = "3";
                //        //        gCamIVA25.dBasGravIVA = 0;
                //        //        gCamIVA25.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA25.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem25.gValorRestaItem = gValorRestaItem25;
                //        //    gCamItem25.gValorItem = gValorItem25;
                //        //    gCamItem25.gCamIVA = gCamIVA25;
                //        //    gCamItem1[f] = gCamItem25;
                //        //}
                //        //if (f == 25)
                //        //{
                //        //    gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem26.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem26.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem26.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem26.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA26.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA26.dPropIVA = 100;
                //        //                gCamIVA26.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA26.dPropIVA = 100;
                //        //                gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA26.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA26.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA26.dPropIVA = 100;
                //        //                gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA26.iAfecIVA = "3";
                //        //        gCamIVA26.dBasGravIVA = 0;
                //        //        gCamIVA26.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA26.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem26.gValorRestaItem = gValorRestaItem26;
                //        //    gCamItem26.gValorItem = gValorItem26;
                //        //    gCamItem26.gCamIVA = gCamIVA26;
                //        //    gCamItem1[f] = gCamItem26;
                //        //}
                //        //if (f == 26)
                //        //{
                //        //    gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem27.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem27.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem27.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem27.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA27.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA27.dPropIVA = 100;
                //        //                gCamIVA27.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA27.dPropIVA = 100;
                //        //                gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA27.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA27.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA27.dPropIVA = 100;
                //        //                gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA27.iAfecIVA = "3";
                //        //        gCamIVA27.dBasGravIVA = 0;
                //        //        gCamIVA27.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA27.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem27.gValorRestaItem = gValorRestaItem27;
                //        //    gCamItem27.gValorItem = gValorItem27;
                //        //    gCamItem27.gCamIVA = gCamIVA27;
                //        //    gCamItem1[f] = gCamItem27;
                //        //}
                //        //if (f == 27)
                //        //{
                //        //    gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem28.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem28.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem28.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem28.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA28.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA28.dPropIVA = 100;
                //        //                gCamIVA28.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA28.dPropIVA = 100;
                //        //                gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA28.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA28.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA28.dPropIVA = 100;
                //        //                gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA28.iAfecIVA = "3";
                //        //        gCamIVA28.dBasGravIVA = 0;
                //        //        gCamIVA28.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA28.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem28.gValorRestaItem = gValorRestaItem28;
                //        //    gCamItem28.gValorItem = gValorItem28;
                //        //    gCamItem28.gCamIVA = gCamIVA28;
                //        //    gCamItem1[f] = gCamItem28;
                //        //}
                //        //if (f == 28)
                //        //{
                //        //    gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem29.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem29.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem29.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem29.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA29.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA29.dPropIVA = 100;
                //        //                gCamIVA29.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA29.dPropIVA = 100;
                //        //                gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA29.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA29.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA29.dPropIVA = 100;
                //        //                gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA29.iAfecIVA = "3";
                //        //        gCamIVA29.dBasGravIVA = 0;
                //        //        gCamIVA29.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA29.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem29.gValorRestaItem = gValorRestaItem29;
                //        //    gCamItem29.gValorItem = gValorItem29;
                //        //    gCamItem29.gCamIVA = gCamIVA29;
                //        //    gCamItem1[f] = gCamItem29;
                //        //}
                //        //if (f == 29)
                //        //{
                //        //    gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem30.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem30.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem30.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem30.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA30.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA30.dPropIVA = 100;
                //        //                gCamIVA30.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA30.dPropIVA = 100;
                //        //                gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA30.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA30.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA30.dPropIVA = 100;
                //        //                gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA30.iAfecIVA = "3";
                //        //        gCamIVA30.dBasGravIVA = 0;
                //        //        gCamIVA30.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA30.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem30.gValorRestaItem = gValorRestaItem30;
                //        //    gCamItem30.gValorItem = gValorItem30;
                //        //    gCamItem30.gCamIVA = gCamIVA30;
                //        //    gCamItem1[f] = gCamItem30;
                //        //}
                //        //if (f == 30)
                //        //{
                //        //    gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem31.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem31.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem31.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem31.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA31.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA31.dPropIVA = 100;
                //        //                gCamIVA31.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA31.dPropIVA = 100;
                //        //                gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA31.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA31.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA31.dPropIVA = 100;
                //        //                gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA31.iAfecIVA = "3";
                //        //        gCamIVA31.dBasGravIVA = 0;
                //        //        gCamIVA31.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA31.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem31.gValorRestaItem = gValorRestaItem31;
                //        //    gCamItem31.gValorItem = gValorItem31;
                //        //    gCamItem31.gCamIVA = gCamIVA31;
                //        //    gCamItem1[f] = gCamItem31;
                //        //}
                //        //if (f == 31)
                //        //{
                //        //    gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem32.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem32.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem32.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem32.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA32.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA32.dPropIVA = 100;
                //        //                gCamIVA32.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA32.dPropIVA = 100;
                //        //                gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA32.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA32.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA32.dPropIVA = 100;
                //        //                gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA32.iAfecIVA = "3";
                //        //        gCamIVA32.dBasGravIVA = 0;
                //        //        gCamIVA32.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA32.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem32.gValorRestaItem = gValorRestaItem32;
                //        //    gCamItem32.gValorItem = gValorItem32;
                //        //    gCamItem32.gCamIVA = gCamIVA32;
                //        //    gCamItem1[f] = gCamItem32;
                //        //}
                //        //if (f == 32)
                //        //{
                //        //    gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem33.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem33.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem33.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem33.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA33.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA33.dPropIVA = 100;
                //        //                gCamIVA33.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA33.dPropIVA = 100;
                //        //                gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA33.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA33.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA33.dPropIVA = 100;
                //        //                gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA33.iAfecIVA = "3";
                //        //        gCamIVA33.dBasGravIVA = 0;
                //        //        gCamIVA33.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA33.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem33.gValorRestaItem = gValorRestaItem33;
                //        //    gCamItem33.gValorItem = gValorItem33;
                //        //    gCamItem33.gCamIVA = gCamIVA33;
                //        //    gCamItem1[f] = gCamItem33;
                //        //}
                //        //if (f == 33)
                //        //{
                //        //    gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem34.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem34.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem34.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem34.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA34.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA34.dPropIVA = 100;
                //        //                gCamIVA34.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA34.dPropIVA = 100;
                //        //                gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA34.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA34.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA34.dPropIVA = 100;
                //        //                gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA34.iAfecIVA = "3";
                //        //        gCamIVA34.dBasGravIVA = 0;
                //        //        gCamIVA34.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA34.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem34.gValorRestaItem = gValorRestaItem34;
                //        //    gCamItem34.gValorItem = gValorItem34;
                //        //    gCamItem34.gCamIVA = gCamIVA34;
                //        //    gCamItem1[f] = gCamItem34;
                //        //}
                //        //if (f == 34)
                //        //{
                //        //    gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem35.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem35.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem35.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem35.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA35.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA35.dPropIVA = 100;
                //        //                gCamIVA35.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA35.dPropIVA = 100;
                //        //                gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA35.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA35.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA35.dPropIVA = 100;
                //        //                gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA35.iAfecIVA = "3";
                //        //        gCamIVA35.dBasGravIVA = 0;
                //        //        gCamIVA35.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA35.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem35.gValorRestaItem = gValorRestaItem35;
                //        //    gCamItem35.gValorItem = gValorItem35;
                //        //    gCamItem35.gCamIVA = gCamIVA35;
                //        //    gCamItem1[f] = gCamItem35;
                //        //}
                //        //if (f == 35)
                //        //{
                //        //    gCamItem36.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem36.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem36.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem36.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem36.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem36.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem36.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA36.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA36.dPropIVA = 100;
                //        //                gCamIVA36.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA36.dPropIVA = 100;
                //        //                gCamIVA36.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA36.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA36.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA36.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA36.dPropIVA = 100;
                //        //                gCamIVA36.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA36.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA36.iAfecIVA = "3";
                //        //        gCamIVA36.dBasGravIVA = 0;
                //        //        gCamIVA36.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem36.gValorRestaItem = gValorRestaItem36;
                //        //    gCamItem36.gValorItem = gValorItem36;
                //        //    gCamItem36.gCamIVA = gCamIVA36;
                //        //    gCamItem1[f] = gCamItem36;
                //        //}
                //        //if (f == 36)
                //        //{
                //        //    gCamItem37.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem37.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem37.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem37.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem37.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem37.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem37.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA37.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA37.dPropIVA = 100;
                //        //                gCamIVA37.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA37.dPropIVA = 100;
                //        //                gCamIVA37.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA37.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA37.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA37.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA37.dPropIVA = 100;
                //        //                gCamIVA37.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA37.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA37.iAfecIVA = "3";
                //        //        gCamIVA37.dBasGravIVA = 0;
                //        //        gCamIVA37.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA37.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem37.gValorRestaItem = gValorRestaItem37;
                //        //    gCamItem37.gValorItem = gValorItem37;
                //        //    gCamItem37.gCamIVA = gCamIVA37;
                //        //    gCamItem1[f] = gCamItem37;
                //        //}
                //        //if (f == 37)
                //        //{
                //        //    gCamItem38.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem38.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem38.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem38.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem38.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem38.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem38.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA38.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA38.dPropIVA = 100;
                //        //                gCamIVA38.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA38.dPropIVA = 100;
                //        //                gCamIVA38.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA38.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA38.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA38.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA38.dPropIVA = 100;
                //        //                gCamIVA38.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA38.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA38.iAfecIVA = "3";
                //        //        gCamIVA38.dBasGravIVA = 0;
                //        //        gCamIVA38.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA38.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem38.gValorRestaItem = gValorRestaItem38;
                //        //    gCamItem38.gValorItem = gValorItem38;
                //        //    gCamItem38.gCamIVA = gCamIVA38;
                //        //    gCamItem1[f] = gCamItem38;
                //        //}
                //        //if (f == 38)
                //        //{
                //        //    gCamItem39.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem39.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem39.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem39.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem39.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem39.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem39.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA39.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA39.dPropIVA = 100;
                //        //                gCamIVA39.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA39.dPropIVA = 100;
                //        //                gCamIVA39.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA39.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA39.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA39.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA39.dPropIVA = 100;
                //        //                gCamIVA39.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA39.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA39.iAfecIVA = "3";
                //        //        gCamIVA39.dBasGravIVA = 0;
                //        //        gCamIVA39.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem39.gValorRestaItem = gValorRestaItem39;
                //        //    gCamItem39.gValorItem = gValorItem39;
                //        //    gCamItem39.gCamIVA = gCamIVA39;
                //        //    gCamItem1[f] = gCamItem39;
                //        //}
                //        //if (f == 39)
                //        //{
                //        //    gCamItem40.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem40.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem40.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem40.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem40.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem40.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem40.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA40.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA40.dPropIVA = 100;
                //        //                gCamIVA40.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA40.dPropIVA = 100;
                //        //                gCamIVA40.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA40.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA40.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA40.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA40.dPropIVA = 100;
                //        //                gCamIVA40.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA40.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA40.iAfecIVA = "3";
                //        //        gCamIVA40.dBasGravIVA = 0;
                //        //        gCamIVA40.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA40.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem40.gValorRestaItem = gValorRestaItem40;
                //        //    gCamItem40.gValorItem = gValorItem40;
                //        //    gCamItem40.gCamIVA = gCamIVA40;
                //        //    gCamItem1[f] = gCamItem40;
                //        //}
                //        //if (f == 40)
                //        //{
                //        //    gCamItem41.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem41.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem41.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem41.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem41.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem41.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem41.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA41.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA41.dPropIVA = 100;
                //        //                gCamIVA41.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA41.dPropIVA = 100;
                //        //                gCamIVA41.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA41.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA41.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA41.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA41.dPropIVA = 100;
                //        //                gCamIVA41.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA41.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA41.iAfecIVA = "3";
                //        //        gCamIVA41.dBasGravIVA = 0;
                //        //        gCamIVA41.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA41.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem41.gValorRestaItem = gValorRestaItem41;
                //        //    gCamItem41.gValorItem = gValorItem41;
                //        //    gCamItem41.gCamIVA = gCamIVA41;
                //        //    gCamItem1[f] = gCamItem41;
                //        //}
                //        //if (f == 41)
                //        //{
                //        //    gCamItem42.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem42.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem42.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem42.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem42.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem42.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem42.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA42.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA42.dPropIVA = 100;
                //        //                gCamIVA42.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA42.dPropIVA = 100;
                //        //                gCamIVA42.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA42.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA42.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA42.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA42.dPropIVA = 100;
                //        //                gCamIVA42.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA42.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA42.iAfecIVA = "3";
                //        //        gCamIVA42.dBasGravIVA = 0;
                //        //        gCamIVA42.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA42.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem42.gValorRestaItem = gValorRestaItem42;
                //        //    gCamItem42.gValorItem = gValorItem42;
                //        //    gCamItem42.gCamIVA = gCamIVA42;
                //        //    gCamItem1[f] = gCamItem42;
                //        //}
                //        //if (f == 42)
                //        //{
                //        //    gCamItem43.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem43.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem43.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem43.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem43.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem43.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem43.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA43.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA43.dPropIVA = 100;
                //        //                gCamIVA43.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA43.dPropIVA = 100;
                //        //                gCamIVA43.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA43.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA43.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA43.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA43.dPropIVA = 100;
                //        //                gCamIVA43.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA43.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA43.iAfecIVA = "3";
                //        //        gCamIVA43.dBasGravIVA = 0;
                //        //        gCamIVA43.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA43.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem43.gValorRestaItem = gValorRestaItem43;
                //        //    gCamItem43.gValorItem = gValorItem43;
                //        //    gCamItem43.gCamIVA = gCamIVA43;
                //        //    gCamItem1[f] = gCamItem43;
                //        //}
                //        //if (f == 43)
                //        //{
                //        //    gCamItem44.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem44.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem44.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem44.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem44.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem44.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem44.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA44.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA44.dPropIVA = 100;
                //        //                gCamIVA44.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA44.dPropIVA = 100;
                //        //                gCamIVA44.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA44.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA44.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA44.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA44.dPropIVA = 100;
                //        //                gCamIVA44.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA44.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA44.iAfecIVA = "3";
                //        //        gCamIVA44.dBasGravIVA = 0;
                //        //        gCamIVA44.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA44.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem44.gValorRestaItem = gValorRestaItem44;
                //        //    gCamItem44.gValorItem = gValorItem44;
                //        //    gCamItem44.gCamIVA = gCamIVA44;
                //        //    gCamItem1[f] = gCamItem44;
                //        //}
                //        //if (f == 44)
                //        //{
                //        //    gCamItem45.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                //        //    gCamItem45.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                //        //    gCamItem45.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                //        //                                                                                     //gValorItem
                //        //    gValorItem45.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                //        //    gValorItem45.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gValorRestaItem
                //        //    gValorRestaItem45.dDescItem = 0;
                //        //    //gValorRestaItem.dAntPreUniIt = 0;
                //        //    //gValorRestaItem.dTotOpeItem = 0;  
                //        //    gValorRestaItem45.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //    //gCamIVA
                //        //    string IVA = oDatos.Fields.Item(15).Value.ToString();
                //        //    if (IVA.Equals("5") || IVA.Equals("10"))
                //        //    {
                //        //        gCamIVA45.iAfecIVA = "1";
                //        //        if (IVA.Equals("10"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA45.dPropIVA = 100;
                //        //                gCamIVA45.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //                gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA45.dPropIVA = 100;
                //        //                gCamIVA45.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                //        //                gCamIVA45.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                //        //            }

                //        //        }
                //        //        if (IVA.Equals("5"))
                //        //        {
                //        //            if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                //        //            {
                //        //                gCamIVA45.dPropIVA = 100;
                //        //                decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                //        //                gCamIVA45.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                //        //                gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                //        //            }
                //        //            else
                //        //            {
                //        //                gCamIVA45.dPropIVA = 100;
                //        //                gCamIVA45.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                //        //                gCamIVA45.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                //        //            }

                //        //        }

                //        //    }
                //        //    else if (IVA.Equals("0"))
                //        //    {
                //        //        gCamIVA45.iAfecIVA = "3";
                //        //        gCamIVA45.dBasGravIVA = 0;
                //        //        gCamIVA45.dLiqIVAItem = 0;
                //        //    }
                //        //    gCamIVA45.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                //        //    gValorItem45.gValorRestaItem = gValorRestaItem45;
                //        //    gCamItem45.gValorItem = gValorItem45;
                //        //    gCamItem45.gCamIVA = gCamIVA45;
                //        //    gCamItem1[f] = gCamItem45;
                //        //}
                //        #endregion
                //    }

                //    f++;
                //    oDatos.MoveNext();
                //    if (false == oCompany.InTransaction)
                //    {
                //        oCompany.StartTransaction();
                //    }
                //}

                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = template;
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                if (tablacab.Equals("OINV"))
                {
                    gDtipDE.gCamFE = gCamFE;
                    gDtipDE.gCamCond = gCamCond;
                }
                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;
                if (condicion.Equals("2") && tablacab.Equals("OINV"))
                {
                    gCamCond.gPagCred = gPagCred;

                }

                gCamCond.gPaConEIni = gPaConEIni1;
                gDtipDE.gCamItem = gCamItem1;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento

                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "' AND \"DocSubType\"='IX' ");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    //actualizamos el folio de la factura si es que esta vacío
                    if (string.IsNullOrEmpty(folioReenvio))
                    {
                        Recordset oActFolio;
                        oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "',\"Printed\"='Y',\"U_Info_Export\"='" + infoExp + "' where \"DocNum\"='" + codigo + "' AND \"DocSubType\"='IX'");
                        //actualizamos el folio del asiento
                        Recordset oActAsiento;
                        oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");
                        //actualizamos la numeracion de la serie           
                        Recordset oActSerie;
                        oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");
                    }



                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 278)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");//
                                                                                                                                                                                                                                                                                                                 //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
                //oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
            }
        }

        //validaciones para export
        private static void validacionExport(SAPbouiCOM.Form oForm)
        {
            //validaciones de campos para export
            SAPbouiCOM.ComboBox oDirePay = (SAPbouiCOM.ComboBox)oForm.Items.Item("226").Specific;//direccion paycode
            //SAPbouiCOM.ComboBox oDireShip = (SAPbouiCOM.ComboBox)oForm.Items.Item("40").Specific;//direccion shipcode
            SAPbouiCOM.ComboBox oDireShip = (SAPbouiCOM.ComboBox)oForm.Items.Item("40").Specific;//direccion shipcode
            SAPbouiCOM.EditText oCardCode = (SAPbouiCOM.EditText)oForm.Items.Item("4").Specific;//codigo del SN
            SAPbouiCOM.EditText oDocNum = (SAPbouiCOM.EditText)oForm.Items.Item("8").Specific;//DocNum
            SAPbouiCOM.Button oBtn = (SAPbouiCOM.Button)oForm.Items.Item("btnPDFEX").Specific;
            string v_direPay = oDirePay.Selected.Value.ToString();
            string v_direShip = oDireShip.Value.ToString();
            string v_cardcode = oCardCode.Value.ToString();
            string v_DocNum = oDocNum.Value.ToString();
            //si las direcciones estan vacías
            if (string.IsNullOrEmpty(v_direPay) && string.IsNullOrEmpty(v_direShip))
            {
                MessageBox.Show("La dirección en la factura no puede quedar vacío!!");
                oBtn.Caption = "Re-enviar";
                return;
            }
            //si hay datos vacíos del SN
            SAPbobsCOM.Recordset querySN;
            querySN = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
            querySN.DoQuery("SELECT \"IndustryC\",\"U_iNatRec\",\"U_iTipCont\" FROM OCRD WHERE \"CardCode\"='" + v_cardcode + "' ");
            string v_industry = querySN.Fields.Item(0).Value.ToString();
            string v_nat = querySN.Fields.Item(1).Value.ToString();
            string v_cont = querySN.Fields.Item(2).Value.ToString();
            //consulta apara el pais
            if (!string.IsNullOrEmpty(v_direShip))
            {
                SAPbobsCOM.Recordset paisSN;
                paisSN = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                paisSN.DoQuery("SELECT \"Country\" FROM CRD1 WHERE \"CardCode\"='" + v_cardcode + "' ");
                string v_pais = paisSN.Fields.Item(0).Value.ToString();
                if (string.IsNullOrEmpty(v_pais))
                {
                    MessageBox.Show("Se debe cargar el país del receptor!!");
                    oBtn.Caption = "Re-enviar";
                    return;
                }
            }
            if (!string.IsNullOrEmpty(v_direPay))
            {
                SAPbobsCOM.Recordset paisSN;
                paisSN = (SAPbobsCOM.Recordset)(Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                paisSN.DoQuery("SELECT \"Country\" FROM CRD1 WHERE \"CardCode\"='" + v_cardcode + "' ");
                string v_pais = paisSN.Fields.Item(0).Value.ToString();
                if (string.IsNullOrEmpty(v_pais))
                {
                    MessageBox.Show("Se debe cargar el país del receptor!!");
                    oBtn.Caption = "Re-enviar";
                    return;
                }
            }


            if (string.IsNullOrEmpty(v_industry))
            {
                MessageBox.Show("El tipo de operación del Socio de negocio no puede quedar vacío!!");
                oBtn.Caption = "Re-enviar";
                return;
            }
            else if (string.IsNullOrEmpty(v_nat))
            {
                MessageBox.Show("La naturaleza del receptor no puede quedar vacío!!");
                oBtn.Caption = "Re-enviar";
                return;
            }
            else if (string.IsNullOrEmpty(v_cont))
            {
                MessageBox.Show("El tipo de contribuyente del receptor no puede quedar vacío");
                oBtn.Caption = "Re-enviar";
                return;
            }
            else
            {
                SBO_Application.ActivateMenuItem("47667");//47660
                SAPbouiCOM.Form form = SBO_Application.Forms.ActiveForm;
            }
        }

        //funcion para crear documento SALONES
        private static void CrearDocumentoSalones(string codigo, string tablacab, string tabladet, string documento, string template, string descdoc)
        {
            try
            {
                BasicHttpBinding httpBinding = new BasicHttpBinding();
                httpBinding.MaxReceivedMessageSize = Int32.MaxValue;
                httpBinding.MaxBufferSize = Int32.MaxValue;

                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();
                //proceso para mandar documento
                //consultamos los datos del documento
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //consultamos cual direccion se eligio              
                oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",'sin direccion',CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                      "CASE WHEN T0.\"GroupNum\" IN (18,-1,55,19,10) THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\")) END," +
                                      "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",'Paraguay',T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                      "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                      "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                      "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  END \"HORA\", " +
                                      "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\",T0.\"DocTotal\",T0.\"U_docElectronico\", " +
                                      "T0.\"U_Trans\",T0.\"U_Chofer\",T0.\"U_Vehiculo\",'vacio','vacio','vacio',T13.\"U_SET_FE\", " +
                                      "'vacio','vacio','vacio','vacio','vacio','vacio','vacio',T0.\"NumAtCard\", " +
                                      "'vacio','vacio','vacio' ," +
                                      "T13.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"TransId\" " +
                                      "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                      "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" " +
                                      //"LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"AdresType\"='B'" +
                                      //"LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                      "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                      "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                      "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                      //"LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                      //"LEFT JOIN OCPR T12 ON T12.\"CardCode\"=T0.\"U_Trans\" AND T12.\"Name\"=T0.\"U_Chofer\" " +
                                      "LEFT JOIN  \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T0.\"U_ESTA\" " +
                                      //"LEFT JOIN OCRD T14 ON T14.\"CardCode\"=T0.\"U_Trans\" " +
                                      //"LEFT JOIN CRD1 T15 ON T15.\"CardCode\"=T14.\"CardCode\" AND T15.\"AdresType\"='B' " +
                                      //"LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T15.\"Country\" " +
                                      "WHERE T0.\"DocNum\"='" + codigo + "'");

                string Entry = oDatos.Fields.Item(0).Value.ToString();
                string electronico = oDatos.Fields.Item(30).Value.ToString();
                string trans = oDatos.Fields.Item(31).Value.ToString();
                string NumSerie = oDatos.Fields.Item(17).Value.ToString();
                string DocNum = oDatos.Fields.Item(45).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(46).Value.ToString();
                string rec_dist = oDatos.Fields.Item(47).Value.ToString();
                string rec_loc = oDatos.Fields.Item(48).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(49).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string RespFlete = oDatos.Fields.Item(50).Value.ToString();
                string transId = oDatos.Fields.Item(51).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                ////actualizamos el folio de la factura
                // Recordset oActFolio;
                // oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActFolio.DoQuery("UPDATE "+ tablacab + " SET \"U_ESTA\"='"+esta+"',\"U_PEMI\"='"+pun+"',\"FolioNum\"='"+folio.ToString()+"',\"U_TIMB\"='"+ timbrado + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                // //actualizamos la numeracion de la serie           
                // Recordset oActSerie;
                // oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                // oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());         
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                    //instaciamos los objetos que vutilizaremos
                }

                #region INSTANCIAR OBJETOS
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                //instanciamos varias lineas para el detalle
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                //linea 36
                servicio.gCamItem gCamItem36 = new servicio.gCamItem();
                servicio.gValorItem gValorItem36 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem36 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA36 = new servicio.gCamIVA();
                //linea 37
                servicio.gCamItem gCamItem37 = new servicio.gCamItem();
                servicio.gValorItem gValorItem37 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem37 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA37 = new servicio.gCamIVA();
                //linea 38
                servicio.gCamItem gCamItem38 = new servicio.gCamItem();
                servicio.gValorItem gValorItem38 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem38 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA38 = new servicio.gCamIVA();
                //linea 39
                servicio.gCamItem gCamItem39 = new servicio.gCamItem();
                servicio.gValorItem gValorItem39 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem39 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA39 = new servicio.gCamIVA();
                //linea 40
                servicio.gCamItem gCamItem40 = new servicio.gCamItem();
                servicio.gValorItem gValorItem40 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem40 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA40 = new servicio.gCamIVA();
                //linea 41
                servicio.gCamItem gCamItem41 = new servicio.gCamItem();
                servicio.gValorItem gValorItem41 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem41 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA41 = new servicio.gCamIVA();
                //linea 42
                servicio.gCamItem gCamItem42 = new servicio.gCamItem();
                servicio.gValorItem gValorItem42 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem42 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA42 = new servicio.gCamIVA();
                //linea 43
                servicio.gCamItem gCamItem43 = new servicio.gCamItem();
                servicio.gValorItem gValorItem43 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem43 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA43 = new servicio.gCamIVA();
                //linea 44
                servicio.gCamItem gCamItem44 = new servicio.gCamItem();
                servicio.gValorItem gValorItem44 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem44 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA44 = new servicio.gCamIVA();
                //linea 45
                servicio.gCamItem gCamItem45 = new servicio.gCamItem();
                servicio.gValorItem gValorItem45 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem45 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA45 = new servicio.gCamIVA();
                #endregion
                #endregion

                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                //gTimb
                gTimb.iTiDE = documento;
                gTimb.dDesTiDE = descdoc;
                gTimb.dNumTim = timbrado;
                gTimb.dEst = esta;
                gTimb.dPunExp = pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gOpeCom
                //tipo de transaccion
                string transaccion = oDatos.Fields.Item(23).Value.ToString();
                string TipTra = null;
                string DesTipTra = null;
                if (transaccion.Equals("1")) { TipTra = "1"; DesTipTra = "Venta de mercadería"; }
                if (transaccion.Equals("2")) { TipTra = "2"; DesTipTra = "Prestación de servicios"; }
                if (transaccion.Equals("3")) { TipTra = "3"; DesTipTra = "Mixto (Venta de mercadería y servicios) "; }
                if (transaccion.Equals("4")) { TipTra = "4"; DesTipTra = "Venta de activo fijo"; }
                if (transaccion.Equals("5")) { TipTra = "5"; DesTipTra = "Venta de divisas"; }
                if (transaccion.Equals("6")) { TipTra = "6"; DesTipTra = "Compra de divisas"; }
                if (transaccion.Equals("7")) { TipTra = "7"; DesTipTra = "Promoción o entrega de muestras"; }
                if (transaccion.Equals("8")) { TipTra = "8"; DesTipTra = "Donación"; }
                if (transaccion.Equals("9")) { TipTra = "9"; DesTipTra = "Anticipo"; }
                if (transaccion.Equals("10")) { TipTra = "10"; DesTipTra = "Compra de productos"; }
                if (transaccion.Equals("11")) { TipTra = "11"; DesTipTra = "Compra de servicios"; }
                if (transaccion.Equals("12")) { TipTra = "12"; DesTipTra = "Venta de crédito fiscal"; }
                if (transaccion.Equals("13")) { TipTra = "13"; DesTipTra = "Muestras médicas (Art. 3 RG 24 / 2014)"; }

                gOpeCom.iTipTra = TipTra;// oDatos.Fields.Item(23).Value.ToString();
                gOpeCom.dDesTipTra = DesTipTra;// "Venta de mercadería";
                gOpeCom.iTImp = oDatos.Fields.Item(24).Value.ToString();
                gOpeCom.cMoneOpe = oDatos.Fields.Item(8).Value.ToString();
                //en caso de que sea DOLAR
                if (oDatos.Fields.Item(8).Value.ToString() == "USD")
                {
                    gOpeCom.dCondTiCam = "1";
                    gOpeCom.dTiCam = decimal.Parse(oDatos.Fields.Item(28).Value.ToString());
                    gOpeCom.dTiCamSpecified = true;
                }
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                if (oDatos.Fields.Item(26).Value.ToString() == "2")
                {
                    gDatRec.iTiOpe = "2";
                    //gDatRec.iTiContRec = "1";
                }
                else
                {
                    gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                }
                //gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                gDatRec.cPaisRec = "PRY";// oDatos.Fields.Item(16).Value.ToString();
                //gDatRec.dDesPaisRe = "Paraguay";

                if (tablacab.Equals("ORIN"))
                {
                    gCamNCDE.iMotEmi = "1";//hay que modificar
                }
                //si es contribuyente le pasamos el ruc sino la cedula
                if (oDatos.Fields.Item(26).Value.ToString() == "1")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                }
                else
                {
                    gDatRec.dNumIDRec = oDatos.Fields.Item(4).Value.ToString();
                    gDatRec.iTipIDRec = "1";
                }



                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                                                                         //gDatRec.dDirRec = oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                                                                         //gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                                                                         //consultamos si es credito o contado a operacion
                string condicion = oDatos.Fields.Item(9).Value.ToString();
                if (tablacab.Equals("OINV"))
                {
                    //gCamFE
                    gCamFE.iIndPres = oDatos.Fields.Item(22).Value.ToString();
                    //gCamCond
                    gCamCond.iCondOpe = oDatos.Fields.Item(9).Value.ToString(); //"2";               

                    if (oDatos.Fields.Item(9).Value.ToString() == "2")
                    {
                        //consultamos si el campo de cuota es mayor a cero
                        int Cuota = int.Parse(oDatos.Fields.Item(20).Value.ToString());
                        string concred = null;
                        if (Cuota > 0)
                        {
                            concred = "2";
                        }
                        else
                        {
                            concred = "1";
                        }
                        if (concred.Equals("2"))
                        {
                            gPagCred.dCuotas = Cuota.ToString();
                            gPagCred.iCondCred = concred;
                        }
                        else
                        {
                            //gPagCred
                            int plazo = int.Parse(oDatos.Fields.Item(10).Value.ToString());
                            gPagCred.dPlazoCre = plazo.ToString("D2");//oDatos.Fields.Item(10).Value.ToString(); //"12";
                            gPagCred.iCondCred = concred;
                        }
                    }
                }
                //si es contado mandamos el tipo de pago
                if (condicion.Equals("1"))
                {
                    gPaConEIni.iTiPago = "1";
                    gPaConEIni.dMonTiPag = decimal.Parse(oDatos.Fields.Item(29).Value.ToString());
                    gPaConEIni.cMoneTiPag = oDatos.Fields.Item(8).Value.ToString();
                    gPaConEIni1[0] = gPaConEIni;
                }
                //gCamItem
                int f = 0;
                //gCamItem1.Initialize();
                //recorremos el recordset y mandamos los datos del detalle al objeto

                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                while (!oDatos.EoF)
                {
                    #region DETALLE DOCUMENTO
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                       //gValorItem
                        gValorItem.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA.iAfecIVA = "1";
                            gCamIVA.dPropIVA = 100;
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA.dPropIVA = 100;
                                    gCamIVA.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA.iAfecIVA = "3";
                            gCamIVA.dBasGravIVA = 0;
                            gCamIVA.dLiqIVAItem = 0;
                        }
                        gCamIVA.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem.gValorRestaItem = gValorRestaItem;
                        gCamItem.gValorItem = gValorItem;
                        gCamItem.gCamIVA = gCamIVA;
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem2.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem2.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem2.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem2.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA2.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA2.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA2.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA2.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA2.dPropIVA = 100;
                                    gCamIVA2.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA2.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA2.iAfecIVA = "3";
                            gCamIVA2.dBasGravIVA = 0;
                            gCamIVA2.dLiqIVAItem = 0;
                        }
                        gCamIVA2.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem2.gValorRestaItem = gValorRestaItem2;
                        gCamItem2.gValorItem = gValorItem2;
                        gCamItem2.gCamIVA = gCamIVA2;
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {
                        gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem3.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem3.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem3.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem3.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA3.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA3.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA3.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA3.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA3.dPropIVA = 100;
                                    gCamIVA3.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA3.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA3.iAfecIVA = "3";
                            gCamIVA3.dBasGravIVA = 0;
                            gCamIVA3.dLiqIVAItem = 0;
                        }
                        gCamIVA3.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem3.gValorRestaItem = gValorRestaItem3;
                        gCamItem3.gValorItem = gValorItem3;
                        gCamItem3.gCamIVA = gCamIVA3;
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem4.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem4.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem4.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem4.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA4.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA4.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA4.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA4.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA4.dPropIVA = 100;
                                    gCamIVA4.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA4.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA4.iAfecIVA = "3";
                            gCamIVA4.dBasGravIVA = 0;
                            gCamIVA4.dLiqIVAItem = 0;
                        }
                        gCamIVA4.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem4.gValorRestaItem = gValorRestaItem4;
                        gCamItem4.gValorItem = gValorItem4;
                        gCamItem4.gCamIVA = gCamIVA4;
                        gCamItem1[f] = gCamItem4;
                    }
                    if (f == 4)
                    {
                        gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem5.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem5.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem5.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem5.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA5.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA5.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA5.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA5.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA5.dPropIVA = 100;
                                    gCamIVA5.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA5.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA5.iAfecIVA = "3";
                            gCamIVA5.dBasGravIVA = 0;
                            gCamIVA5.dLiqIVAItem = 0;
                        }
                        gCamIVA5.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem5.gValorRestaItem = gValorRestaItem5;
                        gCamItem5.gValorItem = gValorItem5;
                        gCamItem5.gCamIVA = gCamIVA5;
                        gCamItem1[f] = gCamItem5;
                    }
                    if (f == 5)
                    {
                        gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem6.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem6.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem6.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem6.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA6.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA6.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA6.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA6.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA6.dPropIVA = 100;
                                    gCamIVA6.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA6.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA6.iAfecIVA = "3";
                            gCamIVA6.dBasGravIVA = 0;
                            gCamIVA6.dLiqIVAItem = 0;
                        }
                        gCamIVA6.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem6.gValorRestaItem = gValorRestaItem6;
                        gCamItem6.gValorItem = gValorItem6;
                        gCamItem6.gCamIVA = gCamIVA6;
                        gCamItem1[f] = gCamItem6;
                    }
                    if (f == 6)
                    {
                        gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem7.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem7.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem7.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem7.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA7.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA7.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA7.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA7.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA7.dPropIVA = 100;
                                    gCamIVA7.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA7.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA7.iAfecIVA = "3";
                            gCamIVA7.dBasGravIVA = 0;
                            gCamIVA7.dLiqIVAItem = 0;
                        }
                        gCamIVA7.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem7.gValorRestaItem = gValorRestaItem7;
                        gCamItem7.gValorItem = gValorItem7;
                        gCamItem7.gCamIVA = gCamIVA7;
                        gCamItem1[f] = gCamItem7;
                    }
                    if (f == 7)
                    {
                        gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem8.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem8.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem8.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem8.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA8.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA8.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA8.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA8.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA8.dPropIVA = 100;
                                    gCamIVA8.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA8.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA8.iAfecIVA = "3";
                            gCamIVA8.dBasGravIVA = 0;
                            gCamIVA8.dLiqIVAItem = 0;
                        }
                        gCamIVA8.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem8.gValorRestaItem = gValorRestaItem8;
                        gCamItem8.gValorItem = gValorItem8;
                        gCamItem8.gCamIVA = gCamIVA8;
                        gCamItem1[f] = gCamItem8;
                    }
                    if (f == 8)
                    {
                        gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                        //gValorItem
                        gValorItem9.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem9.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem9.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem9.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA9.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA9.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA9.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA9.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA9.dPropIVA = 100;
                                    gCamIVA9.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA9.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA9.iAfecIVA = "3";
                            gCamIVA9.dBasGravIVA = 0;
                            gCamIVA9.dLiqIVAItem = 0;
                        }
                        gCamIVA9.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem9.gValorRestaItem = gValorRestaItem9;
                        gCamItem9.gValorItem = gValorItem9;
                        gCamItem9.gCamIVA = gCamIVA9;
                        gCamItem1[f] = gCamItem9;
                    }
                    if (f == 9)
                    {
                        gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem10.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem10.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem10.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem10.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA10.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA10.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA10.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA10.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA10.dPropIVA = 100;
                                    gCamIVA10.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA10.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA10.iAfecIVA = "3";
                            gCamIVA10.dBasGravIVA = 0;
                            gCamIVA10.dLiqIVAItem = 0;
                        }
                        gCamIVA10.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem10.gValorRestaItem = gValorRestaItem10;
                        gCamItem10.gValorItem = gValorItem10;
                        gCamItem10.gCamIVA = gCamIVA10;
                        gCamItem1[f] = gCamItem10;
                    }
                    if (f == 10)
                    {
                        gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem11.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem11.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem11.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem11.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA11.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA11.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA11.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA11.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA11.dPropIVA = 100;
                                    gCamIVA11.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA11.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA11.iAfecIVA = "3";
                            gCamIVA11.dBasGravIVA = 0;
                            gCamIVA11.dLiqIVAItem = 0;
                        }
                        gCamIVA11.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem11.gValorRestaItem = gValorRestaItem11;
                        gCamItem11.gValorItem = gValorItem11;
                        gCamItem11.gCamIVA = gCamIVA11;
                        gCamItem1[f] = gCamItem11;
                    }
                    if (f == 11)
                    {
                        gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem12.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem12.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem12.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem12.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA12.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA12.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA12.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA12.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA12.dPropIVA = 100;
                                    gCamIVA12.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA12.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA12.iAfecIVA = "3";
                            gCamIVA12.dBasGravIVA = 0;
                            gCamIVA12.dLiqIVAItem = 0;
                        }
                        gCamIVA12.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem12.gValorRestaItem = gValorRestaItem12;
                        gCamItem12.gValorItem = gValorItem12;
                        gCamItem12.gCamIVA = gCamIVA12;
                        gCamItem1[f] = gCamItem12;
                    }
                    if (f == 12)
                    {
                        gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem13.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem13.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem13.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem13.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA13.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA13.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA13.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA13.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA13.dPropIVA = 100;
                                    gCamIVA13.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA13.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA13.iAfecIVA = "3";
                            gCamIVA13.dBasGravIVA = 0;
                            gCamIVA13.dLiqIVAItem = 0;
                        }
                        gCamIVA13.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem13.gValorRestaItem = gValorRestaItem13;
                        gCamItem13.gValorItem = gValorItem13;
                        gCamItem13.gCamIVA = gCamIVA13;
                        gCamItem1[f] = gCamItem13;
                    }
                    if (f == 13)
                    {
                        gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem14.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem14.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem14.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem14.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA14.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA14.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA14.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA14.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA14.dPropIVA = 100;
                                    gCamIVA14.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA14.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA14.iAfecIVA = "3";
                            gCamIVA14.dBasGravIVA = 0;
                            gCamIVA14.dLiqIVAItem = 0;
                        }
                        gCamIVA14.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem14.gValorRestaItem = gValorRestaItem14;
                        gCamItem14.gValorItem = gValorItem14;
                        gCamItem14.gCamIVA = gCamIVA14;
                        gCamItem1[f] = gCamItem14;
                    }
                    if (f == 14)
                    {
                        gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem15.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem15.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem15.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem15.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA15.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA15.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA15.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA15.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA15.dPropIVA = 100;
                                    gCamIVA15.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA15.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA15.iAfecIVA = "3";
                            gCamIVA15.dBasGravIVA = 0;
                            gCamIVA15.dLiqIVAItem = 0;
                        }
                        gCamIVA15.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem15.gValorRestaItem = gValorRestaItem15;
                        gCamItem15.gValorItem = gValorItem15;
                        gCamItem15.gCamIVA = gCamIVA15;
                        gCamItem1[f] = gCamItem15;
                    }
                    if (f == 15)
                    {
                        gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem16.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem16.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem16.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem16.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA16.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA16.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA16.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA16.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA16.dPropIVA = 100;
                                    gCamIVA16.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA16.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA16.iAfecIVA = "3";
                            gCamIVA16.dBasGravIVA = 0;
                            gCamIVA16.dLiqIVAItem = 0;
                        }
                        gCamIVA16.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem16.gValorRestaItem = gValorRestaItem16;
                        gCamItem16.gValorItem = gValorItem16;
                        gCamItem16.gCamIVA = gCamIVA16;
                        gCamItem1[f] = gCamItem16;
                    }
                    if (f == 16)
                    {
                        gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem17.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem17.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem17.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem17.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA17.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA17.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA17.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA17.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA17.dPropIVA = 100;
                                    gCamIVA17.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA17.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA17.iAfecIVA = "3";
                            gCamIVA17.dBasGravIVA = 0;
                            gCamIVA17.dLiqIVAItem = 0;
                        }
                        gCamIVA17.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem17.gValorRestaItem = gValorRestaItem17;
                        gCamItem17.gValorItem = gValorItem17;
                        gCamItem17.gCamIVA = gCamIVA17;
                        gCamItem1[f] = gCamItem17;
                    }
                    if (f == 17)
                    {
                        gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem18.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem18.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem18.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem18.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA18.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA18.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA18.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA18.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA18.dPropIVA = 100;
                                    gCamIVA18.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA18.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA18.iAfecIVA = "3";
                            gCamIVA18.dBasGravIVA = 0;
                            gCamIVA18.dLiqIVAItem = 0;
                        }
                        gCamIVA18.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem18.gValorRestaItem = gValorRestaItem18;
                        gCamItem18.gValorItem = gValorItem18;
                        gCamItem18.gCamIVA = gCamIVA18;
                        gCamItem1[f] = gCamItem18;
                    }
                    if (f == 18)
                    {
                        gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem19.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem19.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem19.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem19.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA19.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA19.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA19.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA19.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA19.dPropIVA = 100;
                                    gCamIVA19.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA19.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA19.iAfecIVA = "3";
                            gCamIVA19.dBasGravIVA = 0;
                            gCamIVA19.dLiqIVAItem = 0;
                        }
                        gCamIVA19.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem19.gValorRestaItem = gValorRestaItem19;
                        gCamItem19.gValorItem = gValorItem19;
                        gCamItem19.gCamIVA = gCamIVA19;
                        gCamItem1[f] = gCamItem19;
                    }
                    if (f == 19)
                    {
                        gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem20.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem20.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem20.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem20.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA20.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA20.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA20.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA20.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA20.dPropIVA = 100;
                                    gCamIVA20.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA20.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA20.iAfecIVA = "3";
                            gCamIVA20.dBasGravIVA = 0;
                            gCamIVA20.dLiqIVAItem = 0;
                        }
                        gCamIVA20.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem20.gValorRestaItem = gValorRestaItem20;
                        gCamItem20.gValorItem = gValorItem20;
                        gCamItem20.gCamIVA = gCamIVA20;
                        gCamItem1[f] = gCamItem20;
                    }
                    if (f == 20)
                    {
                        gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem21.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem21.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem21.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem21.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA21.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA21.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA21.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA21.dPropIVA = 100;
                                    gCamIVA21.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA21.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA21.iAfecIVA = "3";
                            gCamIVA21.dBasGravIVA = 0;
                            gCamIVA21.dLiqIVAItem = 0;
                        }
                        gCamIVA21.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem21.gValorRestaItem = gValorRestaItem21;
                        gCamItem21.gValorItem = gValorItem21;
                        gCamItem21.gCamIVA = gCamIVA21;
                        gCamItem1[f] = gCamItem21;
                    }
                    if (f == 21)
                    {
                        gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem22.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem22.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem22.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem22.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA22.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA22.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA22.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA22.dPropIVA = 100;
                                    gCamIVA22.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA22.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA22.iAfecIVA = "3";
                            gCamIVA22.dBasGravIVA = 0;
                            gCamIVA22.dLiqIVAItem = 0;
                        }
                        gCamIVA22.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem22.gValorRestaItem = gValorRestaItem22;
                        gCamItem22.gValorItem = gValorItem22;
                        gCamItem22.gCamIVA = gCamIVA22;
                        gCamItem1[f] = gCamItem22;
                    }
                    if (f == 22)
                    {
                        gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem23.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem23.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem23.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem23.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA23.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA23.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA23.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA23.dPropIVA = 100;
                                    gCamIVA23.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA23.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA23.iAfecIVA = "3";
                            gCamIVA23.dBasGravIVA = 0;
                            gCamIVA23.dLiqIVAItem = 0;
                        }
                        gCamIVA23.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem23.gValorRestaItem = gValorRestaItem23;
                        gCamItem23.gValorItem = gValorItem23;
                        gCamItem23.gCamIVA = gCamIVA23;
                        gCamItem1[f] = gCamItem23;
                    }
                    if (f == 23)
                    {
                        gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem24.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem24.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem24.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem24.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA24.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA24.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA24.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA24.dPropIVA = 100;
                                    gCamIVA24.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA24.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA24.iAfecIVA = "3";
                            gCamIVA24.dBasGravIVA = 0;
                            gCamIVA24.dLiqIVAItem = 0;
                        }
                        gCamIVA24.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem24.gValorRestaItem = gValorRestaItem24;
                        gCamItem24.gValorItem = gValorItem24;
                        gCamItem24.gCamIVA = gCamIVA24;
                        gCamItem1[f] = gCamItem24;
                    }
                    if (f == 24)
                    {
                        gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem25.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem25.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem25.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem25.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA25.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA25.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA25.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA25.dPropIVA = 100;
                                    gCamIVA25.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA25.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA25.iAfecIVA = "3";
                            gCamIVA25.dBasGravIVA = 0;
                            gCamIVA25.dLiqIVAItem = 0;
                        }
                        gCamIVA25.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem25.gValorRestaItem = gValorRestaItem25;
                        gCamItem25.gValorItem = gValorItem25;
                        gCamItem25.gCamIVA = gCamIVA25;
                        gCamItem1[f] = gCamItem25;
                    }
                    if (f == 25)
                    {
                        gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem26.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem26.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem26.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem26.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA26.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA26.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA26.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA26.dPropIVA = 100;
                                    gCamIVA26.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA26.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA26.iAfecIVA = "3";
                            gCamIVA26.dBasGravIVA = 0;
                            gCamIVA26.dLiqIVAItem = 0;
                        }
                        gCamIVA26.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem26.gValorRestaItem = gValorRestaItem26;
                        gCamItem26.gValorItem = gValorItem26;
                        gCamItem26.gCamIVA = gCamIVA26;
                        gCamItem1[f] = gCamItem26;
                    }
                    if (f == 26)
                    {
                        gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem27.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem27.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem27.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem27.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA27.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA27.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA27.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA27.dPropIVA = 100;
                                    gCamIVA27.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA27.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA27.iAfecIVA = "3";
                            gCamIVA27.dBasGravIVA = 0;
                            gCamIVA27.dLiqIVAItem = 0;
                        }
                        gCamIVA27.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem27.gValorRestaItem = gValorRestaItem27;
                        gCamItem27.gValorItem = gValorItem27;
                        gCamItem27.gCamIVA = gCamIVA27;
                        gCamItem1[f] = gCamItem27;
                    }
                    if (f == 27)
                    {
                        gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem28.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem28.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem28.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem28.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA28.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA28.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA28.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA28.dPropIVA = 100;
                                    gCamIVA28.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA28.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA28.iAfecIVA = "3";
                            gCamIVA28.dBasGravIVA = 0;
                            gCamIVA28.dLiqIVAItem = 0;
                        }
                        gCamIVA28.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem28.gValorRestaItem = gValorRestaItem28;
                        gCamItem28.gValorItem = gValorItem28;
                        gCamItem28.gCamIVA = gCamIVA28;
                        gCamItem1[f] = gCamItem28;
                    }
                    if (f == 28)
                    {
                        gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem29.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem29.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem29.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem29.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA29.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA29.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA29.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA29.dPropIVA = 100;
                                    gCamIVA29.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA29.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA29.iAfecIVA = "3";
                            gCamIVA29.dBasGravIVA = 0;
                            gCamIVA29.dLiqIVAItem = 0;
                        }
                        gCamIVA29.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem29.gValorRestaItem = gValorRestaItem29;
                        gCamItem29.gValorItem = gValorItem29;
                        gCamItem29.gCamIVA = gCamIVA29;
                        gCamItem1[f] = gCamItem29;
                    }
                    if (f == 29)
                    {
                        gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem30.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem30.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem30.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem30.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA30.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA30.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA30.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA30.dPropIVA = 100;
                                    gCamIVA30.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA30.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA30.iAfecIVA = "3";
                            gCamIVA30.dBasGravIVA = 0;
                            gCamIVA30.dLiqIVAItem = 0;
                        }
                        gCamIVA30.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem30.gValorRestaItem = gValorRestaItem30;
                        gCamItem30.gValorItem = gValorItem30;
                        gCamItem30.gCamIVA = gCamIVA30;
                        gCamItem1[f] = gCamItem30;
                    }
                    if (f == 30)
                    {
                        gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem31.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem31.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem31.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem31.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA31.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA31.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA31.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA31.dPropIVA = 100;
                                    gCamIVA31.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA31.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA31.iAfecIVA = "3";
                            gCamIVA31.dBasGravIVA = 0;
                            gCamIVA31.dLiqIVAItem = 0;
                        }
                        gCamIVA31.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem31.gValorRestaItem = gValorRestaItem31;
                        gCamItem31.gValorItem = gValorItem31;
                        gCamItem31.gCamIVA = gCamIVA31;
                        gCamItem1[f] = gCamItem31;
                    }
                    if (f == 31)
                    {
                        gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem32.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem32.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem32.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem32.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA32.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA32.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA32.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA32.dPropIVA = 100;
                                    gCamIVA32.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA32.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA32.iAfecIVA = "3";
                            gCamIVA32.dBasGravIVA = 0;
                            gCamIVA32.dLiqIVAItem = 0;
                        }
                        gCamIVA32.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem32.gValorRestaItem = gValorRestaItem32;
                        gCamItem32.gValorItem = gValorItem32;
                        gCamItem32.gCamIVA = gCamIVA32;
                        gCamItem1[f] = gCamItem32;
                    }
                    if (f == 32)
                    {
                        gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem33.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem33.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem33.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem33.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA33.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA33.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA33.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA33.dPropIVA = 100;
                                    gCamIVA33.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA33.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA33.iAfecIVA = "3";
                            gCamIVA33.dBasGravIVA = 0;
                            gCamIVA33.dLiqIVAItem = 0;
                        }
                        gCamIVA33.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem33.gValorRestaItem = gValorRestaItem33;
                        gCamItem33.gValorItem = gValorItem33;
                        gCamItem33.gCamIVA = gCamIVA33;
                        gCamItem1[f] = gCamItem33;
                    }
                    if (f == 33)
                    {
                        gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem34.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem34.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem34.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem34.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA34.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA34.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA34.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA34.dPropIVA = 100;
                                    gCamIVA34.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA34.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA34.iAfecIVA = "3";
                            gCamIVA34.dBasGravIVA = 0;
                            gCamIVA34.dLiqIVAItem = 0;
                        }
                        gCamIVA34.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem34.gValorRestaItem = gValorRestaItem34;
                        gCamItem34.gValorItem = gValorItem34;
                        gCamItem34.gCamIVA = gCamIVA34;
                        gCamItem1[f] = gCamItem34;
                    }
                    if (f == 34)
                    {
                        gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem35.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem35.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem35.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem35.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA35.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA35.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA35.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA35.dPropIVA = 100;
                                    gCamIVA35.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA35.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA35.iAfecIVA = "3";
                            gCamIVA35.dBasGravIVA = 0;
                            gCamIVA35.dLiqIVAItem = 0;
                        }
                        gCamIVA35.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem35.gValorRestaItem = gValorRestaItem35;
                        gCamItem35.gValorItem = gValorItem35;
                        gCamItem35.gCamIVA = gCamIVA35;
                        gCamItem1[f] = gCamItem35;
                    }
                    if (f == 35)
                    {
                        gCamItem36.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem36.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem36.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem36.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem36.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem36.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem36.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA36.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA36.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA36.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA36.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA36.dPropIVA = 100;
                                    gCamIVA36.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA36.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA36.iAfecIVA = "3";
                            gCamIVA36.dBasGravIVA = 0;
                            gCamIVA36.dLiqIVAItem = 0;
                        }
                        gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem36.gValorRestaItem = gValorRestaItem36;
                        gCamItem36.gValorItem = gValorItem36;
                        gCamItem36.gCamIVA = gCamIVA36;
                        gCamItem1[f] = gCamItem36;
                    }
                    if (f == 36)
                    {
                        gCamItem37.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem37.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem37.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem37.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem37.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem37.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem37.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA37.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA37.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA37.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA37.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA37.dPropIVA = 100;
                                    gCamIVA37.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA37.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA37.iAfecIVA = "3";
                            gCamIVA37.dBasGravIVA = 0;
                            gCamIVA37.dLiqIVAItem = 0;
                        }
                        gCamIVA37.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem37.gValorRestaItem = gValorRestaItem37;
                        gCamItem37.gValorItem = gValorItem37;
                        gCamItem37.gCamIVA = gCamIVA37;
                        gCamItem1[f] = gCamItem37;
                    }
                    if (f == 37)
                    {
                        gCamItem38.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem38.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem38.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem38.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem38.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem38.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem38.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA38.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA38.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA38.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA38.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA38.dPropIVA = 100;
                                    gCamIVA38.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA38.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA38.iAfecIVA = "3";
                            gCamIVA38.dBasGravIVA = 0;
                            gCamIVA38.dLiqIVAItem = 0;
                        }
                        gCamIVA38.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem38.gValorRestaItem = gValorRestaItem38;
                        gCamItem38.gValorItem = gValorItem38;
                        gCamItem38.gCamIVA = gCamIVA38;
                        gCamItem1[f] = gCamItem38;
                    }
                    if (f == 38)
                    {
                        gCamItem39.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem39.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem39.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem39.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem39.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem39.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem39.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA39.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA39.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA39.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA39.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA39.dPropIVA = 100;
                                    gCamIVA39.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA39.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA39.iAfecIVA = "3";
                            gCamIVA39.dBasGravIVA = 0;
                            gCamIVA39.dLiqIVAItem = 0;
                        }
                        gCamIVA36.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem39.gValorRestaItem = gValorRestaItem39;
                        gCamItem39.gValorItem = gValorItem39;
                        gCamItem39.gCamIVA = gCamIVA39;
                        gCamItem1[f] = gCamItem39;
                    }
                    if (f == 39)
                    {
                        gCamItem40.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem40.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem40.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem40.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem40.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem40.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem40.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA40.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA40.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA40.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA40.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA40.dPropIVA = 100;
                                    gCamIVA40.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA40.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA40.iAfecIVA = "3";
                            gCamIVA40.dBasGravIVA = 0;
                            gCamIVA40.dLiqIVAItem = 0;
                        }
                        gCamIVA40.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem40.gValorRestaItem = gValorRestaItem40;
                        gCamItem40.gValorItem = gValorItem40;
                        gCamItem40.gCamIVA = gCamIVA40;
                        gCamItem1[f] = gCamItem40;
                    }
                    if (f == 40)
                    {
                        gCamItem41.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem41.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem41.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem41.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem41.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem41.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem41.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA41.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA41.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA41.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA41.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA41.dPropIVA = 100;
                                    gCamIVA41.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA41.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA41.iAfecIVA = "3";
                            gCamIVA41.dBasGravIVA = 0;
                            gCamIVA41.dLiqIVAItem = 0;
                        }
                        gCamIVA41.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem41.gValorRestaItem = gValorRestaItem41;
                        gCamItem41.gValorItem = gValorItem41;
                        gCamItem41.gCamIVA = gCamIVA41;
                        gCamItem1[f] = gCamItem41;
                    }
                    if (f == 41)
                    {
                        gCamItem42.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem42.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem42.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem42.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem42.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem42.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem42.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA42.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA42.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA42.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA42.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA42.dPropIVA = 100;
                                    gCamIVA42.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA42.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA42.iAfecIVA = "3";
                            gCamIVA42.dBasGravIVA = 0;
                            gCamIVA42.dLiqIVAItem = 0;
                        }
                        gCamIVA42.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem42.gValorRestaItem = gValorRestaItem42;
                        gCamItem42.gValorItem = gValorItem42;
                        gCamItem42.gCamIVA = gCamIVA42;
                        gCamItem1[f] = gCamItem42;
                    }
                    if (f == 42)
                    {
                        gCamItem43.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem43.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem43.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem43.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem43.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem43.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem43.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA43.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA43.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA43.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA43.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA43.dPropIVA = 100;
                                    gCamIVA43.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA43.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA43.iAfecIVA = "3";
                            gCamIVA43.dBasGravIVA = 0;
                            gCamIVA43.dLiqIVAItem = 0;
                        }
                        gCamIVA43.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem43.gValorRestaItem = gValorRestaItem43;
                        gCamItem43.gValorItem = gValorItem43;
                        gCamItem43.gCamIVA = gCamIVA43;
                        gCamItem1[f] = gCamItem43;
                    }
                    if (f == 43)
                    {
                        gCamItem44.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem44.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem44.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem44.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem44.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem44.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem44.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA44.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA44.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA44.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA44.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA44.dPropIVA = 100;
                                    gCamIVA44.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA44.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA44.iAfecIVA = "3";
                            gCamIVA44.dBasGravIVA = 0;
                            gCamIVA44.dLiqIVAItem = 0;
                        }
                        gCamIVA44.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem44.gValorRestaItem = gValorRestaItem44;
                        gCamItem44.gValorItem = gValorItem44;
                        gCamItem44.gCamIVA = gCamIVA44;
                        gCamItem1[f] = gCamItem44;
                    }
                    if (f == 44)
                    {
                        gCamItem45.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem45.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem45.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                                                                                                         //gValorItem
                        gValorItem45.dPUniProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //11364;
                        gValorItem45.dTotBruOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gValorRestaItem
                        gValorRestaItem45.dDescItem = 0;
                        //gValorRestaItem.dAntPreUniIt = 0;
                        //gValorRestaItem.dTotOpeItem = 0;  
                        gValorRestaItem45.dTotOpeItem = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        //gCamIVA
                        string IVA = oDatos.Fields.Item(15).Value.ToString();
                        if (IVA.Equals("5") || IVA.Equals("10"))
                        {
                            gCamIVA45.iAfecIVA = "1";
                            if (IVA.Equals("10"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                    gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1")));
                                }
                                else
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1");
                                    gCamIVA45.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,1"));
                                }

                            }
                            if (IVA.Equals("5"))
                            {
                                if (oDatos.Fields.Item(8).Value.ToString() == "PYG")
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    decimal valor = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                                    gCamIVA45.dBasGravIVA = Math.Round(valor / decimal.Parse("1,05"));
                                    gCamIVA45.dLiqIVAItem = Math.Round((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05")));
                                }
                                else
                                {
                                    gCamIVA45.dPropIVA = 100;
                                    gCamIVA45.dBasGravIVA = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05");
                                    gCamIVA45.dLiqIVAItem = (decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) - ((decimal.Parse(oDatos.Fields.Item(14).Value.ToString()) * decimal.Parse(oDatos.Fields.Item(13).Value.ToString())) / decimal.Parse("1,05"));
                                }

                            }

                        }
                        else if (IVA.Equals("0"))
                        {
                            gCamIVA45.iAfecIVA = "3";
                            gCamIVA45.dBasGravIVA = 0;
                            gCamIVA45.dLiqIVAItem = 0;
                        }
                        gCamIVA45.dTasaIVA = oDatos.Fields.Item(15).Value.ToString(); //"10";

                        gValorItem45.gValorRestaItem = gValorRestaItem45;
                        gCamItem45.gValorItem = gValorItem45;
                        gCamItem45.gCamIVA = gCamIVA45;
                        gCamItem1[f] = gCamItem45;
                    }
                    #endregion


                    f++;
                    oDatos.MoveNext();
                    if (false == oCompany.InTransaction)
                    {
                        oCompany.StartTransaction();
                    }
                }
                //conexion
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = template;
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                if (tablacab.Equals("OINV"))
                {
                    gDtipDE.gCamFE = gCamFE;
                    gDtipDE.gCamCond = gCamCond;
                }
                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gOpeCom = gOpeCom;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;

                gCamEsp.gGrupSup = gGrupSup;
                if (condicion.Equals("2") && tablacab.Equals("OINV"))
                {
                    gCamCond.gPagCred = gPagCred;

                }
                if (tablacab.Equals("ORIN") && electronico.Equals("Si"))
                {

                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //DocAsoc.DoQuery("SELECT T2.\"U_CDC\" FROM ORIN T0 INNER JOIN RIN1 T1 ON T0.\"DocEntry\"=t1.\"DocEntry\" INNER JOIN OINV T2 ON T1.\"BaseEntry\"=t2.\"DocEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_CDC\" FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "1";
                        gCamDEAsoc.dCdCDERef = DocAsoc.Fields.Item(0).Value.ToString();
                        DocAsoc.MoveNext();
                    }
                }
                if (tablacab.Equals("ORIN") && electronico.Equals("No"))
                {
                    //consultamos por el documento asociado
                    Recordset DocAsoc;
                    DocAsoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    // DocAsoc.DoQuery("SELECT T1.\"U_TIMB\",T1.\"U_ESTA\",T1.\"U_PEMI\",T1.\"FolioNum\",T1.\"DocDate\" FROM RIN1 T0 LEFT JOIN OINV T1 ON T1.\"DocEntry\"=T0.\"BaseEntry\" WHERE T0.\"DocEntry\"='" + Entry + "'");
                    DocAsoc.DoQuery("SELECT T0.\"U_TIMB\",T0.\"U_ESTA\",T0.\"U_PEMI\",T0.\"FolioNum\",T0.\"DocDate\", " +
                                    "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN '0'||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\" " +
                                    "FROM  OINV T0  WHERE T0.\"DocNum\"='" + DocNum + "'");
                    while (!DocAsoc.EoF)
                    {
                        gDtipDE.gCamNCDE = gCamNCDE;
                        DE.gCamDEAsoc = gCamDEAsoc1;
                        gCamDEAsoc1[0] = gCamDEAsoc;
                        gCamDEAsoc.iTipDocAso = "2";
                        gCamDEAsoc.dNTimDI = DocAsoc.Fields.Item(0).Value.ToString();//timbrado
                        gCamDEAsoc.dEstDocAso = DocAsoc.Fields.Item(1).Value.ToString();//establecimiento
                        gCamDEAsoc.dPExpDocAso = DocAsoc.Fields.Item(2).Value.ToString();//punto de expedicion
                        gCamDEAsoc.dNumDocAso = DocAsoc.Fields.Item(3).Value.ToString(); ;//folio
                        gCamDEAsoc.iTipoDocAso = "1";//factura
                        DateTime FechaDA = DateTime.Parse(DocAsoc.Fields.Item(4).Value.ToString());
                        string hora2 = DocAsoc.Fields.Item(5).Value.ToString();
                        string DAfecha = FechaDA.ToString("yyyy-MM-dd");//fecha de la factura YYYY-mm-DD
                        gCamDEAsoc.dFecEmiDI = DateTime.Parse(DAfecha);
                        gCamDEAsoc.dFecEmiDISpecified = true;
                        DocAsoc.MoveNext();

                    }


                }



                gCamCond.gPaConEIni = gPaConEIni1;
                //gDtipDE.gCamCond = gCamCond;
                gDtipDE.gCamItem = gCamItem1;
                //gValorItem.gValorRestaItem = gValorRestaItem;
                //gCamItem.gValorItem = gValorItem;
                //gCamItem.gCamIVA = gCamIVA;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento

                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (resultadoOK == false)
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    string mensajeError = resultadoProcesamiento[0].mensajeError.ToString();
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Factura creada pero no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Documento creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    if (true == oCompany.InTransaction)
                    {
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                    //actualizamos el folio de la factura
                    Recordset oActFolio;
                    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocNum\"='" + codigo + "'");
                    //actualizamos la numeracion de la serie           
                    Recordset oActSerie;
                    oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + NumSerie + "'");
                    //actualizamos el folio del asiento
                    Recordset oActAsiento;
                    oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 278)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");//
                                                                                                                                                                                                                                                                                                                 //MessageBox.Show("Documento creada con exito","",MessageBoxButtons.OK,MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Documento creado con Exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
                //oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
            }

        }

        //remision GRANUSA
        private static void NotaRemisionGranusa(string codigo, string tablacab, string tabladet)
        {
            try
            {
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM \"@REMI_CAB\" T0 INNER JOIN NNM1 T1 ON T0.\"U_SeriesRT\"=T1.\"SeriesName\" WHERE T0.\"Code\"='" + codigo + "'");
                string v_PEMI = oSeriesDatos.Fields.Item(1).Value.ToString();
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE \"@REMI_CAB\" SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"Code\"='" + codigo + "' ");

                //proceso para mandar documento
                //consultamos los datos del documento  
                string prueba = oCompany.CompanyName.ToString();
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"Code\",T0.\"U_CardCode\",T0.\"U_CardName\",T0.\"U_Order\",T5.\"Street\",T2.\"LicTradNum\", " +
                               "CASE WHEN T2.\"Cellular\" IS NULL THEN 'SIN NUMERO' ELSE T2.\"Cellular\" END,T0.\"U_DocDate\",T0.\"U_DocCur\", " +
                               "CASE WHEN T3.\"GroupNum\"=-1 THEN 1 ELSE 2 END,T3.\"ExtraDays\",T1.\"U_ItemCode\",T1.\"U_Descripcion\",T1.\"U_Quantity\",T6.\"U_SET_FE\",T6.\"U_DESC_SET_FE\", " +
                               "CASE WHEN LENGTH(T0.\"CreateTime\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTime\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTime\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTime\" AS VARCHAR(6)),4,5) " +
                               "WHEN LENGTH(T0.\"CreateTime\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTime\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTime\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTime\" AS VARCHAR(6)),5,6) " +
                               "WHEN LENGTH(T0.\"CreateTime\") = '3' THEN SUBSTRING (CAST(0||T0.\"CreateTime\"||00 AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0||T0.\"CreateTime\"||00 AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTime\"||000 AS VARCHAR(6)),5,6) " +
                               "WHEN LENGTH(T0.\"CreateTime\") = '4' THEN SUBSTRING (CAST(T0.\"CreateTime\"||00 AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTime\"||00 AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0||T0.\"CreateTime\"||00 AS VARCHAR(6)),5,6) " +
                               "WHEN LENGTH(T0.\"CreateTime\") = '2' THEN SUBSTRING (CAST(T0.\"CreateTime\"||0000 AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTime\"||0000 AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTime\"||0000 AS VARCHAR(6)),5,6) END \"HORA\", " +
                               "T0.\"U_operacion\",T0.\"U_Motivo\",T0.\"U_impAfec\",T8.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T9.\"Rate\", " +
                               "T0.\"U_Chapa\",T10.\"U_MARCA\",T0.\"U_CodTrans\",T11.\"U_iNatRec\",T11.\"CardName\",T11.\"LicTradNum\",T12.\"Street\",T13.\"U_SET_FE\",T13.\"U_DESC_SET_FE\",T14.\"U_Documento\",T14.\"U_Nombre\"||', '||T14.\"U_Apellido\",T15.\"U_SET_FE\", " +
                               "CASE WHEN T5.\"U_CdepSet\" IS NULL THEN 1 ELSE T5.\"U_CdepSet\" END,CASE WHEN T5.\"U_CdisSet\" IS NULL THEN 1 ELSE T5.\"U_CdisSet\" END,CASE WHEN T5.\"U_ClocSet\" IS NULL THEN 1 ELSE T5.\"U_ClocSet\" END," +
                               "T0.\"U_SeriesRT\",T15.\"U_DESC_SET_FE\",T16.\"TaxIdNum\",T14.\"U_Direccion\"  " +
                               "FROM \"@REMI_CAB\" T0 INNER JOIN \"@REMI_DET\" T1 ON T0.\"Code\"=T1.\"Code\" " +
                               "INNER JOIN OCRD T2 ON T0.\"U_CardCode\"=T2.\"CardCode\" " +
                               "INNER JOIN ORDR T3 ON T0.\"U_Order\"=T3.\"DocNum\" " +
                               "INNER JOIN RDR1 T4 ON T3.\"DocEntry\"=T4.\"DocEntry\" " +
                               //"LEFT JOIN ORDR T3 ON T3.\"DocNum\"=T0.\"U_Order\" " +
                               //"LEFT JOIN RDR1 T4 ON T4.\"DocEntry\"=T3.\"DocEntry\" " +
                               "LEFT JOIN CRD1 T5 ON T5.\"CardCode\"=T2.\"CardCode\" AND T5.\"Address\"=T3.\"ShipToCode\" " +
                               "LEFT JOIN \"@EQUIVALENCIAS_FE\" T6 ON T6.\"U_SAP\"=T5.\"Country\" " +
                               "LEFT JOIN OOND T7 ON T7.\"IndCode\"=T2.\"IndustryC\" " +
                               "LEFT JOIN \"@EQUIVALENCIAS_FE\" T8 ON T8.\"U_SAP\"=T7.\"IndName\" " +
                               "LEFT JOIN ORTT T9 ON T9.\"RateDate\"=T0.\"U_DocDate\" AND T9.\"Currency\"='USD' " +
                               "LEFT JOIN \"@VEHICULOS\" T10 ON T10.\"U_CHAPA\"=T0.\"U_Chapa\" " +
                               "LEFT JOIN OCRD T11 ON T11.\"CardCode\"=T0.\"U_CodTrans\" " +
                               "LEFT JOIN CRD1 T12 ON T12.\"CardCode\"=T0.\"U_CodTrans\" AND T12.\"AdresType\"='B' " +
                               "LEFT JOIN \"@EQUIVALENCIAS_FE\" T13 ON T13.\"U_SAP\"=T12.\"Country\" " +
                               "LEFT JOIN \"@CHOFERES\" T14 ON T14.\"Code\"=T0.\"U_CodChofer\" " +
                               "LEFT JOIN \"@EQUIVALENCIAS_FE\" T15 ON T15.\"U_SAP\"=T0.\"U_ESTA\" " +
                               "LEFT JOIN OADM T16 ON T16.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                               "WHERE T0.\"Code\"='" + codigo + "' " +
                               "GROUP BY T0.\"DocEntry\",T0.\"Code\",T0.\"U_CardCode\",T0.\"U_CardName\",T0.\"U_Order\",T5.\"Street\",T2.\"LicTradNum\",T2.\"Cellular\", " +
                               "T0.\"U_DocDate\",T0.\"U_DocCur\",T3.\"GroupNum\",T3.\"ExtraDays\",T1.\"U_ItemCode\",T1.\"U_Descripcion\",T1.\"U_Quantity\",T6.\"U_SET_FE\",T6.\"U_DESC_SET_FE\",T0.\"CreateTime\", " +
                               "T0.\"U_operacion\",T0.\"U_Motivo\",T0.\"U_impAfec\",T8.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T9.\"Rate\",T0.\"U_Chapa\",T10.\"U_MARCA\",T0.\"U_CodTrans\", " +
                               "T11.\"U_iNatRec\",T11.\"CardName\",T11.\"LicTradNum\",T12.\"Street\",T13.\"U_SET_FE\",T14.\"U_Documento\",T14.\"U_Nombre\",T14.\"U_Apellido\",T15.\"U_SET_FE\", " +
                               "T13.\"U_DESC_SET_FE\",T5.\"U_CdepSet\",T5.\"U_CdisSet\",T5.\"U_ClocSet\",T0.\"U_SeriesRT\",T15.\"U_DESC_SET_FE\",T16.\"TaxIdNum\",T14.\"U_Direccion\" ");
                //variables RT
                string v_DocEntryRT = oDatos.Fields.Item(0).Value.ToString();
                string v_CodeRT = oDatos.Fields.Item(1).Value.ToString();
                string v_CardCodeRT = oDatos.Fields.Item(2).Value.ToString();
                string v_CardNameRT = oDatos.Fields.Item(3).Value.ToString();
                string v_Order = oDatos.Fields.Item(4).Value.ToString();
                string v_StreetCL = oDatos.Fields.Item(5).Value.ToString();
                string v_RucCL = oDatos.Fields.Item(6).Value.ToString();
                string v_Cel = oDatos.Fields.Item(7).Value.ToString();
                string v_Fecha = oDatos.Fields.Item(8).Value.ToString();
                string v_Moneda = oDatos.Fields.Item(9).Value.ToString();
                string v_Condicion = oDatos.Fields.Item(10).Value.ToString();
                string v_ExtraDays = oDatos.Fields.Item(11).Value.ToString();
                string v_PaisCL = oDatos.Fields.Item(15).Value.ToString();
                string v_PaisDescCL = oDatos.Fields.Item(16).Value.ToString();
                string v_hora = oDatos.Fields.Item(17).Value.ToString();
                string v_Operacion = oDatos.Fields.Item(18).Value.ToString();
                string v_Motivo = oDatos.Fields.Item(19).Value.ToString();
                string v_ImpAfec = oDatos.Fields.Item(20).Value.ToString();
                string v_B2 = oDatos.Fields.Item(21).Value.ToString();
                string v_Naturaleza = oDatos.Fields.Item(22).Value.ToString();
                string v_Contribuyente = oDatos.Fields.Item(23).Value.ToString();
                string v_Cotizacion = oDatos.Fields.Item(24).Value.ToString();
                string v_Chapa = oDatos.Fields.Item(25).Value.ToString();
                string v_Marca = oDatos.Fields.Item(26).Value.ToString();
                string v_CodTrans = oDatos.Fields.Item(27).Value.ToString();
                string v_NaturalezaTRans = oDatos.Fields.Item(28).Value.ToString();
                string v_NombreTrans = oDatos.Fields.Item(29).Value.ToString();
                string v_RucTrans = oDatos.Fields.Item(30).Value.ToString();
                string v_StreetTrans = oDatos.Fields.Item(31).Value.ToString();
                string v_PaisTrans = oDatos.Fields.Item(32).Value.ToString();
                string v_PaisDescTrnas = oDatos.Fields.Item(33).Value.ToString();
                string v_ChoferCed = oDatos.Fields.Item(34).Value.ToString();
                string v_ChoferNombre = oDatos.Fields.Item(35).Value.ToString();
                string v_Establecimiento = oDatos.Fields.Item(36).Value.ToString();
                string v_Departamento = oDatos.Fields.Item(37).Value.ToString();
                string v_Distrito = oDatos.Fields.Item(38).Value.ToString();
                string v_Localidad = oDatos.Fields.Item(39).Value.ToString();
                string v_SeriesRT = oDatos.Fields.Item(40).Value.ToString();
                string v_Salida = oDatos.Fields.Item(41).Value.ToString();
                string v_RucEmi = oDatos.Fields.Item(42).Value.ToString();
                string v_ChoferDire = oDatos.Fields.Item(43).Value.ToString();



                //validamos los campos obligatorios
                #region VALIDACIONES               

                //string v_natu = oDatos.Fields.Item(26).Value.ToString();
                //if (string.IsNullOrEmpty(v_natu))
                //{
                //    SBO_Application.StatusBar.SetText("Cargar naturaleza al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                //    return;
                //}
                //string v_ope = oDatos.Fields.Item(25).Value.ToString();
                //if (string.IsNullOrEmpty(v_ope) || v_ope.Equals("0"))
                //{
                //    SBO_Application.StatusBar.SetText("Cargar tipo de operacion al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                //    return;
                //}
                //string v_cont = oDatos.Fields.Item(27).Value.ToString();
                //if (string.IsNullOrEmpty(v_cont))
                //{
                //    SBO_Application.StatusBar.SetText("Cargar tipo de contribuyente al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //    return;
                //}
                //string v_direSal = oDatos.Fields.Item(39).Value.ToString();
                //if (string.IsNullOrEmpty(v_direSal))
                //{
                //    SBO_Application.StatusBar.SetText("Cargar direccion del establecimiento", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                //    return;
                //}
                //string v_natTrans = oDatos.Fields.Item(32).Value.ToString();
                //if (string.IsNullOrEmpty(v_natTrans))
                //{
                //    SBO_Application.StatusBar.SetText("Cargar naturaleza del transportista", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                //    return;
                //}
                //string v_direTrans = oDatos.Fields.Item(41).Value.ToString();
                //if (string.IsNullOrEmpty(v_direTrans))
                //{
                //    SBO_Application.StatusBar.SetText("Cargar direccion del transportista", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                //    return;
                //}
                //string v_chof = oDatos.Fields.Item(37).Value.ToString();
                //if (string.IsNullOrEmpty(v_chof))
                //{
                //    SBO_Application.StatusBar.SetText("Cargar un chofer a la remision", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                //    return;
                //}
                //string v_idchof = oDatos.Fields.Item(36).Value.ToString();
                //if (string.IsNullOrEmpty(v_idchof))
                //{
                //    SBO_Application.StatusBar.SetText("Cargar cedula al chofer", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                //    return;
                //}
                //string v_direChof = oDatos.Fields.Item(42).Value.ToString();
                //if (string.IsNullOrEmpty(v_direChof))
                //{
                //    SBO_Application.StatusBar.SetText("Cargar direccion al chofer", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                //    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                //    return;
                //}
                #endregion


                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from \"@REMI_DET\" where \"Code\"='" + v_DocEntryRT + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"SeriesName\"='" + v_SeriesRT + "'");
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(oSerie.Fields.Item(2).Value.ToString());
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                //salida
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;

                string[] guion = v_Salida.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //actualizamos los UDF
                Recordset oActUDF;
                oActUDF = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oActUDF.DoQuery("UPDATE \"@REMI_CAB\" SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "' where \"DocEntry\"=" + v_DocEntryRT + " ");
                ////actualizamos la numeracion de la serie           
                Recordset oInfo;
                oInfo = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oInfo.DoQuery("SELECT \"U_InfoAdicional\" FROM \"@REMI_CAB\" WHERE \"Code\"='" + v_DocEntryRT + "'");
                string v_InfoAdicional = oInfo.Fields.Item(0).Value.ToString();
                //deconstruimos el RUC del emisor
                int indexE = v_RucEmi.IndexOf("-");
                int canE = v_RucEmi.Length;
                string rucE = v_RucEmi.Remove(indexE, canE - indexE);
                string dvE = v_RucEmi.Remove(0, indexE + 1);
                string serieremi = v_SeriesRT;
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (!v_B2.Equals("4"))
                {
                    index = v_RucCL.IndexOf("-");
                    can = v_RucCL.Length;
                    ruc = v_RucCL.Remove(index, can - index);
                    dv = v_RucCL.Remove(0, index + 1);
                }
                //instaciamos los objetos que vutilizaremos
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                #endregion
                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                gOpeDE.dInfoFisc = "Remision";
                if (!string.IsNullOrEmpty(v_InfoAdicional))
                {
                    gOpeDE.dInfoEmi = v_InfoAdicional;
                }
                //gTimb
                gTimb.iTiDE = "7";
                gTimb.dNumTim = timbrado;// timbrado;
                gTimb.dEst = esta;// esta;
                gTimb.dPunExp = pun;// pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                DateTime fe = Convert.ToDateTime(v_Fecha);
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + "17:00:00";// v_hora;      
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = v_Naturaleza;
                gDatRec.iTiOpe = v_Operacion;
                gDatRec.cPaisRec = v_PaisCL;
                gDatRec.dDesPaisRe = v_PaisDescCL;
                gDatRec.dNomRec = v_CardNameRT;
                string direRec = v_StreetCL;
                string newdireRec = null;
                if (!Regex.IsMatch(direRec, @"^[a-zA-Z-0-9]+$") == true)
                {
                    newdireRec = Regex.Replace(direRec, @"[^0-9a-zA-Z ]+", "");
                }
                else
                {
                    newdireRec = direRec;
                }
                gDatRec.dDirRec = newdireRec;
                gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = v_Cel;
                if (v_PaisCL == "PRY")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                    gDatRec.cDepRec = v_Departamento;
                    gDatRec.cDisRec = v_Distrito;
                    gDatRec.cCiuRec = v_Localidad;
                    gDatRec.iTiContRec = v_Contribuyente;
                }
                //gCamSal
                gCamSal.dDirLocSal = v_Establecimiento;
                gCamSal.dNumCasSal = "0";
                //gCamSal.dComp1Sal =  "aviadores del chaco";
                gCamSal.cDepSal = sal_dep;
                gCamSal.cDisSal = sal_dist;
                gCamSal.cCiuSal = sal_loc;
                //gCamEnt
                gCamEnt.dDirLocEnt = newdireRec;// oDatos.Fields.Item(5).Value.ToString(); //"santa teresa";
                gCamEnt.dNumCasEnt = "0";
                gCamEnt.cDepEnt = v_Departamento;
                gCamEnt.cDisEnt = v_Distrito;
                gCamEnt.cCiuEnt = v_Localidad;
                gCamEnt1[0] = gCamEnt;


                if (v_RucTrans == v_RucCL)
                {
                    gTransp.iTipTrans = "1";
                    gTransp.dDesTipTrans = "Propio";
                }
                else
                {
                    gTransp.iTipTrans = "2";
                    gTransp.dDesTipTrans = "Tercero";
                }
                gTransp.iModTrans = "1";
                gTransp.iRespFlete = "1";
                gTransp.dIniTras = fe;
                gTransp.dIniTrasSpecified = true;
                gTransp.dFinTras = fe;
                gTransp.dFinTrasSpecified = true;
                //gVehTras
                //gTransp.gVehTras = gVehTras1;
                gVehTras1[0] = gVehTras;
                gVehTras.dTiVehTras = "Terrestre";
                gVehTras.dMarVeh = v_Marca;
                gVehTras.dTipIdenVeh = "2";
                gVehTras.dNroMatVeh = v_Chapa;
                //gCamTrans
                gCamTrans.iNatTrans = v_NaturalezaTRans;
                gCamTrans.dNomTrans = v_NombreTrans;
                //deconstruimos el RUC del transportista
                string rucCam = null;
                string dvCam = null;
                if (v_NaturalezaTRans == "1")
                {
                    int indexCam = v_RucTrans.IndexOf("-");
                    int canCam = v_RucTrans.Length;
                    rucCam = v_RucTrans.Remove(indexCam, canCam - indexCam);
                    dvCam = v_RucTrans.Remove(0, indexCam + 1);
                }
                if (v_PaisTrans.Equals("PRY"))
                {
                    gCamTrans.dRucTrans = rucCam;
                    gCamTrans.dDVTrans = dvCam;
                }
                else
                {
                    gCamTrans.dNumIDTrans = v_RucTrans;
                    gCamTrans.iTipIDTrans = "3";
                    gCamTrans.dDTipIDTrans = "Cédula extranjera";
                }
                gCamTrans.cNacTrans = v_PaisTrans;
                gCamTrans.dDesNacTrans = v_PaisDescTrnas;
                gCamTrans.dDomFisc = v_StreetTrans;
                gCamTrans.dNumIDChof = v_ChoferCed;
                gCamTrans.dNomChof = v_ChoferNombre;
                string direChofer = v_ChoferDire;
                string newdireChofer = null;
                if (!Regex.IsMatch(direChofer, @"^[a-zA-Z-0-9]+$") == true)
                {
                    newdireChofer = Regex.Replace(direChofer, @"[^0-9a-zA-Z ]+", "");
                }
                else
                {
                    newdireChofer = direChofer;
                }
                gCamTrans.dDirChof = newdireChofer;
                //gCamNRE
                gCamNRE.iMotEmiNR = "1";
                gCamNRE.dDesMotEmiNR = "Traslado por ventas";
                gCamNRE.iRespEmiNR = "1";
                gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                gCamNRE.dKmR = "3";
                //gCamItem
                int f = 0;
                //recorremos el recordset y mandamos los datos del detalle al objeto
                while (!oDatos.EoF)
                {
                    #region DETALLE
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;                       
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        gCamItem2.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem2.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {

                        gCamItem3.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem3.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem4.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem4;
                    }
                    if (f == 4)
                    {
                        gCamItem5.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem5.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem5;
                    }
                    if (f == 5)
                    {
                        gCamItem6.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem6.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem6;
                    }
                    if (f == 6)
                    {
                        gCamItem7.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem7.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem7;
                    }
                    if (f == 7)
                    {
                        gCamItem8.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem8.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem8;
                    }
                    if (f == 8)
                    {
                        gCamItem9.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem9.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem9;
                    }
                    if (f == 9)
                    {
                        gCamItem10.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem10.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem10;
                    }
                    if (f == 10)
                    {
                        gCamItem11.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem11.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem11;
                    }
                    if (f == 11)
                    {
                        gCamItem12.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem12.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem12;
                    }
                    if (f == 12)
                    {
                        gCamItem13.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem13.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem13;
                    }
                    if (f == 13)
                    {
                        gCamItem14.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem14.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem14;
                    }
                    if (f == 14)
                    {
                        gCamItem15.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem15.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem15;
                    }
                    if (f == 15)
                    {
                        gCamItem16.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem16.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem16;
                    }
                    if (f == 16)
                    {
                        gCamItem17.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem17.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem17;
                    }
                    if (f == 17)
                    {
                        gCamItem18.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem18.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem18;
                    }
                    if (f == 18)
                    {
                        gCamItem19.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem19.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem19;
                    }
                    if (f == 19)
                    {
                        gCamItem20.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem20.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem20;
                    }
                    if (f == 20)
                    {
                        gCamItem21.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem21.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem21;
                    }
                    if (f == 21)
                    {
                        gCamItem22.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem22.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem22;
                    }
                    if (f == 22)
                    {
                        gCamItem23.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem23.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem23;
                    }
                    if (f == 23)
                    {
                        gCamItem24.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem24.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem24;
                    }
                    if (f == 24)
                    {
                        gCamItem25.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem25.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem25;
                    }
                    if (f == 25)
                    {
                        gCamItem26.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem26.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem26;
                    }
                    if (f == 26)
                    {
                        gCamItem27.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem27.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem27;
                    }
                    if (f == 27)
                    {
                        gCamItem28.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem28.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem28;
                    }
                    if (f == 28)
                    {
                        gCamItem29.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem29.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem29;
                    }
                    if (f == 29)
                    {
                        gCamItem30.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem30.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem30;
                    }
                    if (f == 30)
                    {
                        gCamItem31.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem31.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem31;
                    }
                    if (f == 31)
                    {
                        gCamItem32.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem32.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem32;
                    }
                    if (f == 32)
                    {
                        gCamItem33.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem33.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem33;
                    }
                    if (f == 33)
                    {
                        gCamItem34.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem34.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem34;
                    }
                    if (f == 34)
                    {
                        gCamItem35.dCodInt = oDatos.Fields.Item(12).Value.ToString(); //"PV1014";
                        gCamItem35.dDesProSer = oDatos.Fields.Item(13).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(14).Value.ToString()); //12;
                        gCamItem1[f] = gCamItem35;
                    }
                    #endregion

                    f++;
                    oDatos.MoveNext();
                    if (false == oCompany.InTransaction)
                    {
                        oCompany.StartTransaction();
                    }
                }
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = "NOTA_REMISION";
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;
                gDtipDE.gTransp = gTransp;
                //gDtipDE.gCamCond = gCamCond;
                gDtipDE.gCamItem = gCamItem1;
                gDtipDE.gCamNRE = gCamNRE;
                gTransp.gCamTrans = gCamTrans;
                gTransp.gCamSal = gCamSal;
                gTransp.gCamEnt = gCamEnt1;
                gTransp.gVehTras = gVehTras1;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento
                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (true == oCompany.InTransaction)
                {
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                }

                //ACTUALIZAMOS LOS CAMPOS
                #region ACTUALIZACIONES
                //actualizacion de establecimiento, punto de emision y folio

                #endregion
                if (resultadoOK == false)
                {
                    string mensajeError = resultadoProcesamiento[0].mensajeError;
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap 
                    SAPbobsCOM.Recordset oDocAct1;
                    oDocAct1 = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oDocAct1.DoQuery("UPDATE \"@REMI_CAB\" SET \"U_PEMI\"='" + esta + "',\"U_ESTA\"='" + pun + "' WHERE \"Code\"='" + codigo + "' ");

                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE \"@REMI_CAB\" SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"Code\"='" + codigo + "'");
                    //MessageBox.Show("Remision no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Remision creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    //actualizamos el folio de la factura
                    Recordset oActFolio;
                    oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActFolio.DoQuery("UPDATE \"@REMI_CAB\" SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"U_FolioPref\"='" + esta + "',\"U_FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"Code\"='" + codigo + "'");
                    //actualizar el estado del documento si es B2G
                    //if (v_Operacion.Equals("3"))
                    //{
                    //    Recordset oActEstado;
                    //    oActEstado = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    //    oActEstado.DoQuery("UPDATE " + tablacab + " SET \"Printed\"='Y' where \"DocNum\"='" + codigo + "'");
                    //}
                    //actualizamos la numeracion de la serie           
                    Recordset oActSerie;
                    oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"SeriesName\"='" + v_SeriesRT + "'");

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 250)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE \"@REMI_CAB\" SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"Code\"='" + codigo + "'");
                    //MessageBox.Show("Remision creada con exito", "", MessageBoxButtons.OK, MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Remision creado con exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
                //oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
            }

        }

        //evento para copiar a RT a Entrega
        private static void RTaEntrega(SAPbouiCOM.Form oForm, string OrderNum, string code, SAPbouiCOM.Form oFormUDF)
        {
            try
            {

                //datos de la cabecera
                int v_extradays = 0;
                SAPbobsCOM.Recordset oRecord;
                oRecord = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.BoRecordset);
                oRecord.DoQuery("SELECT \"DocEntry\" FROM ORDR WHERE \"DocNum\"='" + OrderNum + "'");
                int v_DEOrden = int.Parse(oRecord.Fields.Item(0).Value.ToString());
                //instanciamos el objeto
                SAPbobsCOM.Documents OrdenVenta;
                OrdenVenta = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oOrders);
                if (OrdenVenta.GetByKey(v_DEOrden))
                {
                    string v_CardCode = OrdenVenta.CardCode;
                    string v_Moneda = OrdenVenta.DocCurrency;
                    DateTime v_DocDate = OrdenVenta.DocDate;
                    string v_FechaDoc = v_DocDate.ToString("yyyyMMdd");
                    DateTime v_TaxDate = OrdenVenta.TaxDate;
                    string v_FechaEnt = v_TaxDate.ToString("yyyyMMdd");
                    string v_clase = OrdenVenta.DocType.ToString();

                    //mandar datos al form de entrega
                    EditText E_CardCode = (EditText)oForm.Items.Item("4").Specific;
                    SAPbouiCOM.ComboBox E_Moneda = (SAPbouiCOM.ComboBox)oForm.Items.Item("63").Specific;
                    SAPbouiCOM.ComboBox E_Pago = (SAPbouiCOM.ComboBox)oForm.Items.Item("47").Specific;
                    SAPbouiCOM.EditText E_DocDate = (SAPbouiCOM.EditText)oForm.Items.Item("10").Specific;
                    SAPbouiCOM.EditText E_TaxDate = (SAPbouiCOM.EditText)oForm.Items.Item("12").Specific;
                    EditText E_FolioPreF = (SAPbouiCOM.EditText)oForm.Items.Item("208").Specific;
                    EditText E_FolioNum = (SAPbouiCOM.EditText)oForm.Items.Item("211").Specific;
                    SAPbouiCOM.ComboBox E_Clase = (SAPbouiCOM.ComboBox)oForm.Items.Item("3").Specific;
                    SAPbouiCOM.Button E_btnAnexo = (SAPbouiCOM.Button)oForm.Items.Item("2").Specific;
                    v_extradays = OrdenVenta.ExtraDays;
                    E_CardCode.Value = v_CardCode;
                    if (v_clase.Equals("dDocument_Items")) { E_Clase.Select(0, SAPbouiCOM.BoSearchKey.psk_Index); }
                    else { E_Clase.Select(1, SAPbouiCOM.BoSearchKey.psk_Index); }

                    //verficamos que tipo de moneda tiene el cliente
                    Recordset oMone;
                    oMone = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oMone.DoQuery("SELECT \"Currency\" FROM OCRD WHERE \"CardCode\"='" + v_CardCode + "' ");
                    string v_currency = oMone.Fields.Item(0).Value.ToString();

                    if (v_currency.Equals("##"))
                    {
                        E_Moneda.Select(v_Moneda, SAPbouiCOM.BoSearchKey.psk_ByValue);
                    }



                }
                //consultamos los datos de la RT
                SAPbobsCOM.Recordset oDatosRT;
                oDatosRT = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.BoRecordset);
                oDatosRT.DoQuery("SELECT \"U_ESTA\",\"U_PEMI\", \"U_TIMB\", \"U_CodTrans\", \"U_Chapa\", \"U_CodChofer\", \"U_Motivo\", \"U_operacion\", \"U_impAfec\", " +
                                 "\"U_CDC\", \"U_ID\", \"U_ESTADO\", \"U_KUDE\", \"U_XMLFIRMADO\", \"U_FechaT\", \"U_CODIGOQR\", \"U_Order\",\"U_SeriesRT\",\"U_DocDate\",\"U_DocDueDate\" FROM \"@REMI_CAB\" WHERE \"Code\"='" + code + "' ");
                //cargamos los datos en una variable
                string v_esta = oDatosRT.Fields.Item(0).Value.ToString();
                string v_pemi = oDatosRT.Fields.Item(1).Value.ToString();
                string v_timb = oDatosRT.Fields.Item(2).Value.ToString();
                string v_codtrans = oDatosRT.Fields.Item(3).Value.ToString();
                string v_chapa = oDatosRT.Fields.Item(4).Value.ToString();
                string v_chofer = oDatosRT.Fields.Item(5).Value.ToString();
                string v_motivo = oDatosRT.Fields.Item(6).Value.ToString();
                string v_operacion = oDatosRT.Fields.Item(7).Value.ToString();
                string v_impafec = oDatosRT.Fields.Item(8).Value.ToString();
                string v_cdc = oDatosRT.Fields.Item(9).Value.ToString();
                string v_id = oDatosRT.Fields.Item(10).Value.ToString();
                string v_estado = oDatosRT.Fields.Item(11).Value.ToString();
                string v_kude = oDatosRT.Fields.Item(12).Value.ToString();
                string v_xml = oDatosRT.Fields.Item(13).Value.ToString();
                string v_fechaT = oDatosRT.Fields.Item(14).Value.ToString();
                string v_qr = oDatosRT.Fields.Item(15).Value.ToString();
                string v_OV = oDatosRT.Fields.Item(16).Value.ToString();
                string v_Serie = oDatosRT.Fields.Item(17).Value.ToString();
                string v_DocDateRT = oDatosRT.Fields.Item(18).Value.ToString();
                DateTime fecha_vRT = DateTime.Parse(v_DocDateRT);
                string DocDateETRT = fecha_vRT.ToString("yyyyMMdd");
                string v_DueDateRT = oDatosRT.Fields.Item(19).Value.ToString();
                DateTime DueDate_vRT = DateTime.Parse(v_DueDateRT);
                DateTime v_diasCalculado = DueDate_vRT.AddDays(v_extradays);
                string DueDateE = v_diasCalculado.ToString("yyyyMMdd");
                //mandamos las variables a la entrega
                EditText E_Esta = (EditText)oFormUDF.Items.Item("U_ESTA").Specific;
                EditText E_Pemi = (EditText)oFormUDF.Items.Item("U_PEMI").Specific;
                EditText E_Timb = (EditText)oFormUDF.Items.Item("U_TIMB").Specific;
                EditText E_Transportista = (EditText)oFormUDF.Items.Item("U_TRANSPORTISTA").Specific;
                EditText E_chapa = (EditText)oFormUDF.Items.Item("U_VEHICULOS").Specific;
                EditText E_chofer = (EditText)oFormUDF.Items.Item("U_CHOFERES").Specific;
                EditText E_cdc = (EditText)oFormUDF.Items.Item("U_CDC").Specific;
                EditText E_id = (EditText)oFormUDF.Items.Item("U_ID").Specific;
                EditText E_estado = (EditText)oFormUDF.Items.Item("U_ESTADO").Specific;
                EditText E_kude = (EditText)oFormUDF.Items.Item("U_KUDE").Specific;
                EditText E_XML = (EditText)oFormUDF.Items.Item("U_XMLFIRMADO").Specific;
                EditText E_fechaT = (EditText)oFormUDF.Items.Item("U_FechaT").Specific;
                EditText E_QR = (EditText)oFormUDF.Items.Item("U_CODIGOQR").Specific;
                EditText E_OV = (EditText)oFormUDF.Items.Item("U_RT").Specific;
                SAPbouiCOM.EditText E_RTa = (SAPbouiCOM.EditText)oFormUDF.Items.Item("U_RTa").Specific;
                SAPbouiCOM.EditText E_DocDateE = (SAPbouiCOM.EditText)oForm.Items.Item("10").Specific;
                SAPbouiCOM.EditText E_DueDateE = (SAPbouiCOM.EditText)oForm.Items.Item("12").Specific;


                SAPbouiCOM.ComboBox C_Serie = (SAPbouiCOM.ComboBox)oForm.Items.Item("88").Specific;
                SAPbouiCOM.ComboBox C_Ope = (SAPbouiCOM.ComboBox)oFormUDF.Items.Item("U_iIndPres").Specific;
                SAPbouiCOM.ComboBox C_Tra = (SAPbouiCOM.ComboBox)oFormUDF.Items.Item("U_iTipTra").Specific;
                SAPbouiCOM.ComboBox C_Imp = (SAPbouiCOM.ComboBox)oFormUDF.Items.Item("U_iTimp").Specific;
                SAPbouiCOM.ComboBox C_Liiva = (SAPbouiCOM.ComboBox)oFormUDF.Items.Item("U_LIIV").Specific;

                E_DocDateE.Value = DocDateETRT;
                E_DueDateE.Value = DueDateE;
                E_RTa.Value = "ENTREGA";
                E_Esta.Value = v_esta;
                E_Pemi.Value = v_pemi;
                E_Timb.Value = v_timb;
                E_Transportista.Value = v_codtrans;
                E_chapa.Value = v_chapa;
                E_chofer.Value = v_chofer;
                E_cdc.Item.Enabled = true;
                E_cdc.Value = v_cdc;
                E_id.Item.Enabled = true;
                E_id.Value = v_id;
                E_estado.Item.Enabled = true;
                E_estado.Value = v_estado;
                //E_kude.Item.Enabled = true;
                //E_kude.Value = v_kude;
                //E_XML.Item.Enabled = true;
                //E_XML.Value = v_xml;
                E_fechaT.Item.Enabled = true;
                E_fechaT.Value = v_fechaT;
                E_QR.Item.Enabled = true;
                E_QR.Value = v_qr;
                E_OV.Item.Enabled = true;
                E_OV.Value = code;
                //C_Serie.Select(v_Serie, SAPbouiCOM.BoSearchKey.psk_ByDescription);
                C_Ope.Select(v_operacion, SAPbouiCOM.BoSearchKey.psk_ByValue);
                C_Tra.Select(v_motivo, SAPbouiCOM.BoSearchKey.psk_ByValue);
                C_Imp.Select(v_impafec, SAPbouiCOM.BoSearchKey.psk_ByValue);
                C_Liiva.Select("2", SAPbouiCOM.BoSearchKey.psk_ByValue);
                E_cdc.Item.Enabled = false;
                E_id.Item.Enabled = false;
                E_estado.Item.Enabled = false;
                //E_kude.Item.Enabled = false;
                //E_XML.Item.Enabled = false;
                E_fechaT.Item.Enabled = false;
                E_QR.Item.Enabled = false;
                E_OV.Item.Enabled = false;

                //cargamos el detalle de la entrega
                SAPbouiCOM.Matrix MatrixEnt = (SAPbouiCOM.Matrix)oForm.Items.Item("38").Specific;
                //para traer los datos del detalle
                SAPbobsCOM.Recordset oDatosDet;
                oDatosDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oDatosDet.DoQuery("SELECT \"U_ItemCode\",\"U_Quantity\",\"U_WhsCode\",\"U_Price\",\"U_SlpName\" FROM \"@REMI_DET\" WHERE \"Code\"='"+code+"'");
                //oDatosDet.DoQuery("SELECT T2.\"ItemCode\",T2.\"Quantity\",T2.\"WhsCode\",T2.\"Price\",T2.\"SlpCode\",T2.\"TaxCode\",T2.\"LineTotal\",T2.\"TotalFrgn\",T1.\"DocTotal\",T1.\"DocTotalFC\" " +
                //                 "FROM \"@REMI_CAB\" T0 " +
                //                 "INNER JOIN ORDR T1 ON T0.\"U_Order\"=T1.\"DocNum\" " +
                //                 "INNER JOIN RDR1 T2 ON T1.\"DocEntry\"=T2.\"DocEntry\" " +
                //                 "WHERE T0.\"Code\"='" + code + "'");

                oDatosDet.DoQuery("SELECT T2.\"ItemCode\",T3.\"U_Quantity\",T2.\"WhsCode\",T2.\"Price\",T2.\"SlpCode\",T2.\"TaxCode\",T3.\"U_TotalLine\",T2.\"TotalFrgn\",T1.\"DocTotal\",T1.\"DocTotalFC\",T3.\"U_Price\" " +
                                 "FROM \"@REMI_CAB\" T0 " +
                                 "INNER JOIN ORDR T1 ON T0.\"U_Order\"=T1.\"DocNum\" " +
                                 "INNER JOIN RDR1 T2 ON T1.\"DocEntry\"=T2.\"DocEntry\" " +
                                 "INNER JOIN \"@REMI_DET\" T3 ON T0.\"Code\"=T3.\"Code\" AND T2.\"ItemCode\"=T3.\"U_ItemCode\" " +
                                 "WHERE T0.\"Code\"='" + code + "'");
                //cargamos los datos a una variable
                string totalGS = null;
                string totalUSD = null;
                int filaC = 1;
                while (!oDatosDet.EoF)
                {
                    string v_ItemCode = oDatosDet.Fields.Item(0).Value.ToString();
                    string v_Quantity = oDatosDet.Fields.Item(1).Value.ToString();
                    string v_WhsCode = oDatosDet.Fields.Item(2).Value.ToString();
                    string v_price = oDatosDet.Fields.Item(3).Value.ToString();
                    string v_SlpName = oDatosDet.Fields.Item(4).Value.ToString();
                    string v_totalGS = oDatosDet.Fields.Item(6).Value.ToString();
                    string v_totalUSD = oDatosDet.Fields.Item(7).Value.ToString();
                    totalGS = oDatosDet.Fields.Item(8).Value.ToString();
                    totalUSD = oDatosDet.Fields.Item(9).Value.ToString();
                    string v_priceIva = oDatosDet.Fields.Item(10).Value.ToString();
                    EditText C_ItemCode = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("1").Cells.Item(filaC).Specific;
                    EditText C_Quantity = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("11").Cells.Item(filaC).Specific;
                    EditText C_Price = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("14").Cells.Item(filaC).Specific;
                    EditText c_PriceIva = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("20").Cells.Item(filaC).Specific;
                    EditText C_TotalLinea = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("21").Cells.Item(filaC).Specific;
                    //EditText C_TotalLineaGS = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("20").Cells.Item(filaC).Specific;
                    EditText C_UM = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("1470002145").Cells.Item(filaC).Specific;
                    SAPbouiCOM.ComboBox C_Vend = (SAPbouiCOM.ComboBox)MatrixEnt.Columns.Item("27").Cells.Item(filaC).Specific;
                    C_ItemCode.Value = v_ItemCode;
                    C_Quantity.Value = v_Quantity.Replace(",", ".");
                    C_UM.Value = "TN";
                    C_Price.Value = v_price;
                    c_PriceIva.Value = v_priceIva;
                    C_Vend.Select(v_SlpName, SAPbouiCOM.BoSearchKey.psk_ByDescription);
                    //C_TotalLinea.Value = v_totalGS;
                    oDatosDet.MoveNext();
                    filaC++;
                }

            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.ToString());
                //MessageBox.Show("No existe Remisión Temporal!! verificar","Error",MessageBoxButtons.OK,MessageBoxIcon.Error);
            }


        }

        //evento para copiar a RT a Reserva
        private static void RTaReserva(SAPbouiCOM.Form oForm, string OrderNum, string code, SAPbouiCOM.Form oFormUDF)
        {
            try
            {
                string v_Moneda = null;
                int v_extradays = 0;
                //datos de la cabecera
                SAPbobsCOM.Recordset oRecord;
                oRecord = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.BoRecordset);
                oRecord.DoQuery("SELECT \"DocEntry\" FROM ORDR WHERE \"DocNum\"='" + OrderNum + "'");
                int v_DEOrden = int.Parse(oRecord.Fields.Item(0).Value.ToString());
                //instanciamos el objeto
                SAPbobsCOM.Documents OrdenVenta;
                OrdenVenta = (SAPbobsCOM.Documents)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oOrders);
                if (OrdenVenta.GetByKey(v_DEOrden))
                {
                    string v_CardCode = OrdenVenta.CardCode;
                    v_Moneda = OrdenVenta.DocCurrency;
                    DateTime v_DocDate = OrdenVenta.DocDate;
                    string v_FechaDoc = v_DocDate.ToString("yyyyMMdd");
                    DateTime v_TaxDate = OrdenVenta.TaxDate;
                    string v_FechaEnt = v_TaxDate.ToString("yyyyMMdd");
                    string v_clase = OrdenVenta.DocType.ToString();
                    //int v_condicion = OrdenVenta.
                    v_extradays = OrdenVenta.ExtraDays;
                    //mandar datos al form de factura reserva
                    EditText E_CardCode = (EditText)oForm.Items.Item("4").Specific;
                    SAPbouiCOM.ComboBox E_Moneda = (SAPbouiCOM.ComboBox)oForm.Items.Item("63").Specific;
                    SAPbouiCOM.EditText E_DocDate = (SAPbouiCOM.EditText)oForm.Items.Item("10").Specific;
                    SAPbouiCOM.EditText E_TaxDate = (SAPbouiCOM.EditText)oForm.Items.Item("12").Specific;
                    EditText E_FolioPreF = (SAPbouiCOM.EditText)oForm.Items.Item("208").Specific;
                    EditText E_FolioNum = (SAPbouiCOM.EditText)oForm.Items.Item("211").Specific;
                    SAPbouiCOM.ComboBox E_Clase = (SAPbouiCOM.ComboBox)oForm.Items.Item("3").Specific;
                    SAPbouiCOM.Button E_btnAnexo = (SAPbouiCOM.Button)oForm.Items.Item("2").Specific;
                    SAPbouiCOM.ComboBox E_CondicionV = (SAPbouiCOM.ComboBox)oForm.Items.Item("47").Specific;


                    E_CardCode.Value = v_CardCode;
                    //verficamos que tipo de moneda tiene el cliente
                    Recordset oMone;
                    oMone = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oMone.DoQuery("SELECT \"Currency\" FROM OCRD WHERE \"CardCode\"='" + v_CardCode + "' ");
                    string v_currency = oMone.Fields.Item(0).Value.ToString();

                    if (v_currency.Equals("##"))
                    {
                        E_Moneda.Select(v_Moneda, SAPbouiCOM.BoSearchKey.psk_ByValue);
                    }

                }
                //consultamos los datos de la RT
                SAPbobsCOM.Recordset oDatosRT;
                oDatosRT = (SAPbobsCOM.Recordset)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.BoRecordset);
                oDatosRT.DoQuery("SELECT \"U_ESTA\",\"U_PEMI\", \"U_TIMB\", \"U_CodTrans\", \"U_Chapa\", \"U_CodChofer\", \"U_Motivo\", \"U_operacion\", \"U_impAfec\", " +
                                 "\"U_CDC\", \"U_ID\", \"U_ESTADO\", \"U_KUDE\", \"U_XMLFIRMADO\", \"U_FechaT\", \"U_CODIGOQR\", \"U_Order\",\"U_SeriesRT\",\"Code\" FROM \"@REMI_CAB\" WHERE \"Code\"='" + code + "' ");
                //cargamos los datos en una variable
                string v_esta = oDatosRT.Fields.Item(0).Value.ToString();
                string v_pemi = oDatosRT.Fields.Item(1).Value.ToString();
                string v_timb = oDatosRT.Fields.Item(2).Value.ToString();
                string v_codtrans = oDatosRT.Fields.Item(3).Value.ToString();
                string v_chapa = oDatosRT.Fields.Item(4).Value.ToString();
                string v_chofer = oDatosRT.Fields.Item(5).Value.ToString();
                string v_motivo = oDatosRT.Fields.Item(6).Value.ToString();
                string v_operacion = oDatosRT.Fields.Item(7).Value.ToString();
                string v_impafec = oDatosRT.Fields.Item(8).Value.ToString();
                string v_cdc = oDatosRT.Fields.Item(9).Value.ToString();
                string v_id = oDatosRT.Fields.Item(10).Value.ToString();
                string v_estado = oDatosRT.Fields.Item(11).Value.ToString();
                string v_kude = oDatosRT.Fields.Item(12).Value.ToString();
                string v_xml = oDatosRT.Fields.Item(13).Value.ToString();
                string v_fechaT = oDatosRT.Fields.Item(14).Value.ToString();
                string v_qr = oDatosRT.Fields.Item(15).Value.ToString();
                string v_OV = oDatosRT.Fields.Item(16).Value.ToString();
                string v_Serie = oDatosRT.Fields.Item(17).Value.ToString();
                string v_Code = oDatosRT.Fields.Item(18).Value.ToString();
                //mandamos las variables a la entrega
                EditText E_Esta = (EditText)oFormUDF.Items.Item("U_ESTA").Specific;
                EditText E_Pemi = (EditText)oFormUDF.Items.Item("U_PEMI").Specific;
                EditText E_Timb = (EditText)oFormUDF.Items.Item("U_TIMB").Specific;
                EditText E_Transportista = (EditText)oFormUDF.Items.Item("U_TRANSPORTISTA").Specific;
                EditText E_chapa = (EditText)oFormUDF.Items.Item("U_VEHICULOS").Specific;
                EditText E_chofer = (EditText)oFormUDF.Items.Item("U_CHOFERES").Specific;
                EditText E_cdc = (EditText)oFormUDF.Items.Item("U_CDC").Specific;
                EditText E_id = (EditText)oFormUDF.Items.Item("U_ID").Specific;
                EditText E_estado = (EditText)oFormUDF.Items.Item("U_ESTADO").Specific;
                EditText E_kude = (EditText)oFormUDF.Items.Item("U_KUDE").Specific;
                EditText E_XML = (EditText)oFormUDF.Items.Item("U_XMLFIRMADO").Specific;
                EditText E_fechaT = (EditText)oFormUDF.Items.Item("U_FechaT").Specific;
                EditText E_QR = (EditText)oFormUDF.Items.Item("U_CODIGOQR").Specific;
                EditText E_OV = (EditText)oFormUDF.Items.Item("U_RT").Specific;
                EditText E_INFO = (EditText)oFormUDF.Items.Item("U_InfoAdicional").Specific;
                SAPbouiCOM.EditText E_RTa = (SAPbouiCOM.EditText)oFormUDF.Items.Item("U_RTa").Specific;

                SAPbouiCOM.ComboBox C_Serie = (SAPbouiCOM.ComboBox)oForm.Items.Item("88").Specific;
                SAPbouiCOM.ComboBox C_Ope = (SAPbouiCOM.ComboBox)oFormUDF.Items.Item("U_iIndPres").Specific;
                SAPbouiCOM.ComboBox C_Tra = (SAPbouiCOM.ComboBox)oFormUDF.Items.Item("U_iTipTra").Specific;
                SAPbouiCOM.ComboBox C_Imp = (SAPbouiCOM.ComboBox)oFormUDF.Items.Item("U_iTimp").Specific;
                SAPbouiCOM.ComboBox C_Liiva = (SAPbouiCOM.ComboBox)oFormUDF.Items.Item("U_LIIV").Specific;

                E_RTa.Value = "FACTURA";
                E_Esta.Value = v_esta;
                E_Pemi.Value = v_pemi;
                E_Timb.Value = v_timb;
                E_Transportista.Value = v_codtrans;
                E_chapa.Value = v_chapa;
                E_chofer.Value = v_chofer;
                E_INFO.Value = "N° de Remisión: " + v_AdicionalInfo;
                E_OV.Item.Enabled = true;
                E_OV.Value = v_Code;

                //E_cdc.Item.Enabled = true;
                //E_cdc.Value = v_cdc;
                //E_id.Item.Enabled = true;
                //E_id.Value = v_id;
                //E_estado.Item.Enabled = true;
                //E_estado.Value = v_estado;
                //E_kude.Item.Enabled = true;
                //E_kude.Value = v_kude;
                //E_XML.Item.Enabled = true;
                //E_XML.Value = v_xml;
                //E_fechaT.Item.Enabled = true;
                //E_fechaT.Value = v_fechaT;
                //E_QR.Item.Enabled = true;
                //E_QR.Value = v_qr;
                //E_OV.Item.Enabled = true;
                //E_OV.Value = code;
                //C_Serie.Select(v_Serie, SAPbouiCOM.BoSearchKey.psk_ByDescription);
                C_Ope.Select(v_operacion, SAPbouiCOM.BoSearchKey.psk_ByValue);
                C_Tra.Select(v_motivo, SAPbouiCOM.BoSearchKey.psk_ByValue);
                C_Imp.Select(v_impafec, SAPbouiCOM.BoSearchKey.psk_ByValue);
                C_Liiva.Select("2", SAPbouiCOM.BoSearchKey.psk_ByValue);
                E_OV.Item.Enabled = false;
                //E_cdc.Item.Enabled = false;
                //E_id.Item.Enabled = false;
                //E_estado.Item.Enabled = false;
                //E_kude.Item.Enabled = false;
                //E_XML.Item.Enabled = false;
                //E_fechaT.Item.Enabled = false;
                //E_QR.Item.Enabled = false;
                //E_OV.Item.Enabled = false;

                //cargamos el detalle de la entrega
                SAPbouiCOM.Matrix MatrixEnt = (SAPbouiCOM.Matrix)oForm.Items.Item("38").Specific;

                //para traer los datos del detalle
                SAPbobsCOM.Recordset oDatosDet;
                oDatosDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oDatosDet.DoQuery("SELECT \"U_ItemCode\",\"U_Quantity\",\"U_WhsCode\",\"U_Price\",\"U_SlpName\",\"U_TaxCode\" FROM \"@REMI_DET\" WHERE \"Code\"='" + code + "'");
                oDatosDet.DoQuery("SELECT T2.\"ItemCode\",T2.\"Quantity\",T2.\"WhsCode\",T2.\"Price\",T2.\"SlpCode\",T2.\"TaxCode\",T2.\"LineTotal\",T2.\"TotalFrgn\",T1.\"DocTotal\",T1.\"DocTotalFC\" " +
                                  "FROM \"@REMI_CAB\" T0 " +
                                  "INNER JOIN ORDR T1 ON T0.\"U_Order\"=T1.\"DocNum\" " +
                                  "INNER JOIN RDR1 T2 ON T1.\"DocEntry\"=T2.\"DocEntry\" " +
                                  "WHERE T0.\"Code\"='" + code + "'");
                //cargamos los datos a una variable
                string totalGS = null;
                string totalUSD = null;
                int filaC = 1;
                while (!oDatosDet.EoF)
                {
                    string v_ItemCode = oDatosDet.Fields.Item(0).Value.ToString();
                    string v_Quantity = oDatosDet.Fields.Item(1).Value.ToString();
                    string v_WhsCode = oDatosDet.Fields.Item(2).Value.ToString();
                    string v_price = oDatosDet.Fields.Item(3).Value.ToString();
                    string v_SlpName = oDatosDet.Fields.Item(4).Value.ToString();
                    string v_TaxCode = oDatosDet.Fields.Item(5).Value.ToString();
                    string v_totalGS = oDatosDet.Fields.Item(6).Value.ToString();
                    string v_totalUSD = oDatosDet.Fields.Item(7).Value.ToString();
                    totalGS = oDatosDet.Fields.Item(8).Value.ToString();
                    totalUSD = oDatosDet.Fields.Item(9).Value.ToString();
                    EditText C_ItemCode = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("1").Cells.Item(filaC).Specific;
                    EditText C_Quantity = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("11").Cells.Item(filaC).Specific;
                    EditText C_Price = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("14").Cells.Item(filaC).Specific;
                    EditText C_TotalLinea = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("23").Cells.Item(filaC).Specific;
                    EditText C_TotalLineaGS = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("21").Cells.Item(filaC).Specific;
                    EditText C_TotalIva = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("83").Cells.Item(filaC).Specific;
                    EditText C_UM = (SAPbouiCOM.EditText)MatrixEnt.Columns.Item("1470002145").Cells.Item(filaC).Specific;
                    SAPbouiCOM.ComboBox C_Vend = (SAPbouiCOM.ComboBox)MatrixEnt.Columns.Item("27").Cells.Item(filaC).Specific;
                    C_ItemCode.Value = v_ItemCode;
                    C_Quantity.Value = v_Quantity.Replace(",", ".");
                    C_UM.Value = "TN";
                    C_Price.Value = v_price;
                    if (v_Moneda.Equals("USD"))
                    {
                        C_TotalLinea.Value = v_totalUSD;
                    }
                    else
                    {
                        C_TotalLineaGS.Value = v_totalGS;
                    }

                    //C_Price.Value = v_price.Replace(",", ".");
                    C_Vend.Select(v_SlpName, SAPbouiCOM.BoSearchKey.psk_ByValue);

                    oDatosDet.MoveNext();
                    filaC++;
                }
                EditText E_TotalDoc = (EditText)oForm.Items.Item("29").Specific;
                if (v_Moneda.Equals("USD"))
                {
                    E_TotalDoc.Value = totalUSD;
                }
                else
                {
                    E_TotalDoc.Value = totalGS;
                }
                //SAPbouiCOM.ComboBox E_CondicionV = (SAPbouiCOM.ComboBox)oForm.Items.Item("47").Specific;
                // E_CondicionV.Select("-1", SAPbouiCOM.BoSearchKey.psk_ByValue);
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.ToString(), "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }


        }

        //actualizar condicion de venta - Socio de Negocio
        private static void ActualizarCondi(string CardCode, int CondicionV)
        {
            //instanciamos el objeto
            SAPbobsCOM.BusinessPartners SocioNegocio;
            SocioNegocio = (SAPbobsCOM.BusinessPartners)oCompany.GetBusinessObject(SAPbobsCOM.BoObjectTypes.oBusinessPartners);
            if (SocioNegocio.GetByKey(CardCode))
            {
                SocioNegocio.PayTermsGrpCode = CondicionV;
                int UpdateSN = SocioNegocio.Update();
                if (UpdateSN != 0)
                {
                    MessageBox.Show(oCompany.GetLastErrorDescription().ToString());
                    //MessageBox.Show("No es posible actualizar el Socio de Negocio","Error",MessageBoxButtons.OK,MessageBoxIcon.Error);
                    return;
                }
            }
        }

        //funcion para remision
        private static void ReenvioNotaRemision(string codigo, string tablacab, string tabladet, string r_folio)
        {
            try
            {
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //buscamos el establecimeinto y punto de exp correspondiente
                SAPbobsCOM.Recordset oSeriesDatos;
                oSeriesDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSeriesDatos.DoQuery("SELECT T1.\"BeginStr\",T1.\"EndStr\" FROM " + tablacab + " T0 INNER JOIN NNM1 T1 ON T0.\"Series\"=T1.\"Series\" WHERE T0.\"DocNum\"='" + codigo + "'");
                //procedemos a actualizar el documento
                SAPbobsCOM.Recordset oDocAct;
                oDocAct = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDocAct.DoQuery("UPDATE " + tablacab + " SET \"U_PEMI\"='" + oSeriesDatos.Fields.Item(1).Value.ToString() + "',\"U_ESTA\"='" + oSeriesDatos.Fields.Item(0).Value.ToString() + "' WHERE \"DocNum\"='" + codigo + "' ");

                Recordset oDire;
                oDire = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oDire.DoQuery("select \"PayToCode\",\"ShipToCode\" from " + tablacab + " where \"DocNum\"='" + codigo + "'");
                string direPay = oDire.Fields.Item(0).Value.ToString();
                string direShip = oDire.Fields.Item(1).Value.ToString();

                Recordset oDireTras;
                oDireTras = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                string direTras = null;
                if (tablacab.Equals("OWTR"))
                {
                    oDireTras.DoQuery("SELECT T2.\"Address\" FROM OWTR T0 LEFT JOIN OCRD T1 ON T1.\"CardCode\"=T0.\"CardCode\" " +
                                      "LEFT JOIN CRD1 T2 ON T2.\"CardCode\"=T1.\"CardCode\" AND T2.\"AdresType\"='B' WHERE T0.\"DocNum\"='" + codigo + "'");
                    direTras = oDireTras.Fields.Item(0).Value.ToString();
                    if (string.IsNullOrEmpty(direTras))
                    {
                        SBO_Application.StatusBar.SetText("Cargar direccion al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                        oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    }
                }
                //proceso para mandar documento
                //consultamos los datos del documento              
                Recordset oDatos;
                oDatos = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);

                #region QUERY REMISION
                if (tablacab.Equals("OWTR"))
                {
                    if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                    {
                        if (!string.IsNullOrEmpty(direTras))
                        {
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",T0.\"Address\",CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                       "T0.\"U_Vehiculo\",T11.\"U_Marca\",T0.\"U_Trans\", " +
                                       "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"Pager\",T15.\"Name\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                       "T13.\"Street\",T15.\"Address\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\" " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                       "LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_Trans\" and T15.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                        else
                        {

                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",T0.\"Address\",CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                       "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                       "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                       "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                       "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                       "T0.\"U_Vehiculo\",T11.\"U_Marca\",T0.\"U_Trans\", " +
                                       "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"Pager\",T15.\"Name\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                       "T13.\"Street\",T15.\"Address\", " +
                                       "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                       "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\" " +
                                       "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                       "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"AdresType\"='S' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                       "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                       "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                       "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                       "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                       "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                       "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_Trans\" " +
                                       "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                       "LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_Trans\" and T15.\"Name\"=T0.\"U_Chofer\" " +
                                       "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                       "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }

                    }
                    //GRANUSA
                    else
                    {
                        if (!string.IsNullOrEmpty(direTras))
                        {
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",T0.\"Address\",CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                  "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                  "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                  "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                  "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                  "CASE WHEN T11.\"U_CHAPA_CARRE\" is null THEN T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T0.\"U_TRANSPORTISTA\", " +
                                  "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"U_Documento\",T15.\"U_Nombre\"||', '||T15.\"U_Apellido\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                  "T13.\"Street\",T15.\"U_Direccion\", " +
                                  "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                  "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_PerContacto\" " +
                                  "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                  "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"AdresType\"='B' " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                  "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                  "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                  "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                  "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                  "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                  "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                  "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                  "LEFT JOIN \"@CHOFERES\" T15 ON T15.\"Code\"=T0.\"U_CHOFERES\" " +
                                  //"LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_TRANSPORTISTA\" and T15.\"Name\"=T0.\"U_CHOFERES\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                  "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                        else
                        {
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",T0.\"Address\",CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                  "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                  "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                  "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                  "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                  "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                  "CASE WHEN T11.\"U_CHAPA_CARRE\" is null THEN T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T0.\"U_TRANSPORTISTA\", " +
                                  "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"U_Documento\",T15.\"U_Nombre\"||', '||T15.\"U_Apellido\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                  "T13.\"Street\",T15.\"U_Direccion\", " +
                                  "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END ," +
                                  "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_PerContacto\" " +
                                  "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                  "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"AdresType\"='S' " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                  "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                  "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                  "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                  "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                  "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_VEHICULOS\" " +
                                  "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                  "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                  "LEFT JOIN \"@CHOFERES\" T15 ON T15.\"Code\"=T0.\"U_CHOFERES\" " +
                                  //"LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_TRANSPORTISTA\" and T15.\"Name\"=T0.\"U_CHOFERES\" " +
                                  "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                  "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }

                    }
                }
                else
                {
                    //consultamos la direccion que se eligio
                    if (!string.IsNullOrEmpty(direShip))
                    {
                        if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                        {
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                           "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                           "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                           "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                           "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                           "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                           "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                           "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                           "T0.\"U_Vehiculo\",T11.\"U_Marca\",T0.\"U_Trans\", " +
                                           "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"Pager\",T15.\"Name\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                           "T13.\"Street\",T15.\"Address\", " +
                                           "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                           "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_PerContacto\" " +
                                           "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                           "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                           "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                           "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                           "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                           "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                           "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                           "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_Trans\" " +
                                           "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                           "LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_Trans\" and T15.\"Name\"=T0.\"U_Chofer\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                           "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                        else
                        {
                            //GRANUSA
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                      "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                      "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                      "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                      "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                      "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                      "CASE WHEN T11.\"U_CHAPA_CARRE\" is null THEN T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T0.\"U_TRANSPORTISTA\", " +
                                      "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"U_Documento\",T15.\"U_Nombre\"||', '||T15.\"U_Apellido\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                      "T13.\"Street\",T15.\"U_Direccion\", " +
                                      "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                      "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_PerContacto\" " +
                                      "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                      "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"ShipToCode\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                      "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                      "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                      "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                      "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                      "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                      "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                      "LEFT JOIN \"@CHOFERES\" T15 ON T15.\"Code\"=T0.\"U_CHOFERES\" " +
                                      //"LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_TRANSPORTISTA\" and T15.\"Name\"=T0.\"U_CHOFERES\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                      "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                    }
                    else
                    {
                        if (compania.Equals("FRIGORIFICO GUARANI S.A.C.I."))
                        {
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                           "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                           "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                           "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                           "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                           "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTImp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                           "T0.\"U_Vehiculo\",T11.\"U_Marca\",T0.\"U_Trans\", " +
                                           "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"Pager\",T15.\"Name\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                           "T13.\"Street\",T15.\"Address\", " +
                                           "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                           "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\" " +
                                           "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                           "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                           "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                           "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                           "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                           "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                           "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Name\"=T0.\"U_Vehiculo\" " +
                                           "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_Trans\" " +
                                           "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                           "LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_Trans\" and T15.\"Name\"=T0.\"U_Chofer\" " +
                                           "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                           "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                        else
                        {
                            //GRANUSA
                            oDatos.DoQuery("SELECT T0.\"DocEntry\",T0.\"DocNum\",T0.\"CardCode\",T0.\"CardName\",T2.\"LicTradNum\",CASE WHEN T3.\"Street\" IS NULL THEN 'Paraguay' ELSE T3.\"Street\" END,CASE WHEN T2.\"Cellular\" IS NULL THEN 'SINNUMERO' ELSE T2.\"Cellular\" END AS \"cel\",T0.\"DocDate\",T5.\"U_SET_FE\" AS \"moneda\"," +
                                      "CASE WHEN T0.\"GroupNum\"=-1 THEN 1 ELSE 2 END AS \"Cond\",T0.\"ExtraDays\",T1.\"ItemCode\",T1.\"Dscription\",T1.\"Quantity\",CASE WHEN T0.\"DocCur\"='GS' THEN ROUND(T1.\"Price\"+(T1.\"VatSum\"/T1.\"Quantity\")) ELSE ROUND(T1.\"Price\"+(T1.\"VatSumFrgn\"/T1.\"Quantity\"),2) END," +
                                      "CASE WHEN T1.\"TaxCode\"='IVA_10' THEN 10 WHEN T1.\"TaxCode\"='IVA_5' THEN 5 else 0 END AS \"Iva\",T4.\"U_SET_FE\" AS \"pais\",T0.\"Series\",T6.\"TaxIdNum\",T0.\"CreateTS\",T7.\"InstNum\", " +
                                      "CASE WHEN LENGTH(T0.\"CreateTS\") = '5' THEN 0||SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,1) || ':' || SUBSTRING(SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),2,3),1,2) ||':' || SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),4,5) WHEN LENGTH(T0.\"CreateTS\") = '6' THEN SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(T0.\"CreateTS\" AS VARCHAR(6)),5,6)  " +
                                      "WHEN LENGTH(T0.\"CreateTS\") = '3' THEN SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '4' THEN SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(00||T0.\"CreateTS\" AS VARCHAR(6)),5,6)   " +
                                       "WHEN LENGTH(T0.\"CreateTS\") = '2' THEN SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),1,2) || ':' ||  SUBSTRING (SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),3,4),1,2) ||':' ||  SUBSTRING (CAST(0000||T0.\"CreateTS\" AS VARCHAR(6)),5,6) END \"HORA\", " +
                                      "T0.\"U_iIndPres\",T0.\"U_iTipTra\",T0.\"U_iTimp\",T9.\"U_SET_FE\",T2.\"U_iNatRec\",T2.\"U_iTipCont\",T10.\"Rate\", " +
                                      "CASE WHEN T11.\"U_CHAPA_CARRE\" is null THEN T0.\"U_VEHICULOS\" ELSE T11.\"U_CHAPA_CARRE\" END,T11.\"U_MARCA\",T0.\"U_TRANSPORTISTA\", " +
                                      "T12.\"U_iNatRec\",T12.\"CardName\",T12.\"LicTradNum\",T14.\"U_SET_FE\",T15.\"U_Documento\",T15.\"U_Nombre\"||', '||T15.\"U_Apellido\",T4.\"U_DESC_SET_FE\",T16.\"U_SET_FE\",T14.\"U_DESC_SET_FE\",  " +
                                      "T13.\"Street\",T15.\"U_Direccion\", " +
                                      "CASE WHEN T3.\"U_CdepSet\" IS NULL THEN 1 ELSE T3.\"U_CdepSet\" END,CASE WHEN T3.\"U_CdisSet\" IS NULL THEN 1 ELSE T3.\"U_CdisSet\" END,CASE WHEN T3.\"U_ClocSet\" IS NULL THEN 1 ELSE T3.\"U_ClocSet\" END, " +
                                      "T16.\"U_DESC_SET_FE\",CASE WHEN T0.\"U_ResFlete\" IS NULL THEN 1 ELSE T0.\"U_ResFlete\" END,T0.\"U_LICITACION\",T0.\"TransId\",T0.\"U_InfoAdicional\",T0.\"U_PerContacto\" " +
                                      "FROM " + tablacab + " T0 INNER JOIN " + tabladet + " T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" " +
                                      "LEFT JOIN OCRD T2 ON T2.\"CardCode\"=T0.\"CardCode\" LEFT JOIN CRD1 T3 ON T3.\"CardCode\"=T2.\"CardCode\" AND T3.\"Address\"=T0.\"PayToCode\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T4 ON T4.\"U_SAP\"=T3.\"Country\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T5 ON T5.\"U_SAP\"=T0.\"DocCur\" " +
                                      "LEFT JOIN OADM T6 ON T6.\"CompnyName\"='" + oCompany.CompanyName + "' " +
                                      "LEFT JOIN OCTG T7 ON T7.\"GroupNum\"=T0.\"GroupNum\" " +
                                      "LEFT JOIN OOND T8 ON T8.\"IndCode\"=T2.\"IndustryC\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T9 ON T9.\"U_SAP\"=T8.\"IndName\" " +
                                      "LEFT JOIN ORTT T10 ON T10.\"RateDate\"=T0.\"DocDate\" AND T10.\"Currency\"='USD' " +
                                      "LEFT JOIN \"@VEHICULOS\" T11 ON T11.\"Code\"=T0.\"U_VEHICULOS\" " +
                                      "LEFT JOIN OCRD T12 ON T12.\"CardCode\"=T0.\"U_TRANSPORTISTA\" " +
                                      "LEFT JOIN CRD1 T13 ON T13.\"CardCode\"=T12.\"CardCode\" AND T13.\"AdresType\"='B' " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T14 ON T14.\"U_SAP\"=T13.\"Country\" " +
                                      "LEFT JOIN \"@CHOFERES\" T15 ON T15.\"Code\"=T0.\"U_CHOFERES\" " +
                                      //"LEFT JOIN OCPR T15 ON T15.\"CardCode\"=T0.\"U_TRANSPORTISTA\" and T15.\"Name\"=T0.\"U_CHOFERES\" " +
                                      "LEFT JOIN \"@EQUIVALENCIAS_FE\" T16 ON T16.\"U_SAP\"=T0.\"U_ESTA\" " +
                                      "WHERE T0.\"DocNum\"='" + codigo + "'");
                        }
                    }
                }

                #endregion

                //validamos los campos obligatorios
                #region VALIDACIONES
                if (tablacab.Equals("ODLN"))
                {
                    if (string.IsNullOrEmpty(direPay))
                    {
                        if (string.IsNullOrEmpty(direShip))
                        {
                            SBO_Application.StatusBar.SetText("Cargar direccion al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                            oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                            return;
                        }
                    }
                }

                string v_natu = oDatos.Fields.Item(26).Value.ToString();
                if (string.IsNullOrEmpty(v_natu))
                {
                    SBO_Application.StatusBar.SetText("Cargar naturaleza al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_ope = oDatos.Fields.Item(25).Value.ToString();
                if (string.IsNullOrEmpty(v_ope) || v_ope.Equals("0"))
                {
                    SBO_Application.StatusBar.SetText("Cargar tipo de operacion al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_cont = oDatos.Fields.Item(27).Value.ToString();
                if (string.IsNullOrEmpty(v_cont))
                {
                    SBO_Application.StatusBar.SetText("Cargar tipo de contribuyente al Socio de Negocio", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    return;
                }
                string v_direSal = oDatos.Fields.Item(39).Value.ToString();
                if (string.IsNullOrEmpty(v_direSal))
                {
                    SBO_Application.StatusBar.SetText("Cargar direccion del establecimiento", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_natTrans = oDatos.Fields.Item(32).Value.ToString();
                if (string.IsNullOrEmpty(v_natTrans))
                {
                    SBO_Application.StatusBar.SetText("Cargar naturaleza del transportista", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_direTrans = oDatos.Fields.Item(41).Value.ToString();
                if (string.IsNullOrEmpty(v_direTrans))
                {
                    SBO_Application.StatusBar.SetText("Cargar direccion del transportista", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_chof = oDatos.Fields.Item(37).Value.ToString();
                if (string.IsNullOrEmpty(v_chof))
                {
                    SBO_Application.StatusBar.SetText("Cargar un chofer a la remision", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_idchof = oDatos.Fields.Item(36).Value.ToString();
                if (string.IsNullOrEmpty(v_idchof))
                {
                    SBO_Application.StatusBar.SetText("Cargar cedula al chofer", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                string v_direChof = oDatos.Fields.Item(42).Value.ToString();
                if (string.IsNullOrEmpty(v_direChof))
                {
                    SBO_Application.StatusBar.SetText("Cargar direccion al chofer", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Error);
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                    return;
                }
                #endregion


                //consulta para saber cuantas lineas posee el documento par poder instanciar el objeto de acuerdo a la cantidad de fila
                Recordset oLineas;
                oLineas = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oLineas.DoQuery("select COUNT(*) from " + tabladet + " where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                int i = int.Parse(oLineas.Fields.Item(0).Value.ToString());
                //consultamos a traves de la serie, el folio, establecimiento y punto de expedición
                Recordset oSerie;
                oSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oSerie.DoQuery("SELECT \"BeginStr\",\"EndStr\",CASE WHEN \"NextFolio\" IS NULL THEN 0+1 ELSE \"NextFolio\"+1 END,\"Remark\" FROM NNM1 WHERE \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                string esta = oSerie.Fields.Item(0).Value.ToString();
                string pun = oSerie.Fields.Item(1).Value.ToString();
                int folio = int.Parse(r_folio);
                string timbrado = oSerie.Fields.Item(3).Value.ToString();
                //receptor
                string rec_dep = oDatos.Fields.Item(43).Value.ToString();
                string rec_dist = oDatos.Fields.Item(44).Value.ToString();
                string rec_loc = oDatos.Fields.Item(45).Value.ToString();
                //salida
                string valorSalida = oDatos.Fields.Item(46).Value.ToString();
                string sal_dep = null;
                string sal_dist = null;
                string sal_loc = null;
                //responsable del flete
                string ResFlete = oDatos.Fields.Item(47).Value.ToString();
                string CodLicitacion = oDatos.Fields.Item(48).Value.ToString();
                string transId = oDatos.Fields.Item(49).Value.ToString();
                string infoadicional = oDatos.Fields.Item(51).Value.ToString();
                //string infoExport = oDatos.Fields.Item(51).Value.ToString();

                string valorG = valorSalida;
                string[] guion = valorG.Split('-');
                int g = 0;
                foreach (string valor2 in guion)
                {
                    if (g == 0)
                    {
                        sal_dep = valor2;
                    }
                    if (g == 1)
                    {
                        sal_dist = valor2;
                    }
                    if (g == 2)
                    {
                        sal_loc = valor2;
                    }
                    g++;
                }
                //actualizamos los UDF
                Recordset oActUDF;
                oActUDF = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                oActUDF.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "' where \"DocEntry\"='" + oDatos.Fields.Item(0).Value.ToString() + "'");
                ////actualizamos la numeracion de la serie           
                //Recordset oActSerie;
                //oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                //oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"=" + oDatos.Fields.Item(17).Value.ToString());
                //deconstruimos el RUC del emisor
                string varE = oDatos.Fields.Item(18).Value.ToString();
                int indexE = varE.IndexOf("-");
                int canE = oDatos.Fields.Item(18).Value.ToString().Length;
                string rucE = oDatos.Fields.Item(18).Value.ToString().Remove(indexE, canE - indexE);
                string dvE = oDatos.Fields.Item(18).Value.ToString().Remove(0, indexE + 1);
                string serieremi = oDatos.Fields.Item(17).Value.ToString();
                //deconstruimos el RUC del cliente
                string var = null;
                int index = 0;
                int can = 0;
                string ruc = null;
                string dv = null;
                if (!oDatos.Fields.Item(25).Value.ToString().Equals("4"))
                {
                    var = oDatos.Fields.Item(4).Value.ToString();
                    index = var.IndexOf("-");
                    can = oDatos.Fields.Item(4).Value.ToString().Length;
                    ruc = oDatos.Fields.Item(4).Value.ToString().Remove(index, can - index);
                    dv = oDatos.Fields.Item(4).Value.ToString().Remove(0, index + 1);
                }
                //instaciamos los objetos que vutilizaremos
                servicio.FacturacionElectronicaClient cliente = new servicio.FacturacionElectronicaClient();
                servicio.procesarLotePorFacturaRequest procesarFactura = new servicio.procesarLotePorFacturaRequest();
                servicio.procesarDocumento procesarDocumento = new servicio.procesarDocumento();
                servicio.procesarDocumento[] procesarDocumento2 = new servicio.procesarDocumento[1];
                servicio.rDE rDE = new servicio.rDE();
                servicio.DE DE = new servicio.DE();
                servicio.gOpeDE gOpeDE = new servicio.gOpeDE();
                servicio.gTimb gTimb = new servicio.gTimb();
                servicio.gDatGralOpe gDatGralOpe = new servicio.gDatGralOpe();
                servicio.gOpeCom gOpeCom = new servicio.gOpeCom();
                servicio.gEmis gEmis = new servicio.gEmis();
                servicio.gDatRec gDatRec = new servicio.gDatRec();
                servicio.gCamFE gCamFE = new servicio.gCamFE();
                servicio.gCamFEE gCamFEE = new servicio.gCamFEE();
                servicio.gCamFEI gCamFEI = new servicio.gCamFEI();
                servicio.gCamAE gCamAE = new servicio.gCamAE();
                servicio.gCamNCDE gCamNCDE = new servicio.gCamNCDE();
                servicio.gCamNRE gCamNRE = new servicio.gCamNRE();
                servicio.gDtipDE gDtipDE = new servicio.gDtipDE();
                servicio.gCamCond gCamCond = new servicio.gCamCond();
                servicio.gCamItem gCamItem = new servicio.gCamItem();
                servicio.gCamItem[] gCamItem1 = new servicio.gCamItem[i];
                servicio.gValorItem gValorItem = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA = new servicio.gCamIVA();
                servicio.gActEco gActEco = new servicio.gActEco();
                servicio.gActEco[] gActEco1 = new servicio.gActEco[1];
                servicio.gRespDE gResPDE = new servicio.gRespDE();
                servicio.gCompPub gCompPub = new servicio.gCompPub();
                servicio.gPaConEIni gPaConEIni = new servicio.gPaConEIni();
                servicio.gPaConEIni[] gPaConEIni1 = new servicio.gPaConEIni[1];
                servicio.gPagCheq gPagCheq = new servicio.gPagCheq();
                servicio.gPagTarCD gPagTarCD = new servicio.gPagTarCD();
                servicio.gPagCred gPagCred = new servicio.gPagCred();
                servicio.gCuotas gCuotas = new servicio.gCuotas();
                servicio.gCuotas[] gCuotas1 = new servicio.gCuotas[1];
                servicio.gVehNuevo gVehNuevo = new servicio.gVehNuevo();
                servicio.gRasMerc gRasMerc = new servicio.gRasMerc();
                servicio.gCamEsp gCamEsp = new servicio.gCamEsp();
                servicio.gGrupAdi gGrupAdi = new servicio.gGrupAdi();
                servicio.gGrupEner gGrupEner = new servicio.gGrupEner();
                servicio.gGrupSeg gGrupSeg = new servicio.gGrupSeg();
                servicio.gGrupPolSeg gGrupPolSeg = new servicio.gGrupPolSeg();
                servicio.gGrupPolSeg[] gGrupPolSeg1 = new servicio.gGrupPolSeg[1];
                servicio.gGrupSup gGrupSup = new servicio.gGrupSup();
                servicio.gTransp gTransp = new servicio.gTransp();
                servicio.gCamEnt gCamEnt = new servicio.gCamEnt();
                servicio.gCamEnt[] gCamEnt1 = new servicio.gCamEnt[1];
                servicio.gCamSal gCamSal = new servicio.gCamSal();
                servicio.gCamTrans gCamTrans = new servicio.gCamTrans();
                servicio.gVehTras gVehTras = new servicio.gVehTras();
                servicio.gVehTras[] gVehTras1 = new servicio.gVehTras[1];
                servicio.gTotSub gTotSub = new servicio.gTotSub();
                servicio.gCamGen gCamGen = new servicio.gCamGen();
                servicio.gCamCarg gCamCarg = new servicio.gCamCarg();
                servicio.gCamDEAsoc gCamDEAsoc = new servicio.gCamDEAsoc();
                servicio.gCamDEAsoc[] gCamDEAsoc1 = new servicio.gCamDEAsoc[1];
                servicio.gCamFuFD gCamFuFD = new servicio.gCamFuFD();
                servicio.docAsociado docAsociado = new servicio.docAsociado();
                servicio.docAsociado[] docAsociado1 = new servicio.docAsociado[1];
                servicio.parametrosProcesamiento parametros = new servicio.parametrosProcesamiento();
                servicio.resultadoProcesamiento[] resultadoProcesamiento = new servicio.resultadoProcesamiento[1];
                servicio.documentoElectronicoGenerado[] documentoElectronicoGenerado = new servicio.documentoElectronicoGenerado[1];
                #region LINEAS
                //linea 2
                servicio.gCamItem gCamItem2 = new servicio.gCamItem();
                servicio.gValorItem gValorItem2 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem2 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA2 = new servicio.gCamIVA();
                //linea 3
                servicio.gCamItem gCamItem3 = new servicio.gCamItem();
                servicio.gValorItem gValorItem3 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem3 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA3 = new servicio.gCamIVA();
                //linea 4
                servicio.gCamItem gCamItem4 = new servicio.gCamItem();
                servicio.gValorItem gValorItem4 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem4 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA4 = new servicio.gCamIVA();
                //linea 5
                servicio.gCamItem gCamItem5 = new servicio.gCamItem();
                servicio.gValorItem gValorItem5 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem5 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA5 = new servicio.gCamIVA();
                //linea 6
                servicio.gCamItem gCamItem6 = new servicio.gCamItem();
                servicio.gValorItem gValorItem6 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem6 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA6 = new servicio.gCamIVA();
                //linea 7
                servicio.gCamItem gCamItem7 = new servicio.gCamItem();
                servicio.gValorItem gValorItem7 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem7 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA7 = new servicio.gCamIVA();
                //linea 8
                servicio.gCamItem gCamItem8 = new servicio.gCamItem();
                servicio.gValorItem gValorItem8 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem8 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA8 = new servicio.gCamIVA();
                //linea 9
                servicio.gCamItem gCamItem9 = new servicio.gCamItem();
                servicio.gValorItem gValorItem9 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem9 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA9 = new servicio.gCamIVA();
                //linea 10
                servicio.gCamItem gCamItem10 = new servicio.gCamItem();
                servicio.gValorItem gValorItem10 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem10 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA10 = new servicio.gCamIVA();
                //linea11
                servicio.gCamItem gCamItem11 = new servicio.gCamItem();
                servicio.gValorItem gValorItem11 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem11 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA11 = new servicio.gCamIVA();
                //linea 12
                servicio.gCamItem gCamItem12 = new servicio.gCamItem();
                servicio.gValorItem gValorItem12 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem12 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA12 = new servicio.gCamIVA();
                //linea 13
                servicio.gCamItem gCamItem13 = new servicio.gCamItem();
                servicio.gValorItem gValorItem13 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem13 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA13 = new servicio.gCamIVA();
                //linea 14
                servicio.gCamItem gCamItem14 = new servicio.gCamItem();
                servicio.gValorItem gValorItem14 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem14 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA14 = new servicio.gCamIVA();
                //linea 15
                servicio.gCamItem gCamItem15 = new servicio.gCamItem();
                servicio.gValorItem gValorItem15 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem15 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA15 = new servicio.gCamIVA();
                //linea 16
                servicio.gCamItem gCamItem16 = new servicio.gCamItem();
                servicio.gValorItem gValorItem16 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem16 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA16 = new servicio.gCamIVA();
                //linea 17
                servicio.gCamItem gCamItem17 = new servicio.gCamItem();
                servicio.gValorItem gValorItem17 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem17 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA17 = new servicio.gCamIVA();
                //linea 18
                servicio.gCamItem gCamItem18 = new servicio.gCamItem();
                servicio.gValorItem gValorItem18 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem18 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA18 = new servicio.gCamIVA();
                //linea 19
                servicio.gCamItem gCamItem19 = new servicio.gCamItem();
                servicio.gValorItem gValorItem19 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem19 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA19 = new servicio.gCamIVA();
                //linea 20
                servicio.gCamItem gCamItem20 = new servicio.gCamItem();
                servicio.gValorItem gValorItem20 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem20 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA20 = new servicio.gCamIVA();
                //linea 21
                servicio.gCamItem gCamItem21 = new servicio.gCamItem();
                servicio.gValorItem gValorItem21 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem21 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA21 = new servicio.gCamIVA();
                //linea 22
                servicio.gCamItem gCamItem22 = new servicio.gCamItem();
                servicio.gValorItem gValorItem22 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem22 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA22 = new servicio.gCamIVA();
                //linea 23
                servicio.gCamItem gCamItem23 = new servicio.gCamItem();
                servicio.gValorItem gValorItem23 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem23 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA23 = new servicio.gCamIVA();
                //linea 24
                servicio.gCamItem gCamItem24 = new servicio.gCamItem();
                servicio.gValorItem gValorItem24 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem24 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA24 = new servicio.gCamIVA();
                //linea 25
                servicio.gCamItem gCamItem25 = new servicio.gCamItem();
                servicio.gValorItem gValorItem25 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem25 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA25 = new servicio.gCamIVA();
                //linea 26
                servicio.gCamItem gCamItem26 = new servicio.gCamItem();
                servicio.gValorItem gValorItem26 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem26 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA26 = new servicio.gCamIVA();
                //linea 27
                servicio.gCamItem gCamItem27 = new servicio.gCamItem();
                servicio.gValorItem gValorItem27 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem27 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA27 = new servicio.gCamIVA();
                //linea 28
                servicio.gCamItem gCamItem28 = new servicio.gCamItem();
                servicio.gValorItem gValorItem28 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem28 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA28 = new servicio.gCamIVA();
                //linea 29
                servicio.gCamItem gCamItem29 = new servicio.gCamItem();
                servicio.gValorItem gValorItem29 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem29 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA29 = new servicio.gCamIVA();
                //linea 30
                servicio.gCamItem gCamItem30 = new servicio.gCamItem();
                servicio.gValorItem gValorItem30 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem30 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA30 = new servicio.gCamIVA();
                //linea 31
                servicio.gCamItem gCamItem31 = new servicio.gCamItem();
                servicio.gValorItem gValorItem31 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem31 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA31 = new servicio.gCamIVA();
                //linea 32
                servicio.gCamItem gCamItem32 = new servicio.gCamItem();
                servicio.gValorItem gValorItem32 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem32 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA32 = new servicio.gCamIVA();
                //linea 33
                servicio.gCamItem gCamItem33 = new servicio.gCamItem();
                servicio.gValorItem gValorItem33 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem33 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA33 = new servicio.gCamIVA();
                //linea 34
                servicio.gCamItem gCamItem34 = new servicio.gCamItem();
                servicio.gValorItem gValorItem34 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem34 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA34 = new servicio.gCamIVA();
                //linea 35
                servicio.gCamItem gCamItem35 = new servicio.gCamItem();
                servicio.gValorItem gValorItem35 = new servicio.gValorItem();
                servicio.gValorRestaItem gValorRestaItem35 = new servicio.gValorRestaItem();
                servicio.gCamIVA gCamIVA35 = new servicio.gCamIVA();
                #endregion
                //armamos la estructura que enviaremos con los datos
                //gOpeDE
                gOpeDE.iTipEmi = "1";
                gOpeDE.dInfoFisc = "Remision";
                string oper = oDatos.Fields.Item(25).Value.ToString();
                if (!string.IsNullOrEmpty(infoadicional))
                {
                    gOpeDE.dInfoEmi = infoadicional;
                }
                //gTimb
                gTimb.iTiDE = "7";
                gTimb.dNumTim = timbrado;// timbrado;
                gTimb.dEst = esta;// esta;
                gTimb.dPunExp = pun;// pun;
                gTimb.dNumDoc = folio.ToString("D7");
                //gDatGralOpe
                //armamos el formato de la fecha
                string hora = oDatos.Fields.Item(21).Value.ToString();
                DateTime fe = Convert.ToDateTime(oDatos.Fields.Item(7).Value.ToString());
                string fecha = fe.ToString("yyyy-MM-dd") + "T" + hora; //oDatos.Fields.Item(7).Value.ToString("yyyy-MM-dd") + "T" + hora;        
                gDatGralOpe.dFeEmiDE = DateTime.Parse(fecha);//DateTime.Parse("2022-11-01T17:41:55");
                gDatGralOpe.dFeEmiDESpecified = true;
                //gEmis
                gEmis.dRucEm = rucE;
                gEmis.dDVEmi = dvE;
                //gEmis.dDirEmi = "";//la direccion del punto de expedicion           
                //gDatRec
                gDatRec.iNatRec = oDatos.Fields.Item(26).Value.ToString();
                gDatRec.iTiOpe = oDatos.Fields.Item(25).Value.ToString();
                string pais = oDatos.Fields.Item(16).Value.ToString();
                if (string.IsNullOrEmpty(pais))
                {
                    gDatRec.cPaisRec = "PRY";
                }
                else
                {
                    gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                }
                //gDatRec.cPaisRec = oDatos.Fields.Item(16).Value.ToString();
                gDatRec.dDesPaisRe = oDatos.Fields.Item(38).Value.ToString();

                gDatRec.dNomRec = oDatos.Fields.Item(3).Value.ToString();//"BIGGIE S.A - LAMBARE ROA BASTOS";
                string direRec = oDatos.Fields.Item(5).Value.ToString();
                string newdireRec = null;
                if (!Regex.IsMatch(direRec, @"^[a-zA-Z-0-9]+$") == true)
                {
                    newdireRec = Regex.Replace(direRec, @"[^0-9a-zA-Z ]+", "");
                }
                else
                {
                    newdireRec = direRec;
                }
                gDatRec.dDirRec = newdireRec;// oDatos.Fields.Item(5).Value.ToString();//"AVDA AUGUSTO ROA BASTOS esq San Marcos";
                gDatRec.dNumCasRec = "0";
                gDatRec.dTelRec = oDatos.Fields.Item(6).Value.ToString();//"021615257";
                if (oDatos.Fields.Item(16).Value.ToString() == "PRY")
                {
                    gDatRec.dRucRec = ruc;
                    gDatRec.dDVRec = dv;
                    gDatRec.cDepRec = rec_dep;
                    gDatRec.cDisRec = rec_dist;
                    gDatRec.cCiuRec = rec_loc;
                    gDatRec.iTiContRec = oDatos.Fields.Item(27).Value.ToString();
                }
                //gCamSal
                gCamSal.dDirLocSal = oDatos.Fields.Item(39).Value.ToString();
                gCamSal.dNumCasSal = "0";
                //gCamSal.dComp1Sal =  "aviadores del chaco";
                gCamSal.cDepSal = sal_dep;
                gCamSal.cDisSal = sal_dist;
                gCamSal.cCiuSal = sal_loc;
                //gCamEnt
                gCamEnt.dDirLocEnt = newdireRec;// oDatos.Fields.Item(5).Value.ToString(); //"santa teresa";
                gCamEnt.dNumCasEnt = "0";
                gCamEnt.cDepEnt = rec_dep;
                gCamEnt.cDisEnt = rec_dist;
                gCamEnt.cCiuEnt = rec_loc;
                gCamEnt1[0] = gCamEnt;

                //LICITACION
                #region LICITACION
                if (oDatos.Fields.Item(25).Value.ToString() == "3")
                {
                    Recordset oLicitacion;
                    oLicitacion = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oLicitacion.DoQuery("SELECT \"U_dModCont\",\"U_dEntCont\",\"U_dAnoCont\",\"U_dSecCont\",\"U_dFeCodCont\" FROM \"@LICITACION\" WHERE \"U_LICI\"='" + CodLicitacion + "'");

                    gCompPub.dModCont = oLicitacion.Fields.Item(0).Value.ToString();//"LP";
                    gCompPub.dEntCont = oLicitacion.Fields.Item(1).Value.ToString(); //"12009";
                    gCompPub.dAnoCont = oLicitacion.Fields.Item(2).Value.ToString(); //"22";
                    int sec = int.Parse(oLicitacion.Fields.Item(2).Value.ToString());
                    gCompPub.dSecCont = sec.ToString("D7");// oLicitacion.Fields.Item(3).Value.ToString(); //"218529";
                    DateTime v_fechaLic = DateTime.Parse(oLicitacion.Fields.Item(4).Value.ToString());
                    string fechalic_v = v_fechaLic.ToString("yyyy-MM-dd");
                    gCompPub.dFeCodCont = DateTime.Parse(fechalic_v);//DateTime.Parse("2022-08-31");
                    gCompPub.dFeCodContSpecified = true;
                    gCamFE.gCompPub = gCompPub;
                    //gDtipDE.gCamFE = gCamFE;


                }
                #endregion


                if (oDatos.Fields.Item(34).Value.ToString() == varE)
                {
                    gTransp.iTipTrans = "1";
                    gTransp.dDesTipTrans = "Propio";
                }
                else
                {
                    gTransp.iTipTrans = "2";
                    gTransp.dDesTipTrans = "Tercero";
                }
                gTransp.iModTrans = "1";
                gTransp.iRespFlete = ResFlete;
                gTransp.dIniTras = fe;
                gTransp.dIniTrasSpecified = true;
                gTransp.dFinTras = fe;
                gTransp.dFinTrasSpecified = true;
                //gVehTras
                //gTransp.gVehTras = gVehTras1;
                gVehTras1[0] = gVehTras;
                gVehTras.dTiVehTras = "Terrestre";
                gVehTras.dMarVeh = oDatos.Fields.Item(30).Value.ToString();
                gVehTras.dTipIdenVeh = "2";
                gVehTras.dNroMatVeh = oDatos.Fields.Item(29).Value.ToString();
                //gCamTrans
                gCamTrans.iNatTrans = oDatos.Fields.Item(32).Value.ToString();
                gCamTrans.dNomTrans = oDatos.Fields.Item(33).Value.ToString();
                //deconstruimos el RUC del transportista
                string rucCam = null;
                string dvCam = null;
                if (oDatos.Fields.Item(32).Value.ToString() == "1")
                {
                    string varCam = oDatos.Fields.Item(34).Value.ToString();
                    int indexCam = varCam.IndexOf("-");
                    int canCam = oDatos.Fields.Item(34).Value.ToString().Length;
                    rucCam = oDatos.Fields.Item(34).Value.ToString().Remove(indexCam, canCam - indexCam);
                    dvCam = oDatos.Fields.Item(34).Value.ToString().Remove(0, indexCam + 1);
                }
                string paisTrans = oDatos.Fields.Item(35).Value.ToString();
                if (paisTrans.Equals("PRY"))
                {
                    gCamTrans.dRucTrans = rucCam;
                    gCamTrans.dDVTrans = dvCam;
                }
                else
                {
                    gCamTrans.dNumIDTrans = oDatos.Fields.Item(34).Value.ToString();
                    gCamTrans.iTipIDTrans = "3";
                    gCamTrans.dDTipIDTrans = "Cédula extranjera";
                }
                gCamTrans.cNacTrans = oDatos.Fields.Item(35).Value.ToString();
                gCamTrans.dDesNacTrans = oDatos.Fields.Item(40).Value.ToString();
                gCamTrans.dDomFisc = oDatos.Fields.Item(41).Value.ToString();
                gCamTrans.dNumIDChof = oDatos.Fields.Item(36).Value.ToString();
                gCamTrans.dNomChof = oDatos.Fields.Item(37).Value.ToString();
                string direChofer = oDatos.Fields.Item(42).Value.ToString();
                string newdireChofer = null;
                if (!Regex.IsMatch(direChofer, @"^[a-zA-Z-0-9]+$") == true)
                {
                    newdireChofer = Regex.Replace(direChofer, @"[^0-9a-zA-Z ]+", "");
                }
                else
                {
                    newdireChofer = direChofer;
                }
                gCamTrans.dDirChof = newdireChofer;// oDatos.Fields.Item(42).Value.ToString();
                //gCamNRE
                string motivo = null;
                string codmotivo = null;
                if (tablacab.Equals("OWTR"))
                {
                    codmotivo = "7";
                    motivo = "Traslado entre locales de la empresa";
                }
                else
                {
                    codmotivo = "1";
                    motivo = "Traslado por ventas";
                }
                gCamNRE.iMotEmiNR = codmotivo;// "1";
                gCamNRE.dDesMotEmiNR = motivo;// "Traslado por ventas";
                gCamNRE.iRespEmiNR = "1";
                gCamNRE.dDesRespEmiNR = "Emisor de la factura";
                gCamNRE.dKmR = "3";
                //gCamItem
                int f = 0;
                //recorremos el recordset y mandamos los datos del detalle al objeto
                while (!oDatos.EoF)
                {
                    #region DETALLE
                    if (f == 0)
                    {
                        gCamItem.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();//"024";
                            double dncpNum = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem.dDncpG = dncpNum.ToString();
                        }
                        gCamItem1[f] = gCamItem;
                    }
                    if (f == 1)
                    {
                        decimal ll = decimal.Parse(oDatos.Fields.Item(13).Value.ToString());
                        gCamItem2.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem2.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem2.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem2.dDncpE = oLiciDet.Fields.Item(0).Value.ToString();// "024";
                            double dncpNum2 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem2.dDncpG = dncpNum2.ToString();
                        }
                        gCamItem1[f] = gCamItem2;
                    }
                    if (f == 2)
                    {

                        gCamItem3.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem3.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem3.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem3.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum3 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem3.dDncpG = dncpNum3.ToString();
                        }
                        gCamItem1[f] = gCamItem3;
                    }
                    if (f == 3)
                    {
                        gCamItem4.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem4.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem4.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem4.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum4 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem4.dDncpG = dncpNum4.ToString();
                        }
                        gCamItem1[f] = gCamItem4;
                    }
                    if (f == 4)
                    {
                        gCamItem5.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem5.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem5.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem5.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum5 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem5.dDncpG = dncpNum5.ToString();
                        }
                        gCamItem1[f] = gCamItem5;
                    }
                    if (f == 5)
                    {
                        gCamItem6.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem6.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem6.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem6.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum6 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem6.dDncpG = dncpNum6.ToString();
                        }
                        gCamItem1[f] = gCamItem6;
                    }
                    if (f == 6)
                    {
                        gCamItem7.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem7.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem7.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem7.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); // "024";
                            double dncpNum7 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem7.dDncpG = dncpNum7.ToString();
                        }
                        gCamItem1[f] = gCamItem7;
                    }
                    if (f == 7)
                    {
                        gCamItem8.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem8.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem8.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem8.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum8 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem8.dDncpG = dncpNum8.ToString();
                        }
                        gCamItem1[f] = gCamItem8;
                    }
                    if (f == 8)
                    {
                        gCamItem9.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem9.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem9.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem9.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum9 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem9.dDncpG = dncpNum9.ToString();
                        }
                        gCamItem1[f] = gCamItem9;
                    }
                    if (f == 9)
                    {
                        gCamItem10.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem10.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem10.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem10.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum10 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem10.dDncpG = dncpNum10.ToString();
                        }
                        gCamItem1[f] = gCamItem10;
                    }
                    if (f == 10)
                    {
                        gCamItem11.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem11.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem11.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem11.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum11 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem11.dDncpG = dncpNum11.ToString();
                        }
                        gCamItem1[f] = gCamItem11;
                    }
                    if (f == 11)
                    {
                        gCamItem12.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem12.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem12.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem12.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum12 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem12.dDncpG = dncpNum12.ToString();
                        }
                        gCamItem1[f] = gCamItem12;
                    }
                    if (f == 12)
                    {
                        gCamItem13.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem13.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem13.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem13.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum13 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem13.dDncpG = dncpNum13.ToString();
                        }
                        gCamItem1[f] = gCamItem13;
                    }
                    if (f == 13)
                    {
                        gCamItem14.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem14.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem14.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem14.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum14 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem14.dDncpG = dncpNum14.ToString();
                        }
                        gCamItem1[f] = gCamItem14;
                    }
                    if (f == 14)
                    {
                        gCamItem15.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem15.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem15.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem15.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum15 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem15.dDncpG = dncpNum15.ToString();
                        }
                        gCamItem1[f] = gCamItem15;
                    }
                    if (f == 15)
                    {
                        gCamItem16.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem16.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem16.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem16.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum16 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem16.dDncpG = dncpNum16.ToString();
                        }
                        gCamItem1[f] = gCamItem16;
                    }
                    if (f == 16)
                    {
                        gCamItem17.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem17.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem17.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem17.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum17 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem17.dDncpG = dncpNum17.ToString();
                        }
                        gCamItem1[f] = gCamItem17;
                    }
                    if (f == 17)
                    {
                        gCamItem18.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem18.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem18.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem18.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum18 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem18.dDncpG = dncpNum18.ToString();
                        }
                        gCamItem1[f] = gCamItem18;
                    }
                    if (f == 18)
                    {
                        gCamItem19.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem19.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem19.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem19.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum19 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem19.dDncpG = dncpNum19.ToString();
                        }
                        gCamItem1[f] = gCamItem19;
                    }
                    if (f == 19)
                    {
                        gCamItem20.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem20.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem20.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem20.dDncpE = oLiciDet.Fields.Item(0).Value.ToString(); //"024";
                            double dncpNum20 = double.Parse(oLiciDet.Fields.Item(1).Value.ToString());//50112001;
                            gCamItem20.dDncpG = dncpNum20.ToString();
                        }
                        gCamItem1[f] = gCamItem20;
                    }
                    if (f == 20)
                    {
                        gCamItem21.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem21.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem21.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            Recordset oLiciDet;
                            oLiciDet = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                            oLiciDet.DoQuery("SELECT T1.\"U_dDncpE\",T1.\"U_dDncpG\" FROM \"@LICITACION\" T0 INNER JOIN \"@DETALLE_LICITACION\" T1 ON T0.\"DocEntry\"=T1.\"DocEntry\" WHERE T0.\"U_LICI\"='" + CodLicitacion + "' AND T1.\"U_ARTICULO\"='" + oDatos.Fields.Item(11).Value.ToString() + "' ");

                            gCamItem21.dDncpE = "024";
                            int dncpNum21 = 50112001;
                            gCamItem21.dDncpG = dncpNum21.ToString();
                        }
                        gCamItem1[f] = gCamItem21;
                    }
                    if (f == 21)
                    {
                        gCamItem22.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem22.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem22.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem22.dDncpE = "024";
                            int dncpNum22 = 50112001;
                            gCamItem22.dDncpG = dncpNum22.ToString();
                        }
                        gCamItem1[f] = gCamItem22;
                    }
                    if (f == 22)
                    {
                        gCamItem23.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem23.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem23.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem23.dDncpE = "024";
                            int dncpNum23 = 50112001;
                            gCamItem23.dDncpG = dncpNum23.ToString("");
                        }
                        gCamItem1[f] = gCamItem23;
                    }
                    if (f == 23)
                    {
                        gCamItem24.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem24.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem24.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem24.dDncpE = "024";
                            int dncpNum24 = 50112001;
                            gCamItem24.dDncpG = dncpNum24.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem24;
                    }
                    if (f == 24)
                    {
                        gCamItem25.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem25.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem25.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem25.dDncpE = "024";
                            int dncpNum25 = 50112001;
                            gCamItem25.dDncpG = dncpNum25.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem25;
                    }
                    if (f == 25)
                    {
                        gCamItem26.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem26.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem26.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem26.dDncpE = "024";
                            int dncpNum26 = 50112001;
                            gCamItem26.dDncpG = dncpNum26.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem26;
                    }
                    if (f == 26)
                    {
                        gCamItem27.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem27.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem27.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem27.dDncpE = "024";
                            int dncpNum27 = 50112001;
                            gCamItem27.dDncpG = dncpNum27.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem27;
                    }
                    if (f == 27)
                    {
                        gCamItem28.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem28.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem28.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem28.dDncpE = "024";
                            int dncpNum28 = 50112001;
                            gCamItem28.dDncpG = dncpNum28.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem28;
                    }
                    if (f == 28)
                    {
                        gCamItem29.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem29.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem29.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem29.dDncpE = "024";
                            int dncpNum29 = 50112001;
                            gCamItem29.dDncpG = dncpNum29.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem29;
                    }
                    if (f == 29)
                    {
                        gCamItem30.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem30.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem30.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem30.dDncpE = "024";
                            int dncpNum30 = 50112001;
                            gCamItem30.dDncpG = dncpNum30.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem30;
                    }
                    if (f == 30)
                    {
                        gCamItem31.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem31.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem31.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem31.dDncpE = "024";
                            int dncpNum31 = 50112001;
                            gCamItem31.dDncpG = dncpNum31.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem31;
                    }
                    if (f == 31)
                    {
                        gCamItem32.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem32.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem32.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem32.dDncpE = "024";
                            int dncpNum32 = 50112001;
                            gCamItem32.dDncpG = dncpNum32.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem32;
                    }
                    if (f == 32)
                    {
                        gCamItem33.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem33.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem33.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem33.dDncpE = "024";
                            int dncpNum33 = 50112001;
                            gCamItem33.dDncpG = dncpNum33.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem33;
                    }
                    if (f == 33)
                    {
                        gCamItem34.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem34.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem34.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem34.dDncpE = "024";
                            int dncpNum34 = 50112001;
                            gCamItem34.dDncpG = dncpNum34.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem34;
                    }
                    if (f == 34)
                    {
                        gCamItem35.dCodInt = oDatos.Fields.Item(11).Value.ToString(); //"PV1014";
                        gCamItem35.dDesProSer = oDatos.Fields.Item(12).Value.ToString(); //"NACHOS SABOR QUESO 300 GRS";
                        gCamItem35.dCantProSer = decimal.Parse(oDatos.Fields.Item(13).Value.ToString()); //12;
                        if (oDatos.Fields.Item(25).Value.ToString() == "3")
                        {
                            gCamItem35.dDncpE = "024";
                            int dncpNum35 = 50112001;
                            gCamItem35.dDncpG = dncpNum35.ToString("D8");
                        }
                        gCamItem1[f] = gCamItem35;
                    }
                    #endregion

                    f++;
                    oDatos.MoveNext();
                    if (false == oCompany.InTransaction)
                    {
                        oCompany.StartTransaction();
                    }
                }
                if (false == oCompany.InTransaction)
                {
                    oCompany.StartTransaction();
                }
                //los parámetro de procesamientos
                parametros.retornarKuDE = true;
                parametros.retornarXmlFirmado = true;
                parametros.templateKuDE = "NOTA_REMISION";
                parametros.cicloFacturacion = fe.ToString("yyyy-MM-dd");
                //mandamos los sub ojetos a los objetos principales
                DE.gOpeDE = gOpeDE;
                DE.gTimb = gTimb;
                DE.gDatGralOpe = gDatGralOpe;
                DE.gDatGralOpe.gEmis = gEmis;
                DE.gDatGralOpe.gDatRec = gDatRec;
                DE.gDtipDE = gDtipDE;
                gDtipDE.gTransp = gTransp;
                //gDtipDE.gCamCond = gCamCond;
                gDtipDE.gCamItem = gCamItem1;
                gDtipDE.gCamNRE = gCamNRE;
                gTransp.gCamTrans = gCamTrans;
                gTransp.gCamSal = gCamSal;
                gTransp.gCamEnt = gCamEnt1;
                gTransp.gVehTras = gVehTras1;
                rDE.DE = DE;
                procesarDocumento.rDE = rDE;
                procesarDocumento.parametrosProcesamiento = parametros;
                procesarDocumento2[0] = procesarDocumento;
                procesarFactura.procesarDocumento = procesarDocumento2;
                //procesamos el documento
                resultadoProcesamiento = cliente.procesarLotePorFactura(procesarFactura);
                //obtenemos el resultado
                documentoElectronicoGenerado = resultadoProcesamiento[0].documentoElectronicoGenerado;
                dynamic resultadoOK = resultadoProcesamiento[0].ok;
                //consultamos si el resultado fue TRUE O FALSE
                if (true == oCompany.InTransaction)
                {
                    oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
                }
                if (resultadoOK == false)
                {
                    string mensajeError = resultadoProcesamiento[0].mensajeError;
                    string numDocError = resultadoProcesamiento[0].numDocumentoError.ToString();
                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_MensajeError\"='" + mensajeError.Replace("'", "") + "',\"U_ESTADO\"='NO PROCESADO',\"U_FechaT\"='" + fecha + "' where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Remision no procesada", "", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    SBO_Application.SetStatusBarMessage("Remision creado con error de la SET!!", SAPbouiCOM.BoMessageTime.bmt_Short, true);
                }
                else
                {
                    if (r_folio.Equals("") || r_folio.Equals("0"))
                    {
                        //actualizamos el folio de la factura
                        Recordset oActFolio;
                        oActFolio = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActFolio.DoQuery("UPDATE " + tablacab + " SET \"U_ESTA\"='" + esta + "',\"U_PEMI\"='" + pun + "',\"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "',\"U_TIMB\"='" + timbrado + "' where \"DocNum\"='" + codigo + "'");
                        //actualizamos el folio del asiento
                        Recordset oActAsiento;
                        oActAsiento = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActAsiento.DoQuery("UPDATE OJDT SET \"FolioPref\"='" + esta + "',\"FolioNum\"='" + folio.ToString() + "' where \"BaseRef\"='" + codigo + "' AND \"TransId\"='" + transId + "'");
                        //actualizamos la numeracion de la serie           
                        Recordset oActSerie;
                        oActSerie = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActSerie.DoQuery("UPDATE NNM1 SET \"NextFolio\"='" + folio + "' where \"Series\"='" + serieremi + "'");
                    }

                    //actualizar el estado del documento si es B2G
                    if (v_ope.Equals("3"))
                    {
                        Recordset oActEstado;
                        oActEstado = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                        oActEstado.DoQuery("UPDATE " + tablacab + " SET \"Printed\"='Y' where \"DocNum\"='" + codigo + "'");
                    }

                    dynamic kude = documentoElectronicoGenerado[0].kuDE;
                    string Kude64 = Convert.ToBase64String(kude);
                    dynamic xmlfirmado = documentoElectronicoGenerado[0].xmlFirmado;
                    string xmlfirmado64 = Convert.ToBase64String(xmlfirmado);
                    //extraemos el CDC del XML
                    dynamic json = Encoding.UTF8.GetString(xmlfirmado);
                    string[] indice = json.Split('>');
                    int c = 0;
                    string cdc = null;
                    //string QR = null;
                    foreach (string indice2 in indice)
                    {
                        if (c == 3)
                        {
                            cdc = indice2.Replace("<DE Id=", "").Replace("\"", "").Replace(@"""", "");
                        }
                        //if (c == 250)
                        //{
                        //    QR = indice2.Replace("</dCarQR", "");
                        //}
                        c++;
                    }
                    string id = documentoElectronicoGenerado[0].id;
                    //extraemos el QR del XML
                    string pp = Encoding.UTF8.GetString(xmlfirmado);
                    int ind1 = pp.IndexOf("<dCarQR>") + "<dCarQR>".Length;
                    int ind2 = pp.IndexOf("</dCarQR>");
                    int carateres = ind2 - ind1;
                    string QR = pp.Substring(ind1, carateres);

                    //proceso para grabar en sap
                    Recordset oACtualizarDoc;
                    oACtualizarDoc = (Recordset)oCompany.GetBusinessObject(BoObjectTypes.BoRecordset);
                    oACtualizarDoc.DoQuery("UPDATE " + tablacab + " SET \"U_KUDE\"='" + Kude64 + "',\"U_XMLFIRMADO\"='" + xmlfirmado64 + "',\"U_ID\"='" + id + "',\"U_ESTADO\"='PROCESADO',\"U_CDC\"='" + cdc + "',\"U_FechaT\"='" + fecha + "',\"U_CODIGOQR\"='" + QR + "'  where \"DocNum\"='" + codigo + "'");
                    //MessageBox.Show("Remision creada con exito", "", MessageBoxButtons.OK, MessageBoxIcon.Information);
                    SBO_Application.StatusBar.SetText("Documento creado con exito!!", BoMessageTime.bmt_Medium, BoStatusBarMessageType.smt_Success);
                    //SBO_Application.SetStatusBarMessage("Remision creado con exito!!", SAPbouiCOM.BoMessageTime.bmt_Short, false);
                }
            }
            catch (Exception e)
            {
                MessageBox.Show(e.ToString());
                //oCompany.EndTransaction(BoWfTransOpt.wf_RollBack);
            }

        }
        #endregion
    }
}
